thread,timestamp,speaker,message
1,1546233120.5048,Antwan,I'm looking at laterna now and I'm not quite sure; Maybe something about the way it displays characters in cells means that a new line wont implicitly move to a cell below?
2,1546259234.5068,Brain,"I'm currently doing some experimentation getting a vscode WebView REPL with REBL like viewing, although it's very prototype and early days currently. Full code editing would require literally throwing out vscode's editor and using a custom one however, since it's quite strict about what you can do within a vanilla text editor.; This is *definitely* a path I feel needs pursuing to it's fullest though, even if it means dropping vscode and building a dedicated electron application.; I never saw the Interlisp version of that, though I've read many times how friendly it was considered to be. The only experience I have with lispms is mid-90's Symbolics machines, are there any emulators, videos, or perhaps surviving documentation that describe it?"
2,1546266997.5103,Isa,"I need to convert file to PDF, but:
- things have to be precise to each mm
- input file has to be in format easy to edit by user, PhotoShop, some kind of drawing in web browser, maybe even XML
- if font is too big to fit text into space it needs to decrease font

I don’t any good solution to do it. Generating PDF is a nightmare.
* Unless I want to pay a lot for some extra payment SaaS or libraries; But idea is to make a product from it, so I don’t want to stick with any sick high price licence"
3,1546268494.5114,Isa,especially for label printers
4,1546273024.5134,Jessia,"Depending on how you want to deliver this to users, the cheap-and-cheerful option is to make a printer-friendly HTML page and let users print to PDF (or paper) themselves"
5,1546277759.5141,Latonya,"In what way can something be precise to each mm, but also auto-adjust text size?  I don't understand how those two desires can be satisfied at the same time."
5,1546277872.5142,Sheron,"imho it's always a nightmare, even with paid add ons"
6,1546280660.5159,Lana,"I feel like I must be missing something… why is it that when I call `keys` on a `sorted-map`, I don’t get a sorted collection? I am trying to implement a simple interval tree, and this gap is a sticking point."
6,1546281120.5166,Rosaline,"what do you mean by a sorted collection?; if you mean a seq of the keys in order, I am not sure, but I would be surprised if that is not what you get, so I wonder what makes you think that is not what you are getting; ```
user=&gt; 
(let [x (shuffle (range 32))]
  (= (sort x)
     (keys (into (sorted-map) (zipmap x x)))))
true
user=&gt; 
```"
7,1546282664.5189,Antwan,"maybe postscript would be helpful?; _in general_ what you want to do might be a headache and a half, but it might be possible to hack together something specific; Like, a brute force way might be (if you are printing only one line on a label) to pick a font size based on a heuristic (12, lets say) and then render a pdf. Run an image of that pdf through handwriting recognition software and see if it reads it correctly; then just find the largest font size on which you can read everything; and if there is none then you can send a message back to your users that there is no way for you to do it; as an upside you can throw ""uses machine learning"" on whatever your product is; as a downside there is everything else"
8,1546285238.5241,Isa,"I don’t know any way to do it with precision to each 1 mm; Only with Java and even then it is super hard. But with Java code users can’ really give an input as a file; What is the best way in your opinion to convert input (file, XML, etc.) to PDF with precision to 1 mm?"
8,1546286435.5253,Lana,"<@Rosaline> I mean something that implements `clojure.lang.Sorted` so you can use `subseq` on it.; They do come back in the expected order, but not implementing the right interfaces to take full advantage of that.; Ah,  but it turns out the map itself does implement sorted, so I can use `subseq` directly on that, which addresses my efficient interval matching quite effectively.; That’s what I was missing. ^_^"
9,1546306658.5357,Alix,"I'm confused about when to use what style of namespaced keys. I know how they work, I just don't know what is best from a maintainability standpoint. For example is `:user/email` a good namespaced key? Or should it be namespaced to the company such as `com.company.user/email`? Or perhaps namespaced to the project `com.company.project.user/email` or even a project file namespace such as `com.company.project.spec.user/email`. Should any way be used exclusively, or are there use cases where either style might be used? I'm thinking that `:user/email` still might result in naming collisions if two systems deal with `user` in a different way. I'm hoping to figure out an optimal solution for systems spanning many projects in an organisation.; I think I remember a Rich Hickey talk on this but I don't remember which one"
9,1546307149.537,Rosaline,"project level is pretty good, I don't care very much for using the names of code namespaces for keyword namespaces; I think a good rule of thumb is to imagine all your data that exists in memory exists in a sql database, the namespaces would be the table names and the names would be the column names; and then imagine everyone's data is in the same global table space, and what would you need to name your tables to avoid collisions"
9,1546307387.5394,Alix,"When you say everyone's data, are you referring to company level namespace like `com.company.user/email`?"
9,1546307429.5402,Rosaline,"that would be one possible solution to that, prefixing all your table names with some string that you ""own""; another solution would be using uuids, which would work but are not very friendly"
9,1546308637.5425,Celestine,"Another factor to consider <@Alix> is how ""global"" your data is going to be. Is this just a map of data that will exist inside your company? Inside just this project? How unique does the name need to be?; If you produce it from a library you put out there for everyone to use, it needs to be ""more unique"" so that it can't conflict with any similar data used by any of the users of your library."
10,1546308825.544,Madeleine,I know I've used `::`
9,1546308843.5445,Madeleine,And the issue was that it coupled our key names with the namespace;  So I'd say be careful about that
9,1546309732.556,Alix,"Right so it looks like there is no real convention around this. And I should just go with what makes the most sense given the factors.; Some examples:
If I need a db uri for my users db in my company I could namespace like this `:db.users/uri`. I wouldn't want to use `:db/uri` as I might have many databases in my company. I also didn't namespace to the company because this key will be accessed only within the company
And I could use `:user/email` if users in my company are global among all projects. But if my company had two products I would namespace the user attributes accordingly such as `:project1.user/email` &amp; `:project2.user/email` but only if some of the code was shared in any way.; That's where my thinking is after considering the feedback"
11,1546312533.5662,Otelia,"This issue of keyword namespaces is very confusing to me. What advantage is there to making the keyword completely unique across, for example, the organization? In other words, what harm is there in using :user/email for the email column in two different DBs in an organization? Is the keyword alone really used to determine which table an attribute belongs to?; Maybe :person/email would be an even better example."
9,1546313392.5754,Alix,"<@Otelia> If there was 2 databases for users (employees, clients) then the business logic for dealing with the two types of users would probably be different. And the data is stored is two different places. To me this because of the 2 datasources, I would think to namespace to two separate namespaces. The namespace gives me the ability to inspect my data and decide if I want to do something with a client or an employee. And I can tell the difference because of the namespace. If there was no difference, then there would be no reason to store client &amp; employee separately or differently (with some technical exceptions such as security). Because they're essentially the same I would namespace them the same. I'm still working all this out but that's my thinking."
11,1546313477.5767,Otelia,I understand what you're saying. I'm just surprised that there wouldn't always be context available (client vs employee) and that the keyword alone must be unique to get the context.
9,1546313759.5798,Alix,"Yea that's something I've though about also. For example the namespaces seem redundant for this data structure `{:orgs [{:org/employees [{:employee/paychecks [{:paycheck/id 1}]}]}]}` because each level up contains the context. Perhaps the namespace allows you to avoid passing in the context or more information than that is needed. For a paycheck/id=1 instead of giving `{:employee/paychecks [{:paycheck/id 1}`, you just give `{:paycheck/id 1}` and the namespace allows you to determine the context."
9,1546313839.5806,Otelia,I think you must be right.; But it would be interesting to know what specific benefits others have found for the unique keywords.
9,1546313975.5833,Alix,Yea I'd like to know also. I've never written code like and I'd like to know if others how found it practical for production use; The most practical scenarios I can think of is dynamic spec validation. It could just lookup the spec for all its keys and avoid knowing any context apart from the keys; I've never done that though so I'm not sure how if at all it would work; Or even if it's a good idea. I feel like you would want to explicitly specify what spec you're validating against
9,1546314104.5858,Otelia,"OTOH, a spec for :person/email would probably work for email addresses in all tables."
9,1546314190.5863,Alix,"However you could still do that with unique keys and some mapping.; But your thinking raises another question for me. So far I've assumed that the namespace of keys in a map would be the same. Are there any use cases for them to be different? Perhaps what your suggesting might also be a correct way of doing this. `{:person/id ""123"" :person/name ""Caleb"" :employee/number ""001""}`; As long as there would be no way that the information stored in the shared keys would need to be handled differently I would think"
9,1546314437.5908,Otelia,"Yes, I've wondered about that. But I don't have enough experience in Clojure to say. Someone with more experience will probably chime in. I can admit that unique keywords give you the most flexibility for treating them differently, if necessary, just don't know specifically when it's necessary."
9,1546314482.5914,Alix,Yea I agree. How far is too far. Perhaps there are times when you would use them and times when you wouldn't.
9,1546314717.5947,Celestine,"When you're looking at nested data structures, remember that sometimes you'll just be passing part of it around -- so you don't always have the parental context.; Qualified keys are designed to ""avoid conflicts"" and to ""uniquely identify an entity in a given context"". So they really are about _context_.; For example, at work, we have a billing subsystem and we generally have all the keys in maps associated with billing qualified with `wsbilling`. The context we need to convey is that ""this data all belongs to billing"", so the maps within that system tend to have keys like `:wsbilling/member-id`, `:wsbilling/initial-amount` and so on -- unique within the context of billing and the systems that it interacts with.; Another part of the system deals with multiple ""layers"" of domain logic so it uses qualifiers that identify the different layers."
9,1546315080.6019,Alix,"Right that makes sense. And expanding upon mixing namespaces in a map as I previously suggested. Looking back on work with datomic, your entities wouldn't contain maps with mixed namespaced keys. They would nest them under a ref."
9,1546315091.6025,Celestine,"Some of these qualifiers match actual namespaces, some don't."
9,1546315110.603,Alix,So perhaps the second nesting would be better than mixing namespaces
9,1546315133.6038,Celestine,"The idea is you use whatever qualifiers make sense for your data in your context. Making these ""as unique as they need to be""."
9,1546315200.6052,Alix,<@Celestine> And would the use of qualifiers matching actual namespaces be almost exclusively used for keywords private to the namespace? Are there other reasons you might do this?
9,1546315204.6053,Celestine,(which is why there are no specific rules of thumb about this whole thing :slightly_smiling_face: )
9,1546315446.6086,Alix,Yea Clojure is very interesting in that regard. It's like the complete opposite of something opinionated like ruby on rails. Everyone sort of does what works for them. It does make it a little difficult if you're new however as its hard to copy what other people do because everyone does it so differently. I imagine it's an experienced developers dream though as they can do everything exactly how they like it.
9,1546315471.609,Celestine,"It means you need to understand more of the abstractions and concepts, yes."
9,1546315790.6106,Nova,"<@Alix> It's more so that people program with abstractions, and the concrete code that comes out varies"
9,1546315819.6107,Otelia,"Thanks Sean, I see your point about nested data structures. And it is good to know that there is no standard convention.

Another question: If you have both :employee/email and :client/email, don't you sometimes want to treat all emails the same or similarly, and in that case do you use the keyword name to identify it as an email? Just curious if you'd encountered that situation."
9,1546316156.6143,Alix,<@Nova> That blows my mind a little bit. When deciding on how to implement something I've usually started by figuring out what worked for me in the past or finding out what other people have done. Pretty much just lots of practice. Perhaps to improve myself I should spend some more time reading up on the theory.
9,1546316480.6167,Nova,"<@Alix> It's not so much about theory, as much as it's about understanding 'what needs to happen'"
9,1546316498.6171,Celestine,"<@Otelia> If you've named them `:employee/email` and `:client/email` it'll generally be because you want to be able to tell them apart in a particular context. If you want to do something email-generic, you can pass either value to a function that just takes ""an email address"" or you can construct a new map containing the bits you might want under more generic names.; When you get into specs, you also have to consider whether these fields have the same underlying spec or not."
9,1546316550.619,Nova,"<@Alix> I find that when programming in Lisps, especially clojure, I rarely need to think about writing code. I spend most of my time thinking about architecture or specification. I find this also leads to better applications."
9,1546316572.6194,Celestine,"For example, your spec for `:employee/email` might be a regex that has a fixed `@` domain name part (for your company).; <@Alix> Clojure certainly rewards thinking at a higher level of abstraction a lot of the time... and can punish thinking at a lower level sometimes :slightly_smiling_face:"
9,1546316715.6214,Nova,"<@Celestine> I feel like that's a bit unfair, because the flexibility of the language allows you to do far-reaching optimizations with lower-level code changes. Perhaps more accurate to say that Clojure punishes premature optimization more than other languages?"
9,1546317028.6233,Otelia,"My takeaway from this conversation is that I am free to use keyword namespaces for whatever purpose is most suited to my app, which turns the focus back to the app data model. It's a nice freedom. Thanks everyone for the comments and help."
9,1546317163.6236,Alix,Likewise thank you for the help
9,1546317297.6242,Celestine,"<@Nova> OK, yeah, that's what I was reaching for really.; But also if you try to dive in and think about problems the way you might in other languages -- where mutable variables and loops are the basic building blocks -- you'll find Clojure working against you.; So you often have to step back and think in terms of collections rather than elements, and abstractions rather than implementation, in order to get the ""shape"" of a Clojure solution."
12,1546337737.629,Sheron,"wondering which is more intuitive for people to read, dispatching async work in future or async/thread , any opinions ? i don't really care for results that much but i need to dispatch a bunch of i/o bound threads and wait for all of them to finish; and count of threads is likely to be bigger than core count because i/o has latency :disappointed:; it appears they both easily scale beyond the count of cores available"
13,1546348530.6354,Stefany,"I am doing some timeseries analytics with clojure, and I have noticed some strange performance issues in loading data. I load timeseries from CSV files (size 500KB each), and I find that slurping data in takes 10ms, and then the CSV parsing takes 100ms (I parse timestamp, and floats). I compared this to incanter csv load (which takes 300ms, so worse). I used taoensso.tufte for performance tracking. I wonder if there are any ideashow to improve performance of such stimple things? If reading from disk takes 10ms, then the parsing should be perhaps another 10ms, but not longer, as disks typically are the bottomleg.  I spend a lot of time just to get simple benchmarks, because I had to remove all the lazyness via ""doall"".  Any ideas on how to speed Clojure up? Any tricks or recommendations?"
13,1546349039.6362,Sheron,did you measure the timings before and after jit got kicked in as well ?
13,1546349068.6366,Stefany,I assume the Java JIT runs the first time a function is called.; I ran my performance numbers many times.; So I dont think this is the culprit.
13,1546349103.6378,Sheron,"they dont get compiled on the first time; that number is either in hundreds or thousands before java kicks it's jit into motion; but if you had files of 500kb then yes it should have kicked in at some point; can you try to isolate the slowness part by excluding parts of parsing ?; date parsing does sound a little bit of annoying , so i would try to avoid that at first"
13,1546349168.6397,Stefany,I now track everything
13,1546349187.6403,Sheron,if it turns out to be the slowpoint you'll figure out what to optimize
13,1546349189.6405,Stefany,But I still miss about 50% of the total time.
13,1546349218.6409,Sheron,how many rows do you have in those 500kb ? and how many columns ?
13,1546349313.641,Stefany,"None; 5000 rows, 6 cols"
14,1546349398.6427,Matha,"Hi! I am in a bit of a pickle. I would like to use generative testing as part of my test suit and to this end wrote the following test:
```
(deftest generative
  (is (successful? (stest/check `term-&gt;ast))))
```
When running this, however, I get the following error:
```
Exception: java.util.concurrent.ExecutionException: Syntax error compiling at (clojure/test/check/clojure_test.cljc:95:1).
...
```
This only happens if the assertion fails; if it passes everything is fine. Any idea why?"
13,1546349453.6428,Stefany,"sorry, I could not post to this thread my performance snippet.; What is really bizarre that the slurping is so fast,; and the parsing so slow.; It is order of magnitudes opposite how it should be.; this is the source"
13,1546349971.644,Sheron,"i tried this over here; generating a csv file with
```
for((i=0; i &lt; 25000; i++)); do echo ""`date -Iseconds`,$i.25,\""anytext\""""; done &gt; somecsv.csv
```; and then tried this code to read the result:
```
(defn do-parsing[]
  (let [data (slurp ""somecsv.csv"")]
    (last (csv/read-csv data))))

(defn time-parsing []
  (time (do-parsing)))

; (time-parsing)
```; indeed seems like feeding it into the read-csv added 200ms of execution time"
13,1546350407.6448,Stefany,"bizarre, isnt it?; I thought that perhaps the clojure csv library is somehow not performance optimized,; So this is why I tried incanter.; But incanter is even slower."
13,1546350633.6456,Sheron,"i would rather look for a pure java csv parser and wrap it into something comfy; it looks to me that already splitting the lines apart by linebreaks is slower than slurping it from the disk; i tried to parallelize the work
```

(defn do-parallel-parsing[]
  (let [data (slurp ""somecsv.csv"")
        rows (clojure.string/split-lines data)
        parsed-rows (pmap csv/read-csv rows)]
    (last parsed-rows)))

(defn time-parallel-parsing []
  (time (do-parallel-parsing)))

; (time-parallel-parsing)

```; and that was a bit faster but still slow by all means :slightly_smiling_face:; and had a chance of introducing bugs due to linebreaks within cell values"
13,1546350760.6466,Stefany,perhaps nobody every uses csv files in clojure; so this might be the reason.
13,1546350777.647,Sheron,but even the split lines here took the execution time to 50ms already before any csv action
13,1546350825.6472,Stefany,"line splitting can be a performance cost,"
13,1546350826.6474,Sheron,people use csv for sure :slightly_smiling_face: but yeah probably they don't go after the milliseconds but have more slowness somewhere else
13,1546350828.6476,Stefany,"if it is not done correctly.; because one has to create thousands of sub strings; and this is expensive.; well,; my thinking is,; that csv parsing should be a fraction of the time it takes to read it from disk.; I have written a library in c# for .net; that had that performance.; so something is really wrong here.; But I have no clue what.; I am too much novice of clojure to find that out."
13,1546351111.6498,Sheron,i tried to use java's own string splitting .. yes it's in a class of it's own
13,1546351134.65,Stefany,"When I wrote my c# csv parser,"
13,1546351137.6502,Sheron,"```

(defn do-parallel-parsing[]
  (let [data (slurp ""somecsv.csv"")
        rows (into [] (.split data ""\n""))
        parsed-rows (pmap csv/read-csv rows)]
    (last parsed-rows)))
```; just like that"
13,1546351145.6506,Stefany,"I bascically created my own string class,"
13,1546351154.6508,Sheron,my example went from 100ms to 50-60 range
13,1546351154.651,Stefany,"that allowed you to take sub-strings.; so I have avoided all the senseless copying of strings.; and in the parsing,"
13,1546351180.6516,Sheron,but now my son is requesting my attention ... good luck  (and yeah. get an efficient java lib for the heavy loading)
13,1546351181.6518,Stefany,"I wrote my own parser,; by reading from my own datastructure; Thanks a lot kulminaator!; Happy new year!"
15,1546354335.6565,Nannette,"I really love Clojure and Clojure REPL is the most productive environment I have ever used. Now I encountered one puzzle with Clojure REPL that I can't figure out how to do it. I needed to create a couple of gen-classes for a Java API I'm using via Clojure/Java interop. Before those gen-classes using Clojure REPL was a breeze. If I wanted to refresh all namespaces in Clojure REPL I just called function
(do (require '[clojure.tools.namespace.repl :refer [refresh]]) (refresh))
... in Clojure REPL. But after implementing those gen-classes I get error: ""namespace 'mygenclass' not found after loading 'mygenclass"". I was wondering if there is some standard procedure  or best practice with gen-classes I have missed?"
15,1546354864.6596,Samual,"<@Nannette> By the way, which REPL are you using? Are you using :gen-class in the ns declaration or a free-standing (gen-class)? Anyway, I do not know c.t.n.repl, but I sometimes see that error message, in Cider, after trying to reload a ns that has errors in it OR trying to reload a ns whose name does not correspond to its filename."
15,1546356145.6617,Nannette,"I'm using Cursive REPL with IntelliJ IDEA. I really love Cursive. I have configured all kinds of hotkeys for IntelliJ/Cursive and using those hotkeys I can jump back and forth between editor and REPL, send S-tokens from editor to REPL etc. I really love it. This refresh issue with gen-class is the only thing that causes a bit of nuisance.; I'm using :gen-class in the ns declaration. Example in comment thread.; Example:
(ns simpleserver.util.azuregenclass.session
  (:import (com.microsoft.azure.storage.table TableServiceEntity))
  (:gen-class
    :extends com.microsoft.azure.storage.table.TableServiceEntity
    :constructors {[] []}
    :init init
    :prefix ""bean-""
    :state state))

(defn bean-init
  ([]
    ))"
16,1546358857.6631,Ellyn,"IIRC, this is related to <https://dev.clojure.org/jira/browse/CLJ-2343>, and would be fixed if that patch was applied; Nicola would know for sure"
15,1546364426.6635,Sheron,"btw. after giving the jvm a good chance at jit compiling the whole thing i reverted the code pretty much to original; looks like the repl is just getting into my way here :slightly_smiling_face:; with code like this
```
(ns silly-csv-parser.core
  (:require [clojure.data.csv :as csv])
  (:gen-class))

(defn do-parsing[]
  (let [data (slurp ""somecsv.csv"")]
    (last (csv/read-csv data))))

(defn time-parsing [_]
  (time (do-parsing)))

(defn -main
  ""I don't do a whole lot ... yet.""
  [&amp; args]
  (mapv time-parsing (range 1 25)))
```; running the (time (do-parsing)) from the repl was always like 200ms; however ,  lein uberjar and then running that jar was a wastly different result"
15,1546364585.6645,Celestine,That exception comes from `defspec` in `clojure.test.check.clojure-test` -- which doesn't match the code you shared <@Matha>
15,1546364597.6647,Sheron,"```
$ lein uberjar
Compiling silly-csv-parser.core
$ java -jar target/uberjar/silly-csv-parser-0.1.0-SNAPSHOT-standalone.jar 
""Elapsed time: 301.065242 msecs""
""Elapsed time: 66.629456 msecs""
""Elapsed time: 112.770513 msecs""
""Elapsed time: 46.826564 msecs""
""Elapsed time: 54.771694 msecs""
""Elapsed time: 47.163652 msecs""
""Elapsed time: 45.761238 msecs""
""Elapsed time: 46.835782 msecs""
""Elapsed time: 49.504536 msecs""
""Elapsed time: 37.032187 msecs""
""Elapsed time: 37.907508 msecs""
""Elapsed time: 44.113467 msecs""
""Elapsed time: 34.527459 msecs""
""Elapsed time: 34.381777 msecs""
""Elapsed time: 35.217125 msecs""
""Elapsed time: 34.771945 msecs""
""Elapsed time: 40.187299 msecs""
""Elapsed time: 34.952462 msecs""
""Elapsed time: 35.637608 msecs""
""Elapsed time: 34.520076 msecs""
""Elapsed time: 35.482058 msecs""
""Elapsed time: 34.636292 msecs""
""Elapsed time: 35.011732 msecs""
""Elapsed time: 35.886221 msecs""
```; you can see pretty well where the jit and proper memory management seem to kick in :slightly_smiling_face:"
15,1546365482.6651,Nannette,Ok. Thanks for info. Let's hope that patch will fix this issue some day. :slightly_smiling_face:
17,1546366109.6653,Britteny,"went and upvoted the issue, since I happened to stumble on genclassing lately too; more upvotes might help :slightly_smiling_face:"
17,1546366802.6657,Nannette,I signed in to Clojure JIRA and upvoted as well. :slightly_smiling_face:
18,1546369955.6701,Vita,could anyone provide some pointers on a macro I’m trying to write? I want a function or macro that I can call with a map of let bindings (symbols to values) and then execute some form in the body of that let. I have it working for some cases but not all.; None
19,1546370355.6716,Rosaline,you cannot do that in the general case
18,1546370385.6719,Vita,really? :disappointed:
18,1546370388.6721,Rosaline,yes; you are trying to build a structure at compile time that depends on a value at runtime
18,1546370415.6727,Matha,<@Celestine> I am most definitely running `deftest`; I just tried it again after clearing the cache :thinking_face:
18,1546370459.6738,Vita,hm is there no way to achieve the same goal? eval some code with different values for particular symbols as supplied by some map?
18,1546370464.6741,Rosaline,"you're existing implementation is also broken for the case were it ""works"" because it ends up double evaling; what you are describing is a function; code parameterized by different arguments"
18,1546370596.6761,Vita,lol. yeah in abstract I guess. in this case I’m taking code as input and want to replace the meaning of some things using data. Should I just be walking the form and making replacements instead of trying to keep the same symbols but assign different values than what they’d otherwise resolve to?; I guess maybe that’s better
18,1546370633.6768,Celestine,What is the rest of the stack trace?
18,1546370777.6779,Rosaline,"<https://github.com/ztellman/riddley> is a library that might be helpful (I've never used it, I would be more inclined to write an interpreter for a dsl then to try and transform clojure expressions and call eval on them)"
18,1546370802.6781,Matha,<@Celestine> <https://gist.github.com/hmaurer/447392ac3ddee94250d26f580f6c7310>
18,1546370888.6789,Vita,"thanks, I’ll take a look"
18,1546370931.679,Matha,perhaps the fact that I am using kaocha as a test runner is the issue :thinking_face:; nah it’s not; I am getting the same error with vanilla `lein test`
20,1546375331.6796,Celestine,There is a lot of machinery in that stack trace beyond `clojure.test` and I see you're also using `respeced.test$successful_QMARK_.invokeStatic (test.cljc:104)` which seems to be what is actually leading to the error here...
18,1546375614.681,Matha,<@Celestine> problem solved in the end; it was an issue with `lein test` monkey-patching `clojure.test` :face_with_rolling_eyes:
20,1546375628.6813,Celestine,Ouch!; It's not compatible with `respeced`?
20,1546375687.6822,Matha,<@Celestine> <https://dev.clojure.org/jira/browse/TCHECK-113> if you are interested (thanks to <@Clarine> for finding this). The issue is tangential to `respeced`.; Also `test.check v0.10.0-alpha3` doesn’t seem to have the issue
20,1546375745.6826,Clarine,"respeced has nothing to do with it, it’s a clojure.test.check + lein issue"
20,1546375820.6828,Matha,"ah yes, tangential wasn’t the right choice of word; I meant they were unrelated :slightly_smiling_face:"
20,1546375861.683,Clarine,"well, they are related, so I get it. but the problem is really with lein’s monkey patching I guess"
20,1546375863.6832,Celestine,<@Clarine> Cool. Was just curious when I saw it in the stacktrace -- I hadn't looked at the code.
20,1546375955.6834,Matha,<@Clarine> do you use `test.check` v`0.10.0` yourself?
20,1546375973.6836,Clarine,"no, but I haven’t used lein for testing for a long while"
20,1546376008.6838,Celestine,"Lein's monkey-patching has caused problems with other tooling in the past (and, lately, `~/.lein/profiles.clj` seems to be the bane of every beginner's life).; (also haven't used Leiningen for a long time -- switched to Boot three years ago and switched to `clj`/`deps.edn` this year)"
20,1546376073.6842,Clarine,"I’m going along the same path. For work we’re using boot still, but for newer personal projects I tend to choose TADA"
20,1546376130.6844,Celestine,We were very heavy Boot users until this year. We just started having too many problems with it :disappointed:
20,1546376142.6846,Clarine,"being able to use git and local deps really makes a difference; we don’t have many problems with it at work, so no need to migrate for now."
20,1546376353.685,Matha,<@Celestine> I wanted to use Boot but there was a nice template project for Fulcro + shadow-cljs with lein; <@Celestine> what do you use now? deps.edn?
20,1546376972.6854,Celestine,"See 14 minutes ago in this thread :slightly_smiling_face: ""(also haven't used Leiningen for a long time -- switched to Boot three years ago and switched to clj/deps.edn this year)""; So we run tests with Cognitect's `test-runner`"
20,1546378022.6858,Clarine,"I use that one also, if I’m not using my own test runner script."
21,1546392510.6872,Ferne,"<@Vita> if you're taking code as input at runtime, I think that's basically the definition of what `eval` is for; if the code has unbound locals, which I _think_ is what you're describing, I've used a trick to wrap it in a function that takes the named arguments you want to supply

e.g.,
```
(eval `(fn [{:keys [~@some-arg-names]}] ~the-expression-with-unbound-locals))
```; then you can call that function with a map"
21,1546392693.69,Vita,ooh; I think that would do the trick. thanks for the idea!; should’ve known I was trying to do too much in one macro + eval instead of just using a function lol; thanks <@Ferne> that allowed me to do what I was trying to.; I’m not actually trying to rebind merge to inc.. just an example. lol; though a “guess what function I replaced your original function with” game sounds fun
21,1546395923.6932,Ferne,Nice
22,1546400418.6944,Mariela,"Is there something like <https://github.com/lightyear/sql-logging#options> but for Clojure?

tldr it aides you see if you have costly SQL being emitted, and actually points out the culprit LOC; On second thoughts, probably this library wouldn't make _that_ much sense in Clojure, given ""magical"" ORMs aren't the norm here... so emitted SQL should have no surprises

...but still I can see myself using some simple metrics, e.g. query _x_ took 30ms"
22,1546400991.6995,Celestine,<@Mariela> I believe there are Java libraries that can act as a proxy for the actual JDBC driver and provide that sort of statistical logging.
22,1546401030.6996,Mariela,thanks! will look into it
22,1546401080.6998,Celestine,<https://github.com/ttddyy/datasource-proxy>
22,1546401144.7001,Vita,<@Mariela> you can always just hook the function yourself too if you can find the place you want to instrument
22,1546401201.7004,Celestine,User guide <http://ttddyy.github.io/datasource-proxy/docs/current/user-guide/index.html>
22,1546401293.7008,Mariela,"Fantastic. TIL :slightly_smiling_face:; Handy, thanks! :beers:"
22,1546401345.7012,Celestine,"If you have any problems integrating it with `clojure.java.jdbc`, ping me in the <#C1Q164V29|sql> channel and I'll see if I can help."
22,1546401791.7016,Vita,"np! and if you want to see what code led to it you could create an exception and parse the stack trace (or I think later versions of java have mechanisms to reflect on the stack without making exceptions). Obviously this solution has potential issues with laziness or the arguments not containing the info you want, but it’s often a quick easy option for local dev and can be applied to almost any clojure library."
22,1546402325.7018,Mariela,"Got it, good call!"
23,1546412740.7022,Stefany,OMG!; I thought that the REPL compiles the same way how it would be compiled to a JAR. I don't get it...; But thank you so much! I honestly would  never have believed that such great differences possibly could exist between repl and jar!! :+1::heart:
24,1546422399.7038,Kristine,"why does `(read-string ""07"")` return `7`, but `(read-string ""08"")` throws an exception?"
24,1546422603.7046,Tammera,"a leading zero often means that the following number is octal; 8 however, is not a valid literal in octal; `(read-string ""010"")` is also 8 (base 10) instead of the 10 (base 10) you would have expected; WHY they decided to have `0` be the prefix for octal instead of `0o` is beyond me. As the hex/binary prefix is `0x` and `0b` respectively…"
24,1546422933.7069,Elizebeth,Yay Java. I remember that one hitting me way back when I was doing Java for my degree...
25,1546428336.7072,Kristine,thx
26,1546445803.7115,Celestine,"Because everything dating back to C did it. Technically back to B, C's predecessor. B's predecessor BCPL used # for octal but B used that as an operator. So leading 0 means octal in almost every language out there today. "
24,1546445858.7118,Tammera,"Yeah, but, “because language X did it” is not a technically sound argument IMO :wink:"
26,1546445992.7147,Celestine,"Octal was much more common back in the day. I worked with octal a lot. Then later ""graduated"" to hex. So those early conventions were very strong for a generation of programmers, maybe even two generations. And those were the folks that designed and built all the languages we use today. "
26,1546446168.7149,Tammera,"Right, it makes sense. But endlessly sticking with the convensions of your predecessors ends up with situations where newer developers wonder why a leading zero changes `read-string` to a base that is hardly used anymore."
24,1546446201.7151,Tammera,"At some point, someone needs to decide that that is crazy, and throw it out of (newer) languages"
24,1546446491.7153,Elizebeth,Was there ever an A?
26,1546446716.7178,Celestine,"BCPL -&gt; B -&gt; C. There could have been a P but instead we got C++ and D. Although we did also get PL/1. Programmers are such wits :upside_down_face:; Since BCPL was influenced by CPL which in turn was influenced by ALGOL 60, I guess you could say A was ALGOL? :grinning:; I wonder if I'm the only one here who has programmed in BCPL and ALGOL 60? :confused:"
26,1546447023.7211,Elizebeth,I did C and Java at Uni. Nothing older than that
26,1546447543.7214,Sebrina,"I played with ASM a bit, I think that’s the oldest language I’ve worked with."
27,1546448836.7229,Tressa,"if i have an input array of strings, and i want to pick those that are also in a predefined set of valid strings, is it better to use `(filter #{""valid1"" ""valid"",,,} input)` or some other way?"
27,1546448927.7233,Tammera,"I think with the set is quite elegant; `def` the set of accepted strings somewhere, or make a predicate `is-allowed-string?` I guess"
27,1546449044.7251,Tressa,yeah that's the plan. i was wondering if for example `set/intersection` would be a better choice?
27,1546449114.7253,Tammera,"(Fun fact, Rust, which is a relatively young language, chose to adopt `0o` for its octal syntax)"
27,1546449171.726,Tressa,"the result would need to be all unique too, so i'd need to fit a `distinct` in there"
27,1546449233.7266,Tammera,intersection would work too if your input is a set
27,1546449270.7272,Tressa,it isn't
27,1546449274.7273,Tammera,"(remember, all set operations are explicitly undefined for non-sets)"
27,1546449309.728,Tressa,"i'd need to cast the input to set, making me again wonder if that's faster or running `distinct` on it"
27,1546449334.7283,Tammera,test it ^^
27,1546449347.7287,Melina,Benchmark it with criterium
27,1546449359.7289,Tressa,timing it now
27,1546449398.7295,Melina,"Unless performance is a bottleneck, pick the appropriate semantics.; i.e, if order doesn't matter and you don't care about duplicates; use clojure.set/intersection"
27,1546449445.7314,Tressa,"in the normal case it isn't (as only 3-4 elements should be in the input), but i'd rather not accidentally create an attack vector"
27,1546449455.7316,Melina,"else (filter #{""input1"" ""input2"" ...} input)"
27,1546449654.732,Tammera,`distinct` has an … interesting implementation
27,1546450193.7326,Tressa,"this is interesting; ```
user=&gt; (time (-&gt;&gt; input distinct (filter valid)))
""Elapsed time: 0.229339 msecs""

user=&gt; (time (-&gt;&gt; input distinct (filter valid) sort))
""Elapsed time: 0.581802 msecs""

user=&gt; (time (set/intersection valid (set input)))
""Elapsed time: 0.219935 msecs""

user=&gt;   (time (sort (set/intersection valid (set input))))
""Elapsed time: 0.199401 msecs""
```; why is sort so slow? the resulting filtered collection in the second case is only 4 elements, why is it taking such a toll?"
27,1546450580.7344,Jasmine,you have to be careful on some of those - filter is lazy and you aren’t forcing realization; so the first timing isn’t doing the filter at all; all of the other ops here are eager so will force realization; timing a single instance of any of these is also likely meaningless
27,1546450675.7358,Tressa,will into serve that purpose?
27,1546450691.7362,Jasmine,"doall would work; but really you should time 1000s of instances of these ops to compare; like `(dotimes [i 5] (time (dotimes [i 1000] (-&gt;&gt; input distinct (filter valid) sort))))`; the outer loop is 5 trials, the inner loop is 1000 reps per trial; you’ll usually notice it gets faster as the jit warms up; critierium is a fancier version of this"
27,1546450964.7383,Tressa,i see; thanks for the advice!; using sets seems to be significantly faster; like 3-4 times
27,1546451494.7399,Tammera,"hah, I did not expect that. I expected converting to a set to be a pricey operation"
27,1546451528.7403,Tressa,"i tried generating the input randomly so the jvm would sweat a little; ```
user=&gt; (time (dotimes [m 10000] (-&gt;&gt; (input) distinct (filter valid) sort)))
""Elapsed time: 693.849881 msecs""
user=&gt; (time (dotimes [m 10000] (sort (set/intersection valid (set (input))))))
""Elapsed time: 279.379693 msecs""
```
i didn't expect this big a difference; moving `distinct` after the `filter` makes it a little faster but still twice as slow"
28,1546451884.7417,Shayla,input being a list?
27,1546451896.742,Shayla,"try making it a set in the first one, i wonder if that'll speed it up at all"
28,1546452066.7424,Tressa,sure did.
27,1546452135.7436,Tressa,using `set` instead of `distinct` made it 2-3 times faster
28,1546452150.7439,Shayla,i suspect using the filter set predicate is using some sort of set-based stuff under the hood that makes comparisons to other sets much faster than comparing against a list; the only issue is if your input has duplicates; and you need them for some reason
27,1546452181.7448,Tressa,"no, i need it to be distinct so it's perfect; ```
user=&gt; (time (dotimes [m 10000] (-&gt;&gt; (input) set (filter valid) sort)))
""Elapsed time: 272.51252 msecs""
user=&gt; (time (dotimes [m 10000] (-&gt;&gt; (input) set (set/intersection valid) sort)))
""Elapsed time: 271.146103 msecs""
```
basically no difference"
28,1546453505.7461,Celestine,"<@Tressa> Just FYI, `(time (dotimes ..))` doesn't always give you accurate benchmarks -- check out criterium for a better approach."
29,1546453536.7467,Celestine,"(uh-oh, is Alex going to correct me?)"
29,1546453561.7472,Jasmine,"with a big enough N and enough sample points, dotimes is sufficient, imo"
29,1546453872.7473,Latonya,"So obviously people are not ""endlessly"" sticking with conventions of predecessors?"
29,1546454043.7475,Celestine,"Using `0o`, `0b`, `0x` as prefixes is certainly more consistent."
30,1546459485.7482,Tammera,"Haha, you are right andy. I actually made my statement before looking up whether newer gen languages would have adapted. As often, Rust serves as a positive surprise; Swift also goes for `0o` whereas Go goes for the traditional `0`. Interesting"
30,1546470837.7513,Samual,"And criterium is the agreed definition of ""a big enough N and enough sample points"" !"
30,1546470949.7517,Dann,the fact that it loudly warns you if JIT is turned off is also a bonus
31,1546471175.7525,Jasmine,I find the benefit of NOT using criterium is that you can see when the jit is sufficiently warm when the sample stabilize
30,1546471193.7532,Jasmine,generally this is much faster than using criterium; I also don’t find that usually the gc stuff in criterium is worth much; and if you don’t use leiningen you never run into the jit thing :)
32,1546480910.7566,Kirby,"Does anyone know of a good way to ""sandbox"" the loading of namespaces?
I'm trying to find a way to load and evaluate a namespace from an external source without interfering with the bindings in my current Clojure process' instance of the same namespace."
32,1546484337.7573,Celestine,<@Kirby> Perhaps look at the `clojail` project?; That will also make it safe to load and run that code (or at least _safer_) since it's coming from an external source...
30,1546490158.7581,Vita,I made this a while ago for that purpose: <https://github.com/RutledgePaulV/clj-embed> I keep meaning to come back and update it a bit. If you end up using it let me know and I’ll bring it up to date and cut a new release
33,1546500321.7589,Latonya,"There is a mranderson library that can create a ""shadowed"" version of a namespace, meaning renamed.  I have not used it myself, but I know some other libraries have used it: <https://github.com/benedekfazekas/mranderson>"
34,1546506774.7595,Amada,Does anyone have an example of deploying a clojure library to clojars from gitlab-ci?
34,1546506916.7597,Elizebeth,Is leading `0o` used for anything *else*? It would be nice if we could see older languages adopting that pattern too. At least then if `0o` and `0` both represented octal people could start writing code where it was clearer that a number was intended to be octal
34,1546507368.7602,Tammera,"I would say that alternatives in syntax are actually worse than having inconsistent, but only one, syntax"
35,1546512674.7604,Bernard,in for answer
35,1546525624.7622,Stasia,;
35,1546525672.763,Queen,"Is there any syntax that will help me include a specific key/val in a map depending on clojure/clojurescript target?
I know of `#?(:clj)`, but usable inside a map form; I can wrap the whole thing in assoc of course, but still"
35,1546525734.7639,Jasmine,can you use the splicing reader conditional?; I guess not; could use a cond-&gt; whose test is a reader conditional; `(cond-&gt; { … } #?(:clj true :cljs false) (assoc :clj-only :foo))`
35,1546526052.7674,Queen,"<@Jasmine> Thanks, splicing reader was what I was looking for."
35,1546526077.7676,Becki,did the splicing reader work for you?
35,1546526089.7679,Queen,and for map; `{#?@(:clj [:key :val])}`
35,1546526304.7687,Jasmine,I’m a little surprised that works but I guess it makes sense
35,1546526382.7691,Queen,A happy accident?
35,1546526394.7695,Jasmine,it wouldn’t surprise me if that gives trouble to other tools with their own lexers
35,1546526397.7697,Tammera,"Interesting syntax tho, `#?@(...)`"
35,1546526419.7702,Jasmine,as it looks like a map with an odd number of elements until it’s read
35,1546526477.7706,Becki,would that break edn reading of a file with those forms?
35,1546526519.7709,Jasmine,edn doesn’t have reader conditionals
36,1546533251.7724,Xochitl,"Does anyone know how to configure the built-in MacOS firewall to permanently accept incoming connections? I've added the version of java to the firewall but I'm stick stuck clicking ""allow"" each time I restart the server."
37,1546538652.7728,Kirby,"Thanks guys!  I had seen mranderson from where refactor-nrepl uses it to deal with this problem, but that solution seems a little more finicky than I was hoping for.
clj-embed looks cool!  The classloader solution-route was what I was hoping to find examples for.; In the short term, I think I will forgo the namespace isolation requirement in my project, in order to focus on exercising the other aspects of the project.  Later, I'll plan on attempting to incorporate clj-embed. So no hurry <@Vita>, but thank you."
38,1546539390.7749,Hassie,"Is there any way to determine in custom macro whether passed symbol is macro or function?; my test is `(:macro (meta (var loop)))`; of course this doesn't work here
```
(defmacro is-macro? [sym]
  (let [m? (:macro (meta (var sym)))]
    `~m?))
```; is there any way to resolve `sym` within a macro?"
38,1546539879.7762,Fredda,`resolve`?
38,1546539929.7768,Otelia,(Note that you can't resolve vars in Clojurescript macros.)
38,1546539950.7771,Hassie,it's in Clojure; works! thanks a lot
38,1546540064.7783,Becki,just for curiosity can you explain why you need to know?
38,1546540127.7784,Fredda,"Except at compile-time, depending on... things; I banged on this until it worked. It might not work in all situations though <https://github.com/johnmn3/dispacio/blob/master/src/dispacio/alpha/core.cljc#L156>"
38,1546540373.7822,Otelia,"Interesting, thanks!! Earlier I couldn't figure out a way to do it, and just found a way to avoid the need for it, but I'll hang on to this for future reference."
38,1546540409.7831,Hassie,I have math functions and some of them are expressed as macros (java calls) and some of them are clj functions. I want to wrap such macros into functions (and avoid wrapping functions) to generate rest of the code.
38,1546540466.7839,Fredda,"It doesn't work in most ways, you're right. There's just certain situations where you can get it to work."
38,1546540479.7842,Hassie,so my macro checks symbol and generated function or leave symbol unwrapped ```(if (:macro (meta (resolve f))) `(fn [v#] (~f v#)) f)``` which is used in final generated code
38,1546540492.7843,Fredda,And I don't understand the interplay well enough to explain when it does or doesn't. But it works there :slightly_smiling_face:
38,1546540511.7846,Otelia,Could come in handy.
38,1546540599.7856,Dann,"one possible gotcha is if you get a function literal instead of a symbol bound to an fn; ""cannot embed object in bytecode"" is the error message IIRC"
38,1546540711.7874,Hassie,"fortunately I operate on symbols here, it's a private macro and should be ok in my case"
39,1546550241.7883,Antwan,None; got some... fun recursion
39,1546550565.7893,Dann,"Why recur with objs in one tail, and sorted-objs in another, when both are the same value?; oh I see, there's a path where you want to use sorted-objs, even as objs got rebound, I get it now"
39,1546551539.7897,Antwan,"yeah, the fact that it is confusing is my reason for posting; had a hope someone would have insight on how to simplify it"
39,1546551663.7901,Dann,"maybe there's a way to turn the path that recurs with `rest` into a normal reduce, and the one that recurs with sorted-objs into a recur on the enclosing fn?; just a thought"
40,1546553288.7927,My,"Weird request, but working on a perf improvement to something and want to provide a realistic benchmark on public data. Tried randomly generating data, but issue is time is dominated by things that are artifacts of random data you wouldn't see in practice (for instance, all keywords are distinct and very long). I don't want to try to generate ""realsitic data since that seems bad and want to know if someone has some large public batch of EDN data laying around that might be 'representative' of real-world data, or even better something someone's used to benchmark before"
40,1546553326.7929,Lura,mbrainz?
41,1546586814.7954,Mariela,Is there something like <https://github.com/NoRedInk/rspec-retry> for clojure.test?
41,1546587112.7956,Stasia,"To refresh specific tests, or refresh in general?"
41,1546587359.7958,Mariela,"To re-run a test that is failing, operating under the assumption that the test is flaky"
42,1546590219.7962,Stasia,"Ah, none that I'm aware of then"
43,1546599249.797,Wanita,how to get a hash of a data structure in Clojure?
43,1546599294.7976,Sherril,`(hash datastructure)`
44,1546602081.7991,Hassie,reminds me my question from yesterday: how to resolve a symbol in a macro? answer: `(resolve s)`
41,1546607019.7995,Shayla,test-refresh?
42,1546607498.7997,Mariela,have used it in the past. I don't recall that it re-reruns failed tests speculatively
42,1546607584.7999,Shayla,"&gt; Runs previously failing tests first, giving you feedback even quicker.; oh speculatively, yeah i don't know about that"
45,1546611348.8013,Harmony,"Hello! I'm new here, I posted this message in <#C053AK3F9|beginners> but I think it's not the best place... here it goes:
We are working on a project were Datomic is being used. We want to analyze de data using ML alorightms (we are data analyst). The thing is we don't event know where to start from!! Could someone point me in any direction?"
42,1546611689.8027,Fredda,"<@Harmony> in addition to the official datomic docs, this might be helpful summary <http://tonsky.me/blog/unofficial-guide-to-datomic-internals/>"
45,1546611854.804,Fredda,"It's basically a stream of datoms, which you can just use like data however you want"
45,1546611870.8043,Harmony,"thx John, I'll check it now :slightly_smiling_face: I'm sure I'll find interesting things there"
45,1546612064.8049,Fredda,Slice up history using `as-of` and `since` <https://docs.datomic.com/on-prem/filters.html>; There's more convo about it over in <#C03RZMDSH|datomic> def ask around in there too
45,1546613239.8062,Stasia,<@Harmony> are you already familiar with datalog?; If you aren't: <http://www.learndatalogtoday.org/>; (uses Datomic)
45,1546613716.8073,Harmony,"I've read the documentation about it, but I haven't use it. So I wouldnt say Iam ""familiar""; anyway,my question was more related to arquitecture; for example, can I somehow connect Spark to Datomic?; thx <@Stasia>"
46,1546617920.81,Colin,`defrecord` can't catch closure? ```(let [x 3] (defrecord Foo [] IFoo (foo [this] x)))```
45,1546617981.8101,Harmony,"I've seen that there's a way to connect python to datomic with the pydatomic library, which access datomic DBMS via the REST API"
46,1546618068.8106,Jasmine,no; `reify` can be used to create instances of an interface that close over state
47,1546620268.8138,Sebrina,"Is there a way to run a clojure -main from outside the project dir like?
```cd ~/Projects
clj --dir ~/Projects/find-git-files -m find-git-files.cmdline ./```"
47,1546620617.8144,Yen,is there a native way to deploy an `uberjar` with `lein` ? I am trying to do this using a CI Server with `lein` installed on it.
47,1546620892.8154,Sebrina,"I think I figured it out, I can use the -Sdeps flag pointing to the repo to include it in the classpath; ```clj -Sdeps ""{:deps {find-git-remotes {:local/root \""./find-git-remotes\""}}}"" -m find-git-remotes``` seems to be working but I’m curious if there’s a cleaner way to do that."
48,1546622962.8167,Romona,"Struggling with lein's uberjar feature, I'm confused why we're not making this not easier for people; Here's my summary:

- most of the time AOT compilation is not desirable
- ns-level forms are executed during AOT compilation, which is confusing
- the only reason why most people use AOT is to set the entry point for the uberjar so that you can `java -jar uberjar.jar` instead of the - often superior - `java -cp uberjar.jar -m foo.main`; The whole situation confuses people:

- people don't understand how gen-class works or why it's necessary
- leiningen warns and unnecessarily suggests that you should set `:aot :all` - which doesn't seem like a good default to me
- if you specify `:aot [foo.main]` explicitly, that works but due to a bug in lein it compiles the ns twice if you also set `:main foo.main` <https://github.com/technomancy/leiningen/issues/2521>; Really all you want is to generate a class that does the equivalent of these two lines: <https://github.com/pesterhazy/lein-aot-example/blob/master/src/foo/main.clj#L7-L8>; AIUI most projects will be better off doing that than AOT'ing everything; ... given that the Clojure compiler is very fast, it doesn't blur the line between compile time and run time and other issues with AOT'ing; Is there something I'm missing here?"
48,1546623526.8249,Yen,Can you deploy an uberjar with `lein deploy` ?
48,1546623667.8261,Jasmine,"you shouldn’t, at least not in public repos"
48,1546623674.8262,Meagan,I think there's also a perception that AOT helps with startup time
48,1546624043.8275,Romona,<@Meagan> I mean it'll be faster because the compile step isn't needed but is there any advantage to aot'ing other than that?
48,1546624073.8276,Meagan, ¯\_(ツ)_/¯
48,1546624343.8281,Marlyn,"if you’re deploying an application: AOT is fine. library: don’t AOT; yes, it helps with startup time significantly; <https://clojure.org/reference/compilation>
is the bible on it, not whatever lein says"
48,1546624853.8298,Romona,"<@Marlyn> that distinction between lib and app code is useful, thanks"
48,1546624908.8302,Marlyn,lein uberjar generally does _both_ `tar` and AOT
48,1546624954.8307,Romona,"by default `lein uberjar` doesn't aot, unless you specify `:main` or `:aot` AFAIK"
48,1546625138.8323,Sebrina,"Wrote this tiny cli tool to update git remotes in all of my projects. However, since I need to write to the file I’m reading I have to read all the lines of each config file into a seq, process them, then write to the file, move to next file. Is there a way to make that more efficient so I don’t need to load an entire config into memory at once like in line #23?"
48,1546625210.8331,Romona,"<@Marlyn> also thanks for providing the link to the justification for aot'ing. Part of the problem is that leiningen is undocumented, except for the sample project.clj; a better default for lein, I think, would be to do the moral equivalent of `lein run` in the uberjar; then users would be able to enable aot'ing as necessary, irrespective of whether they're building an uberjar or not; as it is, lein unnecessarily complects aot'ing and creating uberjars"
48,1546625536.8359,Rosaline,"that is not true; ugh; it is, that must have changed at some point; ugh, five years ago"
49,1546626963.8375,Sebrina,Oops! Too much context. Boiled the question down and asked in beginners channel where it more likely belongs :slightly_smiling_face:
49,1546627265.8382,Yen,"I figured out how to deploy an uberjar `lein do uberjar, deploy [release-repo] [identifer] [version] path/to/uberjar, deploy [release-repo]`"
49,1546627356.8391,Dann,<@Yen> does the last step do anything?; is that if you want to deploy both a jar and an uberjar?
49,1546627413.8402,Yen,"<@Dann>, Yeah I should have specified that. I wanted to deploy both a jar and an uberjar. I knew how to deploy a jar but not an uberjar."
50,1546629884.8406,Stasia,"<@Harmony> the REST API is legacy now, see <https://docs.datomic.com/on-prem/rest.html> , it's replaced by the Client API"
51,1546632591.8424,Tammera,"hmm I noticed that pulling in git dependencies from a deps.edn is not possible when pulling over ssh with an ed25519 keypair. I know thats a limitation of the JGit library (<https://bugs.eclipse.org/bugs/show_bug.cgi?id=520927>), but shouldn’t that be something that is worth documenting in tools.gitlib’s readme?; Or is there some workaround I am missing"
51,1546632994.8431,Marlyn,it’s annoying but make sure you use an ssh agent <@Tammera>; export SSH_AUTH_SOCK=…path to your agent socket; you also may have to modify entries within .ssh/config — specifically remove IdentityFile and let your ssh-agent be smart about it
51,1546633452.8457,Tammera,"Right, but only the ed25519 public key is known to GH right.; Hmm maybe I have multiple issues at the same time :’), eyeballing <https://dev.clojure.org/jira/browse/TDEPS-91>"
51,1546634303.8478,Jasmine,"yes, that’s a separate issue; I believe it’s probably something you can get around by editing your ~/.ssh/known_hosts, but certainly not the best; I’d like to make the switch to just using git but I need to strategize how to best do that without breaking lots of people"
51,1546634463.8493,Tammera,"right, because that would need git to be explicitly installed right; as in the C binaries + all other git fluff"
51,1546635486.8505,Celestine,<@Jasmine> Maybe attempt to shell out to `git` and fallback to jgit if that fails?
51,1546637065.8516,Jasmine,well I’m thinking that we would maybe initially ship with support for both and have some way for user to override; but default logic would probably be git falling back to jgit (as I’d like to eventually remove jgit entirely)
52,1546639011.8538,Venice,"Hey, all. I'm using deps.edn and building my project on Gitlab. It takes ages because it pulls the clojars deps everytime. How can I find out where on the filesystem those deps end up so that I can cache them?; I was expecting it to be ~/.m2, but that seems not to be the case..."
52,1546639215.8554,Rosaline,"are all your dependencies maven artifacts? those should all end up in m2; any git dependencies will be in ~/.gitlibs; but if you are downloading stuff from clojars, then it should end up in ~/.m2 then I would double check your build environment, you building in a container or something and getting a fresh ~/.m2 everytime, etc"
52,1546639411.858,Venice,"Cheers, will dig more."
52,1546640338.8588,Clarine,<@Venice> it seems that `.m2` is the location they use by default: <https://gitlab.com/gitlab-org/gitlab-ce/blob/master/lib/gitlab/ci/templates/Maven.gitlab-ci.yml> and caching the dir `.m2/repository` should work
52,1546640484.8604,Venice,"<@Clarine> Thanks, I've actually seen that before, it didn't seem to work for me.; I'll just do a find and bruteforce my way to finding out where they are."
52,1546640682.8622,Karena,"no need to brute force.
write the output of find to a file. Then run find again after into a different file.
then do:
`vim -d file1 file2` to see the difference between the two :slightly_smiling_face:"
52,1546640722.8626,Venice,"Yea, well, that's really what I mean by bruteforce."
53,1546640732.8627,Lashawn,Is this a bug?
53,1546640853.8642,Rosaline,no; type returns a instance of java.lang.Class; clojure.lang.Keyword is a symbol (that evaluates to a java.lang.Class object) and case test-constants are not evaluated
53,1546640961.8661,Karena,`case` only works with compile time literals. Try `condp =` instead; <https://puredanger.github.io/tech.puredanger.com/2010/05/30/learning-clojure-15-case/>
53,1546640981.8666,Lashawn,thank you very much:)
52,1546641216.867,Clarine,<@Venice> you can also run `clojure -Spath`
52,1546642718.8672,Venice,<@Clarine> perfect!
54,1546644210.8686,Tonya,"When writing websites, is it recommended to stick to standard HTML? Writing with a DSL such as Hiccup seems powerful, but I'm wondering about how I should handle CSS/Javascript then."
54,1546644774.8691,Gilda,"For css you might try <https://github.com/noprompt/garden> if you are looking for a DSL similar to hiccup.; Additionally because hiccup emits HTML, you can just write plain css or js to accompany it and link those resources as you would normally. Otherwise, <#C0FQERS0H|garden> and <#C03S1L9DN|clojurescript> are the likely recommendations you will see if you plan on using hiccup to serve templated HTML."
54,1546645439.8697,Tonya,That makes sense.; <@Gilda> is it kosher to have both clojurescript + clojure in same project? I'm using ring + compojure for the backend.; Thanks for help btw.
54,1546645763.8703,Gilda,"It's perfectly alright to have both clojure and clojurescript in the same project. In fact, clojure supports reader conditionals <https://clojure.org/guides/reader_conditionals> to maximize code sharing between the two. Many fullstack applications have a considerable amount of code written in .cljc files in order to facilitate this.; If you are using leiningen you might take a look at <https://github.com/emezeske/lein-cljsbuild> for getting started."
54,1546645915.8708,Tonya,Will lein-cljsbuild work with lein-repl?; Currently I run lein repl :headless and then connect with cider in emacs.; To reset the state of the webserver I run (mount/start)
54,1546646692.8714,Dimple,<@Tonya> I created CHP because it is better to use hiccup instead of HTML <https://bitbucket.org/sonwh98/chp/src/master/>
54,1546647630.8722,Samual,<@Karena> <@Rosaline> case is different in Clojure and ClojureScript. Clojure case does not evaluate the stanza handles. CLJS does.
54,1546647658.8727,Rosaline,cljs also doesn't have clojure.lang.Keyword
54,1546647666.873,Samual,oh; well the trivia is the point
54,1546647759.8749,Rosaline,"case is like the millionth place where clojure and cljs diverge, and if you complain about someone will popup and say ""oh, its just an edge case""; <https://dev.clojure.org/jira/browse/CLJS-2102>; ""As discussed in that thread we're not re-breaking a thing we broke 2 years ago. It's simply not that important and far too late."""
54,1546647987.8762,Samual,Hey that Jira issue has a link to a Google Group thread that I started!; Anyway opinions differ as to whether Clojure's case is the broken one.
54,1546648062.8771,Rosaline,"that is nonsense; clojure's case behaves the way it does because it has to. case provides constant time dispatch, in order to compute the jump table it has to have the values on hand, which in the general case means they have to be unevaluated constants"
54,1546649122.8795,Milford,ClojureScript’s `case` is constant-time as well.; (For most uses.)
54,1546649788.8803,Rosaline,"hilariously the non-constant time cases are the cases where its semantics match clojure's, if I recall; oh right, that is exactly what the ticket I linked is for; the cond fallback the clojurescript macro uses treats symbols differently then the constant time dispatch part"
54,1546650163.8843,Milford,"Yeah, there’s also the unfortunate handling of const vars <http://blog.fikesfarm.com/posts/2015-06-15-clojurescript-case-constants.html>"
54,1546650193.8847,Rosaline,"basically clojurescript's case was implemented by someone who didn't entirely understand case, and now it is enshrined forever as an asterisk on any discussion of clojurescript / clojure portability"
54,1546650470.8861,Milford,"Right. A similar thing happened with `binding` (the parallel aspect) but that was fixed.; It feels like we are down to this hastening only once or twice a year now (where a mistaken difference is discovered and a decision needs to be taken on whether to fix it).; Another recent one sitting there is the handling of empty regex s, but those differ anyway"
54,1546650908.8921,Rosaline,"I just remember arguing with dnolen on irc way back because he insisted that clojurescript just be referred to as clojure, and clearly there are differences enough that the distinction must be made"
54,1546651064.8946,Milford,"Hah, yeah. The same concept arises with self-hosted ClojureScript. Ideally you could just pretend it is the same language, but perhaps it is another (albeit close) dialect"
54,1546651101.8949,Rosaline,"clojure, clojure', clojure'', ..."
54,1546651136.8952,Milford,Yep. Three targets.; 0h forgot about CLR
54,1546651261.8959,Dann,CLR is the most compatible with the JVM version
54,1546651448.8967,Becki,who works on that version these days?
54,1546651498.8969,Dann,"<https://github.com/clojure/clojure-clr/graphs/contributors>; David Miller; if CLR wasn't a microsoft project and there was a tool like lein for clojure-clr, I bet Clojure-CLR would see a lot more use"
54,1546651641.9,Becki,wow. that is a ton of work. and largely thankless i suppose
54,1546651647.9002,Milford,"I thought I read somewhere that, back in the day, you would upgrade from one version of Lisp to another by running your source through some Lisp designed to translate :)"
54,1546651699.9021,Dann,<@Becki> from what I gather the similarities between CLR / JVM and C# / Java mean it's not as bad as you might think
54,1546651706.9025,Milford,"You could have like Swift 1, Swift 2, Swift 3, or whatever it is up to now"
54,1546651712.9027,Becki,"i like everything about C# except how tied to windows it was when i used it. winforms, etc, visual studio, etc; haven't followed along with the core stuff."
54,1546651740.9038,Rosaline,there is a very interesting paper somewhere about doing that with sbcl
54,1546651743.9041,Dann,"mono is usable, but I think MS' reputation still holds CLR back"
54,1546651767.9046,Rosaline,it is kind of tricky to think about and do in a clean away; because it is very easy to confuse the source and the target language when you are using the same language and are generating an in memory image to dump to disk
54,1546651819.9066,Milford,"Well we could have a spec for Clojure, confirm the code, and then unform it to a spec for Clojure2; Gah"
54,1546651837.9074,Becki,doesn't elm kinda do this when they do compiler upgrades? you can run something over your code to get the mechanical stuff
54,1546651841.9075,Rosaline,"<https://pdfs.semanticscholar.org/98bf/0466dcb0712d2082a7b02d8773bb744ea626.pdf> ""SBCL: a Sanely-Bootstrappable Common Lisp"""
54,1546651886.9081,Milford,Oh wow :open_mouth: gotta read that 
54,1546651890.9082,Becki,just downloaded that. thanks!
54,1546652067.9104,Madeleine,"I mean, porting Clojure to other platforms is tricky both because Clojure leaves some semantics up to Java, adopts some weirdnesses because of Java, and also lacks a formal spec or a cross target test suite."
54,1546652365.9113,Milford,"Maybe it is a bit like Unix / C, with just the right amount of looseness at the bottom to let it spread easily.; In 2026 we will be coding to the CLOJIX standard."
54,1546652776.9123,Rosaline,just don't forget to run ./configure before you build
54,1546652812.9128,Dann,and google how the hell to run autotools and then run them before running configure
54,1546652883.9136,Becki,"that paper describes kinda self hosted cljs right? it grabs a js environment, feeds it enough info to become a cljs environment and then compiles the cljs compiler?"
54,1546652946.9138,Rosaline,no
55,1546681768.9148,Maynard,Can anyone here point me to any documentation on the meaning of ::keys for destructuring?; Notice the second colon.; I am reading code that uses this and I don't understand how it works.
55,1546682676.9172,Ellyn,"<@Maynard> that is called a “namespaced keyword”: <https://clojure.org/reference/reader#_literals>; basically, `::foo` expands to `:the-namespace-your-are-in/foo`"
55,1546682709.9181,Maynard,"Ok, I know the difference now via some experimentation. I just thought it weird I could not find any documentation. I did find this: <https://clojureverse.org/t/poll-destructuring-namespaced-keywords/1388/5>; Thanks <@Ellyn>"
55,1546682754.919,Ellyn,official docs on it are here: <https://clojure.org/guides/destructuring#_namespaced_keywords>
55,1546682804.9196,Maynard,"though that page still doesn't mention ""::keys""; The meaning is sort of obvious I guess once you try it out."
55,1546682849.9205,Clarine,"so `(pop [])` errors, but `(peek [])` and `(pop nil)` just work… what’s the reasoning behind that?"
56,1546684044.9244,Kristine,"hello friends,

Question about concurrency: if i have two http requests (ring) coming in, in quick succession, I want to make sure that the first one can do some work, and block the second request for a little bit, and after the first request is done, the other can continue (it’s ok if the 2nd one takes a few milliseconds longer to succeed)

How should I go about this? I started out with a global `atom`, for simplicity let’s say it’s a boolean `busy?` which is `true` when it’s busy, and `false` otherwise

but how to ‘wait’ for the atom? I could of course make a spinning loop but that feels very dirty.

Which construct from clojure would be suitable?"
57,1546684265.9248,Clarine,"why not make one endpoint for it, that synchronizes the work?"
56,1546684326.9254,Kristine,"more context: I am integrating with an oauth2 API, which requires me to refresh access tokens; the refreshing is done in a ring middleware; but if two calls to this api follow each other up quite quickly (which could happen) for the same user; and the first one is busy refreshing the token via a HTTP POST  call to the external API; then the second one will fail because the external api says: ‘you are using an outdated token’"
56,1546684436.9279,Venice,I think you're setting yourself up for a world of hurt trying to block that.
56,1546684456.9287,Clarine,you could use `locking` if the user’s token is refreshing
56,1546684467.929,Kristine,aah thanks
56,1546684470.9292,Clarine,but I’m not sure if that’s a good idea
56,1546684474.9293,Kristine,<@Venice> why so?
56,1546684495.93,Venice,I'd say just let them receive the 401 and do the refresh dance.
56,1546684512.9307,Clarine,it would be better to make it idempotent. so a second refresh just gets you the same token as the first refresh; you could make a local atom keeping the tokens and return the same token if it’s still valid
56,1546684547.9316,Kristine,ah yea so move the problem to my clojurescript client
56,1546684590.9325,Clarine,"I mean, cache the tokens server side. the refresh function goes through the cache"
56,1546684698.9344,Venice,"Yea, basically, catch the ""invalid token"" message at the clojurescript, do the dance to refresh it with the refresh token, then continue with whatever it was the client was actually requesting."
56,1546684742.935,Kristine,ah yeah ok
56,1546684762.9354,Venice,"Avoid trying to do clever things with locking though, I bet it's a total minefield."
56,1546684768.9356,Kristine,yeah
56,1546684779.936,Clarine,I agree
56,1546684825.9369,Kristine,"one idea i also have, come to think of it, is to just retry. catch the refresh token outdated exception server-side, re-look in the database (which has a new token in a very short while) and retry; ok but i can work from here; thanks, i hoped there was some construct that did this for me, so that I came to check here.; thanks"
56,1546684910.9384,Venice,I'm assuming you know about <https://github.com/funcool/buddy> ?
56,1546684934.9387,Kristine,"yeah; how would that help? i ’m integrating with an external api here that i don’t control; but i just realize the simple solution is staring me in the face:
- catch the ‘outdated token’ refresh action, and just proceed; there must ’ve been a previous request which done that"
56,1546685046.9417,Clarine,"<@Kristine> I have a similar construct with futures. I’m getting some data from a future and keep those futures in an atom. It doesn’t matter if the future is already realized or still running. If there is already a future, I just wait for that one. If there isn’t one, I create one."
56,1546685057.9419,Kristine,ah yeah
56,1546685079.9422,Clarine,"if the future is not valid anymore, I remove or cancel it"
56,1546685083.9424,Kristine,"yeah; gotcha; Decided to ‘keep it simple’. If the refresh failed due to outdated token (ie. race condition), wait 200ms, assume by now the new tokens are stored in the database by the previous request, re-fetch those (they should be valid anyway, since validity is 10minutes), and proceed the handler.; the only thing is the thread/sleep… but at least it’s very clear what’s happening. Not sure if this gives lots of problem when i have a gazillion concurrent users doing things like this, but I’ll come back here when that happens :wink:; as an aside: again realizing the middleware pattern is awesome. the business logic ring handlers are now simplified so much."
56,1546691960.9474,Ellyn,"here’s a non-blocking way to do it: a function called `is-about-to-expire` and an atom `is-updating`, then in your request have something like this:
```
(if (and (is-about-to-expire token) (compare-and-set! is-updating false true))
  (try
    (swap! token-atom (get-new-token)))
    (finally
      (reset! is-updating false)))
```; that means the first thread that sees that the token is about to expire will fetch a new one, but since the old one hasn’t expired yet everyone can keep making requests"
58,1546692035.9489,Ellyn,"when the refresh has happened, the old token is atomically replaced with the new one"
56,1546692495.9507,Alix,What does a la carte mean? Im having trouble trying to find a good definition on google.
56,1546692662.9518,Ellyn,"it’s a restaurant term, it means that you can pick and choose what dishes you want instead of getting a pre-composed menu"
59,1546693672.9525,Magdalene,How do deftest and spec differ?
60,1546701489.9559,Tim,Does anybody know if there are performance improvements or other good or bad side effects in moving from openjdk 8 to 11?
61,1546704703.9598,Roslyn,"Hi! I'm doing a library that provides optional functionality that depends on `clojure.core.cache`. But since this is optional functionality, I don't want to introduce dependency on `core.cache`, and thinking how can I make this dependency a ""soft"" one. Initially I tried using own protocol similar to `core.cache` and extend it to `core.cache`'s one if it exists like that:; ```
(when (try
        (require 'clojure.core.cache)
        true
        (catch Exception _
          false))
  (extend-protocol Cache
    (:on-interface clojure.core.cache/CacheProtocol)
    (lookup [this k]
      (clojure.core.cache/lookup this k))
    (has? [this k]
      (clojure.core.cache/has? this k))
    (hit [this k]
      (clojure.core.cache/hit this k))
    (miss [this k v]
      (clojure.core.cache/miss this k v))
    (evict [this k]
      (clojure.core.cache/evict this k))))
```; But I think this solution sucks, because I can't extend protocol to another protocol, only to interfaces; I just realized I can check if supplied cache satisfies `clojure.core.cache/CacheProtocol` and wrap it with my cache"
61,1546705502.9621,Simonne,"<@Roslyn> <https://github.com/clojure/spec.alpha/blob/master/src/main/clojure/clojure/spec/gen/alpha.clj#L17>; You can optionally run some code, depending on whether you’re able to load `clojure.core.cache`"
61,1546706315.9634,Roslyn,"Yeah, I decided to do it like that:
```
(def core-cache-protocol
  (try
    @(requiring-resolve 'clojure.core.cache/CacheProtocol)
    (catch Exception _
      nil)))

(defn -&gt;cache [x]
  (if (and core-cache-protocol (satisfies? core-cache-protocol x))
    (let [core-cache-lookup @(resolve 'clojure.core.cache/lookup)
          core-cache-has? (resolve 'clojure.core.cache/has?)
          core-cache-hit (resolve 'clojure.core.cache/hit)
          core-cache-miss (resolve 'clojure.core.cache/miss)
          core-cache-evict (resolve 'clojure.core.cache/evict)]
      (reify Cache
        (lookup [_ k] (core-cache-lookup x k))
        (has? [_ k] (core-cache-has? x k))
        (hit [_ k] (core-cache-hit x k))
        (miss [_ k v] (core-cache-miss x k v))
        (evict [_ k] (core-cache-evict x k))))
    x))
```"
62,1546710447.9658,Doreatha,"I want do serve files from the file system, like with `python -m SimpleHTTPServer`, but from inside a clojure process. I think saw a tweet the other day about a(n old, ""done"") library for this, but I can't seem to find it. Does anyone know which library I'm talking about?"
62,1546712887.9704,Isa,How to run `sh` in Clojure to run `wkhtmltopdf` with input stream and output stream if possible? I want to do in from in-memory data instead of files.; So as inputs I will have long HTML / js / css code and as output PDF file.
62,1546713521.9712,Simonne,"<@Doreatha> Maybe this will help: <https://github.com/ring-clojure/ring/wiki/Static-Resources>; If you know what ring is and how to use it.; If not, it’s good to learn. Ring is the standard clj http api."
62,1546714148.9726,Isa,ok I think the only one way is to use `-` instead of file name for output. Then I will have output in `:out`.
62,1546714330.9749,Doreatha,"Thanks, I think it was <https://github.com/tailrecursion/lein-simpleton> that I saw. As it turns out it's not exactly what I wanted, but it looks easy enough to just use ring directly."
62,1546714378.9751,Isa,"so I have to figure out how to make input from memory. Probably with `:in` but this will be long input string.; hmm looks like it is pretty easy, string is fine; ```
(sh ""wkhtmltopdf"" ""-B"" ""0"" ""-L"" ""0"" ""-R"" ""0"" ""-T"" ""0"" ""--page-height"" ""58mm"" ""--page-width"" ""43mm"" ""--disable-smart-shrinking"" ""-"" ""foo.pdf""
      :in (slurp ""resources/index.html""))
```; Does it have size limit?; <https://github.com/cognitect-labs/test-runner> - this library for tests is be default included to `clj` template for new project. Does it have option to watch and test again after each change? Or should I use something else?; Did somebody read from bardcode reader devices and can share experience how to do it in Clojure / Java?"
63,1546771110.9931,Wanita,I have working code where I get hash code of data structures with (hash data-structure) but it works in small amount of them. When I have few millions of data structures it will start giving me duplicate hashes (clash). How to get something more unique when structure of data structure is unknown?
63,1546773566.9945,Yee,"<@Wanita> hash returns a 32 bit int, so the birthday problem means you'll start to get conflicts regardless; You might want to look in to something like sha or md5; Or design your data structures to work even with hash conflicts, which is what clj itself does "
64,1546774665.9973,Clarine,"how do I get pprint to print this with the leading quote?
```
(def x '[foo bar])
(pprint x)
=&gt; [foo bar]
```; `(pprint (list 'quote x))` seems to work"
65,1546775411.9982,Harmony,I've seen that PyDatomic uses the Rest API; not the client api; I think that's the only way to connect Python with datomic; isn't it?
66,1546785737.999,Stasia,"Yeah, unfortunately :neutral_face: hopefully it continues to work well enough"
65,1546786852.9992,Harmony,haha; that's not a bad news; thx for your help greywolve
67,1546789307.0011,Milford,"<@Clarine> Not sure if it is an idiom, but I often see the sequence
```
`'~
```
used in macros. It looks a bit like line noise, but perhaps it is an idiom.
So for that example
```
(pprint `'~x)
```"
67,1546789361.0015,Clarine,cool. I have used it in macros yeah
68,1546799800.0066,Cody,"Hey everyone, I have a problem with leiningen, reloaded.repl, Cursive and/or CLJC. I have defined some protocols in .cljc files which are used from clj/s. In an open REPL from Cursive, most of the time when using `reloaded.repl/reset(-all)`, it doesn't pick up my changes at all. If I do a ""manual"" `clojure.tools.namespace/refresh(-all)`, my changes are picked up but all the protocol implementations won't satisfy their respective (newly modified) protocols anymore, so I get exceptions from somewhere near `clojure.core/-cache-protocol-fn`. I need to fully restart the REPL for everything to be picked up again. Is there a way to remedy this, or workarounds? Has anybody encountered this? (my google searches haven't turned up much); (My workflow is roughly equivalent of what using chestnut involves)"
68,1546800048.0081,Meagan,"this sounds relevant: <https://lambdaisland.com/blog/2018-02-09-reloading-woes>
&gt; when you use tools.namespace to reload your code, it effectively creates completely new and separate versions of functions, records, multimethods, vars, even namespace objects, and any state that is left around from before the reload might still be referencing the old ones; I personally don’t use tools.namespace, but I know that re-evaluating things like multimethods is tricky; I wonder if records/types that implement protocols is the same; have you had any success simply re-evaluating the namespace you’re trying to refresh?"
68,1546800457.0105,Cody,"Well, sort of. It sends me on a wild goose chase through my namespaces, totally arbitrary and non-deterministic; Sooner or later it sometimes works, but not so often that restarting the whole thing isn't much easier and faster; Multimethods work fine, by the way; I have lots of `defrecords` implementing various protocols, and those very often ""loose"" their implementations in this way"
68,1546800589.0138,Meagan,"well, specifically, I always run into an issue where you can’t re-evaluate the `(defmulti &lt;dispatch&gt;)` part. re-evaluating the cases works fine :slightly_smiling_face:"
68,1546800590.0139,Cody,"which is a bummer since I quite like the architecture so far, but without proper refreshes in the REPL it's very frustrating; ah you're right, I know that one too ^^; Maybe it's reloaded.repl's alter-var-root! that does something funky?"
68,1546800666.0152,Meagan,"so, question: if you create a new instance of the new `defrecord` impl, do you see the correct behavior?; after a reload; (I’m also assuming that you’re interacting with this at a REPL to some extent)"
68,1546800768.0165,Cody,"iirc yes, if I switch to the respective namespace and manually instantiate the record, it satisfies the protocol; but let me check real quick; (most of the records are instantiated via an integrant like multimethod mechanism)"
68,1546800866.0179,Meagan,"so it sounds like what’s happening is that your `defrecord` is being picked up correctly, but your application is still referring to instances of the old implementations; I haven’t use integrant, I typically use mount because I’m lazy. but I assume there is a way to stop/start your system with new instances of your records, which would solve the problem you’re encountering I think?"
68,1546801079.0195,Cody,"i'm not using integrant, but the core of the IoC mechanism is a multimethod that's basically integrant's init-key; i'll look into the REPL utilities to see if there's something that keeps around stuff; I'd be surprised though since afaik there's one aliases and stuff. reloaded.repl uses alter-var-root! and component/suspendable, so in a reset, it'll call Lifecycle/stop. All the records in question are re-instantiated on start and discarded on stop. But there could be a bug there as well I suppose.; there's only aliases*"
68,1546801285.0233,Meagan,"hm. oh, so you’re using component?"
68,1546801298.0236,Cody,"yes, but only ""behind the scenes""; and really only for repl convience. all components wrap a subsystem which consists of the actual parts of the application; the wrapper components discard the subsystem on stop and create a fresh one through the IoC mechanism on start; which is why this protocol issue puzzles me; reloaded.repl's reset does stop, refresh, start, so in theory the subsystems should be created after the tools.namespace refresh; and with the new implementations; but maybe that's the crux, a combination of cljc processing and protocol/multimethod reloading; or protocol reloading and multimethod instantiation, rather; the reason I suspect something very messy is that very rarely everything breaks completely, even after a REPL restart, and I have to `lein clean` before any of it will work again :sweat_smile:"
68,1546801685.0296,Meagan,"hm yeah this all sounds very complex; FWIW I don’t use reloaded.repl at all. I use mount and re-evaluate the var or namespace I’m in as I develop. Occasionally, if necessary, I call `(mount/stop) (mount/start)`; but I also have never used records and rarely use protocols :stuck_out_tongue: so take my advice with a grain of salt!"
68,1546801861.0323,Cody,"we considered mount but decided on component+reloaded, since they seemed to be made for record/protocol stuff; and it works quite beautifully, too, except the actual reloading :smile:; Well, I'll try reproducing this in a minimal test project i think. Maybe it really is something with the code. Otherwise maybe I can try using an atom for REPL development and completely scrap everything on restart, to rule out reloaded"
68,1546802054.0352,Isa,Who can share experience about <https://github.com/onyx-platform/onyx> ? Do you feel it is right solution for PDF processing when fast response for query by API is needed?
68,1546802142.036,Reiko,I remember seeing a comparison table of Clojure web libraries/frameworks. I can't seem to find it now. Anyone have the link?
69,1546802474.0364,Reiko,It showed which ones use macros and which ones are data driven
70,1546803325.0368,Aubrey,I think you might mean this <https://github.com/juxt/bidi/blob/master/README.md>
69,1546803586.0375,Reiko,"Yes, that was it, thanks. Forgot it was just comparing routing specifically though.; I'm contemplating bidi + yada, but not quite sure the practical differences between the libraries"
70,1546803887.0385,Isa,From what I see yada use bidi under the hood
69,1546803940.039,Isa,I don’t know this library but it looks like it is bidi + ring glue; <@Reiko> ^
69,1546803991.0398,Reiko,"That could be. They are both from JUXT and is stated as sister libraries; It is an alternative to ring though; ""A yada handler is an instance of the yada.handler/Handler record. Since this record satisfies clojure.lang.IFn, yada handlers behave just like normal Ring handlers and can be used wherever you might use a Ring handler. """
69,1546804493.0412,Britteny,there's this one too <https://github.com/metosin/reitit> 
69,1546804506.0416,Reiko,"Yeah, looking at that too"
69,1546804509.0418,Meagan,yeah. I think you would use something like: ring (http abstraction) + jetty (web server) + bidi (routing) + yada (resources)
69,1546804529.0422,Reiko,"No, yada provides the http server and is an alternative to ring; It uses Aleph"
69,1546804547.0427,Meagan,:thinking_face: my mistake. must have misread the docs
69,1546807704.0433,Sixta,"<@Reiko> if you have any questions about bidi/yada, there is a subset of us specifically in <#C0CFGN25D|juxt>"
71,1546808575.0466,Sixta,"Fwiw, it isn't outside the realm of possibilities for yada to work with other web servers, but yada is currently coupled to the async extensions that Aleph adds. We haven't had a need to extend yada to other web servers, so it hasn't happened, and in the mean time, we have added conveniences for starting yada. "
72,1546809036.0481,Aubrey,"I can also recommend pedestal. Different aims than yada, still a good candidate. "
69,1546810535.0488,Reiko,Thanks for the recommendations
72,1546816558.0569,Fredda,I try to avoid the life cycle (mount/component) stuff unless absolutely necessary
69,1546817142.057,Reiko,Can you elaborate?
69,1546817336.0572,Fredda,"I guess certain extremely complex webservers can benefit from it. But it seems like lots of templates include the structure just in case you need it. Which usually isn't a huge deal, since it doesn't usually get too much in the way even when you don't need it. But then it's just one extra piece of unnecessary complexity.; And in my experience, it's quite easy for projects to evolve and reloading to become broken with life cycles, unless teams maintain good discipline"
73,1546818417.0576,Samual,"""Component"" itself is an outline of the necessary discipline, no?"
69,1546818980.0578,Fredda,It is. And I guess I'm glad the abstraction has some standard. I just think it's over used
69,1546819429.0588,Celestine,"<@Fredda> What would you recommend for managing resources that have a start/stop lifecycle then, given that you need to be able to retain a live REPL experience (with _some_ level of code reloading)."
69,1546819870.0644,Fredda,"<@Celestine> some component like thing, sure. But do all web services really have such complex runtime life cycle interdependent resources? I guess it depends on how you archetect your services. `defonce` is often good enough for simple things imo."
69,1546819896.0645,Samual,"Ran across this from H L Ship of Walmart Labs <https://medium.com/@hlship/tips-and-tricks-for-component-d00832abcdfa>; definitely an enterprise use case; as opposed to small team; There is also ""reloaded.repl"" to go with Component, looks very labor-saving"
69,1546820006.0663,Celestine,"Database connections, caching layer, environment/configuration setup, tons of other stuff benefits from the start/stop lifecycle; I haven't found I need to actually refresh namespaces and there are enough gotchas with full reloading that I avoid it."
69,1546820060.068,Samual,Also if you use Component as dependency injection then it looks like it would let you have several alternative setups or build a mini-system somewhat a la carte
69,1546820060.0681,Fredda,"Yeah, large enterprise services"
69,1546820082.0685,Samual,uh oh gotchas?
69,1546820126.0691,Celestine,"Component's DI allows you to easily swap in ""mocks"" for testing, yes."
69,1546820167.0695,Samual,<@Celestine> You encountered glitches with full reloading?
69,1546820264.0708,Celestine,"I see a lot of people running into problems with it, yes. I've also seen a lot of people who've set up ProtoREPL for Atom using Jason's opinionated guide run into refreshing problems -- and I recommend they *uncheck* those three options in ProtoREPL."
69,1546820332.0721,Fredda,"If you have all those things, and you have complex runtime dependencies between them, sure. And it's nice that there's a common abstraction for that."
69,1546820333.0723,Celestine,It seems like it often blows away things in namespaces that they don't expect and they run into errors relating to that which they don't understand (and have to restart their REPL anyway).
69,1546820548.075,Samual,"hm yes everything you've done in the 'user ns is gone.. but as long as the reload-all is preceded by component/stop and followed by component/start, the big picture should be ok!; OTOH it reloads from disk. So if you draft work in namespaces and do not save it, I guess it's lost"
69,1546821129.0779,Celestine,"<@Samual> I tend to work a lot against the REPL by evaluating top-level s-expr's without saving files. I use `comment` blocks for code that I'm using for exploration and tests -- also evaluated directly as s-expr's into the REPL without saving. I have component start/stop calls in comments too, but mostly I start the system and eval code live into it for hours as I develop.; I don't tend to have a workflow these days where I need to do full reloads -- and even when I need a bit more brute force that just loading a single file into the REPL, a `(require … :reload-all)` is sufficient."
74,1546821218.0802,Antwan,"(not to interject, but what are the pro/cons of component vs the defstate stuff in mount)"
69,1546821271.0813,Celestine,<@Antwan> My feeling is that defstate in mount is still global state and should be avoided. I like component's ability to have multiple distinct instances live in my REPL at the same time.
69,1546821331.0822,Meagan,"what I like about mount is that it allows me to write my code mostly like I would expect if I _wasn’t_ use mount, e.g. vars referring to other vars in namespaces; it’s more on the _easy_ side of the simple vs. easy continuum; but you do lose some power, like <@Celestine> said"
69,1546821390.0839,Celestine,"I like my functions to rely solely on their parameters (and other functions) -- so if they're doing DB stuff, they should be passed the `db-spec` (or something that contains it).; When we got started with Clojure at work back in 2011, we didn't start with Component... and we're still regretting that...; We've worked very hard to adopt Component and to refactor code to remove the global state that we had to start with."
69,1546821465.0859,Meagan,sure. and you can still do that in mount. mount states are just vars
69,1546821467.086,Celestine,So I'm *very* strongly against global shared state these days because of that experience.; Vars are global shared state.
69,1546821489.0865,Meagan,right. I see what you’re saying
69,1546821536.0873,Antwan,"maybe a tangent for offtopic, but what were the kinds of issues you ran into?"
69,1546821654.0892,Meagan,"typically the way I end up writing my applications, is that different namespaces might declare different states. those states get introduced into my application at various entrypoints, and are passed around from that point on.

I find that mount pretty much solves the _reloading_ part of my issues, e.g. being in a dirty REPL and wanted to start/stop some resource that things are referring to.

it doesn’t really help you at all with architecting your application, since it allows you to be as strict or loose with how you reference those global states as you want; the upside is much less ceremony. but I haven’t been burned too badly yet, so I’m willing to pay that cost for now :wink:"
69,1546822076.0912,Celestine,"There's no ""One True Way"" in Clojure so you can use whatever approach suits you best -- but that also means there's not much guidance and nothing very opinionated, which can be hard when you're getting started. And no frameworks adds to that.; We've changed our approach a lot over the years -- and in our suite of apps, some of them are built very differently to other, based on who built the core of it and at what point in our usage it got started. We have about seven and a half years of code now, and over 86K lines of Clojure so there's quite a bit of variety in there."
69,1546822743.0929,Reiko,I guess I'm not exactly sure what your statement was responding to.
75,1546823033.0931,Fredda,My statement?
69,1546823179.0933,Fredda,"I was just airing a general complaint, sorry. Your use case may be entirely appropriate."
69,1546823513.0935,Reiko,"I'm just not familiar with mount or component and didn't see it mentioned above it so I was just confused by that. If I knew them I might agree with your complaint.; From a cursory glance of them, it sounds to me like it's another example of OOP mentality trying to claw back in to our functional paradise. :slightly_smiling_face:"
69,1546823740.0939,Fredda,I guess I was reading some backlog in another channel... And I accidentally responded in this channel... Lol
69,1546823762.0941,Reiko,No worries. It ended up having a relation indirectly after all
69,1546823763.0943,Fredda,Now I can't find it :grin:
69,1546824470.0951,Samual,"Installed Atom + Chlorine.  No idea how to use it.  Tried ""chlorine connect clojure socket repl"" command, put in the port number, it said it worked.  But; how do I evaluate a form?"
69,1546824523.0962,Celestine,"<@Samual> Unless you have key bindings, you'll have to do everything through the command palette.; Happy to share my config in the <#CF02KPG4U|chlorine> channel; The console pane is output-only at the moment. The expectation is that you will eval code from your editor pane into the REPL."
76,1546827378.0978,Felix,Is there a port of <https://common-lisp.net/project/mcclim/> to Clojure anywhere?
77,1546828867.0985,Annamaria,"Since I love writing templates in Hiccup, I got around to creating a template for clojure built sites on netlify:

<https://github.com/minikomi/simple-static>

Hiccup, cljs, garden for css."
77,1546829895.0988,Colette,cider-send-ns-form-to-repl and cider-send-ns-form-to-repl-focus; a bit late but :slightly_smiling_face:
78,1546832147.0993,Abby,Thanks for that! I've used it before to learn :slightly_smiling_face:
79,1546832182.0995,Annamaria,"no problem, just a basic thing you can build on."
79,1546832300.0997,Abby,"And since I also love to write templates in Hiccup, it really saddens me that there seems to be very little effort from the community to attract simple front end developers. I've struggled a lot to find good material to ease entrance, both for me and for friends I would like to experience Hiccup/Garden."
80,1546839501.105,Alix,"What's a good way to provide context/metadata to my transducers? My transformation relies on some collection specific config data.
- Lexical scoped variable would mean I only need to provide it once however I would need to pass it to all the inner function calls.
- I could merge it into each element however then I would be duplicating this config data. This might be inefficient as this config data contains a collection itself and I would be repeating that collection for each element in my data.
- I could also do something with metadata too?
- Maybe I could provide a function to each element which when called returns the config data?"
81,1546841103.1054,Rosaline,"merge it in; in memory it is a pointer to the same data, not separate copies of the data"
81,1546842975.1069,Alix,<@Rosaline> Ah right. That would work great then as the merge is the simplest to implement. Thanks :slightly_smiling_face:
82,1546852625.1082,Ivana,"Like this? ```(clojure.pprint/pprint ''[foo bar])
'[foo bar]```"
82,1546852661.1084,Clarine,can you do that with the x instead of the double quoted vector?
82,1546852825.1086,Ivana,Maybe not. Is it for edn data or for something else?
82,1546852847.1088,Clarine,"code generation, but I already have a solution, you’ll see it if you read on :slightly_smiling_face:"
82,1546852993.1092,Ivana,"Or indeed ```user=&gt; (defmacro quoted [x] `(quote (quote ~x)))
#'user/quoted
user=&gt; (def x (quoted [foo bar]))
#'user/x
user=&gt; (clojure.pprint/pprint (quoted [foo bar]))
'[foo bar]```; cool, i'm curious"
82,1546853043.1097,Clarine,I did it like this: `(list 'quote all-syms-clj)`; anyone got a tip how I can get highlighted clojure code in keynote?
82,1546853075.1102,Ivana,nice
82,1546854066.1113,Min,if you use emacs you can just emit html for it via htmlize-region (it will generate all the css that matches your theme/colors) and paste it there somehow (I did that with google presentations not keynote but I guess html might be supported) -&gt; <https://melpa.org/#/htmlize>
83,1546854222.1114,Chanelle,as an option copy somewhere online with syntax highlight and copy back - keynote might use the colors.
83,1546854576.1118,Katherina,I use <http://pygments.org/demo/> with the Clojure option and copy back the code which comes with the colors. Supports multiple highlight styles too
83,1546854591.112,Tammera,"yeah, I copy code of GitHub, and manually fix newlines"
83,1546854816.1123,Clarine,thanks
82,1546855003.1126,Clarine,"<@Min> cool, that works for me"
84,1546870127.1144,Antwan,"<@Felix> I've never heard of that library, how does it function?; (if it's cool enough I need a side project regardless)"
83,1546872135.1156,Shayla,"looks like it's a gui toolkit/framework: ""McCLIM is a FOSS implementation of the Common Lisp Interface Manager specification, a powerful toolkit for writing GUIs in Common Lisp."""
83,1546872294.1167,Evonne,"I’m guessing that compiles down to machine code, as opposed to something like seesaw, that hooks into Java Swing <https://github.com/daveray/seesaw>; (See also: <https://github.com/fn-fx/fn-fx>); I used to be very interested in native GUIs, but lately, you know, the web app is just right there…"
84,1546873697.1187,Antwan,"I think for customer facing stuff that makes sense, but I've had acquaintances whose job it was to make a tiny internal tool that needed to have a gui; god rest their souls; they chose swing; so seesaw looks cool"
84,1546874758.1196,Gilda,<@Tonya> You have a couple of options. One is to just use the built-in support ala <https://github.com/emezeske/lein-cljsbuild/blob/1.1.7/doc/REPL.md>. Another is to use middleware and launch a clojurescript repl from your main repl via something like <https://github.com/nrepl/piggieback>.
84,1546878753.1212,Felix,"<@Antwan>: not sure, never used McClim. The manual looked impressive, so I was hoping someone had ported it over to Clojure so I could test it."
85,1546880623.1241,Jasmine,"If you took the Clojure survey, and marked “Reference docs” as a priority for making improvements, I would be interested to learn more. 1) do you mean something other than the docs at <https://clojure.org/reference/*>. 2) do you think existing docs should be improved or new things added. And then I’m interested in learning if there are specific things (if so, an issue at <https://github.com/clojure/clojure-site/issues> would be best) or if this is something else."
86,1546887024.1291,Somer,"I am attempting to read a serialized function from an `ObjectInputStream`. This code is running in a Java Class and looks like this: `IFn f = (IFn) in.readObject();`. I am getting an exception pointing to that line:
```
Caused by: java.io.IOException: java.lang.ClassNotFoundException: compute.connector.serialize$myfn
```
I'm guessing this has to do with Clojure's classloader? Do I need to switch the classloader for the thread calling `readObject`?; Right before that line, I require the namespace: `require.invoke(Clojure.read(namespace));`.; Actually, the code looks almost identical to this: <https://github.com/gorillalabs/sparkling/blob/b6e93ca6005a86b3d67bfae646db5e26d145dc68/src/java/sparkling/serialization/Utils.java#L33-L58>"
86,1546887168.131,Dann,don't IFn instances created via eg. fn get randomized automatic names that don't persist across restarts?; or are you using something like deftype to get something that implements IFn but has a predictable name?
86,1546887266.1326,Rosaline,defn results in a fn with the same classname
86,1546887269.1327,Somer,"For this first cut I'm defining `myfn` as:
```
(defn myfn
    [x]
    (inc x))```
It's only run once so _I think_ its name would be the same?"
86,1546887305.1332,Rosaline,"yes, you'll have to use the compiler's classloader; I would strongly recommend against that; why not serialize the var?; serializing fn objects is gross; if you serialize the var, you can still do the namespace require trick with the namespace for the var, then deref the var to get the value, no classloader stuff required"
86,1546887433.1362,Somer,Hmm. I'm not sure. Ultimately it may need to serialize an anonymous function :grimacing:
86,1546887445.1366,Dann,then you run into what I was saying
86,1546887454.1371,Rosaline,"or don't even bother to deref the var, because vars implement ifn"
86,1546887458.1373,Dann,the name is auto-generated gibberish that changes on reload
86,1546887471.1377,Rosaline,don't put yourself in a situation of needing to serialize anonymous functions
86,1546887518.1385,Somer,I'm not sure if it can be avoided. The anonymous function is calculated through an expensive ML-esque process.; I've seen this <https://github.com/technomancy/serializable-fn> but that seems kinda gross to me. Perhaps less gross than serializing an anonymous function?
86,1546887712.1407,Dann,it's the only technique that will reliably work correctly across restarts / vms though
86,1546887752.141,Becki,"that docstring on that macro is so nice lol; ```
(defmacro ^{:doc (str (:doc (meta #'clojure.core/fn))
                      ""\n\n  Oh, but it also allows serialization!!!111eleven"")}
```"
86,1546887841.1424,Somer,"&gt; it's the only technique that will reliably work correctly across restarts / vms though
How come?; Why?"
86,1546888386.1434,Dann,because anonymous function names are auto-generated
86,1546888403.1437,Somer,"If you could get them to be statically generated, would it work?"
86,1546888442.1443,Dann,"hmm - actually, maybe having a predictable name isn't needed for object deserialization? honestly I don't know"
86,1546888593.146,Rosaline,it is; the object is an instance of some class; and the class needs to be defined
86,1546888659.1473,Dann,I guess you could serialize the class itself with the instance...
86,1546888752.148,Rosaline,"just don't paint yourself in to the corner of serializing closures; and like, you are already shipping the clojure code around (otherwise you wouldn't be able to require the namespace); so just get what you need from there instead of going through java object serialization; so you use some weird process to generate your code, instead of generating a code object and using java serialization, have it generate a form, stick that form in a file with a def, require the file, grab the var"
86,1546889011.1514,Somer,"Yeah that path seems to have less friction. Curious, have you gone down the serialization path before and hit problems?"
86,1546889145.1529,Rosaline,"not really, I can't tell you the last time I've used java serialization, I was present at the seajure meetup were serializable-fn was written, and I have spent a little bit of time thinking about shipping functions around in a distributed systems setting"
86,1546889248.1535,Somer,I see. Is storing the form as a string still the best approach you've seen?
86,1546889318.1546,Fredda,"If you absolutely need it, I prefer to define objects so they print with enough info so that the object can be reconstructed on the other side, as defined by some object reader.; But that won't be easy for arbitrary closures"
86,1546889581.1579,Somer,"In an ideal world, storing the data to construct the function would be great. In our case, the data used to create these functions can have thousands of different complex properties. It would be a large undertaking to model that data, and we'd like to push that off for the time being."
86,1546889840.1581,Rosaline,"I don't mean a string; I mean, like, generate a file that contains (def f (fn [...] ...)); then load that file"
86,1546889925.1598,Somer,"That’s not much different than a string, right?"
86,1546889944.16,Rosaline,it depends; if you have a namespace and load the file via require then multiple loads won't result in new code generation; the naive approach of sending a string around and evaling it will
86,1546890005.1612,Somer,What’s the downside to new code generation?
86,1546890026.1619,Rosaline,it won't be hot
86,1546890062.1626,Fredda,"Some fns also want to close over local state, which won't work very well when you've stringified your form, unless you're careful"
86,1546890103.1629,Rosaline,any form of serialization has that problem
86,1546890110.1631,Fredda,right; that's true
86,1546890186.1645,Somer,Doesn’t the serializable-fn handle locals?
86,1546890201.1648,Rosaline,it handles them as best it can; (which in my opinion is not very well); the problem with serializing arbitrary object graphs from memory (which closure serialization is) is pointer identity is not preserved; vars are sort of like pointers where the identity is preserved
86,1546890502.1691,Somer,Not sure I totally understand. Is that a performance trade off or a different behavior than originally expected?
86,1546890518.1696,Rosaline,both in the case of mutable objects; the first in the case of immutable values
86,1546890558.1707,Fredda,What if `serializable-fn` is closing over another closure?; May only work with data
86,1546890595.1715,Rosaline,"or a ref, or an atom, or some random java object"
86,1546890601.1717,Fredda,right; lot's of gotchas
86,1546890988.1748,Somer,I suppose that’s the trade off I’d be making with taking approach. <@Rosaline> you said you spend some time thinking of this. Was this the best solution you found?
86,1546891080.1756,Rosaline,"there isn't a good general solution, so you should solve your specific problem; your specific problem is you have some clojure code you want to distribute; the best way to distribute clojure code is as code; (not serializing java objects from memory); there is some tool that people use for deploying clojure functions as aws lambdas, you might check that out (I forget the name); I have trouble believing it works well"
86,1546891282.1801,Marceline,"Here is a naive question. I would like to refer a java enum member: java.awt.Desktop.Action.BROWSE. I tried various different forms, yet none works."
86,1546891351.1824,Rosaline,java.awt.Desktop$Action/BROWSE
86,1546891354.1827,Dann,"for the first thing, the object owning it is Desktop$Action - that's how inner classes work"
86,1546891366.1833,Marceline,"For instance, (. java.awt.Desktop.Action BROWSE), (java.awt.Desktop.Action/BROWSE)..."
86,1546891387.1841,Somer,That’s a great breakdown of the problem. Thank you guys for your input! Going to investigate the serializable-fn approach to see if it will cover the entirety of my problem. 
86,1546891394.1844,Dann,"inner classes are fictional, what actually exists is a class with a $ in the middle of the name"
86,1546891413.1846,Marceline,<@Rosaline> thanks! Let me try it.
86,1546891417.1849,Dann,"also the parens are allowed, but not needed"
86,1546891426.1852,Marceline,"Seems it is not in the document -- I did read it, :slightly_smiling_face:"
86,1546891505.186,Dann,"<@Marceline> documented where? The official docs mention how to access an enum and how to access an inner class, but for this case you need to know both; oh maybe they don't directly mention enums..."
86,1546891640.1871,Marceline,<@Dann> I was reading: <https://clojure.org/reference/java_interop>.; I found it now -- it refers to the $ syntax at one place -- I missed it.
86,1546891675.1883,Dann,"yeah, I remember things that clearly aren't covered there - it doesn't mention the thing about inner classes and doesn't show using enums either; oh, $ is under ""nested"" not ""inner"""
86,1546891706.189,Rosaline,enum values are static field on the enum class; it definitely mentions static fields
86,1546891747.1898,Dann,"yeah, I guess there's a few things you need to know about the JVM internals before all those docs are clear"
86,1546891781.1904,Rosaline,"that isn't really even jvm internals, ""enums"" exist as a java language contstruct"
86,1546891813.1909,Dann,and they are defined in-language to be equivialent to static fields on an object?
86,1546891967.1912,Rosaline,that is what the compiler turns them in to
86,1546892103.1922,Dann,"right, what I'm saying is that there's a piece of information about the internals, that isn't derived from the language ~spec~ docs, needed to understand how to access an enum"
86,1546892218.1941,Marceline,The official java doc annotate the nested class Action as: java.awt.Desktop.Action -- so java uses . to refer to nested class. Yet clojure uses $.
86,1546892332.1944,Dann,"right - but the clojure docs actually describe that discrepency; what I was getting at is enums, which are indirectly described (you need to know it's implemented as static fields on a class)"
87,1546892875.1966,Jasmine,If only there was a way to register these issues for update
86,1546892930.1967,Jasmine,<https://github.com/clojure/clojure-site/issues>
86,1546893573.1973,Marceline,<@Jasmine> I will register an issue about this one later today. thanks!
86,1546893703.1976,Jasmine,Thanks!
87,1546896360.1992,Tammera,"<@Jasmine> Looking at some of the documentation I sometimes find myself puzzled at what is actually suggested. Take for example <https://clojuredocs.org/clojure.core/reduce-kv>, it tells me that it takes a function with three positions, an `f`/`init`/`coll` and that it applies f to `init`, `k1`, `v1`, and applies `f` to that result, `k2` and `v2`… etc.

This particular case tells me “how” and “what”, but forgets to tell “why”. It is actually, as a beginner in Clojure, surprisingly difficult to quickly find functions that I need due to these highly dense detailed pieces of documentation that “forget” to tell the higher picture.

Certainly written with great intention, and all information is there, but not usually in a very “yes this is what I want”/“no I don’t want this” kinda way. If that makes any sense?"
87,1546896493.2004,Jasmine,"That is pretty much by design. The docstrings are not intended to teach you the language, the idioms, etc of the language. They are meant to be concise statements about what each function does.; We don’t really have any intention to change that (and in fact, making these much longer and more explanatory would also increase code size and degrade classloading and startup time); However, it is perfectly reasonable to combine docstrings with ancillary material that is useful to one or more audiences into a documentation site that would be better for those audiences"
87,1546896726.2039,Tammera,"yeah ofc, they are pretty printed docstrings, I get that. I am merely saying that, as a beginner, that is often the only thing I have, and dumps quite a bit information on my “newbie” mind."
87,1546896731.204,Jasmine,"<http://clojuredocs.org/> is such a site - it combines the docstrings with examples, links, etc; some efforts that have been made in adding supplementary docstring material but it’s a big effort and one that’s hard to do well; maybe some day we will spend more time on this in the core team, but other things seem more pressing at the moment; there is a lot of intro Clojure material available in a variety of forms and I’d say all of them are a better way to learn the “why” parts than reading docstrings"
87,1546897093.209,Tammera,"Right, link was actually to clojuredocs ^^. Its hard to pinpoint, I’d admit that, but it feels currently that there is a great detailed explanation but no higher level overview. I am merely pointing out what I recently notices was holding me back a bit in terms of documentation. Please take it as no offense"
87,1546897121.2093,Jasmine,none taken! :); you are hardly the first to make such an observation :)
87,1546897531.2111,Tammera,"haha ofcourse, and I will certainly not be the last. Its easy saying that “clojure documentation is x”, but “why I think its x”, thats such a different question."
88,1546898125.213,Celestine,"<@Tammera> I'm curious as to what would have helped you here (specifically)? Were you just looking over all the various core functions thinking ""Hmm, I wonder when I would use that?"" or did you start from a problem, thinking ""Hmm, what core function would solve this problem?"""
87,1546898218.2138,Celestine,"Are the examples of `reduce-kv` on the <http://clojuredocs.org|clojuredocs.org> page not explaining a ""why"" here?"
88,1546898236.2141,Reiko,<@Tammera> You may find this helpful: <https://clojure.org/api/cheatsheet>
87,1546898424.2162,Celestine,I haven't read this but it may be a good resource for this sort of question <https://www.manning.com/books/clojure-the-essential-reference> (anyone have any input on it?)
88,1546898440.217,Becki,"There's also <https://www.conj.io/> which i really like. It has examples which often include more of what you want. IE, if you look up defprotocol you're probably gonna want to glance at extend-type or extend-protocol"
87,1546898446.2173,Reiko,"I understand where you're coming from. From my perspective, it's hard to answer the ""why"" because answering that is entirely context dependent."
87,1546898530.219,Becki,i browse it from CIDER `(C-c C-d r)` and just saw that it hotlinks to crossclj to find usages. that's pretty cool
88,1546898673.2213,Tammera,"<@Celestine> in this particular case I stumbled upon it because a coworker was using it. I think the “problem” of the examples here is that there is no base case. The first example is more complex than it should have been, and most other examples feel more esoteric than valid usecases of the particular function. If this particular page just had a very simple `(reduce-kv (fn [memo k v]) ...) init coll)` I would already have been helped tremendously in _quickly_ finding out what it is about. (Also, it was just some example of a page that I remembered took me longer to “parse” than it should have imo, don’t assign too much value to the example ^^)"
87,1546898967.2237,Celestine,"Ah, reading code and finding an unknown function and thinking ""Hmm, why have they used this function?"" … yeah, I can see that use case... and you're pretty much going to be at the mercy of whatever examples (and comments) folks have added to <http://clojuredocs.org|clojuredocs.org> at that point. At least more examples/comments can be added by the community so now maybe someone here can go add something that would have helped you... or you could add something that would help future you's coming along and hitting the same question/use case."
87,1546899091.2249,Tammera,"Right, I knew that was coming, it is a community resource after all. Ofcourse I want to contribute, but I was just taking this as an example of something that “hindered” me as a newbie."
87,1546899240.2267,Reiko,Do you have any prior experience with the functional paradigm?
88,1546899259.2272,Tammera,"yes, have programmed in Haskell before"
87,1546899274.2274,Celestine,"No worries. There are lots of gaps and rough edges in the public Clojure documentation sphere, unfortunately, and precious few people who have the time/energy to contribute so we all owe them a huge amount of thanks for what we've got so far. None of that helps folks today who hit something that is not well-covered in the docs tho'... :disappointed:; I wish I had more time to spend on docs and tutorials but I'm really not very good at writing that sort of stuff..."
87,1546899366.2287,Becki,we should get the Rust guy who just quit Mozilla. His dream job is Alex's job i think; (not to replace Alex but to work alongside him :)
87,1546899408.2291,Reiko,I thought this last example on clojuredocs was helpful as it is so basic it is showing another way of updating a map.
87,1546899428.2294,Becki,Steve Klabnik is who i was thinking of
87,1546899459.23,Dann,it's basically merge but restricted to two args
87,1546899465.2301,Tammera,o.O did he quit mozilla; what a loss for the Rust community
87,1546899508.2311,Dann,also `(reduce-kv assoc m e)` does the same thing (though admittedly less clear what it's doing)
87,1546899511.2312,Becki,yes. dan luu tweeted about it. and its got some interesting thoughts in it. he was the _lowest_ paid member of his team
87,1546899529.2315,Tammera,"have a link by any chance, Rust is one of those languages I follow with great interest but with lack of time to invest"
87,1546899579.2318,Becki,good thread on it with link to steve's blog: <https://twitter.com/danluu/status/1082321431109795840>
87,1546899658.2339,Diamond,It’ll have different behavior if you give it vectors. :smile:
87,1546899724.2341,Reiko,"""Reduces an associative collection."""
87,1546899902.2358,Dann,merge only works on vectors accidentally
87,1546899906.2361,Arnoldo,"This won't help your general issue of better examples, but for this particular question: <https://stackoverflow.com/questions/48732579/when-to-use-reduce-kv-over-reduce-in-clojure>"
87,1546899919.2365,Dann,or do you mean this works better on vectors than merge does?
87,1546899927.237,Tammera,"Haha, I know what it does _now_, its not a hard function, its just hard to parse from the *current* example[s] (or their order), that it really isn’t."
87,1546900000.2377,Arnoldo,"Personally I've never had an issue with just destructing the map entries using normal reduce, but then I wasn't considering the performance"
87,1546900021.2378,Tammera,really sad; I kinda hope he finds a new home for his Rust work. That language really shows great potential and needs someone like him as much as any other new language.
87,1546900294.2385,Reiko,What's the current preferred libraries for making HTTP requests from an API server?
87,1546900538.2387,Becki,i would be quite happy to see him at Cognitect :slightly_smiling_face:
87,1546900661.2389,Tammera,"haha also, but I kinda also want Rust to succeed"
87,1546900948.2396,Celestine,<@Reiko> we use both `clj-http` and `http-kit` (client).; The latter is nice and simple and async by default. The former is comprehensive with a lot more knobs and dials.
89,1546900981.2405,Reiko,Are there any practical differences between them?
89,1546901030.2412,Celestine,(does my second line answer that or do you want more specifics?)
89,1546901064.242,Reiko,More details would be helpful to weigh them
87,1546901098.2431,Reiko,"My current use case does not require fancy tweaking so I'm more looking at performance, size, http compliance, etc"
89,1546901227.2451,Celestine,I guess it depends on what you need it for. `clj-http` brings in a lot of dependencies (which can be a problem in itself) but it is extremely configurable and has built-in support for a number of over-the-wire protocols and coercions. We've also run into problems with its handling of multipart form POSTs with image files and a few APIs that we needed to interact with (something odd about how it was handling headers I think) and we've switched those to use `http-kit` instead.
87,1546901278.2464,Reiko,I would prefer fewer dependencies as it is only a small project
87,1546901289.2466,Celestine,"Going forward, I think we'll use `http-kit`'s client library more and more (and `clj-http` less) because we really don't need all the bells and whistles that `clj-http` offers -- and we like the simple, async-by-default approach of `http-kit`."
89,1546901304.2469,Reiko,"That seems in line with my thinking, thanks"
89,1546901312.2472,Celestine,"But `clj-http` has been the ""gold standard"" in Clojure for a long time... :slightly_smiling_face:"
87,1546901320.2474,Fredda,def check out <https://github.com/schmee/java-http-clj>; I haven't tried it out yet but I've been meaning to
87,1546901405.2481,Tammera,dependency on Java 11 tho
89,1546901413.2483,Tammera,that may be a dealbreaker?
87,1546901428.2487,Reiko,I hope not. Not for me for sure; Only if you have an environment that requires a previous version
87,1546901478.2495,Tammera,"right, I know people who are reluctant to upgrade because of licensing concerns and therefore stay on 8"
89,1546902284.2501,Celestine,"(if folks are concerned about licensing, they should upgrade to OpenJDK11 -- from somewhere like AdoptJDK :slightly_smiling_face: )"
87,1546902307.2506,Celestine,Staying on (Oracle) JDK 8 means no more updates unless you pay.
87,1546902315.2508,Tammera,"OpenJDK 11 has 6 months of support, no?"
89,1546902330.2511,Celestine,OpenJDK _from Oracle_ has only six months.
89,1546902338.2516,Tammera,"right, ofcourse"
89,1546902344.2518,Celestine,Other OpenJDK providers are offering longer support periods.
87,1546902486.2527,Reiko,Isn't the idea that it shouldn't be a big deal moving forward? Just upgrade to 12 when it comes out?; I thought I remember that being a design goal of the new structure
89,1546902519.254,Celestine,Depends whether you want long term support and/or are willing to pay Oracle money...
87,1546902541.2547,Celestine,(and this should probably go to <#C1AC4BU2K|java> before we suck too much air out of <#C03S1KBA2|clojure> about it)
87,1546902542.2549,Tammera,"Yeah, they are on a faster release schedule, I can see how people were concerned the first time they read “6-months of support or upgrade”."
87,1546902560.2553,Reiko,"Personally, I avoid any software that is coupled to a specific version of Java"
87,1546902580.2558,Tammera,"Right also I am heading off, I managed to break my sleep schedule enough as is. Was a pleasure discussing ^^"
87,1546908688.2569,Diamond,I was making a joke.
90,1546908715.2574,Dorla,"Is there a way to know whether an object satisfies a protocol that's been extended via metadata? `clojure.core/satisfies?` doesn't seem to work?
```
  (defprotocol IFoo
    :extend-via-metadata true
    (foo [this]))

  (def x (with-meta {} {`foo (fn [x] :foo)}))
  (foo x)
  ;; :foo
  (satisfies? IFoo x)
  ;; false
```"
91,1546909032.2576,Diamond,The use of the word “work” in the context of using `merge` with vectors is quite charitable. I’ve never been in a situation where upon finding that a bug due to a mistaken use of `merge` with vectors was considered “working” nor have I ever been in a situation where anyone recommended `merge` as a substitute for `conj`.
90,1546909232.2591,Celestine,"You can query whether the metadata on a given object has entries for the protocol functions you might want to call -- but it would make `satisfies?` a pretty slow function if it had to walk all the metadata to look for all the protocol functions declared for a given protocol...; ...and you might only provide one or two of the functions (the ones you actually know will be called) rather than all of them.; If `IFoo` had two functions, `foo` and `bar`, and you had an object whose metadata defined just `foo`, does it satisfy `IFoo` or not?; ^ <@Dorla>"
91,1546909911.2653,Samual,"<@Reiko> for an API server that is both a server and a client, Zach Tellman's aleph looks excellent.  It's built on Netty so it does all sides of networking.  It's also built on Z.T.'s rip-snorting ""manifold"" async library.  So your non-blocking code that says ""in response to this api request, go ask <http://bla> for something and when it comes back filter it and return it to the end user"" looks perfectly procedural and natural."
90,1546909936.2656,Dorla,"That's a good point. I don't care about performance in this case so it would have been nice if there was a function in core that made a `satisfies?` in the metadata. It's quite easy for me to add (contains? (meta x) `foo) in this case.; As for the second point when an object has just defined one of the functions in `IFoo`, I'd expect `satisfies?` to work like it does on other object who hasn't implemented the protocol fully:
```
  (defprotocol IFoo
    (foo [this])
    (bar [this]))

  (satisfies? IFoo (reify IFoo (foo [this] :foo))) ;; true
```; Thanks <@Celestine> as always :slightly_smiling_face:"
92,1546911029.2689,Dann,haha OK
90,1546911256.2706,Celestine,"I guess the check for protocols that can be extended via metadata needs to be ```(if (or (satisfies? IFoo x) (contains? (meta x) `foo)) (foo x) (throw (ex-info ""Don't know how to foo this!"" {:x x})))```"
92,1546911292.2712,Celestine,(or just let it blow up depending on what you need to do in the non-`foo`-implementing case)
93,1546912124.2719,Reiko,"I'm running yada on the frontend, which uses aleph. The backend API is separate so I'm using java-http-clj on that end"
94,1546921282.2748,Loria,"Why isn't there an equivalent `peek!` function for transient vectors in the standard library?; Say I have a reducing function where each step depends on the previous result and the intermediate steps are all internal
```
(reduce
 (fn [acc val]
   (let [prev (peek acc)]
     (conj acc (... prev val))))
 [:init]
 coll)
```; It would be nice to easily turn it into a transient version
```
(persistent!
 (reduce
  (fn [acc val]
    (let [prev (peek! acc)]
      (conj! acc (... prev val))))
  (transient [:init])
  coll))
```; The only thing I could find was a 8 year old SO post <https://stackoverflow.com/questions/3207298/why-is-there-no-peek-function-for-clojure-transient-vectors>; Is the above code un-idiomatic in some way? I just started learning about transients but I imagine this isn't a rare use case for them."
94,1546922040.2794,Celestine,"Since a transient vector is both Counted and Indexed, I think the following should be O(1): `(defn peek! [t] (nth t (dec (count t)) nil))`; Not quite as fast as having it built-in but probably good enough if you're going to get enough of a performance boost from switching from persistent to transient vectors in a `reduce` like that..."
94,1546922340.2812,Jasmine,"`peek` is a read op. seems like it should just work on a transient vector, probably just an oversight; can’t say I’ve ever seen this mentioned before, but feel free to file a jira"
94,1546922793.282,Marlon,Where can I find information on how defprotocol's :on-interface directive works?
94,1546922882.2823,Jasmine,that’s not a public feature of defprotocol; so I don’t know of any info on it
94,1546923575.2831,Marlon,"Alright. I've just seen references in some of Rich's comments pointing towards it in the case someone had a particular use case, and I wanted to know more about it.; Most notably here: <https://groups.google.com/forum/#!msg/clojure/pZFl8gj1lMs/qVfIjQ4jDDMJ>"
95,1546925234.2834,Loria,"Thanks, I filed one at <https://dev.clojure.org/jira/browse/CLJ-2464> - it's my first time using JIRA so I'm not sure if it's done properly."
96,1546925668.2865,Mariela,"Is there something like the following for clojure.test (ideally not incurring in the banana-jungle problem; I don't want to change frameworks)

`expect { ... }.to change { ... }.from(1).to(2)`

that's ruby rspec in case in case it rings a bell. Else: `{ ... }` represents code blocks (which in clj would be fns, or macro bodies)

I actually implemented `expect-change` in clj a couple jobs ago, can't access the source unfortunately"
96,1546929773.2876,Celestine,"<@Mariela> sounds like you want `expectations/clojure-test` :slightly_smiling_face:; <https://github.com/clojure-expectations/clojure-test> -- it provides an ""expect"" style syntax on top of `clojure.test` (so all your existing tooling continues to work).; It's not as expressive as rspec… I believe there was actually a ""port"" of rspec to Clojure years ago but I don't think it is maintained now.; Although I'm not sure what `expect-change` would be in Clojure given the general lack of side-effect-y stuff...?"
96,1546930709.2939,Mariela,"hmmm interesting! nice job on the library, I appreciate the bridging of both worlds

I was familiar with Expectations, perhaps I don't like that a lot of stuff seems to rely on positional arguments, so occasionally typos might mean false positives/negatives

&gt; `expect-change` would be in Clojure given the general lack of side-effect-y stuff...?

I'd agree with you for unit testing, but for ""controller"" tests (in Rails lingo) where I assert that hitting API endpoint causes side-effect _x_, the technique becomes more useful.; As a random thought, a macro-based impl would rock:

`(expect (inc!) :to-change @foo :from 2 :to 3)`

Here, `(inc!)` and `@foo` are evaluated in a careful, specific order"
96,1546934044.2963,Celestine,"```(deftest side-effect-y
  (expect 2 @foo)
  (inc!)
  (expect 3 @foo))``` :rolling_on_the_floor_laughing:"
96,1546934259.2967,Mariela,yeah... doesn't meet my standards :stuck_out_tongue_winking_eye: BDD-y guy here
97,1546938888.2973,Tressa,is there a way to globally mock out a function during tests?; like with-redefs except global
97,1546938931.298,Ivana,"<@Jasmine> I think I marked this one too. For Clojure as a language the reference docs are pretty complete, as well as for it's core libraries (well done). However, what I think is missing is references on acknowledged Clojure design patterns. E.g. patterns like Component might not be unique to Clojure, but are very relevant for building Clojure applications. Without this knowledge and knowing who is authoritative, it is hard for someone new to know where to start and people will have to reinvent those patterns or wait to be pointed to them by their peers. If they are lucky they are coming from a language where similar patterns existed, if not, good luck.

IMO the same is even more true for the Clojurescript environment, but there I wouldn't even know what the reference patterns are. Is it om.next, something else? Is there even an acknowledged pattern?"
97,1546938973.299,Tressa,i'd want to mock a helper function from a dependency that's irrelevant during tests without having to with-redefs every single time
97,1546939051.3,Ivana,"I like to build it in the design of my application. Having dummy implementations for those dependencies, acting similar to the mocked dependency"
97,1546939141.3002,Tressa,actually it's in the dependency of a dependency and mocking that out feels like more trouble than just with-redefsing every test
97,1546939275.3004,Ivana,"I thought you were after an alternative testing way, but if it's about globally overriding the function. ```(alter-var-root #'the-ns/the-function (constantly (fn [&amp; args] ""whatever""))``` Works too; Be sure to not put it in production :slightly_smiling_face:"
97,1546940401.3009,Tressa,oooooh that's just the kind of thing i was considering; be right back trying it out
98,1546940555.3013,Mariela,are you using Component/Integrant? A nice approach would be to define per-environment components
98,1546940783.3015,Tressa,yup just what needed! thanks a lot!
97,1546947320.3021,Epifania,"Thanks for linking that, super helpful that I wish I found before! Seems to lack a printable version, current one seems to take around ~10 pages"
99,1546949853.3038,Fidelia,"what are your opinions on websocket libraries (vs. non-libraries)?

I used sente for a side project and had quite some trouble getting started, many concepts to understand and quite opinionated. There’s also the possibility of just hooking into http-kit directly. Anything I’ve missed, what do you prefer?"
97,1546953518.304,Jasmine,"Yep, thanks"
100,1546953647.3068,Jasmine,I hear ya. Doing this with a few web pages is generally hard. I sensed the same gap and spent two years co-writing Clojure Applied to try to fill it. It’s doubly hard in ClojureScript because things in contact with JS change at a much faster rate even.
100,1546954249.307,Ivana,"I guess a book is a more appropriate format indeed. I see that your book is mentioned in this list <https://clojure.org/community/books> So that's a start.  An idea for improvement would be if this list is more prominent as a follow up resource and grouped by type of problem or level (your book would be under ""patterns"", ""advanced"")? Maybe even community votes. Just thinking out loud here; I would then also add links between topics on the website and the books (e.g. <https://clojure.org/reference/transducers> would have links to books that have a significant part about transducers)"
99,1546956909.3075,Jasmine,"We would prefer on the main site to avoid “recommending” things, especially since those of us working on the site overlap with the authors of some of the books; categorization would be ok, but I think it’s difficult to categorize things fairly (this has all the problems of categorizing stuff anywhere else)"
100,1546959050.3087,Shayla,Steve is a powerhouse and the Rust community will be worse-off without him. Any community that he joins will benefit greatly.
101,1546960745.3102,Nova,"I have a simple deps.edn, and when I run clj the java process just hangs. What would be the first step to debugging this beyond making sure the dependency exists?

```
{:deps {org.clojure/clojure {:mvn/version ""1.10.0""}
org.openjfx/javafx-fxml     {:mvn/version ""11.0.1""}
```"
101,1546960780.3108,Marlyn,"upgrade your tools.deps, there was a bug previously; er, your clojure tool"
101,1546960815.3113,Nova,<@Marlyn> thanks; would explain why perfectly working code didn't work on a different computer
101,1546960839.3121,Marlyn,it’s actually tools.deps doing an infinite loop 100% cpu
101,1546960854.3126,Ivana,"I see what you mean. As a last suggestion, maybe the main site could only link to a separate site not controlled by the same people of the main site to avoid this potential conflict of interest. I'm guessing you have considered many options already"
101,1546960889.3134,Marlyn,<@Nova> you’re doing that for REBL?
101,1546960916.314,Nova,"<@Marlyn> yes, I was copying a rebl config to a different system; I'm aware the deps I pasted aren't the full reqs; it's just the minimum that cause the java process to hang"
101,1546960947.315,Marlyn,"we have a fix for that now:
<https://github.com/cognitect-labs/REBL-distro/issues/10#issuecomment-451173909>"
101,1546960960.3153,Nova,"<@Marlyn> yes, that's what I'm using"
101,1546962995.3159,Jasmine,"yeah, definitely make sure you’re using latest clj (now 1.10.0.411); if such a thing existed, would be happy to link to it :)"
102,1546966213.3171,Setsuko,"is there an alternative to doing `(merge-with (fn [x y] (or x y)) {:a nil} {:a ""val""})` without having to create an anonymous function?"
102,1546966448.318,Jasmine,"isn’t that just `(merge-with or ...)`; oh, macro"
102,1546966498.3191,Becki,Any chance you can inhibit nils in your map to begin with?
102,1546966545.3196,Jasmine,I can’t think of an alternative that’s clearer (other than to avoid having nils in the first place)
102,1546966817.3203,Lemuel,"`#(or %1 %2)` seems less noisy in this case, but I haven't got anything better"
103,1546966963.321,Loria,`(fn [&amp; vs] (some identity vs))` for the variadic case?
102,1546966989.3214,Loria,`#(some identity %&amp;)`
103,1546967785.3221,Wanita,Who could advice good material on integration testing on Clojure please?
104,1546968862.3233,Onita,"hey guys, tearing my hair out over this error i’m getting … some dependency load is failing with `ExceptionInInitializerError`. this only happens when i run the program on our aws deployment. everything works fine locally. anyone seen this sort of thing before?"
103,1546968910.3241,Onita,"i’m sure the lack of deployment details probably isn’t very helpful, but any place to even start looking would be appreciated; the print statements i put in all of the dependencies all appear in the logs, so it looks like they’re all getting compiled, oddly enough; it’s just the encompassing `require` that seems to be failing somehow"
104,1546969746.3256,Rosaline,are you aot compiling? or are any of your deps aot compiled?; what build tool/dependency manager/classpath builder are you using?
105,1546971393.3285,Harry,"Not sure where to report this, but seems that Clojure 1.9 is missing from <https://clojure.org/community/downloads_older> ?
Spotted because <https://clojure.org/community/downloads> currently lists Clojure 1.10, but other page only goes up to 1.8.
If someone points me in the right direction I can raise a PR (.patch?) on this later, but if it's easy to fix now then go ahead"
105,1546971489.3286,Setsuko,"gotcha, thank you"
105,1546971574.3292,Jasmine,"that’s my bad, I’ll fix! Thanks for the catch…"
104,1546976578.3297,Latonya,"There are several PDF variations that print on 2 pages, if the text isn't too small for you to read, including a US letter color version at the ""Download PDF version"" near the top of the page.  Some other variants available within a couple of clicks through the ""Source repo"" link next to that."
105,1546977280.3303,Jasmine,"If you haven’t completed the 2019 Clojure survey, now’s a great time - takes about 5 minutes. <https://www.surveymonkey.com/r/clojure2019>"
106,1546977659.3315,Jasmine,I wasn’t sure what to expect with Java usage in the survey but the early results are … interesting
106,1546978347.3321,Michale,Care to share what’s interesting? :smile:
106,1546978669.3329,Jasmine,"oh, just wasn’t sure how people are rolling with the whole Java 9/10/11 and LTS release schedule; I’ll refrain from details till we get through the whole survey period"
107,1546979550.3335,Ivana,"What do you think about a site that mines review data on ""clojure"" books via Amazon?  Would you consider that to be objective enough? The referral money for the links on the site could go back to the community (or for sponsoring the development of the site itself)"
106,1546981490.3337,Jasmine,sounds like a fun project :)
107,1546991519.334,Mariela,<https://github.com/igrishaev/etaoin> works quite nicely for me.
108,1546996039.3346,Shonda,"Haha... ""Common household products that can kill you instantly. More at 11"" :joy:

Captured our interest for sure."
108,1547002357.3348,Reiko,Getting a maven error for that version string.
106,1547003735.335,Jasmine,that’s not a Maven artifact; that’s the clj version (for the Mac brew installer or in the linux scripts at <https://clojure.org/guides/getting_started>)
106,1547003816.3354,Reiko,So the 1.10.0 artifact pulls the latest?
106,1547003851.3356,Jasmine,"they are separate things; you need clojure (Maven artifact org.clojure/clojure, version 1.10.0); and the clj tool (version 1.10.0.411), which you can install with the instructions on the link above"
106,1547003938.3362,Reiko,I misread what you were saying. I'm unfamiliar with the clj tool
106,1547004000.3364,Jasmine,What are you trying to do?; This thread started with a question about how to use the `clj` tool for REBL with Java 11 and Clojure 1.10
106,1547004113.3369,Reiko,I just wanted to make sure I was on the latest version. I misread what you were talking about is all.
106,1547004133.3371,Jasmine,ok.  1.10.0 is the newest version of Clojure :)
106,1547004202.3376,Reiko,I am on Arch Linux and just install the `clojure` package. Now I'm just mainly curious if it is the latest version since it just prints out the Clojure version and not the version of the tool itself.; Looks like it is on 1.10.0.408
106,1547005564.338,Jasmine,"I’m not sure what the Arch package is or who makes it, but that sounds like the clj tool. You should be able to type `clj` at the terminal to get a repl.; the version of `clj` is actually independent from the version of Clojure you use; any version of clj can use any version of the Clojure language"
106,1547005613.3386,Reiko,<https://www.archlinux.org/packages/community/any/clojure/>; I understand they are two different things so we're good on that
106,1547005675.339,Jasmine,"yeah, that’s just a variant of the linux installers listed at <https://clojure.org/guides/getting_started>"
106,1547005697.3392,Reiko,Right and - usr/share/clojure/libexec/clojure-tools-1.10.0.408.jar; So it's slightly behind
106,1547005729.3396,Jasmine,"yeah, just one fairly esoteric bugfix in 411 vs 408 so you are highly unlikely to care"
106,1547005806.3398,Reiko,Exactly
109,1547024943.3402,Bernardo,"Still stuck in Java 7 Land at work... and
<https://github.com/yetibot/yetibot/issues/804>"
106,1547026531.3406,Epifania,"ah, indeed there is a PDF version! Missed that. Thanks a lot!"
110,1547028775.3423,Isa,Did something change about Clojure memory consumption? Hello worlds still consume 256 MB? I am asking in the context of making N instances in environment like kubernetes. Small services can consume very fast too much memory.
110,1547029113.3428,Tammera,"does it consume or request 256m of memory; right, starting a repl here indeed has a initial heap size of 256 of which only 27 is in use. You could probably use the default memory flags of the JVM to change that"
110,1547029325.345,Isa,I was trying it a few years ago and my conclusion was Clojure wrapper for Java takes around 256 MB. I have no idea how it looks today.
110,1547029963.3464,Tammera,"(I checked with VisualVM, the (initial) heapsize is indeed 256, but its not all used, you could probably further restrict that to 64); You seem to be able to pass `:jvm-opts` in your leiningen project file (similarly for `deps.edn`), but the exact correct flags for the JVM are beyond me for now.  Check the usual JVM resources"
110,1547030190.3481,Isa,So how many MB are “lost” only to run Clojure app?; I feel confuse how it will behave in practice after such cut of memory
110,1547031247.3497,Octavia,"JVM will use more memory than it requires by default. If you want to see how low you can go with memory, you have to limit the memory that is available to the jvm. For example by passing this `-Xmx64m`; also, keep in mind that java 8 cannot determine the memory limits of a container reliably (it will in stead take the memory limit of  the host)."
110,1547031363.3501,Isa,but then wouldn’t clojure app have bad performance or other downside?
110,1547031372.3503,Octavia,You can get past that with -XX:+UnlockExperimentalVMOptions -XX:+UseCGroupMemoryLimitForHeap; that is what you have to figure out; all I wanted to say is that JVM will take more memory that strictly needed by default
110,1547031424.3509,Isa,heh ok thx :wink: Just curious what is people experience about memory consumption for services in clouds
110,1547031444.3511,Octavia,do you use java8?
110,1547031464.3513,Isa,now I use 11
111,1547032757.3523,Patti,"If you wanted to write as many bytes as possible per second to a file on the file system on clojure-jvm, how would you do it?"
111,1547032909.3527,Isa,"too general question, but mainly I will buy fast hard drive :wink:"
112,1547035584.3548,Patti,Let me specify then: Would you recommend any specific programmatic route? I've tried out <http://clojure.java.io/output-stream|clojure.java.io/output-stream> but it's not anywhere close what I get out of dd.
112,1547035904.3581,Isa,"I never did performance research for such case. I don’t feel competent to answer. From general point of view I will try to read stream from memory if possible, if know size before save create X MB empty file and write to it (not really sure how and if it performance better, but I think it should), if you can use `dd` use it instead clojure library.; Maybe use bash input stream instead? But it shouldn’t be the case. I guess it is something about `dd` copy whole blocks which is something different than stream."
112,1547037918.3596,Patti,I'll probably look at java.nio next.
113,1547040090.3611,Melynda,"How would I get the var from my function or macro argument? `(defmacro b [f] (var f))` throws `CompilerException java.lang.RuntimeException: Unable to resolve var: f in this context, compiling:(null:1:17)` and `defn` has the exact same behaviour."
114,1547041719.3619,Epifania,Anyone know of any recent libraries similar to `pallet` and/or `re-ops`? Interested in managing infrastructure from Clojure directly
114,1547042008.362,Iva,"This is interesting. Looks like the symbol needs to resolve to a var at compile time not runtime.
Something like this works: ```(defmacro b [f] `(var ~f)) (b x)``` given that x is already a defined var.; Both `defn` and `defmacro` are calling `var` special form during evaluation of a `defn` or `defmacro` definition (unless it is quoted).; This makes sense because vars represent identities that must not change even though the value that is pointed at by them may change at runtime.; <@Xiomara> can probably give a better or more accurate explanation here."
114,1547042485.3643,Isa,"I don’t but I have this feeling I shouldn’t use Clojure as tool for DevOps. I was trying in the past, but… I had bad experience. Just  because of such solutions are not enough popular to be well supported and integrated.; Better to learn good DevOps tool; IMO; Unfortunately I have this impression all open source cicd tools are just bad :slightly_smiling_face: <https://concourse-ci.org> is open source and very interesting solution - unfortunately it is doing a little to slow progress while paid competitors are much faster. <https://codefresh.io> and <https://circleci.com> are good paid alternative IMO if you have budget.; <@Epifania> but doing this in Clojure is a bad idea, because of the reasons which I mentioned above - just my opinion"
114,1547042944.3703,Epifania,"<@Isa> yes, so I'm not interested in ci/cd really, but just to manage instances from different cloud hosters. I personally already know Terraform for managing infra, but this project is a bit different. In the end, the UI I'm building is backed by a Clojure application, that app should be able to create/destroy cloud instances for the user, so can't really ask them to just learn Terraform instead :slightly_smiling_face:"
114,1547042946.3704,Isa,oh and gitlab cicd
114,1547043029.3714,Epifania,"probably will end up with some common interface, then wrappers around existing cloud libs to support that interface in the end. Seems easy enough but wanted to avoid writing it from scratch"
114,1547043046.3718,Isa,hmm I don’t know details to try help; It looks like you have some kind of not standard needs
114,1547043128.373,Epifania,"eh, actually quite simple. Just need to be able to create/destroy/stat(get metrics) from hosts. `pallet` looked really nice for exactly this but seems outdated. If interested, here is the project described: <https://github.com/ipfs-shipyard/cube>"
114,1547043217.3744,Isa,"I remember there was a library for Clojure to create pipelines in Clojure code. But what it does was draw UI. But I don’t remember the name and can’t find it in google.; If it help in any way (from UI perspective); <https://github.com/flosell/lambdacd> this one, but it doesn’t look like it is well supported; But idea was nice :slightly_smiling_face:; <@Epifania> as alternative maybe you can use kubernetes do deploy / destroy etc. ?; then you can use the same way for all cloud providers"
114,1547043527.3773,Epifania,"<@Isa> thanks, but kubernetes is the wrong abstraction, still need to create the kubernetes cluster somehow, and that's the missing piece I'm out after right now"
114,1547043569.378,Isa,ok so as another alternative you can run bash commands. Most of the popular providers let manage instances by bash commands
114,1547044275.3786,Epifania,"<@Isa> well, bash is a horrible language. I'll probably end up going the route described in <https://clojurians.slack.com/archives/C03S1KBA2/p1547043029371400> (with http APIs)"
114,1547044370.3791,Isa,You can run bash commands from Clojure. You don’t have to write bash scripts
114,1547044624.38,Epifania,"<@Isa> you mean with `clojure.java.shell`? In the end the bash commands you talk about end up doing http requests, so can just do the requests directly from clojure instead..."
114,1547044733.3806,Isa,"yes, but it could be easier than interop and update, just saying an alternative"
114,1547044929.3831,Toby,"<@Epifania> if you're serious about functional programming and linux, there's Nixos <https://nixos.org/>"
114,1547044979.3853,Epifania,"<@Toby> yeah, I looked at nixos (specifically nixops) before. Didn't find anything that would concretely help me, but I did get some useful ideas from reading and understanding it"
114,1547044982.3854,Isa,"<@Toby> Interesting, what is the real difference in practice"
114,1547045022.3866,Epifania,"nixpkg is basically a immutable package manager, which is super useful (especially for work machines). Do an upgrade and something broke? Just rollback the entire system to the previous version and stuff is working again. nixos is a operating system using nixpkgs and the immutable ideas"
114,1547045058.3879,Isa,Hmm but considering for everything I use Docker images
114,1547045110.3889,Epifania,"<@Isa> nixops is for the instance setup itself, not the application runtime you run on the instance.; to run your images, you need a host + docker daemon somewhere. Nixops would help you operate that host + daemon"
114,1547045145.3898,Isa,I mean with docker images there is no issues about rollback / update; Just thinking if NixOS can has benefits for me
114,1547045367.3921,Toby,"<@Isa> nixpkgs can be used for building package ie your own app, due to its immutability even your app is reproducible (except database and file system); anyway, it's a lot to learn, so you may consider cost vs benefit"
114,1547045458.3934,Isa,"Well in this case I am thinking about it more in the sense to be early adopter :wink: Just curious what they did, but probably you are right."
114,1547045645.3939,Epifania,personally I hope nix (the package manager) takes over the world. Seems to be the only package manager who does things correctly.
114,1547045692.3941,Toby,the same here :slightly_smiling_face:
114,1547045764.3945,Isa,"True, but I am afraid it is good for developers, not for common people :wink:"
114,1547045796.3948,Epifania,"eh, common people don't use package managers anyways :slightly_smiling_face:"
114,1547045816.3951,Isa,that is why it doesn’t matter for most of the people making it hard to became popular :wink:
115,1547048053.3953,Reiko,I wouldn't compare performance to dd.
114,1547048547.3976,Patti,Surely it can be popular within certain populations. As long as we are speaking package managers it makes sense to speak of popularity with users of package managers.
114,1547049659.3977,Xiomara,`var` is a special form - it expects a symbol literal that corresponds with a var.
115,1547053162.3988,Isa,<@Reiko> did you finish research about <https://github.com/juxt/yada> ? I am wonder if it is worth to switch to use it
115,1547053207.399,Reiko,"Yeah, I'm using it right now. My site is super basic, but it's been a really nice experience and the amount of code I had to write was tiny"
115,1547053242.3993,Isa,Is it public repo?
115,1547053258.3995,Reiko,My site? No
115,1547053285.3997,Isa,How did you find out this repo exist?
115,1547053337.3999,Reiko,What?
115,1547053411.4001,Isa,How did you get info about <https://github.com/juxt/yada> ?
115,1547053457.4008,Vicente,"I have a question. How can I get arglist from `fn`
``` clojure
(defn func1
  ([a])
  ([a b]))

(:arglists (meta (var func1)))
;;=&gt; ([a] [a b])


(def func2 (fn
             ([a] (inc a))
             ([a b] (+ a b))))

(????? func2)
;; =&gt; ([a] [a b])
```"
115,1547053467.4009,Isa,"Asking because maybe I should start read some blog or something, because I miss that info"
115,1547053506.4012,Harris,you can't
115,1547053524.4015,Vicente,even using reflection?
115,1547053622.4021,Harris,"you could reflect on the class backing that anonymous function and look for the `invoke` methods, and you'd get the arg numbers; but blargh; why do you need this?"
115,1547053698.403,Vicente,"I want to call that function, using map.
(do-someting func1 {:a 1 :stuck_out_tongue: 2}); ```
(do-someting func1 {:a 1 :b 2})
```"
115,1547053795.4034,Reiko,Oh. I saw it in my research of popular libraries for creating an API server. It was mentioned in multiple places so I just read the docs at <https://juxt.pro/yada/manual/index.html>
115,1547053894.4038,Rosaline,<https://gist.github.com/hiredman/71b71e4e07e7666fe1b9def9a476c765#file-lrun-clj-L11-L13>
115,1547053935.4041,Reiko,Slack is kinda weird about triple backticks. To actually get Clojure syntax highlighting you need to add a code snippet with the '+' button.
115,1547053944.4045,Becki,the doc-string for `sort-by` doesn't mention that it is stable but I thought i remember hearing this? Am i mistaken?
115,1547054718.4055,Tonya,<https://clojuredocs.org/clojure.core/sort-by>
116,1547054729.4059,Tonya,"""Guaranteed to be stable""; <@Becki>"
115,1547054753.4064,Becki,thanks. wanted to make sure i wasn't just going on rumor; oh. i'm in cljs. and that is conspicuously absent from the docstring
116,1547055059.4073,Jasmine,"that was added in clojure at some point a couple releases ago, maybe corresponding needs to be verified and added in cljs"
115,1547055101.408,Becki,yeah. just put in <#C07UQ678E|cljs-dev>. It's a comment from Stu Halloway from 8 years  ago that it is stable but the doc string purposefully doesn't promise it
117,1547055944.4086,Reiko,Why not? Is it stable or not?
115,1547056038.4089,Becki,it's stable _right now_. But this is asking if cljs will promise this for all future versions essentially
115,1547056077.4091,Reiko,So i'd think that would be the better documentation than being ambiguous
115,1547056267.4094,Becki,it's not ambiguous i suppose. it doesn't promise stability even though it has it. it just seems like this is something that it can promise though is all
115,1547056555.4096,Reiko,"It's ambiguous by not stating. I'm suggesting it state exactly what you said - currently stable, but not guaranteed in future versions; Then update the documentation if that changes..."
118,1547057248.4103,Isa,<https://github.com/juxt/edge> this could be interesting place with best practices; at least examples :slightly_smiling_face:
118,1547057473.4109,Celestine,"If the docstring is updated, it should be to just add ""Not guaranteed to be stable"" -- saying it's stable _now but might change in the future_ isn't useful, IMO.; If a docstring says ""property X is true but might change"", folks can't rely on property X remaining true so either they rely on it today (and might have their code broken in subtle/unexpected ways) or they explicitly don't rely on it at all (even tho' it may never actually change).; It's better to either explicitly guarantee property X or explicitly not guarantee it."
118,1547057612.4115,Becki,agreed. although i'm hoping that the 8 years of stable sort means it will just be acknowledged as a promise. But sean that's a very good comment you should leave on the ticket. Mark it as not guaranteed stable or guaranteed stable to remove confusion?
118,1547057808.4117,Celestine,What ticket?
118,1547057821.4119,Becki,Just ran to lunch. New cljs one; <https://dev.clojure.org/jira/browse/CLJS-3035>
119,1547059604.4128,Harriet,"hey peeps, any advice which library to use with Spark ?"
118,1547059637.4132,Harriet,both flambo and sparkling haven't done any commits the last 6+ months..
118,1547059734.4134,Celestine,Comment added :slightly_smiling_face:
118,1547060272.4136,Becki,appreciate your experience and sharing it :slightly_smiling_face:
119,1547060464.4138,Reiko,"I don't agree with that as ""not guaranteed to be stable"" is ambiguous. It is not stating that is or isn't stable, which was Dan's original question. If the documentation were to state that it is ""Stable, but not guaranteed"" now it's not ambiguous."
118,1547060534.414,Becki,all i'm looking for is what i can bank on for the future. if it is reasonable to promise stability I'm good. If there is no commitment to stability I need to find another solution regardless of current behavior
119,1547060583.4142,Reiko,I think it would be helpful if we had an explanation on why it may not be stable in the future
119,1547060601.4144,Celestine,"I'm answering this as someone who spent nearly a decade working on ANSI/ISO standards committees. Saying ""Stable, but not guaranteed"" is not useful. Saying ""Not guaranteed to be stable"" provides more useful information.; (because it makes it clear that the stability of the current implementation is just an implementation detail and not part of the contract)"
119,1547060684.4148,Reiko,"Please explain to me how something that is ambiguous is more useful than something that is not ambiguous; The documentation should reflect the current behavior. If that behavior changes then the documentation should change with it. If it is stable now, then it should state that it is stable. If it becomes unstable then the documentation should change with that.; Behavior in software changes. I don't subscribe to the idea that the documentation should try to predict the future."
119,1547060957.4154,Celestine,"Stability of a sort is either part of the contract or part of the implementation. You need to know whether it is part of the contract. Either it is intended to be stable or it is not. That is true across Clojure's APIs in general -- if the implementation happens to provide ""more"" than the docstring, what's in the docstring is all you can rely on.; In this case, the docstring provides no guidance (although it _does not guarantee stability_ today so it's actually just fine as it is)."
119,1547061000.4158,Reiko,That may or may not be meaningful. Clojure libraries have a tendency to be completed for their stated objective(s) and haven't needed to change anything since then.
119,1547061071.416,Celestine,"If a Clojure docstring provides a guarantee, that is considered when changes are made in the future -- because the core team have a principle of not breaking guaranteed behavior.; If the docstring provides no guarantee, behavior _can_ change without needing to update the documentation (since the behavior was never guaranteed).; It's a courtesy for the docstring to be explicit about not guaranteeing a specific behavior. That's kind of Clojure's basic position on a lot of things."
119,1547061689.4168,Harriet,I am aware of that. However in this specific case Spark is already at 2.4 and the libs are in 2.1
119,1547061708.417,Reiko,"<https://clojurians.slack.com/archives/C03S1KBA2/p1547055059407300>; Documentation of goog.array/stableSort:
""Sorts the specified array into ascending order in a stable way. If no opt_compareFn is specified, elements are compared using goog.array.defaultCompare, which compares the elements using the built in &lt; and &gt; operators. This will produce the expected behavior for homogeneous arrays of String(s) and Number(s)."""
119,1547062084.4185,Tammera,"huh, googles impl of stableSort is actually quite interesting. Expected an actual stable sort algorithm, but instead they change the comparator to also take index into account.; So it gains `2n` extra time complexity for looping the array twice to add/remove indices, and `n` memory for the array of value/index pairs that is actually sorted"
119,1547062272.4197,Celestine,"Right, and if the decision is to _guarantee a stable sort_ -- as the Clojure docstring does -- then updating the (ClojureScript) docstring to make that same guarantee _about current *and* future behavior_ would be the correct thing to do.; You're missing my point that if there is no intended guarantee of that behavior, then the current docstring is accurate: it _makes no guarantee_ about stability.; Clojure's docstrings are generally very careful about what they do and don't guarantee. If they guarantee something, it is a contract that can be relied on and will not break in the future (because Rich says breakage is bad).; If a docstring does not guarantee a specific behavior, then that behavior can change (because it wasn't part of the contract).; Does that make what I'm saying clearer?"
119,1547062577.4208,Tammera,"(Maybe put it like this, that it _uses_ stable sort is an implementation detail, it could as well use quicksort, which is not stable, but that wouldn’t matter as the stability is not required by the contract between caller (you calling sort) and the callee (cljs’s sort))"
119,1547062956.4213,Becki,that's an interesting find <@Tammera>
119,1547063059.4225,Tammera,"I guess that calling into v8s default sort algorithm is so much faster, that implementing a stability guarantee in javascript is more performant than implementing a complete stable sort alg.; Or; it was easiest. But I am not yet prepared to accept that google engineers take shortcuts too."
119,1547063220.4239,Becki,"yes. it's using the built in sort on arr which probably changes algo depending on size.  i've heard of quick sorts bottoming out into insertion sort at small n, etc; (not saying that is what is happening here but could be the reason not to duplicate that kind of stuff)"
119,1547063252.4247,Tammera,"yeah, lists of less than 10 are actually instertion-sorted; Okay, I was quite wrong: <https://v8.dev/blog/array-sort>; Sorting in javascript is a complete can of worms"
119,1547063660.4253,Reiko,"I've understood what you're saying this whole time; I just don't agree with it. I don't believe my point is being understood, which is that the Clojure version is guaranteed stable and there is no reason that can't be true of the ClojureScript version as the function it is using is guaranteed to be stable. The goog.array library could disappear off of the face of the Earth and we'd still be fine because we could recreate the implementation as it is open source and relies only on essential JS operations that aren't going to change. The fact the CLJS code hasn't changed in 8 years should be a testament to that.; Just O(n) extra: ""Runtime: Same as Array.prototype.sort, plus an additional O(n) overhead of copying the array twice."""
119,1547063907.4257,Tammera,"right, `O(n)` and `O(2n)` are the same complexity class: `O(n)`, it really loops over the array twice"
119,1547064048.4259,Celestine,"You're still missing the point: the question isn't how it is implemented but _whether the intent of the design_ is for a stable sort or not on cljs.; If David Nolen (or whoever can make that decision) says ""Yeah, we intended it to guarantee stability"" then there's no question: the docstring should be updated to reflect that design intention as a guarantee -- and any future implementation changes should reflect that. If he/they say ""Nope, we are not guaranteeing that for cljs"" then the current docstring is correct, but I think it would be a courtesy to update the docstring to reflect that stability is (explicitly) not guaranteed."
119,1547064899.4263,Reiko,"Please stop accusing me of missing the point when I've stated I just don't agree with what you're saying. I just referred to that indirectly in my above message. Obviously we still need to check with the powers that be what their intentions are. I stated that, _objectively_, there isn't any reason it couldn't be guaranteed given the expected and current functionality. I am not speaking for the powers that be as that is not my place.; That being said it also begs the question as the implementation that has survived 8 years uses an, _explicitly_, stable sort function so I would think it should be pretty clear what the intention was when that code was written as they could have used any other sort function, but deliberately chose that one."
120,1547065887.4291,Marcelle,"Hi all! I've built a small tool (based on `rewrite-clj`) that allows to search for a certain values in Clojure files (like `grep`)

Idea is that one can try it from command line in seconds (no need to install): <https://github.com/andrewboltachev/fo0001#clojure-value-finder-like-grep>

Not sure if alternatives exist. Feedback appreciated :slightly_smiling_face:"
120,1547066269.4294,Jasmine,<https://twitter.com/djleeds/status/1082838230662348800>; someone go make that for Clojure! :)
120,1547066847.4303,Tammera,It does exist for java streams: <https://plugins.jetbrains.com/plugin/9696-java-stream-debugger>
121,1547069856.4308,Gilberto,cc <@Alison> :slightly_smiling_face:
122,1547070267.4313,Alison,"Not for Clojure yet, but it’s on some list I have somewhere."
123,1547072788.4335,Aleshia,Anybody around?
123,1547072803.4343,Mandy,Can someone ban this guy (Tariq Nasheed)
123,1547072809.4349,Tabitha,lol 3...2...1...
123,1547072814.4359,Klara,"yeah, it’s annoying"
123,1547072820.4368,Aleshia,Admins know about it
123,1547072822.4369,Alessandra,this guy being <@Celinda>
123,1547072851.4377,Marlyn,I thought at-everyone is disabled
123,1547072874.438,Becki,yeah i was surprised sa well
123,1547072937.4393,Sanjuanita,Stop!
123,1547072940.4394,Willetta,dude!!!!! dont do that!
123,1547072964.4404,Marcell,"Last time this happened, they were impersonating an existing user, too."
123,1547072979.4407,Klara,whoa
123,1547072982.4412,Celinda,racists
123,1547072985.4415,Onita,that has to be the most confusing meme i’ve ever seen
123,1547072987.4416,Klara,I didn’t type that
123,1547072990.4417,Celinda,white supremacist slack
123,1547073011.4422,Pam,how do you block someone?
123,1547073012.4423,Marcell,just like that; UFA3W5N4U is the account that posted; The spammers probably found a way to bypass it; Given they already have robust impersonation utilities.
123,1547073101.445,Jasmine,"fyi, /collapse can be used to collapse all media in the room"
123,1547073109.4452,Angla,maybe this the catalyst for the clojure community moving on from slack?
123,1547073116.4454,Marlyn,and btw: do not download any attachments posted
123,1547073159.4462,Sebrina,Perhaps that’s how they’ve been able to impersonate?
123,1547073260.4465,Klara,funky
123,1547073424.4493,Marcell,"Turn off inline image display in your preferences, too; it's not often needed in this slack, and better safe than sorry"
123,1547073486.4502,Willetta,Preferences &gt; Messeges &amp; Media
124,1547073896.4527,Sebrina,:sweat:
123,1547074001.4541,Celestine,"User deactivated. We're working on deleting the messages wherever they got posted. Feel free to post in <#C04V84U7G|slack-help> with links to ones we haven't gotten to yet. And, yes, these bots are able to get around the restrictions that Slack lets us put in place to prevent non-admins using @ everyone/channel/here..."
125,1547074558.4549,Nadia,"yeesh, client-side permissions enforcement?"
123,1547074853.4551,Hattie,"Huh, the above comments from ""Tariq"" are interesting. That makes it seem like either a) it was a human troll rather than a bot, or b) the bot watches for its (impersonated) name and then says the stuff above. Bit more sophisticated than I expected."
124,1547075120.4566,Celestine,Confirmed via an article one of the other members here sent me (thank you <@Sebrina>!). You can hack the permission client-side in JS and then spam with immunity it seems. Slack have known about it for two and a half years and confirmed a year and a half ago that they won't fix it. Sigh.
123,1547075167.4577,Becki,Also if you remap caps lock to control the caps lock button still makes the text box take focus rather than copying :disappointed:
124,1547075170.4579,Celestine,Probably the only thing we can do at this point is to change the auto-inviter to require moderation somehow.
123,1547075373.4584,Marcell,"It's definitely a human at the wheel, there were direct back-and-forths in the original attack as well"
123,1547081382.4603,Charlette,that sounds like a rabbithole
126,1547082091.462,Larissa,"Hello all, I´ve got this from result `#object[java.util.Optional 0x5c2aa319 Optional[2019-01-09T23:01-02:00[America/Sao_Paulo]]]`, what is that?; is that any way to convert to `ZonedDateTime`?"
126,1547082168.4628,Dann,"it has a `.get` method <https://docs.oracle.com/javase/8/docs/api/java/util/Optional.html>; in general, if you get an object that isn't familiar (especially a java.* object) the javadoc is going to be your best bet; you might also want to use one of the methods there to do some default action of it's empty, rather than throwing an exception as get will"
126,1547082341.4644,Larissa,"oh, I got it, thanks; `.get` did the job"
126,1547082399.465,Dann,"some examples of playing with it in a repl: ```(ins)user=&gt; (java.util.Optional/of 1)
#object[java.util.Optional 0x319bc845 ""Optional[1]""]
(ins)user=&gt; (.get *1)
1
(ins)user=&gt; (java.util.Optional/of nil)
NullPointerException   java.util.Objects.requireNonNull (Objects.java:203)
(ins)user=&gt; (java.util.Optional/ofNullable nil)
#object[java.util.Optional 0xe84a8e1 ""Optional.empty""]
(cmd)user=&gt; (.get *1)
NoSuchElementException No value present  java.util.Optional.get (Optional.java:135)
```; using a default value instead of throwing: ```
cmd)user=&gt; (java.util.Optional/ofNullable nil)
#object[java.util.Optional 0xe84a8e1 ""Optional.empty""]
(ins)user=&gt; (.orElse *1 0)
0
(ins)user=&gt; (java.util.Optional/of 1)
#object[java.util.Optional 0x23d1e5d0 ""Optional[1]""]
(cmd)user=&gt; (.orElse *1 0)
1```"
127,1547103584.4658,Iva,<@Melynda> I am interested in knowing the exact use case here. What are you trying to accomplish with a macro like that?
126,1547105691.466,Karren,not that fancy but debux works for me in those cases: <https://github.com/philoskim/debux#81-dbg-inside-dbgn-or-vice-versa>
128,1547106423.4663,Reiko,Got everything working now with yada. Final code is nice and small.
127,1547121400.4676,Melynda,"<@Iva> That macro is an MWE. The end goal is to retrieve specs with `s/get-spec`, which requires a var as argument. I was wondering how to get that var."
128,1547127145.4688,Ivana,"I see an exotic regression between clojure 1.8 and newer versions. From 1.9 onwards this is now invalidated by clojure spec ```
(let [f (fn [] ""hi"")]
  (eval `(defn foo [] (~f))))``` In older versions this was possible; Is this a bug or a feature? :slightly_smiling_face:"
128,1547127225.4695,Harris,the problem has got nothing to do with the fn; your `foo` is namespace qualified; should be `(defn ~'foo`
128,1547127255.4704,Ivana,ah sharp
128,1547127259.4705,Harris,and the fact that it's rejected by spec now is indeed a feature
128,1547127300.4709,Ivana,"Thanks, sorry for the noise"
129,1547136439.4724,Zada,"Is there a channel on the slack for telling people that hey, I just published a library on Clojars in case anyone is looking for something similar?"
129,1547136502.4727,Hilary,<#C06MAR553|announcements>
130,1547138898.4734,Clarine,"is there a way to fully qualify symbols in a data structure that’s not a literal? e.g.:
``` 
(qualify (clojure.edn/read-string  ""{str #{:clj :cljs}}"" ))
```"
130,1547139114.4738,Harris,what is the result you want out of that?
130,1547139125.4741,Clarine,`{clojure.core/str ....}`
130,1547139136.4744,Harris,you can use `clojure.tools.reader/syntax-quote`; although you probably want the function equivalent
130,1547139189.4752,Fredda,perhaps in conjunction with this <https://stackoverflow.com/a/43722784/10667553>
130,1547139196.4756,Harris,<https://github.com/clojure/tools.reader/blob/master/src/main/clojure/clojure/tools/reader.clj#L1005-L1006>
130,1547139211.4759,Marlyn,<@Clarine> <@Harris> <https://github.com/clojure/spec-alpha2/blob/639767ebe1491536ec7404d8b478628ecfe9200b/src/main/clojure/clojure/spec_alpha2.clj#L315-L326>; `explicate` is a great word <@Jasmine>
130,1547139244.4767,Harris,that won't respect quoting; but if you don't care it's fine; if you're using edn you probably don't anyway
130,1547139332.4775,Clarine,"yeah, I’m reading from EDN; full example for those interested:
``` 
(defn- explicate-1 [a-ns form]
  (walk/postwalk
   #(cond
      (keyword? %) %
      (symbol? %) (or (-&gt;&gt; % (ns-resolve a-ns) symbol) %)
      :else %)
   form))

(comment
  (explicate-1 'clojure.core (clojure.edn/read-string ""{str #{:clj :cljs}}""))
  ;; =&gt; #:clojure.core{str #{:clj :cljs}}
  )
```; thanks all"
131,1547146841.4812,Sharika,"Hey all, can anyone suggest how I can twist `clj-http's` arm into sending such as request
```
curl -i -XPOST -H ""Content-Type:application/octet-stream"" -H ""Authorization: Bearer blah"" --data-binary ""@/Users/me/Downloads/an-image.png"" <https://upload.contentful.com/spaces/space-id/uploads>
```
I've tried
```
{:body         (IOUtils/toByteArray (io/input-stream ""Users/me/Downloads/an-image.png"")
``` but get a 404 from the server"
131,1547146893.482,Rosaline,and what was the rest of your clj-http call?
131,1547146906.4823,Dann,are you sure you're hitting the right endpoint with the right http method?; also I'd be surprised if clj-http couldn't just use an input-stream directly
131,1547146945.4835,Rosaline,404 seems unlikely to be the result of the body content
131,1547146961.4839,Sharika,"Yeah, I believe so, I've tried the same ensuring same url with IntelliJ's http client without specifying the actual binary data, and again receive a 404, so I believe that's the servers behaviour.; Full request coming after I've stripped secrets :wink:"
131,1547147000.4848,Dann,are you sure you're doing a POST?
131,1547147026.485,Sharika,"```(-&gt;&gt; (client/post
       (str
         ""<https://upload.contentful.com/>""
         (System/getenv ""CONTENTFUL_SPACE_ID"")
         ""/uploads"")
       {:body         (IOUtils/toByteArray (io/input-stream ""/Users/will/Downloads/BP TUM Pictures PNG/TUM1 001K.png""))
        :headers      {""Authorization""             (str ""Bearer "" (System/getenv ""CONTENTFUL_MANAGEMENT_KEY""))}
        :content-type ""application/octet-stream""}))```; Yeah, definitely a post."
131,1547147070.4857,Tamisha,<@Sharika> did you tried using the `input-stream` directly? (remove the `IOUtils/toByteArray`)
131,1547147120.4866,Sharika,"Nope, still 404."
131,1547147131.4869,Nathanael,"<@Sharika> you might need a `.trim` on the thing you get from `getenv`, i've had that problem before"
131,1547147137.487,Sharika,"```(-&gt;&gt; (client/post
       (str
         ""<https://upload.contentful.com/>""
         (System/getenv ""CONTENTFUL_SPACE_ID"")
         ""/uploads"")
       {:body         (io/input-stream ""/Users/will/Downloads/BPTUMPicturesPNG/TUM1001K.png"")
        :headers      {""Authorization""             (str ""Bearer "" (System/getenv ""CONTENTFUL_MANAGEMENT_KEY""))}
        :content-type ""application/octet-stream""}))```; Input-stream seems okay ```(io/input-stream ""/Users/will/Downloads/BPTUMPicturesPNG/TUM1001K.png"")
=&gt; #object[java.io.BufferedInputStream 0x36e4cf6f ""java.io.BufferedInputStream@36e4cf6f""]
```"
131,1547147255.4885,Dann,what about directly using the string instead of creating it using getenv (for now) - or at least verifying that CONTENTFUL_SPACE_ID is space-id
131,1547147307.4895,Sharika,"Um... removing the `--data-binary` param from `curl` command returns 400, not 404, so it definitely seems to be something wrong with my clojure code, and not server weird 404s when no file is uploaded :thinking_face:; Will do :white_check_mark:"
131,1547147314.4899,Fredda,"`spaces` is not in the url, while it is in the curl command?"
131,1547147340.4902,Dann,yeah -that would likely explain it; unless CONTENTFUL_SPACE_ID was `spaces/space-id` of course
131,1547147381.4908,Fredda,true
131,1547147396.491,Dann,this is why people hate strings
131,1547147487.4915,Sharika,"Haha, yeah! that will be it! Thank you rubber ducks!; Yeah, that works!"
131,1547147508.492,Dann,:duck:
131,1547147512.4922,Sharika,"Haha; It's funny when you're learning new tech, libraries, etc, how you assume failures are down to your lack of knowledge about that thing, rather than the basics!"
131,1547147566.4936,Dann,"there's a clj-http-fake lib, that is useful for separating this kind of issue from server misbehavior <https://github.com/myfreeweb/clj-http-fake>"
131,1547147585.4943,Sharika,"Oh, and thanks for suggesting removing commons; it's great to remove dependencies!"
131,1547147586.4944,Fredda,"It never stops happening :wink:; (for me, at least)"
131,1547147619.4954,Sharika,"It certainly hasn't for me either, in my 20 years commercial programming!"
131,1547147639.4956,Fredda,aye
131,1547147807.4963,Marilee,"how does macroexpansion interact with laziness? For instance do I need a `doall` around the `for` here?
```
(defmacro defstyle
  [style-id &amp; styles]
  `(defstyle* ~style-id
     ~@(for [style styles]
         (walk/postwalk (fn [node]
                          (if (map? node)
                            (prefix node)
                            node))
style))))
```"
131,1547147880.4967,Dann,"the compiler is eager, so you shouldn't need doall"
131,1547147893.497,Marilee,"great, thanks!"
131,1547147966.4973,Dann,this all depends on what defstyle* does of course - some forms aren't eager of consuming their arguments...; but the absence or presence of doall wouldn't change this
132,1547149194.4977,Brain,"Not that I'm aware of. But if you find or start a project like that, I'd be happy to contribute!"
133,1547150231.499,Scotty,"Has anyone tried to write Kafka Streams code in Clojure? I have googled a few libraries, but haven't found any reports of what works and what does not in reality."
133,1547150879.4991,Sebrina,Dunno if this helps but this one was posted to the Clojure reddit a few weeks ago: <https://www.reddit.com/r/Clojure/comments/aa12wz/ziggurat_a_stream_processing_framework_to_build/>
133,1547151276.4998,Clarine,"interesting. I subconsciously used this as a feature in a test for months now…
``` 
user=&gt; (str/includes? {:a 1} ""1"")
true
```"
133,1547151281.4999,Scotty,"Thanks, I'll have a look."
133,1547151443.5004,Hilary,hmm yeah it toStrings the input `(.contains (.toString s) substr)`; looks like several of the clojure.string predicates do the same
133,1547151508.5013,Marlyn,"it’s because they assume the interface CharSequence as an input, not Object AFIAK"
134,1547153661.5018,Dann,"my company open sourced our kafka-streams library recently, <https://github.com/FundingCircle/jackdaw>"
134,1547153746.5023,Clarine,"yeah, it worked accidentally. I changed the code now :wink:"
134,1547155876.5027,Jasmine,if only that worked in real life; “I put a chainsaw in my toaster and it accidentally came out as toast”
134,1547156169.5053,Rossie,"Instaparse question: I have an existing yacc/lex grammar; I assume the yacc one is the least strenuous to port over (there's no embedded code besides `yyerror`), I'd like to use this with instaparse which takes EBNFs -- any chance someone has done something like that and has a converter laying around? I feel like as soon as I'm writign a file called yacc.cfg and lex.y I have taken a wrong turn; <https://github.com/jrester/EBNF.cr> claims to do this but doesn't work.; (the endgame here is being able to parse C headerifles and automagically generating the right Clojure bindings)"
135,1547158088.5071,Rosaline,"you might try using, uh, I forget, that tool that generates jni bindings, and then relective over the java to generate the clojure; is that tool really just javah?; (it is not); swig is what I am thinking of"
135,1547158588.5098,Becki,I just checked `(doc eduction)` and `(source eduction)` and their doc strings differ. I didn't think this was possible?
135,1547158636.51,Rosaline,it is
135,1547158659.5106,Becki,Well the arg lists i suppose is different to be more precise
135,1547158670.5109,Rosaline,"for example, whatever tooling you use might override doc; which arglists?"
135,1547158730.5117,Becki,"```
  {:arglists '([xform* coll])
   :added ""1.7""}
  [&amp; xforms]
```"
135,1547158741.5122,Rosaline,and what does doc say?
135,1547158744.5124,Becki,"```
user&gt; (doc eduction)
-------------------------
clojure.core/eduction
([xform* coll])
```"
135,1547158749.5128,Julienne,Which lib is better for clojure selenium? <https://github.com/komcrad/webdriver> or <https://github.com/igrishaev/etaoin> or other
135,1547158749.5129,Rosaline,that matches
135,1547158768.5137,Becki,"the arg list in the source is
```
  [&amp; xforms]
  (Eduction. (apply comp (butlast xforms)) (last xforms)))
```"
135,1547158783.5141,Rosaline,the definition includes custom metadata that overrides the arglist form
135,1547158785.5142,Jasmine,the arglists meta overrides
135,1547158809.5148,Rosaline,`:arglists '([xform* coll])`
135,1547158815.5151,Becki,ok. threw me for a loop when i went to check the source.
135,1547158824.5154,Jasmine,the override is trying to convey something impossible to say in the actual arg list; which is a leading vararg
135,1547158876.5159,Becki,i see. thank you
135,1547160459.5177,Celestine,(side note: `:arglists` can confuse tooling that tries to use that information to check source code -- such as Eastwood -- since the `:argslists` metadata doesn't have to represent a valid actual call)
135,1547160538.5188,Diamond,<@Celestine> it can also help it. :slightly_smiling_face: ```(defmulti ^{:arglists '([a-map])} do-thing :key)```
135,1547160733.5196,Celestine,Eastwood can't check `defmulti` calls without a hint? I didn't know that.
135,1547160829.5209,Diamond,`defmulti` can’t attach `:arglists` meta to the var because there’s no general way to derive it from the dispatch-fn.
135,1547160861.5219,Somer,Will calling `count` on a vector of lazy seqs realize the lazy seqs?
135,1547160871.5221,Diamond,No.
135,1547160948.5228,Somer,"Thought so. This result was confusing:
```
(let [xs [(iterate (fn [x]
                     (inc x)) 0)
          (iterate (fn [x]
                     (inc x)) 0)]]
  (map realized? xs))
=&gt; (true true)
```
Guessing `realized?` must be talking about something else here?"
135,1547161138.5233,Dann,"yeah - I wouldn't trust realized? for lazy inputs - it's reliable for `delay` or `promise` objects; I tested by adding println inside those function bodies - not even the first element is being produced; <@Somer> - I had to play with this more - it seems like it kind of works but not for the head of the collection(?) ```(cmd)user=&gt; (def l (iterate println nil))
#'user/l
(cmd)user=&gt; (realized? l)
true
(cmd)user=&gt; (realized? (rest l))
false
(ins)user=&gt; (realized? (nthrest l 2))
nil
false
(cmd)user=&gt; (realized? (rest l))
true
```; that nil after calling nthrest shows one element being realized"
135,1547161611.5245,Somer,Perhaps because the first element is passed explicitly to `iterate`?
135,1547161642.5247,Dann,"oh! I'll try another thing to test that; yeah - you figured it out ```(ins)user=&gt; (def l (repeatedly #(println :realized)))
#'user/l
(ins)user=&gt; (realized? l)
false
(cmd)user=&gt; (realized? (rest l))
:realized
false
(cmd)user=&gt; (realized? (rest l))
false
(cmd)user=&gt; (realized? (nthrest l 2))
:realized
false
(cmd)user=&gt; (realized? (rest l))
true
```"
136,1547174087.5301,Milford,"Yeah, the first value in a lazy sequence generated by `iterate` has been “produced”, and thus the sequence vacuously satisfies `realized?`"
136,1547197953.5319,Shanel,<http://www.learndatalogtoday.org/>; <https://vvvvalvalval.github.io/posts/2016-07-24-datomic-web-app-a-practical-guide.html>
137,1547205143.5339,Isa,"`((:close foo))` - how to write instead something like `(-&gt; (:close foo) ())`. I want to make it more readable, but I confused myself :slightly_smiling_face:; hmm or maybe `((:close foo))` is ok"
137,1547205593.5357,Chanelle,would this look more readable ? `(invoke (:close foo))`?
137,1547206105.5374,Epifania,"<@Isa> maybe something like this?
```
(def foo {:bar #(println ""nice"")})
((-&gt; foo (:bar)))
```; I tend to not use `-&gt;` unless it's more nested, one level usually just do `((:bar foo))` directly, but not sure that's idomatic"
137,1547206203.5386,Isa,well after rethinking `((:close foo))` is good; It is more readable than I thought :slightly_smiling_face:
138,1547208064.5419,Luciano,"hey all, I started using defmulti/defmethod. Is it intended that you can't use Destructuring with Keyword-arguments in defmethod?"
138,1547209527.5422,Nikki,dispatch function (:type) is applied to three arguments. You should either rewrite youy dispatch function for it to be ready to accept vavarg or get rid of vararg and accept just one map
138,1547210168.5424,Luciano,"oh, didn't know that the dispatch-fn will be applied to every arg and not only the first.. Thanks. :+1: I'll use only one map"
139,1547214487.5429,Vernia,"You could do
```
(let [{:keys [close]} foo]
  (close))
```"
140,1547218721.5446,Ashlea,"```
Clojure 1.10.0
user=&gt; (take 2 [])
()
user=&gt; (take-last 2 [])
nil
```

Is it likely that a patch would be accepted to modify `take-last` to return an empty seq when given an empty seq?"
140,1547218894.5448,Jasmine,no
140,1547218945.5451,Ashlea,:+1:
140,1547219001.5456,Jasmine,"in general, I would expect any code that uses the result of either of these to work in either case; expectation for sequence functions should be that take something seqable and return something seqable"
141,1547220236.5479,Virgil,"with Spec, if I have `(s/def my-map (s/keys :req [a b]))` where `a` &amp; `b` are `(s/coll-of something)`, how can I say I want `a` &amp; `b` to have the same length ?; (not using `:count` - I don't care how long they are, only that they're the same length)"
141,1547220672.55,Jasmine,write a function that checks that and s/and it to your spec
141,1547224554.5506,Virgil,<@Jasmine> much easier than I thought! thankyou
141,1547224796.5513,Jasmine,you can pretty much write a predicate to check any arbitrary property of data and all predicates are specs
141,1547225465.5517,Virgil,"it's a while since I used Spec, it's all coming back now"
142,1547228503.5529,Tammera,"Hijacking a question here, can you specify in an `fspec` what the side-effects of a function may be.  That would basically entail doing something _before_ the fn runs, and _after_.; For example, I have a `swap-vals!` kinda thing for redis, I would very much like to assert that the first result you get is the state _prior_ to the function being ran."
142,1547228706.5544,Meagan,":thinking_face:  :thinking_face:  :thinking_face:  well... nothing stops you from doing effects in your predicates; my first instinct is: oh god no; but, maybe fine? I wouldn't reach out to your redis instance each time the fn is called"
142,1547228767.5557,Tammera,"Right, its an obvious development-only kinda deal right"
142,1547228868.5571,Meagan,"maybe you could have a custom instrumentation that swaps an atom with the before state, then compares in the `:ret`"
142,1547228875.5573,Tammera,"Its just that I don’t think you have a hook that is ran _before_ the function is called; (this is obviously more a code-golfing thing than actually useful, please don’t hate me)"
143,1547232437.5602,Clarine,How do I invite a bot to a channel that logs conversations to <https://clojurians-log.clojureverse.org/>
143,1547232638.5608,Celestine,Invite <@Mi> to your channel
143,1547232784.5617,Tamie,there is a web page somewhere that lists api's to third party clojure libraries...help?; <http://cljdoc.org|cljdoc.org>  &lt;-- found it :slightly_smiling_face:
143,1547232859.5626,Celestine,Also <https://crossclj.info/> if you're searching for libraries to solve a specific task.
143,1547233583.563,Tamie,"Thanks Sean, I'll add that to my notes too :slightly_smiling_face:!"
144,1547236069.5633,Clarine,<@Celestine> thanks
145,1547238091.5634,Reiko,"Why complicate this? It's calling the function that is returned by the `:close` key. It's perfectly fine the way it is.; Ah, nvm. Didn't see the text that followed."
146,1547253892.5651,Fairy,i've got a pretty lengthy bash command i'd like to execute in clojure. Is there any way i can just execute the full command with all its arguments as a single string?
146,1547254086.5663,Dann,"sure, via `(clojure.java.shell/sh ""/bin/bash"" ""-c"" cmd)` for example; you can do a similar trick with ProcessBuilder if you  need more flexibility about how the command runs; shell/sh itself doesn't invoke the OS shell - for one thing that's not portable; <@Fairy> ```ins)user=&gt; (.start (ProcessBuilder. (into-array [""/bin/bash"" ""-c"" ""ls""])))
#object[java.lang.UNIXProcess 0x2a8d39c4 ""java.lang.UNIXProcess@2a8d39c4""]
(ins)user=&gt; (slurp (.getInputStream *1))
""CHANGELOG.md\nDockerfile\nREADME.md\nTAGS\nbin\ndashboards\ndeploy\ndev-resources\ndoc\ndoc-updates.otl\ndocker\ndocker-compose.yml\neastwood-config.clj\nprofiles.clj\nproject.clj\nresources\nsrc\ntarget\ntest\n""```  ```(ins)user=&gt; (require 'clojure.java.shell)
nil
(ins)user=&gt; (clojure.java.shell/sh ""/bin/bash"" ""-c"" ""ls"")
{:exit 0, :out ""CHANGELOG.md\nDockerfile\nREADME.md\nTAGS\nbin\ndashboards\ndeploy\ndev-resources\ndoc\ndoc-updates.otl\ndocker\ndocker-compose.yml\neastwood-config.clj\nprofiles.clj\nproject.clj\nresources\nsrc\ntarget\ntest\n"", :err """"}
```"
146,1547254613.5697,Fairy,"ok my issue is parsing out the arguments into an array like that. I tried using conch. And i'm trying to use ffmpeg.
this command returns a non-zero exit code at the first step but also returns the info i want, but conch just hangs up at the first error
```ffmpeg -i /Volumes/Video 1/DRUM_2018-12-19-15-00-54_597.mov 2&gt;&amp;1 | grep Duration | cut -d ' ' -f 4 | sed s/,//```"
146,1547254633.5701,Dann,"yeah, just use ProcessBuilder instead of conch; you need to explicitly call bash or sh to get things like `|`; those aren't execution features, they are shell features, so you need to start a shell; (so maybe conch is still OK for you, as long as you start a shell - I found ProcessBuilder much easier to use in anger)"
146,1547254831.5722,Fairy,"haha... so like
```
(def output (.start (ProcessBuilder. (into-array [""/bin/bash"" ""-c""  ""ffmpeg -i /Volumes/Video 1/DRUM_2018-12-19-15-00-54_597.mov 2&gt;&amp;1 | grep Duration | cut -d ' ' -f 4 | sed s/,//""]))))
```"
146,1547254866.573,Dann,"yeah, but that's more than output - it is a `Process` object that lets you read stdout, stderr, send to stdin, etc.; in my experience for interactive commands like ffmpeg if I want to send it input lines mid execution etc. Process directly instead of conch was easier"
146,1547254971.5741,Fairy,wow much easier! Thanks!
146,1547254980.5743,Dann,"glad I could help; also, once you have an InputStream you are free to parse each line of input from the process with your own parser if sed and cut aren't ""cutting it"", so to speak; but if sed and cut work, no need to reinvent that"
146,1547255512.5761,Lieselotte,"Anybody know how to use missing? with a reverse lookup? Is this supposed to work?
`[(missing? $ ?l :account/_licenses)]`

Also, is there a reason why I can't use 2 missing? statements in an or?
`(or [(missing? $ ?a :account/licenses)] [(missing? $ ?a :account/email)])` (edited)
Error `CompilerException java.lang.RuntimeException: Unable to resolve symbol: $ in this context`"
146,1547255553.5767,Dann,"what is ""missing?"""
146,1547255583.5774,Fairy,"you mean that for the <#C03RZMDSH|datomic>  channel ""?"
146,1547255609.5779,Dann,"oh, if it's datomic the who vector should be quoted right?"
146,1547255665.5782,Fairy,yeah... needs to be quoted
147,1547256208.5798,Lieselotte,There's more exposure here... but I will politely retreat back to <#C03RZMDSH|datomic> if someone protests me posting here.
148,1547267648.5815,Gillian,Something I discovered today is that YourKit works really well with Clojure in an IntelliJ setup (doesn’t interfere with Cursive).; For profiling Clojure code!; I was reading this earlier: <http://yellerapp.com/posts/2014-05-21-tuning-clojure-an-experience-report.html>; Figuring out what Java class names correspond to which parts of your Clojure code is kind of difficult though. But otherwise really helpful once you figure out what’s what.
149,1547283608.5853,Jessia,What’s the best way to interop with Java methods that require a java.util.function? I know it can be done with reify but it is a bit verbose. 
150,1547292594.586,Sixta,There's a library around which provides a macro for that. 
151,1547294752.5889,Dawna,"Hi, I have a question about quil library. How to I call individual functions in the REPL, e.g. quil.core/random? Most quil function can only be run inside sketch functions  (I think because of state handling). Is the any way to _grab_ the current state in the repl and execute code?"
150,1547296432.5894,Kermit,You'll have better luck asking in the dedicated <#C0FM7N1SM|quil> channel
151,1547299559.5896,Dawna,Thanks. didn't know of it
152,1547380131.5956,Brain,"I've just kludged the powershell scripts in <https://dev.clojure.org/jira/browse/INST-15> (and adding the jvm-file and main-file arguments in), and appear to have a working clojure-cli under windows. Has anyone else tried this, and run into further problems down the line?"
153,1547386958.5976,Jasmine,There’s a branch in brew-install with a more up to date version of those; <https://github.com/clojure/brew-install/tree/windows-port>; Although they are lagging a few of the latest changes 
152,1547389565.5991,Brain,"I was wondering where those where hiding, thanks!"
154,1547397459.6019,Isa,"What is your best stack for authentication and authorization? What do you use?
- <https://github.com/funcool/buddy> ?
- With GraphQL or you prefer REST for authentication and GraphQL for authorization with queries?
- OAuth2?
- REST API for authentication by POST? Return HTTP 200? JSON input / output?

My concerns:
- I want to have GraphQL, but not sure if authentication should be separated as REST API.
- authentication should return token to use with authorization with GraphQL
- Users will be able to generate extra tokens for integrations like in GitHub

I confused myself about the way how to solve it. In other words I am asking about your best way how to do it with full details about libraries, methods, concepts, choices :slightly_smiling_face:"
154,1547397613.6025,Elaine,"<@Isa> <#C68M60S4F|fulcro> recomends this csrf. I liked it after I met. You generate a token and deliver it on HTML. Then the application send it on body or headers.
<https://stuarth.github.io/clojure/csrf-pedestal/>; It use sessions/cookies. Somehow (pedestal handles it. I dont know how) if the browser do a `F5`, then it deliver the same token."
154,1547397980.6057,Isa,Thank for that article. That will be for sure something which I will have to do too. For now I confused myself on level of thinking about authentication query / response / library vs my code.
154,1547398533.6059,Elaine,"<https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/dataset#Examples>
:wink:"
154,1547398715.6062,Isa,"I am talking about BE side mainly now, not FE. Not how to send data by JS, but for example if it should be separate REST API only for auth by POST, accept JSON (not?) and return JSON (not?) by HTTP 200. Or GraphQL, because I want to have it anyway probably.; Hmm my `buddy` can be what I am looking for"
154,1547406164.6072,Sheron,you can also secure rest api's via jwt
155,1547408019.6078,Darcel,Is there a way to install dependency from github with a specific sha using leiningen?
155,1547408163.6088,Cira,"```
    (case (type x)
      org.jsoup.nodes.Document x
```
I want to dispatch based on the type/class of a thing but this doesn't work as I expected. Do I have to use `if`? Or is there some other construct for this?"
155,1547408189.6089,Tammera,"I know that a `deps.edn` can specify that, and I know of integration tools between the two; but that may be a bit of a wonky solution"
155,1547408268.6094,Cira,I guess a class doesn't count as a literal/constant?
155,1547408276.6096,Becki,you could try <https://github.com/reifyhealth/lein-git-down>
155,1547408670.6105,Yong,Can’t you define a protocol for this?
155,1547408913.6107,Cira,"Right, that should work, good idea :+1:"
156,1547416398.611,Isa,"use `deps.edn`, if you really want to have lein use <https://github.com/RickMoynihan/lein-tools-deps>"
156,1547417175.6132,Darcel,"Thank you <@Isa>! Since i just wanted to explore hot module reloading with tools.deps.alpha I will definetely stick to deps.edn. ; Btw, may I DM you <@Isa>? I’m seeking for remote job in PL so if you would like to give me some tips then I would be more than grateful."
156,1547417440.6166,Isa,"sure, I will answer tomorrow. I am going sleep now :slightly_smiling_face:; See you!"
156,1547417685.6178,Darcel,Have a deep sleep! :zzz: See you!
157,1547435235.6184,Jasmine,Classes are not constants; condp with = is a good match for this though
158,1547438085.6195,Gene,"I'm getting this when I run 'clj' on a fresh linux install.
```cp: cannot stat 'PREFIX/example-deps.edn': No such file or directory```; ok so I found in old slack logs its to do with a botched clojure install; I can't get it installed though. If I remove the install from linuxbrew then it gives me. bash: `/home/linuxbrew/.linuxbrew/bin/clj: No such file or directory` but if I use brew I get the other error."
159,1547439897.6212,Reiko,Is there not a clojure package in your distro's package manger?
160,1547442839.6227,Alease,"are there core functions/macros that do something similar to this ones I've made
```(defmacro anon-proxy
  [draw-fn]
  `(fn [&amp; ~'args]
     (apply ~draw-fn ~'args)))

(defmacro map-keyed
  {:style/indent :defn}
  [&amp; args]
  `(-&gt;&gt; (list ~@args)
        (interleave (map keyword '(~@args)))
        (apply hash-map)))
```; the first is for live coding with some libraries since you have to have function that calls the one you'll be re-deffing; the second is to just get a key/value from a collection of symbols that are in scope."
158,1547450180.6256,Gene,I managed to fix it. I completely removed linuxbrew and followed instructions on Linux install on Clojure website
160,1547450769.6258,Reiko,"Glad to hear, but that may not be necessary if your distro has a package for it. The method on the website is manual updating"
161,1547452310.6261,Frederick,<https://stackoverflow.com/questions/54177410/calling-special-form-set-in-a-clojure-macro>
162,1547474534.6277,Jasmine,"vars can be invoked and when done, will invoke the function they hold. so I think they already serve this purpose and on the caller side if you just invoked the var, you could change the var binding as much as you want."
162,1547474997.6321,Scotty,"Is there a _generic-ish_ way to transform stateful systems in functional ones? Namely, I have a server serving a complicated stateful protocol (Wayland to be precise), and would like to read some guide or a war story of turning these webs-of-mutating-objects into something more manageable."
161,1547476666.6337,Arturo,"I’m having some fun with the cognitect AWS library, specifically with the KMS functions.. is there a good place to ask questions around this..?; the hash aws channel here seems dead :disappointed:; `{""__type"" ""InvalidCiphertextException"", :cognitect.anomalies/category :cognitect.anomalies/incorrect}` &lt; trying to find out what this means; the `:Decrypt` docs say  `:CiphertextBlob blob`; but doesn’t really elaborate what blob is; i’ve tried byte array, buffered input stream, string..; the ciphertextblob output from encrypt is a bufferedinputstream"
161,1547476979.6376,Marlyn,<@Arturo> have you enabled validation?
161,1547476993.6378,Arturo,no; that sounds like it might be helpful; how do I do that..?; there’s nothing about validation in the readme; `(aws/validate-requests some-client true)`?
161,1547477440.6396,Marlyn,yup
161,1547477495.64,Arturo,thanks; that really should be in the docs.. think they’d take a PR?
161,1547477584.6416,Leah,is there ways people work around the fact that strings and other primitives don’t implement IMeta? For a similar use case as REBL I’d like to allow different viewers for data and I’d like this to work for strings and numbers as well…
161,1547477708.6417,Marlyn,"PRs not accepted, but file an issue please"
161,1547478562.6419,Sheree,"this info gave me enough to check the Java SDK API docs:

<https://docs.aws.amazon.com/AWSJavaSDK/latest/javadoc/com/amazonaws/services/kms/model/DecryptRequest.html#setCiphertextBlob-java.nio.ByteBuffer->

and it looks like it takes a `java.nio.ByteBuffer`"
163,1547479376.6429,Isa,"```
{:status 200,
 :headers {""Content-Type"" ""application/json; charset=utf-8"", ""Vary"" ""Accept"", ""Content-Length"" ""44""},
 :body #object[java.io.BufferedInputStream 0x109943d3 ""java.io.BufferedInputStream@109943d3""]}
```

How do you show maps with objects like in this example, but converted to the value (string) I need it for developing purpose"
163,1547479664.6433,Arturo,`slurp` it?
163,1547479723.6449,Isa,"But I don’t want to do it on `:body`. I would like to have `fn` like `(show-me-values m)`. Perhaps such function doesn’t exist :slightly_smiling_face:; But maybe it exists, so I am asking :slightly_smiling_face:"
163,1547479748.6456,Arturo,not afaik!; :slightly_smiling_face:
164,1547483804.6463,Isa,"What `buddy` exactly add on top of `ring` `sessions`? <http://funcool.github.io/buddy-auth/latest/#session> ? It doesn’t look like it is adding something special, but maybe I miss something.

Asking in different way: I need to make sessions based on DB, I am thinking about <https://github.com/clojusc/ring-redis-session> . Does it make sense to glue it in some way with `buddy`?"
164,1547483985.6467,Arturo,"I used amazonica for now but when i go back to this, will try it out; it’s all pretty obscure, a couple of helper functions here would be really welcome"
164,1547484299.6475,Epifania,<@Isa> aren't `ring sessions` just for authentication? Buddy seems to give you authorization too
164,1547484346.6483,Isa,"Maybe. I am not sure what exactly buddy add. I didn’t use it before.; But I see in buddy doc Authentication with sessions; But there is no info what exactly is the point of using it; I am trying to figure out if `buddy` is something for me or not. What I can use from there.; I don’t see too much benefits while I am using `liberator`, but maybe I miss something. Am I miss something?"
165,1547490102.6515,Fairy,"any advice on how to parse this string (read-string ""09"")...  It's an invalid number, was gonna maybe strip zero's but if there's anything less complicated, i'd love to know :slightly_smiling_face:
```java.lang.NumberFormatException: Invalid number: 09```"
165,1547490181.6523,Rosaline,"```
user=&gt; (Long/parseLong ""09"" 10)
9
user=&gt; 
```; using read-string to turn a string in to a number is using a missile to swat a fly"
165,1547490307.6532,Elaine,"`read-string` is not safe
`(read-string ""#=(prn :code-injection)"")`
Prefer `edn/read-string`
But sure, to parse a number, you can use `Long` or `(bigdec ""09"")`"
165,1547490308.6534,Fairy,lol; thanks <@Rosaline>!
165,1547490338.6539,Vita,"also read-string has security implications if it’s user input; `(read-string ""#=(slurp \""/etc/passwd\"")"")`"
165,1547490890.6551,Fairy,cool good to know !
166,1547491797.6566,Isa,"What do you use for sessions in *clouds* with solution like kubernetes? `redis` to store sessions? `sessionAffinity`? I think the best solution is `redis`, but maybe I am in mistake :slightly_smiling_face: What do you use to store sessions and why?"
166,1547491981.6582,Fairy,"I've used Redis for session stores all the way back to my Ruby on Rails days, so I just use the same thing in clojure apps.; But... my new app uses a datomic db. So I could probably just use that. But I'm also using redis for a message queue, so, why not... If it ain't broke."
166,1547492109.6604,Isa,redis is probably faster for session purpose - my guess
166,1547492125.6607,Fairy,Also I guess redis is nice too for expiring sessions.
166,1547492186.6617,Isa,Cool you can use Datomic. It is a little expensive :wink:
166,1547492207.662,Fairy,"yeah... i presume redis is faster. But then again, I'm storing a session key and a user id value, and then looking the user up in datomic anyways."
166,1547492667.6623,Isa,hmm make sense; but the point is you have a token for session
166,1547492913.664,Meagan,"<@Fairy> for temporary session-state type things, redis would be a better fit than datomic; datomic is best used as a system of record. for sessions that you want to throw away after 30 mins or whatever, you're going to end up growing your database very quickly and probably don't need a lot of what datomic brings to the table (at the cost of increased overhead)"
167,1547508785.6703,Antione,"Best way to implement `first-and-only`, which checks that there is only one item in coll, and throws otherwise?

```
(first-and-only [1]) =&gt; 1
(first-and-only []) =&gt; Exception
(first-and-only [1 2 3]) =&gt; Exception
(first-and-only nil) =&gt; Exception
(first-and-only 1) =&gt; Exception
(first-and-only [nil]) =&gt; nil
(first-and-only [nil nil]) =&gt; Exception
```; ```
(defn first-and-only [x]
  (if (coll? x)
    (if (and (seq x)
             (next x)
             (first x))
      (throw (Exception. ""too many""))
      (first x))
    (throw (Exception. ""not a coll""))))
```
is close, but for instance, wouldn't catch the scenario where the `next` element is `nil`"
167,1547508928.6717,Gillian,Can’t you just count and see if it has 1 item in it?
167,1547508983.6723,Antione,i don't want to `count` if i can avoid it
167,1547508989.6725,Gillian,why not?
167,1547508999.6729,Antione,"if it contains 1029438294839248392 elements, i don't want to count all of them"
167,1547509053.6733,Gillian,ah that’s fair
167,1547509078.6742,Jasmine,There’s `bounded-count`
167,1547509086.6744,Antione,"there's a way to do this. i've written this maybe 4 times, but i forget the solution; ah, never used bounded-count, but that's cool!; ```
(defn first-and-only [x]
  (if (coll? x)
    (let [bc (bounded-count 1 x)]
      (condp = bc
        0 (throw (Exception. ""not enough""))
        1 (first x)
        (throw (Exception. ""too many"")) ))
    (throw (Exception. ""not a collection""))))
```

bleep bloop"
167,1547510189.676,Elaine,"<@Antione> solutin with <#C0FVDQLQ5|specter>
```
(select-one! ALL [1])
;; =&gt; 1
;; This thows with a 'good' error
(select-one! ALL [])
(select-one! ALL (range))
(select-one! ALL [1 2])
```"
168,1547510223.6767,Becki,If the bounded count throws the right error you might just be able to use and bounded count = 1 and then first
167,1547511656.6773,Antione,"<@Becki> good point; <@Becki> mm, it does not throw; it handles the ""potentially giant unrealized sequence"" scenario"
167,1547511803.6797,Becki,I meant on a non collection it should throw. It seems like you want exceptions here. 
167,1547511830.68,Antione,ahhh
167,1547511879.6812,Becki,And then you just throw if the bounded count is not exactly 1
169,1547524646.6821,Donny,"read-string cannot recognize a decimal number headed with 0, but it recognizes ""00"" - ""07"", why? they're considered as octal ones"
170,1547529766.6825,Diamond,`case`
171,1547551336.6849,Aubrey,"&gt; As some of you probably know, Christophe Grand has joined nREPL’s team and is working on bringing some amazing features from unrepl to nREPL:

&gt; The ability to upgrade a plain socket REPL to nREPL.
&gt; Sideloading - allowing clients to act as network classloaders.
&gt; A rich value printer with collection elision.
&gt; (Extremely) Exciting times ahead! I cannot thank Christophe enough for the amazing work he has been doing on nREPL recently! People like him are the heart and soul of the Clojure community and the reason why I love being part of it!; Wow, this is very exciting news; (from <https://metaredux.com/posts/2019/01/15/cider-oslo.html>)"
172,1547553255.6865,Clarine,"Is there a JSON library which lets you only read what you need from a JSON string, to save performance? Like what you would do when writing your own JSON deserializer for a type in e.g. Java or Haskell."
173,1547554871.6876,Epifania,"is there any way I can hook into `ring.middleware.reload` when it's actually doing a reload? Would like to perform some custom task when it's reloaded (specially restart a task that runs every X seconds); looking for something similar to `on-js-reload` from figwheel, which lets you run code when the code has changed"
174,1547556085.6909,Isa,Ring reload event only if ns which you point to is reloaded. I have dev/user.clj which is wrapper app on core app with extra middleware. You can add to this ns restart task code.; I am writing from phone. Sorry if too general 
173,1547559082.6921,Epifania,"ah, right, so basically just split things up more. Makes sense. Thanks <@Isa>"
175,1547560489.6928,Marisha,Hi all. Does anyone have any tips on how to deal with clojure metadata on the Java side?; I have some data with my own metadata attached which I need to pass on to Java code. How do people normally deal with this?
176,1547567461.6952,Maximina,"Is there a way to to (str #inst ""2018-10-15T14:45:07.000000000-00:00"") without the time being converted to my time zone?"
176,1547567639.6959,Jasmine,"Yes, you really need to look into java time stamp formatting ; Clojure really relies on the jdk for all that stuff"
176,1547567726.6971,Maximina,"Will do, thanks; Answer to my question: use SimpleDateFormat"
177,1547572790.6985,Dann,"the metadata is accessible via a method on the Object it's attached to, but you can just use `meta` via `Clojure.var` ```IFn meta = Clojure.var(""clojure.core"", ""meta"");
meta.invoke(o);```; if you cast the object to `IFn`, java should let you call the `meta` method ```o.meta();```, but I think the meta function is more reliable as an entrypoint; But maybe I misunderstood? Are you doing this from Clojure and just want to know how to pass the metadata?"
178,1547584216.7009,Isa,"Is it possible to read session value with <https://github.com/xeqi/peridot> ? I am doing this now in that way:
```
(-&gt;&gt; (get-in mock [:cookie-jar ""localhost"" ""ring-session"" :value])
               (get @mem)
               :uuid
               (some?))
```

But it would be nice to use come kind of ring reader from session instead."
179,1547608487.7049,Lexie,Hi all! Extreme noob to Clojure here. Cider aside.. which dev environment is most suited for beginner Counterclockwise/ Cursive ? Any links on how to setup a dev environment ?
180,1547615723.7053,Meagan,I would suggest Cursive or VS Code + Calva; Counterclockwise hasn’t seen much love in the past years and so getting support for issues you run into might be difficult
180,1547616292.7064,Jasmine,CCW is no longer developed and I don’t think works on newer versions of Java/Clojure
178,1547618598.7076,Isa,"If you use emacs, use Cider. If Intellij use Cursive. If none, use Cursive, because Intellij is easier than emacs. You don’t want to learn hard editor + Clojure at the same time.; *harder editor doesn’t mean better. It is different depend on your preference.; I would love to see stable and extended Clojure plugin for Visual Studio Code. But today you can choose only between emacs + cider / Intellij = Cursive I guess.; `brew install leiningen clojure` and you are ready to go :slightly_smiling_face:; `clojure` is `clj` command"
178,1547619754.7125,Celestine,"If you already use Atom, look at Chlorine or ProtoREPL. If you already use VS Code, use Calva. The main thing you want for learning Clojure is an integration between your editor and a REPL, so you can just hit a key combo and evaluate a form, a top-level form, or the entire file into that REPL — without typing into the REPL. All of those are sufficient."
181,1547619795.7131,Celestine,"(and if you use vim, look at fireplace? I’m not familiar with the vim/Clojure ecosystem, sorry)"
178,1547619846.7136,Celestine,"For beginners, not having to struggle with the basics of an editor is a big help :slightly_smiling_face:"
182,1547633119.7141,Marisha,"Hey! Thanks; Yes, I'm doing it from Clojure, but the data needs to go through some Java and back.
So I'm thinking what's the best way of doing that."
183,1547649540.7173,Raelene,"A macro question:
```
(defmacro transact!
  """"
  [&amp; body] 
  `(jdbc/with-db-transaction [conn# db]
     ~@(map (fn [transaction]
              `(jdbc/execute! conn# ~(honeysql/format transaction)))
            body)))

&gt; (macroexpand-1 '(transact!
                                    (-&gt; (insert-into :foo)
                                        (values [{:id (java.util.UUID/randomUUID)}]))))
=&gt;
(clojure.java.jdbc/with-db-transaction
 [conn__27812__auto__ db-adapter.sqlite/db]
 (clojure.java.jdbc/execute!
  conn__27811__auto__
  (honeysql.core/format
   (-&gt;
    (insert-into :foo)
    (values [{:id (java.util.UUID/randomUUID)}])))))
```
The inner `conn#`, expanded, is a different one than the outer `conn#`. How to make the `conn#`s the same symbol?"
183,1547649769.7187,Karena,"<@Raelene> it has to do with the two layers of quoting; try removing the quote on `(jdbc/execute! ...)`; ```
(defmacro foo
  [&amp; body]
  `(let [conn# ~body]
     (prn conn#)))
;; conn# is the same 

(defmacro foo
  [&amp; body]
  `(let [conn# ~body]
     `(prn conn#)))
;; conn# is different
```"
183,1547650137.7222,Raelene,"Yep, it is the layering but removing the quoting does not work in this case. Because the `map` is evaluated, it tries to evaluate `conn#` at compile time which is not possible."
183,1547650415.7247,Lemuel,<@Raelene> I would make the macro ```(jdbc/with-db-transaction [conn# db] (doto conn# ~@(map (fn [transaction] `(jdbc/execute! ~(honeysql/format transaction))))))``` &lt;-- admittedly just avoids the problem
183,1547650456.7252,Becki,can you use a let binding in the macro to capture `conn#` and then use that common binding in both quoted forms?; an example: <https://github.com/ztellman/manifold/blob/master/src/manifold/deferred.clj#L309-L325>
183,1547650689.7269,Raelene,"<@Becki> Great, this seems to be the solution around this multi-layer-macro problem."
183,1547650703.7276,Becki,i think ztellman solves this problem as well in ridley with a way to unify gensyms across quote boundaries like this
183,1547650704.7277,Raelene,"<@Lemuel> Thanks, this works too, great."
183,1547650829.7287,Becki,<@Raelene> read this section of zach's Potemkin library: <https://github.com/ztellman/potemkin#unify-gensyms>   (not advocating use necessarily. not advocating use but he for sure has thought of a great many problems)
184,1547651438.7305,Loria,Is there any way to collect the statistics from a `criterium` benchmark? Trying to determine the time complexity of an algorithm by running it against different inptus
184,1547653912.7329,Raelene,"<@Loria> not sure what you mean by statistics, but if you referring to the outputs of e.g. `bench`, run it against all your inputs inside `with-out-str` and transform/write the resulting string somewhere."
184,1547654491.7334,Loria,oh.. I suppose that's one way to do it; Strange to have to write a parser when surely those values are around as actual numbers somewhere? I tried searching through the documentation but couldn't find anything
184,1547655265.736,Raelene,"<@Loria> Yep, thats stupid :slightly_smiling_face: `criterium.core/benchmark` returns the result as data <http://hugoduncan.org/criterium/0.4/api/criterium.core.html#var-benchmark>"
184,1547655588.7367,Loria,"thanks, that's exactly what I needed!; ```
(def timing-results
  (doall
   (for [n [5 10 15 20]]
     (criterium/quick-benchmark
      (fib n) nil))))

(map #(get-in % [:mean 0]) timing-results)
;; =&gt;
;; (6.82956017409221E-7
;;  8.839126734896198E-6
;;  1.0012795602974459E-4
;;  0.0010987932789473685)
```; now to write a function which will look at that and estimate if it's O(n), O(n^2), O(n! log (n)) , etc.:thinking_face:"
185,1547656282.7393,Tammera,That is probably more tricky than you would expect. I wouldn’t be surprised if there are mathematicians who spend their lives on that.
185,1547656890.7421,Raelene,"Yep, especially since you will see things in the curve, that are due to the machine, not the ideal algorithm. E.g. jumps when certain chunk sizes are passed etc. Mathematicians usually don't care about such things."
184,1547658502.7461,Loria,"Yeah, I don't need it to be very rigorous, just using this as a way of getting my head around the performance characteristics of `core.logic` programs - which seem really hard to reason about and blow up exponentially in unexpected ways.; I ended up just hacking together something in Python notebook which plots out the points and the regression lines for `logn n, nlogn, n^2 , 2^n`, then eyeball which curve fits best :sweat_smile:"
186,1547662502.7493,Dann,"the `meta` function retrieves the metadata, then you can use it with the java methods in whatever way makes sense; and if you need to round-trip, you can use with-meta to attach the metadata to a new data structure if needed - but this only works with Clojure things (vars, functions, persistent collections, symbols etc.)"
187,1547665985.7508,Tabitha,"why would I be getting an error about manifest type when depending on a git source?
```
             cider/piggieback                {:git/url ""<https://github.com/dpsutton/piggieback.git>""
                                              :sha ""fd99b9e3cfd2069a2484ba9e75dcd1bb04b78ed8""}
```

```
Error building classpath. Manifest type not detected when finding deps for cider/piggieback in coordinate {:git/url ""<https://github.com/dpsutton/piggieback.git>"", :sha ""fd99b9e3cfd2069a2484ba9e75dcd1bb04b78ed8""}
```"
187,1547666217.7519,Jasmine,"tools.deps is trying to determine the transitive dependencies for piggieback, but is not finding a manifest it understands (deps.edn or pom.xml); currently tools.deps doesn’t know how to read lein project.clj files; one option is to forcibly declare it as a deps.edn project (it then treats a missing deps.edn as no transitive deps); you can do this by adding `:deps/manifest :deps` to your coordinate"
187,1547666406.7536,Becki,"i can run `lein pom` and push that to the remote too, can't i?"
187,1547666442.7538,Jasmine,you could; make sure you move your sha then
187,1547666590.7541,Becki,use 0ab53c69a12812b6eb4000862f12447b4874a949; made a branch based on that change with a pom file added
187,1547666638.7547,Tabitha,"gotcha, awesome, thanks!; nice; seems like we're not quite there yet,

but at this point I'm creating extra work for you, so I'll just pull it down and see if it works with a local dependency; None"
187,1547667080.7556,Becki,try c4fbfdadb28a0d3c8700901677ab104d59ddbc27
187,1547667095.7558,Tabitha,trying...
187,1547667131.756,Becki,one more:; 403142e5017628ce447aebf2e4c0c82d482488c3
187,1547667133.7564,Tabitha,same error; trying...
187,1547667144.7568,Becki,the pom had an issue with a dep on tools.nrepl
187,1547667194.7571,Tabitha,"{:git/url ""<https://github.com/dpsutton/piggieback.git>""  :sha ""403142e5017628ce447aebf2e4c0c82d482488c3""}

same error with that"
187,1547667270.7577,Jasmine,"the generated pom just isn’t including your source files; you could just use a deps.edn file like:
```
{:deps
 {org.clojure/clojure {:mvn/version ""1.8.0""}
  org.clojure/clojurescript {:mvn/version ""1.9.946""}
  nrepl {:mvn/version ""0.4.5""}}}```; probably don’t even need nrepl there; oh, maybe you do, not sure"
187,1547667416.7601,Becki,assumes src dir without explicitly putting that? I think it was lacking dirs from the lein generated pom due to profiles
187,1547667433.7606,Tabitha,the nrepl is for working with intellij
187,1547667434.7607,Jasmine,"by default it uses `src` as the source directory; but you could add `:paths [""src""]` to be explicit"
187,1547667451.7615,Becki,ok. that's what i thought. just making sure i didn't end up with the same problem; one more:; 7bbe53ed38dfd79c3e9375d875d8c755a143a4b0
187,1547667481.762,Tabitha,on it
187,1547667482.7622,Becki,this switches to deps.edn; :+1:
187,1547667537.7626,Tabitha,SUCCESS!; ill play with it for a bit and make sure nothing is weird
187,1547667569.7636,Becki,thanks for the help <@Jasmine>
187,1547667583.7641,Jasmine,:+1:
187,1547667774.7652,Jerome,"If I’m using `doto`, is there a clearer way to call `doseq` inside of it instead of wrapping an anonymous function in a function literal? If I want to use `doto` right now I have to do this -
```
(doto (Ctor.)
 (#(doseq [[a b] c]
     (.aMethod % a b))))
```"
187,1547667804.7655,Tabitha,yessss this is so great.  feels so good to be able to do this again
187,1547667866.7662,Jerome,"Leaning towards just doing this because I think it reads better -
```
(let [obj (Ctor.)]
  (do
    (doseq [[a b] c]
      (.aMethod obj a b))
    obj))
```"
187,1547667947.7671,Tabitha,"ah, the old doodooseq"
187,1547667993.768,Rosaline,"`(reduce #(doto %1 (.aMethod (first %2) (second %2))) obj c)`; that is assuming c isn't static, if c is a known value, I would write some code to generate the method calls and just paste them in"
188,1547668219.771,Tabitha,"```
(dorun (map (comp (partial apply .aMethod)
                       (juxt (constantly obj) first second))  c))
```"
187,1547668229.7713,Tabitha,"lol, I have no idea what those values are"
188,1547668353.7722,Tabitha,there we go
188,1547668440.7733,Dann,"as a small thing, you can replace `(dorun (map ...))` with `(run! ...)`"
188,1547668440.7734,Jerome,"Feel like that’s going to generate reflection warnings?; Our project fails compilation if there are any reflection warnings, but I’ve never tried `apply .someJavaMethod`"
188,1547668501.7743,Dann,that simply doesn't work
188,1547668501.7744,Tabitha,great tip!  i didnt know that!; hahaha
188,1547668528.7753,Jerome,Yeahh seemed dubious haha
188,1547668539.7757,Tabitha,sorry!  i diidnt test my solution at all :joy:
188,1547668540.7758,Jerome,Also people on my team would hate me for that
187,1547668548.776,Hilary,<https://github.com/clojure/clojure/blob/28b87d53909774af28f9f9ba6dfa2d4b94194a57/src/jvm/clojure/lang/AFn.java#L143>
188,1547668579.7766,Hilary,`apply` relies on :point_up:
188,1547668591.7767,Dann,"let already has an implicit do in the body btw, so using do there is redundant; not only that, but .someJavaMethod isn't a thing we can put on the stack; . is an interop form, on compilation it generates code to (optionally reflect) and invoke a method; it doesn't point to any real thing that you can use as an arg or put in a collection"
187,1547668697.7791,Jerome,"Yeah that makes sense, and this isn’t even a static method"
188,1547669034.7795,Tabitha,"alright everyone, I hate my idea too"
188,1547669140.7803,Dann,"you can succinctly make a function that calls a method via memfn: `(memfn someJavaMethod)` - this is first class, can be used with apply or map etc."
187,1547669358.782,Jasmine,But will reflect
187,1547669380.7824,Noemi,"when I load open the project I'm interactively developing in emacs/cider, I have to open all the clj files that contain functions I call in my main 'runner' file and eval them to avoid class not found errors... what am I doing wrong?"
187,1547669434.783,Jerome,"Oh interesting, didn’t know about `memfn`"
188,1547669473.7836,Becki,<@Noemi> did you load the main runner file? `cider-load-buffer` (C-c C-k) by default
187,1547669488.7842,Becki,if it has a valid ns form with deps it should pull all of that in as normal
187,1547669528.785,Noemi,"I did load the main runner file with C-c C-k without incident but still having to go load all the namespaces mentioned.; using lein repl, and cider-connect, if it matters."
187,1547669561.7857,Dann,you need to require the namespaces that your runner accesses
187,1547669570.7862,Becki,and are you in the namespace of the main runner?
188,1547669574.7864,Dann,that should either error (if they can't be found) or guarantee they are loaded
187,1547669603.7871,Noemi,"I believe I did those things, but I'll do it all from scratch to double check everything; stand by (and thanks!)."
188,1547669633.7872,Dann,"as long as you access the function from the main runner properly, there's no need to be in that ns"
187,1547669700.7874,Becki,"i'm wondering if there is some confusion that those deps required by the main runner are ""visible"" in that namespace but not visible from the current ns. Its hard to tell if this is a bug or users error"
187,1547669800.7879,Tabitha,"oh yeah +1 about memfn, thats neat!"
188,1547669822.7883,Tabitha,<@Dann> you've really made it worth my while to hang out here today!
187,1547670361.7895,Noemi,"<@Becki> <@Dann> lesson learned, and never forgotten. I was missing the parent directory in src with the project name; my clj files were directly in src for some reason; everything evaluates now."
189,1547672743.7908,Nguyet,`(map #(foo % baz) bars)` vs `(map foo bars (repeat baz))`
187,1547673011.791,Becki,the former for me
190,1547681094.7918,Reiko,"I'd recommend Cursive. It's been the most complete environment for me and gets solid updates. Other environments I've been left in a broken state when the developer(s) of the tool get upset that something changed in core and they leave instead of fixing it. I can't deal with that instability.; I don't know about Chlorine, but I know ProtoRepl doesn't really support ClojureScript. If the person is only writing Clojure then it works well.; PSA: Slack supports syntax highlighting for Clojure(Script) if you use the code snippet function over the code blocks. Makes your code easier to read here!"
191,1547682315.7937,Celestine,My understanding is that Chlorine is great if you're using `shadow-cljs` but not other ClojureScript build/dev tools. Since Chlorine is written in cljs and uses `shadow-cljs` and that's how it is developed (using itself).
192,1547682425.7942,Jerome,"```
(map fn coll)
```; Hmm; Not the same as GitHub’s; Oh you mean by clicking the “+” icon; Yeah but that’s a pain; At least for small things; Yeah I wanted it to work that way too <@Dann>"
193,1547684920.7967,Reiko,"It's actually less work than typing out the backticks...and it's also a pain to read a bunch of lisp code with no syntax highlighting, especially when someone is asking for help on it.; Naturally, for a single line of code that wouldn't be necessary."
193,1547685241.7971,Lexie,absolutely <@Reiko>
193,1547685293.7974,Reiko,"Well that's good to know. I use shadow-cljs myself, but the issue is if I need to use some other tool for whatever reason then now I have to change my entire development environment over a tool being switched out. That's disruptive."
193,1547685364.7977,Lexie,Thanks!
193,1547685532.7979,Celestine,Go open an issue on the Chlorine repo then :slightly_smiling_face:; I'm pretty sure the maintainer is very open to supporting a broader set of cljs workflows. He seems very receptive and helpful in the <#CF02KPG4U|chlorine> channel.
193,1547686001.7983,Reiko,"That's great, but the reality is that it only supports one tool and thus creates this situation. I'm sure I'm not the first to address such a concern. If that changes in the future I'd be happy to check it out."
194,1547689127.8012,Mireille,"Could someone explain this result? I thought that the value of an atom is always fully realized (not lazy), so I would expect the `pr-str` to take much less time.
```=&gt; (let [a (atom (take 10 (repeatedly #(Thread/sleep 1000))))]
    (time (pr-str @a)))
""Elapsed time: 10043.797237 msecs""
```"
194,1547689360.8021,Celestine,"You're deref'ing the atom to get its value -- which is a lazy seq -- and then you're printing it to a string which is realizing the value.; So the 10 seconds is the time it takes `pr-str` to realize the `take 10` -- the deref `@a` would have been near-instantaneous.; ```user=&gt; (let [a (atom (take 10 (repeatedly #(Thread/sleep 1000))))]
         (time @a))
""Elapsed time: 0.007343 msecs""
```; An atom can contain anything -- it's just a container, and it doesn't ""do"" anything to its contents.; ^ <@Mireille> does that help?"
195,1547699314.8055,Jasmine,"well, it should only contain immutable values since the swap! function can be applied more than once in the case of concurrent updates"
194,1547700838.8067,Mireille,"<@Celestine> I see, so if I want the value to be realized before any derefs, I'd need to do that explicitly, like wrap the computation with `doall`. thanks for the insight"
194,1547701044.8073,Celestine,"Yes, the same applies to laziness vs eagerness anywhere in Clojure really."
195,1547710751.8098,Sebrina,I’m thinking of writing a boot task for replacing shortcodes in a markdown file using user-defined functions that return hiccup. Based on other libs I think there should be a `defshortcode` macro for defining them. How are those handled in other libs? Does it update an atom with a map of properties and a function body?; I think data wise it’s important to know the defined shortcodes up front
196,1547721900.8125,Donny,is there any way to run some simple fns inside a clojure jar on android with a much faster startup speed?
196,1547722656.8132,Epifania,how are people dealing with communication between components in `stuartsierra/component`?
197,1547724500.8135,Melina,Two components can communicate by one of them depending on another and using it. Do you have some other communication in mind?
198,1547726569.8137,Epifania,"Well, I might misunderstand something regarding the usage of component... So let's say I have a DB and Web components. The Web component depends on the DB one to do responses with values from the DB. But if I want to change the DB from Web, the state is within DB and cannot be changed from Web.; right now I'm just doing the DB as a simple map that get's stored/load to/from disk. Seemingly, I need to implement this as global state together with the DB component, but then I'm relying on global state..."
198,1547729210.8141,Clarine,"The web component has a refererence to the db component, so it can read and write to the DB. I don’t understand your problem.; A DB is one huge global mutable variable, so that seems OK; you can model the DB with an atom that has a map in it"
199,1547742900.818,Oscar,"started trying out spec after having used schema and core.typed. one thing I noticed, compared to core.typed, spec’ing records is kind of laborious and overly verbose. is this something spec proper would ever address (even if just a macro) or should every one fend for themselves and write their own macros? I suppose there’s a third option which is the core team wants to discourage the use of records and/or their use with spec?"
199,1547742981.8182,Jasmine,kind of a latent question; you can spec them as maps with s/keys and :req-un; there are some ideas we have in spec 2 that might apply better but TBD
199,1547743114.8204,Oscar,"yep, I have, and it’s gross. =P we wrote a macro to fix that, but curious if the need to write such a macro indicates we’re using Clojure in a way not intended by the core team; (or if it’s just because spec is alpha)"
199,1547743188.8213,Jasmine,"nah, just have never resolved what to do about records; spec is centered around the idea of semantics associated with (qualified) attributes; records sit in a weird place with that as the attributes are unqualified but records types themselves are qualified; we’ve kicked around a bunch of ideas but never got something we liked"
199,1547743326.8237,Oscar,"yeah, exactly part of the pain I was feeling with registering specs for record fields; ok, thanks for the info. wanted to make sure I wasn’t missing anything about the design or philosophy of spec"
199,1547743817.8257,Jasmine,"nope, just some unfinished business"
200,1547746447.8275,Zenaida,"Hi guys, I am in doubt about what is the better way to solve the following problem.

Scenario:
Base: `{:response [{:users [{:id 1} {:id 2}]} {:users [{:id 3} {:id 4}]}]}`
Path to: `[:response :users]`
Replace with: `[[{:id 1, :name ""Rafa""} {:id 2, :name ""Ana""}]`
                           `[{:id 3, :name ""Jonas""} {:id 2, :name ""Leo""}]]`

Expected:  `[{:users [{:id 1, :name ""Rafa""} {:id 2, :name ""Ana""}]}`
                       `{:users [{:id 3, :name ""Jonas""} {:id 2, :name ""Leo""}]}]`



I am thinking about recursion but I would like to know if there is a better way (using something like clojure.walk). Any thoughts?"
200,1547746807.8279,Ellyn,what does the data structure containing the `:name`s look like?
200,1547747168.8288,Lane,<@Zenaida> It looks like you want to join on the `:id` attribute. See <https://clojuredocs.org/clojure.set/join>
200,1547747190.8289,Zenaida,"Sorry, I was not clear in my problem... It is not a fixed structure. It's like this: Given a base, path and ""Replace with data"", return base replaced with data; Nice! Thank you very much. But Can I use it lists that have maps and lists... ?"
200,1547747534.8293,Ellyn,"ahh, then you can use `assoc-in`! <https://clojuredocs.org/clojure.core/assoc-in>; i.e `(assoc-in original-data [:response :users] new-data)`"
200,1547747911.8297,Zenaida,"The problem with using assoc-in is that the path don`t know if  some key, like :users, is a list or not."
200,1547748430.83,Ellyn,"okay, now I see what you mean. is this part of a larger example? otherwise it might be easier to wrap the new data structure in `:users`:
```
(def new (mapv #(hash-map :users %) new-data))
```
and then `(assoc old-data :response new)`; is `:id` unique?"
200,1547748756.8304,Zenaida,":id is just a key... Could be anything and could not exist. I am trying now to manipulate the path. So, using the previous example, generate something like: [:response 0 :users] and [:response 1 :users]"
200,1547748812.8306,Ellyn,"I highly recommend Specter for things like this: <https://github.com/nathanmarz/specter/>; here’s an example:
```
user=&gt; m
{1 {:id 1, :name ""Rafa""},
 2 {:id 2, :name ""Ana""},
 3 {:id 3, :name ""Jonas""},
 4 {:id 4, :name ""Leo""}}

user=&gt; base
{:response [{:users [{:id 1} {:id 2}]} {:users [{:id 3} {:id 4}]}]}

user=&gt; (transform [:response ALL :users ALL] #(get m (:id %)) base)
{:response [{:users [{:id 1, :name ""Rafa""} {:id 2, :name ""Ana""}]}
            {:users [{:id 3, :name ""Jonas""} {:id 4, :name ""Leo""}]}]}```; basically, for problems like this the details matter: exactly what the input is, what the data you want to place there instead etc. determines what the best approach is; but for the general problem of “replace something in a nested data structure with something else” Specter is IMO the way to go :slightly_smiling_face:"
200,1547749088.8315,Zenaida,Nice! Thank you! I will give it a shot =D
201,1547753449.8323,Vita,`(clojure.walk/postwalk-replace (into {} (juxt #(select-keys % [:id]) identity) replacements) base)`
202,1547757662.8328,Lane,"You can definitely look at specter but to modify nested data structures in clojure using the ""core library"" you also have zippers. It takes a bit of playing around to get used to them (if you're not already) but once you know them you will be able to apply them in many scenarios."
203,1547759320.8346,Clarine,The changelogs of Clojure only go back to 1.3. I want to know if I remember this correctly: binding was allowed to rebind any var instead of only dynamic vars in the early versions of Clojure. Later on you could only do that with dynamic vars. with-redefs was introduced for rebinding the root values of vars e.g. for testing. Was that related to the change to binding?
201,1547759524.835,Jasmine,"<https://github.com/clojure/clojure/commit/178d8c42609d899208e745b76b89297c4287c078>; <https://dev.clojure.org/jira/browse/CLJ-665>; <http://clojure-log.n01se.net/date/2010-10-29.html#09:11>; by which I’d say, yes"
201,1547759609.8358,Clarine,cool
204,1547764576.8391,Freddie,"is there a nice idiomatic way to take a vector of maps `[{:a 1 :b 2} {:c 3 :d 4}]` and turn it into a map based off some key in  the vec’s map? `{1 {:a 1 :b 2} 3 {:c 3 :d 4} ...`?; obviously a reduce would work, but it feels icky; `(reduce #(assoc %1 (:the-key %2) %2) {} the-vec)`; (now i see that the above is confusing, assume each map entry in the vector has _the same_ keys)"
204,1547764707.8412,Becki,`(into {} (map (juxt :a identity)) coll)`
204,1547764714.8414,Rosaline,group-by
204,1547764743.8417,Freddie,"! `group-by` is exactly it, thanks <@Rosaline>"
204,1547764813.8423,Clarine,"well, it seems you assume that the vector of maps has a unique value for the same key in each map?"
204,1547764818.8424,Freddie,"interesting … seems weird to juxt with an identity, but necessary because of how into works I assume? takes [k v] pairs; yes, i do — which fits for this particular dataset; good heads-up thinking though"
204,1547764853.8436,Clarine,"so then it’s slightly different than group-by. we have a function called index-by for that, I can look it up; ``` 
(defn index-by
  ""Returns a map which indexes values by the result of calling kfn
  with given value.""
  ([kfn values]
   (index-by kfn values nil))
  ([kfn values flat?]
   (tzipmap (map kfn values) values flat?)))
```"
204,1547764911.8442,Becki,yes you want a sequence of [(:a thing) thing] as your key value pairs which will go into the map
204,1547764913.8444,Clarine,(where `tzipmap` is a transient-based version of `zipmap`)
204,1547764976.8451,Becki,i think the `(into {} (map (juxt :a identity)) coll)` will use transients for free because of into
204,1547765022.8459,Clarine,"could be, this code probably stems from before transducers ,etc."
204,1547765055.8466,Dann,"there's the similar `clojure.set/index` as well - allows multiple relations to index and multiple matches for each value of the index; ```egret.run=&gt; (clojure.set/index [{:a 0 :b 1} {:a 1 :b 1}] [:a])
{{:a 0} #{{:a 0, :b 1}}, {:a 1} #{{:a 1, :b 1}}}
```"
204,1547765116.8475,Freddie,"i love `clojure.set`, i use it almost everywhere; its so much easier for me to think about data as just sets and joins/unions/etc"
204,1547765208.8483,Clarine,"this finds `group-by`  as the closest built-in thing:
<https://re-find.it/?args=%5B%7B%3Aa%201%7D%20%7B%3Aa%202%7D%5D%20%3Aa&amp;ret=%7B1%20%7B%3Aa%201%7D%202%20%7B%3Aa%202%7D%7D&amp;more=true>"
204,1547765240.8486,Freddie,woah. that’s a great idea for a tool…; where has this been all my life
204,1547765412.8493,Clarine,set/index comes up first when you use `[{:a 1} {:a 2}] [:a]` as the args.
205,1547766558.8498,Eduardo,"I’m spinning up some old projects with `lein repl` and getting this error:; ```No such var: nrepl.transport/uri-scheme```; I have lein 2.8.3, clojure 1.8.0; I clearly have something out of sync somewhere"
205,1547766600.8509,Becki,downgrade to lein 2.8.1 and try; `yes | lein upgrade 2.8.1`
205,1547766645.8522,Dann,"yeah - lein changed nrepl versions with a recent release, and that could break old projects if they or their middleware relied on the way nrepl used to work"
205,1547766651.8524,Clarine,maybe you have some incompatible nrepl in your profiles.clj?
205,1547766680.853,Dann,it could break all your projects if your profiles.clj pulled in a middleware for the old nrepl
205,1547766695.8534,Eduardo,"Yes, I was hoping to use an older project to do some cider hacking. And it’s complaining about middleware as well. I feel a bit lost, lol.; Everything used to just work; I’m sure the new stuff is great, of course :wink:"
205,1547766727.8544,Dann,"well, the CIDER maintainer also maintains nrepl, so they should at least evolve together now"
205,1547766740.8547,Eduardo,"ok, I have a repl… that’s good…. now let’s try cider….; Hmm. So for CIDER… can I upgrade the deps and the latest CIDER while keeping lein at 2.8.1?"
205,1547766865.8563,Becki,no unfortunately. CIDER was straddling both tools.nrepl and nrepl/nrepl through 0.19 but the most recent 0.20 dropped tools.nrepl support. now the entire application needs to be newer nrepl throughout
205,1547766924.8567,Eduardo,So… if I want to make the leap… is there an upgrade guide?
205,1547766965.8571,Becki,we can chat in <#C0617A8PQ|cider> but just check your deps for tools.nrepl.
205,1547766991.8574,Eduardo,"Cool, thanks!"
206,1547771110.8589,Rosalba,any recommendations for sending email from clojure? I was looking at postal but wanted to check if there was anything else I should consider
207,1547802374.8628,Murray,"hi folks, I want some help, recently sometimes I can't ssh my server that run a clojure application(the only one). the error is `shell request failed on channel 0`, after some searching, I think it may because somewhere is leaking process? I'm not sure how to investigate further. any suggestion will be very helpful. thanks!"
208,1547807455.8637,Morton,Hello - where can I get help on using the Clojure CLI? It's not picking up the location of `.m2/repository` properly and I'm not sure why...; It's trying to access `/var/empty/.m2/repository/` instead of `$HOME/.m2/repository`
208,1547807703.8655,Clarine,"<@Morton> try inspecting your environment variables, if they set some alternative location for m2?"
208,1547807768.8659,Morton,"There are 0 env vars, this is building inside a nix environment; Is there an env var that clojure looks at for the location of m2?"
208,1547807839.8668,Clarine,is there a settings.xml in .m2 maybe?
208,1547807857.8671,Donny,"env of system could be redirected by `export M2_REPO=`; and if you use lein, the key [:local-repo :repositories] in the profiles.clj also could redirect to other folders"
208,1547807993.8696,Clarine,If I google on var/empty nix maven I find some stuff. maybe it’s the home dir location in the nix shell that’s set to /var/empty
208,1547808128.8708,Morton,"```
HOME=$PWD
export M2_REPO=$HOME/.m2
clojure -A:test
```
Still has the clojure cli go toward `/var/empty/.m2`

and `HOME` is set to a proper non `/var/empty/` location :confused:"
208,1547808313.8716,Clarine,"is `M2_REPO` a thing?
You could try this: <https://maven.apache.org/guides/mini/guide-configuring-maven.html>

Configuring your Local Repository
The location of your local repository can be changed in your user configuration. The default value is
``` 
${user.home}/.m2/repository/.

&lt;settings&gt;
  ...
  &lt;localRepository&gt;/path/to/local/repo/&lt;/localRepository&gt;
  ...
&lt;/settings&gt;
```"
208,1547808344.8722,Morton,"yeup, it doesn't pick it up - placed the settings file in both `$HOME/.m2` and `$HOME/.m2/repository` just to be safe; if I introduce syntax errors in the XML, it complains; but doesn't obey the local repo setting"
208,1547808428.873,Clarine,maybe try: <https://stackoverflow.com/questions/1261215/maven-command-to-determine-which-settings-xml-file-maven-is-using>
208,1547808725.8744,Morton,"Already when doing `mvn -X help:effective-settings` it's not able to populate due to trying to go against `/var/empty`; so that's at least one positive, it's not a clojure specific thing :slightly_smiling_face:; ty for the halp!"
209,1547818225.8771,Jasmine,clj uses the Java system property user.home to build the maven repo location; I’m not sure how that would be off but that’s likely why; You can hardcode in your deps.edn though with :mvn/local-repo attribute at the root; If that lets you move forward
209,1547818355.8797,Clarine,<@Morton> ^
210,1547822755.8838,Morton,We ended up being able to globally set the user.home property and now everything is gucci; thanks for the help folks :wave:
211,1547828913.8853,Matha,Hi! Quick request for advice: what would you say is the most “modern”/“well maintained” way of working with a Postgres database in Clojure? HugSQL? Something else? (I lean towards a raw SQL approach over ORM)
211,1547829013.8855,Neil,"I don’t know about “well maintained”, but I forked yesql some years ago and am actively using it in production <https://github.com/tatut/jeesql>"
211,1547829065.8865,Celestine,"If you want your SQL external to your code, use HugSQL. If you want a DSL to builds SQL, use HoneySQL. With both of those, use `org.clojure/java.jdbc`."
211,1547829081.8868,Evonne,"I personally like hugsql, but I think different people have different preferences. Seems like a variety of solid choices available."
211,1547829082.887,Neil,"Also <https://github.com/tatut/specql>, but that’s not “raw SQL”"
211,1547829101.8875,Celestine,"(if you just want raw SQL strings in your code, you don't need anything beyond the latter)"
211,1547829121.8879,Matha,Thanks! Do you use HugSQL or HoneySQL yourself? I’m not quite sure which approach to go for
211,1547829159.8881,Celestine,"We use HoneySQL extensively (and I took over as maintainer recently).; My former colleague, Fumiko Hanreich, gave a talk at Clojure/West about our use of HoneySQL (in 2012? 2013? I'll get you the link)."
211,1547829211.8885,Matha,<@Neil> thanks! I’ll check it out
211,1547829224.8887,Clarine,<@Matha> I’m loving HugSQL. yesql is dead to me :wink:
211,1547829230.8889,Celestine,I like my SQL in my code where I can see it alongside the code that uses it which is why I don't use HugSQL.; Some people love that separation tho'...
211,1547829250.8894,Matha,"<@Celestine> thanks! I might use HoneySQL then. My use case is fairly basic, but I don’t want it to get in the way of using some postgres-specific features; (and I don’t want it to be too smart; just build the queries I expect it to build)"
211,1547829298.8898,Celestine,<https://www.youtube.com/watch?v=alkcjyhesjI> -- 30 minute talk from 2015 (I was off by several years); There's a Postgres-specific extension project for HoneySQL you might want then.; <https://github.com/nilenso/honeysql-postgres>
212,1547845058.8926,Rheba,"Is there a tool to generate a visual graph of my clojure dependencies, a la <https://github.com/pahen/madge>; Actually, I know there is, it just escapes me atm."
212,1547845304.8936,Clarine,<@Rheba> I believe <@Clemente> had something like that: <https://github.com/walmartlabs/vizdeps>
212,1547845339.8942,Rheba,"I’m sorry, I said dependencies, implying libraries, but I meant namespaces."
212,1547845408.8952,Clarine,oh that. maybe <https://github.com/hilverd/lein-ns-dep-graph>?; I’m good at googling :stuck_out_tongue:; I think I’ve used it in the distant past
212,1547845514.8964,Rheba,Awesome! Thanks. Because there’s a Lein plug in for everything!
213,1547846396.8973,Dann,"also, making a graph of references between namespaces and using it to generate a graphiz input is a fun weekend hack"
214,1547847123.8978,Tammera,GraphViz is a very easy format to generate in general
215,1547848229.8999,Maximina,Anyone knows where I can read or have any tips regarding polling and clustering. Lets say I make an api call and create something. I get an ID back and there is another endpoint which I must call every 6 minutes to poll for a status. If  I have node A and B and B goes down while executing the polling I want node A to take over. Afaik one can use a MQ for this.
213,1547848405.9007,Dann,"yeah - clojure on its own isn't opinionated about IPC, you can use the same libs you would with Java, or in most cases the same lib you would use with NodeJS or Ruby"
215,1547848571.9011,Rosaline,"I would like at something like aws step functions; in general what you'll want to do is have some kind of shared(between A and B) transactional store, represent the polling as a simple fsm, and keep the state in the store"
215,1547848824.9045,Fredda,And a watchdog service running health checks on the nodes you want watched
215,1547848897.9056,Rosaline,"the simplest case would be to, instead of having fail over between A and B, having A and B running concurrently(which is why the transactional store), which would avoid the need for some kind of watchdog and failover check"
215,1547849103.9086,Maximina,"I will have a look at the :point_up: thanks.
I will have one node A. When I get more traffic I will pop up another node,  and another... and when the traffic goes down I will kill them."
215,1547849229.9091,Rosaline,"if you are on aws, I would look at directly using step functions <https://docs.aws.amazon.com/step-functions/latest/dg/sample-project-job-poller.html>"
216,1547883742.9098,Toby,<@Matha> have you looked at Walkable? <https://walkable.gitlab.io/>
217,1547903097.9111,Clarine,"anyone got a quick example how to postwalk an edn file using clj-rewrite? I simply want to replace a few keywords by postwalking it, but the README doesn’t have a good example of this; I want to preserve whitespace and comments, therefore normal clojure postwalk doesn’t suffice; I vaguely remember <@Korey> sending me a snippet of this a while ago"
218,1547905957.9136,Ellyn,"is anyone aware of a persistent data structure library for Java that is adapted for primitives, like a persistent vector that is based on `int[]`? i.e something like FastUtil or Agrona but persistent. Does such a thing even make sense?"
218,1547906541.9144,Shaneka,<@Ellyn> I think bifurcan has those. You’ll hardly find anything better <https://github.com/lacuna/bifurcan>
218,1547907601.9158,Ellyn,"Bifurcan has an `IntMap`, but it implements `ISortedMap&lt;java.lang.Long,V&gt;` so it still uses boxed longs, not primitives :confused:"
218,1547909673.9163,Clarine,<@Ellyn> Clojure has them: `(conj (vector-of :int) 1)`
218,1547909925.9167,Ellyn,"hah, in 5 years of Clojure I’ve never seen those! :smile:"
219,1547911239.9173,Peter,they’re useful for java interop ; array-of is equally useful 
220,1547914212.9188,Jasmine,"note that while vector-of helps with primitive storage, boxing will still happen on access; as it’s going through the same Clojure interfaces that take objects; that’s not necessarily true for arrays - with care you can avoid boxing in most uses of arrays"
221,1547921680.9234,Isaura,"hello, how can I push a repo using tool.deps to clojars?"
222,1547922157.9239,Bree,"I wrote about this just today: <https://cjohansen.no/tools-deps-figwheel-main-devcards-emacs/>; It focuses on clojurescript, but should work for Clojure too; Scroll down to the part about publishing "
221,1547922291.9255,Isaura,"<@Bree> this is great, thank you!"
222,1547922471.9257,Bree,:+1:
223,1547965027.9274,Burl,"Is there a way to parametrize namespaces or dependencies? I am at the moment fiddeling around this to make code optionally core.async compatible, but leave it synchronous on the JVM."
223,1547966834.9282,Celestine,So cljs and clj do different things <@Burl>? That sounds like reader conditionals. <https://clojure.org/guides/reader_conditionals>
222,1547969173.9302,Burl,"I am heavily making use of reader conditionals, but this is about macro-expanding code differently depending on backend settings. Basically you can use core.async on both JVM and JS, but sync code on the JVM."
224,1547984049.9312,Sixta,<https://juxt.pro/blog/posts/pack-maven.html> I also wrote this :slightly_smiling_face:
222,1547998523.932,Verla,Hi all.... I ama but stuck on this one...; this works for me: `(apply conj #{1 2 3} '(4 5 6 ))` as expected...; but when the set is in an atom I can't do this `(swap! atom-with-a-set-in-it apply conj '(4 5 6))`; the I get an error: `Wrong number of args (4) passed to: PersistentHashSet`
222,1547998877.9358,Isela,Try `(swap! atom-with-a-set (partial apply conj) ‘(4 5 6))`
222,1547998942.9374,Verla,"yes, that looks good... but why the partial as well?"
222,1547998981.938,Isela,What you have ends up being `(apply a-set conj '(4 5 6))`; `(partial apply conj)` returns a function that is is passed the set as its first parameter and your `(4 5 6)` as its second parameter 
222,1547999339.9412,Verla,makes sense. thank you <@Isela>
225,1548012970.9427,Fredda,"There's a hacky way I parameterize namespaces in CLJS here: <https://clojurians-log.clojureverse.org/cljs-dev/2019-01-08/1546981037.172600> It CLJ it might be a little more straightforward for namespaces, though not sure about the dependency part."
226,1548048692.9459,Christal,hey has anybody worked with postal? I can't quite figure out how to set mime content-id header for the attachment (or whether it's possible at all)?
222,1548048931.9471,Christal,oops. should have gone through the source right away (:content-id for the same mime part map works)
227,1548054359.9485,Kerstin,"Hi, is this a bug in clojure spec?
```
(require [clojure.spec.alpha :as s])
(s/def ::foobar keyword?)
(s/def ::bugged keyword?)
(s/def ::form1 (s/keys :req [::foobar]))
(s/def ::form2 (s/keys :req [::bugged]))
(s/explain ::form1 {::foobar :d})
(s/explain ::form1 {::foobar :d ::bugged nil})
```
The second `(s/explain)` fails."
227,1548054699.9498,Latonya,"Others can answer more authoritatively than I can, but I believe this is expected behavior.  `::form1` only requires `::foobar`, and it allows other key/value pairs to be present as well.  _If_ one of those other keys that is present has a spec, then its value must satisfy that spec.; If one of those other keys that is present does not have a spec, then its value is not checked to see what it is."
227,1548055076.9515,Kerstin,"Hmm, I saw this paragraph in the docs, for `s/keys`
```
In addition, the values of *all* namespace-qualified keys will be validated
(and possibly destructured) by any registered specs. Note: there is
no support for inline value specification, by design.
```; So there's no way to prevent `::bugged` from being checked right?"
227,1548055288.9532,Latonya,"I guess a question would be, if the only valid kind of value to associate with the key ::bugged is  a keyword, then why do you hope for no error to occur when you give that key a value nil?; And if nil _is_ a valid value to associate with the keyword ::bugged, then maybe you want to change the spec for ::bugged to allow nil"
227,1548055423.9544,Tammera,"Well, I could imagine that you sometimes don’t care about what is in `::bugged`; You know, after some form of transform that you would make a stronger guarantee"
227,1548055498.9553,Latonya,Spec certainly lends itself well to doing that by calling the pre-transform and the post-transform things by different keys.; but not sure if that conflicts with other goals you may have.
227,1548055772.956,Tammera,"Yeah, I was merely stating why I would maybe want to have such an option; I don’t think its good or bad about spec to expect each key to have a single (canonical/always applying) spec, its just surprising ^^"
227,1548055960.9589,Kerstin,"Yes, this is something that was surprising to me, and took me a while to figure out if this was a bug with my code, `spec`, or of my understanding with spec; On the other hand, unqualified keywords works the opposite; ```
(s/def ::form1 (s/keys :req-un [::foobar]))
(s/explain ::form1 {:foobar :d :bugged nil}) ;; Success!
(s/def ::form2 (s/keys :req [::foobar]))
(s/explain ::form2 {::foobar :d ::bugged nil}) ;; fails
```"
228,1548066067.961,Bryce,How do you guys exit the clojure repl from `clj` or `clojure` ?
228,1548066105.9612,Johnson,ctrl+d
228,1548066179.9618,Bryce,"Me too, but I thought I was doing something hacky.
[Edit]
Thanks; Trying to understand aliases invoked via `clojure` or `clj` could someone please explain what this most likely means `clojure -A:dev:build:dev/rebel`.

I see `dev` and `build` are aliases that should be in `deps.edn` but I don't quite get it."
228,1548067080.9661,Johnson,aliases let you selectively add functionality/dependencies. so you just basically combine several aliases to get to the result you want
228,1548067250.9674,Bryce,<@Johnson> and the `dev/rebel` that's also an alias in the `deps.edn`?
228,1548067295.9676,Johnson,"yes thats just a namespaced keyword; but deps can be ""inherited"" from system configs; so you can also define an alias in `~/.clojure/deps.edn`; if you want something that is generic and not specific to a project"
228,1548069043.9684,Bryce,"<@Johnson> So in this case there's likely a `deps.edn` file along the lines of:
```
{:aliases 
  {:dev/rebel ...}}
```

right?"
228,1548069061.9686,Johnson,yes; probably this <https://github.com/bhauman/rebel-readline#quick-try>
228,1548069231.9695,Bryce,"Yes it's that, rebel. Okay, let me state the larger issue. I'm trying to get  familiar with this tool edge but to understand it I think I need to figure out yada. Docs on both are however out of sync with the repo.; If one tries to follow <https://juxt.pro/yada/manual/index.html#_build_run> you'll see the edge repo has no app dir; <https://github.com/juxt/edge>"
228,1548069330.9709,Isa,"<@Tammera> if you don’t care, then `:opt` instead of `:req` or define spec which let `::bugged` be `nil`"
228,1548069424.971,Johnson,probably got reorgnized. maybe that is the `main` dir now?
228,1548070158.9712,Bryce,Ya but docs didn't update. Thanks I get it.
229,1548076019.9728,Kellee,I have a protocol which defines the function `last`. how do I refer this function without replacing `clojure.core/last`?
229,1548077260.976,Jasmine,Either fully qualify with the namespace where the protocol is defined or alias that namespace and refer to it via the alias
229,1548077343.9765,Clarine,"<@Kellee> you can also use :refer-clojure to exclude last from core and then refer to clojure.core/last when you need it.; but that can become confusing, since last is probably used often; Is there a variation of `or` in which the first non-nil value (e.g. false) is returned?"
230,1548078936.978,Jasmine,`some` is close to that
230,1548078938.9781,Gilberto,"`#(first (drop-while nil? %))`

Bind it to a suitable name and there's your function."
229,1548078989.9788,Clarine,"yeah, I know how to write a function for it, that wasn’t my question :slightly_smiling_face: the difference between a function and a macro like or is that or short-circuits. of course I could also write my own or.; yeah, or `(first (filter some? ...))`, but I wanted to avoid first filter :wink:"
229,1548079051.9802,Gilberto,"I can't think of a way of implementing this with `some` without an `if` expression inside off the back of my head - but if anyone can I'd love to hear it!; I'm quite certain this will do the same, `drop-while` will yield a lazy seq which will be realized by `first` so it should stop the moment you get an actual head of your seq back."
229,1548079180.9811,Kellee,"okay, so there's no way to somehow say that the protocol just extends `last` to include this new datatype?"
229,1548079191.9815,Clarine,"yeah, but then you should first create a lazy-seq of things you already don’t want to evaluate.
e.g.:
`(or 1 (throw (Exception. ""no"")))`"
229,1548079231.9822,Kellee,"I'm trying to use `name.stadig.deque` to get deques, but for some reason it has separate a function for `last`"
229,1548079248.9825,Sharleen,what about `(some (complement nil?) ...)`
229,1548079278.9827,Clarine,"```
user=&gt; (some (complement nil?) [false])
true
```"
229,1548079288.983,Sharleen,ups :smiley:
229,1548079351.9837,Clarine,<@Kellee> you can try `(:refer-clojure :exclude [last])` in your ns form
229,1548079366.9838,Chanelle,"(some identity …)
should work"
229,1548079377.984,Clarine,"nope, same problem :stuck_out_tongue_winking_eye:"
229,1548079388.9842,Chanelle,"ugh, right"
229,1548079495.9854,Kellee,"<@Clarine> sorry if I'm being unclear, I would want to use `clojure.core/last` as well. I guess I should've phrased the question as ""can I implement `last` for more types in clojure jvm?""; I remember reading that some it wasn't possible with some protocols in clojure jvm, but it is in clojurescript or something like that"
229,1548079536.9863,Clarine,last is a sequence function. if you implement ISeq that should just work out of the box
229,1548079560.9868,Kellee,"oh, huh. I wonder why the deque defines its own interface then"
229,1548079565.9871,Clarine,"but you cannot extend-type ISeq, because it’s not a protocol"
229,1548079565.9872,Kellee,I'll try changing that then :slightly_smiling_face:; is ISeq different from Sequable?
229,1548079602.988,Jasmine,yes
229,1548079623.9888,Clarine,"ISeq has first, next and rest. Seqable has a seq function that tells how to turn something into a seq"
229,1548079635.989,Jasmine,An ISeq is a sequence. Seqable is something that can return a sequence when asked (via `seq`); <http://insideclojure.org/2015/01/02/sequences/> may be helpful
229,1548079656.9895,Kellee,"ah okay; hmm, I think I understand why they define their own `last`; ```
  (last [this]
    (array-last (if (and (zero? (alength suffix))
                         (identical? empty-deque child)
                         (identical? empty-deque substack))
                  prefix
                  suffix)))
```; so I guess I should just qualify that last. it's just kind of sad that it's conceptually the same `last` as `clojure.core/last`; eit seems that `clojure.core/last` works on the deque as well. maybe their own `last` is faster or something; it seems to use a mutable array internally; thanks for the help :slightly_smiling_face:; and thanks for the link <@Jasmine>"
231,1548080498.9931,Shanell,"```
(defn some-nil [coll]
  (when-let [s (seq coll)]
    (if (some? (first s))
      (first s)
      (recur (next s)))))
=&gt; #'dev/some-nil
(some-nil [nil false true]) 
=&gt; false
```
?; derived from the source of `some`"
232,1548083329.995,Aubrey,I’m using `clojure.tools.namespace.repl/refresh` but it seems my `:after` symbol is not called. I’m not sure why. Should it be in the user namespace or can it live anywhere?
233,1548090062.0001,Breana,Can I assume that the `clojure.core/hash` of too clojure sets are always equal if the sets are equal by value? I have a use case where I'd like to store the hash in a database in order to find a set by its hash. Can too different values have the same hash with this implementation?
233,1548090197.0004,Rosaline,yes; that is a hash collision
233,1548090345.0018,Latonya,"There are far more possible sets than there are 32-bit hash values, so there must be collisions.  And in practice if you start generating similar random sets, e.g. of integer values, you can find such collisions without a lot of trouble.; Maybe more detail than you care to know, but there are non-Clojure Java sets that have inconsistent hash values, even though they are `=` to Clojure sets.  If you restrict your attention to Clojure sets of Clojure values, you should avoid those oddities."
233,1548090578.0043,Min,"depends on what's in the set too, no guarantee that hashCode is stable accross process executions in theory"
233,1548090597.0048,Latonya,"Article containing even more details, if you are interested: <https://clojure.org/guides/equality>; Certainly in Clojure, most hashes of Clojure values changed from pre-Clojure-1.6 to Clojure 1.6-and-later, but pretty stable except for that change.  But sure, the hash function could change again in a future Clojure version, or perhaps because of changes in Java hash functions on some values that Clojure calls out to (I don't recall implementation details well enough to know whether Clojure even uses any Java hash code any more, for Clojure values)."
233,1548090761.0079,Min,a set could contain some java instance of Foo with an unstable hashcode in theory; unstable across process executions I mean
233,1548090797.0093,Latonya,"Sure, that falls outside of my qualification of ""Clojure values"" that I slipped in above :slightly_smiling_face:"
233,1548091019.0125,Min,all in all relying on `hash` sounds like a bad idea imho; but that's just me
233,1548091108.0141,Harris,"```Whenever it is invoked on the same object more than once during an execution of a Java application, the hashCode method must consistently return the same integer, provided no information used in equals comparisons on the object is modified. This integer need not remain consistent from one execution of an application to another execution of the same application. ```; from the javadoc; so an unstable hashcode is illegal"
233,1548091124.0149,Reiko,Whatever happened with that hash function that was discovered that had a very small amount of collisions?
233,1548091140.0155,Min,ah? is that something that changed? I recall reading the opposite
233,1548091161.0164,Latonya,<@Reiko> Do you mean the hash function that Clojure used before Clojure 1.6?  It was replaced.
233,1548091176.0172,Min,also is that true for execution in runtime from vendor A to vendor B?
233,1548091189.0179,Harris,"<@Min> notice the difference between ""during an execution"" and ""need not remain consistent from one execution to another""; maybe that's what you were talking about?"
233,1548091201.0184,Min,I need to read this again :stuck_out_tongue:
233,1548091209.0186,Reiko,"No, I remember a hash function that was discovered by some person a few years back that promised very few collisions, but I haven't seen use of it"
233,1548091216.019,Harris,no
233,1548091227.0198,Min,oh yeah that's what I meant
233,1548091260.0218,Harris,gotcha then you were correct; sorry for the noise :)
233,1548091274.0229,Min,no worries
233,1548091284.0233,Breana,"They are going to contain UUIDs (so `java.util.UUID` instances on the JVM), but since the UUIDs are identifying users (or other resources) they are going to repeat a lot since the database contains far less records than the set of 32-bit values.
Thanks you all for the quick answer, and thank you for the article. I shall read it.
Do you know any function/library providing non-colliding hashes (or very low probability, mathematically speaking)? Or an alternative clean way to create a unique identity?"
233,1548091295.0236,Latonya,"<@Breana> We may be talking all around your question, without solving your problem here.  Depending on how long this database will last, relying on someone else's hash function implementation may be a bad idea, since it may change more quickly than the lifetime of your database."
233,1548091313.0244,Min,replikativ has something like that I think
233,1548091321.0248,Latonya,Unless you have an implementation of the hash function that you have source code to that you believe to be stable for longer than your database.
233,1548091332.0252,Min,but it has other tradeoffs
233,1548091342.0255,Rosaline,"because a hash is a summary they contain fewer bits of information then exist in the value being hashed, collisions will always be at least theoretically possible"
233,1548091382.0263,Min,<https://github.com/replikativ/hasch>
233,1548091383.0265,Rosaline,"you can construct a perfect hash, but you need to know the set of values a head of time"
233,1548091401.0269,Reiko,This is getting to be a lot of discussion on this topic. Can you guys please start a thread to keep track?
233,1548091443.0277,Breana,"Sorry about that, thank you for the reminder"
233,1548091471.0285,Rosaline,"I've been there wanting to use a set as a key in some database and trying to come up with some scalar value which maps to the set, and there is no satisfying way to do it; a hash is not great, maybe a bloom filter gets closer, but still has issues"
233,1548091542.0294,Breana,"If there is no perfect solution, an acceptable solution might be way enough.; If a bloom filter can at least reduce my search space by an order of magnitude I'd be happy with it."
233,1548091583.0299,Latonya,"If the set elements are UUIDs or other things with a total order that you can sort them on, would sorting the set elements and using a string representation of that sorted order work?"
233,1548091683.0306,Breana,"It would work I guess, but the string might get huge… If I do it this way I need to find out what will be the maximum set size, and I don't know that yet; Let's think of it pragmatically:
If I hash the sets, I might get collisions.
But even if I get some collisions the probability is still small, so it might be acceptable. But if the hash changes because the implementation changed, I'll get into trouble.
So I'll have to find a way to hash a set that won't change over time/machine/process/version.
A string might do it, but might get huge. A bloom filter might produce some false positives, but it might be acceptable anyway. I don't know how to persist a bloom filter yet though.

You all gave me a lot to think about, and I think I might take the time to refine my requirements and constraints before asking other questions :slightly_smiling_face:

Thank you very much!"
233,1548092530.0312,Latonya,"The string I mentioned would never have collisions, but yes might get too large.; Even if you had a hash function that didn't have collisions, and had a small result, were you planning on storing the full set in the database, in any form at all?  If so, what technique were you planning to use?  Perhaps storing its elements across different database entries?"
234,1548092772.0316,Latonya,"crypto hashes like SHA / MD5 / etc. promise (or strongly hope) very few collisions, but tend to be a little more expensive to calculate than non-cryptographically-strong ones.  Do you recall whether the one you heard of was intended to be cryptographically strong?"
233,1548094187.0319,Breana,"I'm using a SQL relational database, and the current use case is to store users and groups of users. So I have a `Group (id)` table, a `User (id)` table and `UserGroup (group_id, user_id)` join table. I want to find as fast as possible a group having an exact set of user. Not a subset nor a superset. SQL got set operations, but  don't provide a way to compute set equality in one operation. And with this table design I have to perform a `GROUP BY group_id HAVING count(*) = &lt;size of the user set&gt;`, thus iterating with a nested loop at most over all groups.
So I was thinking that hashing the set and storing the hash would gave me direct access…"
235,1548095618.034,Aubrey,Bumping a previous question — how should I debug a `tools.namespace.repl.refresh` invocation not calling my `:after` function? I’m calling it like this: ` (c.t.n.r/refresh :after 'nosco.dev/go)` — where `nosco.dev/go` is a no-args function as instructed. The refresh works (I see a bunch of refreshed namespaces printed out) but the function is not called (nor do I see any exception).
233,1548099756.0342,Latonya,"If you are willing to iterate over all groups that have the same hash, then a decent hash function can help significantly reduce the number of sets you would need to check in a slower way for precise membership equality, often down to 1 candidate, but even if occasionally down to several, would be much faster than checking all with say, the same number of elements."
233,1548100682.0348,Josh,"<@Breana> sort the set and reduce with the v5 uuid constructor fn - that will give you a stable, deterministic hash of your set, with as low a probability of collision as the nsa’s best crypto engineers of the 1990s could devise"
233,1548100761.0351,Breana,Thank you! Will look into it
233,1548101133.0353,Josh,i'm currently happily using clj-uuid for a V5 implementation: <https://github.com/danlentz/clj-uuid#namespaced-v3v5-identifiers>
233,1548101803.0357,Breana,It looks a lot like what `replikative/hasch` (posted by mpenet) is doing with `(uuid5 (edn-hash &lt;value&gt;))` for this use case
236,1548102265.0361,Reiko,Found it - Buzhash.
236,1548102278.0365,Sheron,hitting an interesting java interop issue at last that i'm having trouble solving :slightly_smiling_face:
236,1548102298.0369,Josh,"oh, i hadn't seen `edn-hash` before - yes, that's similar, although perhaps more general (in that it's designed to do all the hard work of distinguishing your general edn structure before feeding it to a hash fn)"
236,1548102380.0385,Sheron,"if you were to declare a java function that expects a biconsumer string-string lambda you would declare it as
public void foo (BiConsumer&lt;String, String&gt; aLambda) { ....  aLambda.accept(""a-string"", ""another-string""); .... }  , something like this ... and whenever other java code tries to invoke it then javac is smart enough to check if that lambda is actually capable of consuming the string string argument pairs; but if i expose a function from clojure ... how do i achieve the same typehint so that java invokers would be aware of the bi-consumer expected ?"
237,1548103578.0395,Rosaline,you can't
236,1548103636.0406,Sheron,"so i need at leat to write pure java interfaces for the ""hinting layer""; a bit sad :disappointed:"
236,1548104067.0421,Nella,you could write something that reifies the interface that you need without it being too hateful; consider voting for <https://dev.clojure.org/jira/browse/CLJ-2365>
236,1548104224.0434,Rosaline,you are thinking of the reverse
236,1548104255.0444,Sheron,"yes i figured the same,  reify is in the opposite direction of my issue :slightly_smiling_face:"
236,1548104264.0446,Marlyn,"Because of type erasure in the JVM there's no way to ensure; ""don't pass it non-strings"""
236,1548104301.0466,Rosaline,my guess is it is more a question of providing intellisense
236,1548104331.0472,Sheron,"it's not about runtime checks :slightly_smiling_face: , it's about making life easier for coworker who invokes my clojure function from java; so that he wouldn't feed my code a biconsumer that expects an elephant and a teapot as argument types"
236,1548104392.0484,Rosaline,"but that is just dynamic typing right?; clojure is a dynamic language, no getting around it"
236,1548104547.0504,Sheron,"well it does look kind of weird that i can  say  (defn foo [^String a-string] .... )  but not  (defn foo [^java.util.List&lt;String&gt; many-strings] ...)  ...; but as said, i'm not married to the biconsumer interface, so i can declare my own, more restrictive, it will have to do"
236,1548104594.0516,Marlyn,type erasure happens in the jvm
236,1548104610.052,Rosaline,"nah, it happens in the java compiler"
236,1548104616.0522,Marlyn,"^, true"
236,1548104629.0531,Rosaline,java the language has generics
236,1548104630.0532,Marlyn,"Also, ^String doesn't actually mean the parameter is a string"
236,1548104636.0536,Rosaline,the jvm doesn't
236,1548104652.0541,Marlyn,"clojure will still make the function signature Object, and do local casts to string where necessary"
236,1548104659.0544,Rosaline,type hints are not type declarations
236,1548104662.0546,Marlyn,^
236,1548104718.0554,Rosaline,<https://clojurians.slack.com/archives/C03S1KBA2/p1548104447049200>
236,1548104915.0557,Sheron,i understand that part; i'm not trying to alter that part either :slightly_smiling_face: ... all i need to do is to define type hints for people invoking the code from java ... so that their intellij could be helpful for them when invoking my code
236,1548104974.0569,Rosaline,there are huge issues with that as well; the classes etc created by clojure may not be visible until you load the clojure code
236,1548105013.0587,Sheron,well the gen-class part etc. i already solved; so i'm generating a nice jar file that has nicely callable functions ... just wanted the parameter types to be more precise
236,1548105058.0604,Nella,you could create the interface in a java file and then implement the interface in clojure
236,1548105071.061,Sheron,instead of just java.util.List :slightly_smiling_face:
236,1548105079.0614,Rosaline,and stop aot compiling your clojure code; (after you write a stub with whatever types in java); use <https://clojure.github.io/clojure/javadoc/clojure/java/api/package-summary.html> to invoke clojure from your java
236,1548105358.0643,Sheron,gen-class with :methods and matching   -some-method is cleaner when you look from the java side; they won't even know it's clojure they are invoking
236,1548105382.0652,Rosaline,"sure, I mean, you write a facade in java and invoke clojure like that"
236,1548105389.0655,Sheron,i'm not struggling with invoking itself :slightly_smiling_face:
236,1548105404.0662,Rosaline,expose your java facade then with whatever types you want
236,1548105410.0664,Sheron,"was just struggling with the generic part which while being a mimic (since the compiler throws it all away in the end) , is helpful at dev time; at least helpful in the way their intellij will draw a bold red line around the elephant and teapot"
236,1548105804.0698,Rosaline,"I am an old foe of clojure's aot compilation (I've seen it cause real head scratchers) so I am generally of the opinion that the design that leaves it out is best, in this case writing some facade in java (so it gets intellisense and types, maybe even javadocs), and having it call clojure via clojure.java.api seems best"
236,1548105864.0716,Celestine,"I agree with <@Rosaline> that if you want IntelliJ to provide type hints, you're going to have to write a facade in Java and then call into Clojure behind the scenes. The Java API that Clojure exposes is really nice -- we rely very heavily on it in production and have done for years to integrate Clojure into our legacy apps."
236,1548105877.0719,Sheron,well this piece of code has just one entry point (calling one singe function) and what follows is a bunch of clojure all the way
238,1548106215.075,Lee,"Is type hinting loses effect at function boundaries?
In the code below I would expect that no reflection is needed, but lein check says it does:
Reflection warning, core.clj:26:43 - reference to field getDisplayLanguage can't be resolved.
Why? Please explain type hinting rules. (I've read <https://clojure.org/reference/java_interop#typehints> and googled this, but can't see why it is working as it does in this case.)
(ns core
  (:import [java.util Locale Locale$Builder]))

(defn get-default
  ^Locale
  []
  (let [l (Locale/getDefault)]
    ;; local usage of the result of a static method:
    ;; no type hint is needed to avoid reflection:
    (println ""gd"" (.getDisplayLanguage l))
    l))

(defn getd2
  []
  (let [l (get-default)]
    ;; local usage of the result of a type hinted return value of an fn:
    ;; no new type hint is needed to avoid reflection:
    (println ""gd2"" (.getDisplayLanguage l))
    l))

(defn -main
  [&amp; _]
  (let [l (getd2)]
    ;; indirect usage of the result of a type hinted return value of an fn:
    ;; type hint is ineffective, reflection is used
    (println ""Hello, type hinting World!"" (.getDisplayLanguage l))))"
236,1548106230.0752,Rosaline,"yes; type hinting is purely local to function boundaries; type hints are not type declarations, type hints are not propagated; there is nothing like a type inference algorithm going on behind the scenes; it is helpful to consider clojure in the context of being dynamic and code reload and things being redfined; it is not safe to conclude getd2 will always return a whatever because the current definition defines it as returning a whatever"
236,1548106460.0794,Sheron,was a small surprise to me too at some point that clojure typehints dont enforce anything really; i was passing through a completely wrong type and the machine happily hummed along :angel:
236,1548106518.0806,Rosaline,"type hints are just that, hints to the compiler when dealing with interop, if you don't do interop they do nothing"
239,1548108958.083,Jasmine,(except long and primitive double type hints)
239,1548109021.0833,Lee,"Thanks for the info. Then <https://clojure.org/reference/java_interop#typehints> is quite misleading for me, stating that ""Once a type hint has been placed on an identifier or expression, the compiler will try to resolve any calls to methods thereupon at compile time. In addition, the compiler will track the use of any return values and infer types for their use and so on, so very few hints are needed to get a fully compile-time resolved series of calls."" Now I think this could be used to deduce the behavior you describe above: ""Type hints are metadata tags placed on symbols or expressions that are consumed by the compiler."""
240,1548109877.0845,Rosaline,"the docs on the page are maybe correct if you add a modifier like ""within a function"" somewhere"
236,1548111641.0863,Celestine,"It's probably worth mentioning that Clojure's ""unit of compilation"" is a single top-level form -- so when `getd2` is compiled, it has no type hint attached to indicate what it might return, and when `-main` is compiled that definition of `getd2` with no true hint is what it sees being used.; It would be incorrect in a lot of cases for Clojure to automatically tag the return type of a function based on whatever it deduces the type of the last expression in its body to be (which would be the only way the type deduced for `l` inside `getd2` to be propagated _out_ of the function).; Does that help <@Lee>?"
241,1548118106.0898,Matha,"Hi! Quick question: how can I add a CSS class to an element based on a condition in Hiccup? I tried `[:div.foo {:class (if error ""has-error"")}]` but it sets `(if error ""has-error"")` as the class of the element :thinking_face:  <@Angila>"
241,1548118259.0902,Angila,"<@Matha> How are you using it?; ```
user=&gt; (use 'hiccup2.core)
nil
user=&gt; (def error true)
#'user/error
user=&gt; (str (html [:div.foo {:class (if error ""has-error"")}]))
""&lt;div class=\""foo has-error\""&gt;&lt;/div&gt;""
user=&gt; (def error false)
#'user/error
user=&gt; (str (html [:div.foo {:class (if error ""has-error"")}]))
""&lt;div class=\""foo\""&gt;&lt;/div&gt;""
```; It sounds like you're accidentally quoting your code."
241,1548118394.0915,Matha,"<@Angila> I was not quoting it I think, but i was on `v1.0.5` of Hiccup; perhaps that explains it? Trying v2 now :slightly_smiling_face: Thanks for the prompt reply"
241,1548118526.092,Angila,It might have been an issue fixed since then.
241,1548118624.0921,Matha,"I just tried it on v2; doesn’t seem to make a difference. Here is how I am using it: <https://gist.github.com/hmaurer/5d52b8a5edb625b00e175b9a7404f904#file-render-fn-clj-L50>; and in the REPL:
```
user=&gt; (use 'hiccup2.core)
nil
user=&gt; (def error true)
#'user/error
user=&gt; (str (html [:div.foo {:class (if error ""has-error"")}]))
""&lt;div class=\""foo if error has-error\""&gt;&lt;/div&gt;""
```; ```
hiccup                       {:mvn/version ""2.0.0-alpha1""}
```"
241,1548118764.0927,Angila,"Ah, it's been fixed in master but not been released."
241,1548118834.0929,Matha,<@Angila> ah; I will just point my dependency to master then. Thanks! :slightly_smiling_face:
241,1548118862.0931,Angila,Not sure you can without a deps.edn in the repo?; I'll release a 2.0.0-alpha2
241,1548118898.0935,Matha,"Ah I don’t know, first time using deps.edn. I just tried and you are right, I can’t :face_with_rolling_eyes:; thanks!"
241,1548118977.0939,Celestine,"Given there are no transitive dependencies, you _can_ use it from GitHub with `deps.edn` -- you have to specify the manifest type as `:deps` and it will silently ignore the lack of a `deps.edn` file in the repo."
241,1548119007.0941,Angila,"Ah, today I learned something :slightly_smiling_face:"
241,1548119120.0943,Celestine,"```clj -Sdeps '{:deps {hiccup {:git/url ""<https://github.com/weavejester/hiccup>"" :sha ""8021043ae0eb64d1a31d87c0fa6071f44bc1c7f3"" :deps/manifest :deps}}}'```"
241,1548119152.0945,Matha,"<@Celestine> ah, TIL as well. Thanks!"
241,1548119173.0947,Angila,"2.0.0-alpha2 has just been uploaded to Clojars anyway, so you can do it either way."
241,1548119286.0949,Matha,<@Angila> Brilliant; just updated the deps; it fixed my issues. Thank you :slightly_smiling_face: (for live support at 1am)
241,1548119319.0951,Angila,No problemo
242,1548120081.0978,Gillian,"Is there anyway, using clojure.zip to replace a node with two new nodes?

```(let [btree [45 [10] [57]]
      root-loc (zip/zipper vector? rest
                           (fn [[x _ _] children]
                             (vec (cons x children)))
                           btree)]
  (-&gt; root-loc
      zip/down ;[10]
      (replace-with [11] [12]) ; instead of zip/replace
      zip/root))
;=&gt; [45 [11] [12] [57]]```


Using `zip/replace` I can only swap out in this example `[10]` with `[[11] [12]]`, which is not what I want because I don't want to add depth.; I can't really see any other way around this besides going up and replacing the children in the parent node.; I see I could replace and possibly insert left or right, will try that next."
242,1548121185.1013,Rosaline,"the way a zipper works, you can think of replace as a mapping operation, you are a particular node, an you map (constantly replacement-value) over the value of that node, what you are talking about would be mapcat; in theory maybe possible, but there are kind of edge cases, like if are visiting node N, and you replace it with nodes N1 and N2, which are node are now visiting? you can make a choice, but there is no single ""right"" answer there"
242,1548121315.1039,Gillian,"Yeah maybe my particular case warrants a new replace with function, like you said no right answer; I really want to split a node in two; I don't really care which node i'm visiting because i zip the tree right after"
242,1548121360.1054,Rosaline,I think you have to do it from the parent
242,1548121367.1056,Gillian,"Combining zip/replace with insert-right works... since i don't really care if it goes left or right in my case:
```(defn replace-with
  [loc node1 node2]
    (let [[x {r :r :as path}] loc]
      (with-meta [node1 (assoc path :r (cons node2 r) :changed? true)] (meta loc))))```; This seems to work"
242,1548121377.1062,Rosaline,"I mean, if you don't want to dig in to the internals of zippers and figure out how to mapcat"
242,1548121430.1067,Gillian,"These are the originals:
```(defn insert-right
  [loc item]
    (let [[node {r :r :as path}] loc]
      (if (nil? path)
        (throw (new Exception ""Insert at top""))
        (with-meta [node (assoc path :r (cons item r) :changed? true)] (meta loc)))))

(defn replace
  [loc node]
    (let [[_ path] loc]
      (with-meta [node (assoc path :changed? true)] (meta loc))))```"
242,1548121431.1068,Rosaline,(which I guess you did)
242,1548121466.1074,Gillian,I was just hoping I maybe missed something but it helped talking to you lol; The only reason I didn't want to do it from the parent is because I did not want to go through at worst n many children to find and replace it with two new children
243,1548147775.1096,Raina,What is the easiest way to achieve the following: I want to split the sequence after the element for which a predicate is true.
243,1548147946.1101,Houston,you can use split-with
243,1548147992.1105,Raina,"split with will split before the element; not after; Like suppose you have `[1 11 8 -3 9 33]` and you want `[1 11 8 -3]` and `[9 33]`, based on predicate `neg?`."
243,1548148325.1122,Arlen,Maybe combine split-with with (partition 2 1 ...)
243,1548150041.1128,Houston,Something like (map #(apply concat %1) (partition-all 2  (partition-by neg? [1 11 8 -3 9 33 -5 6 7])))
243,1548150547.113,Raina,yes that's what I ended up with
244,1548166460.1158,Kandra,"I'm facing a very weird problem with `require`. For some reason, when I'm saying `(require my-ns-var :refresh)` the changes are *not* applied to that namespace. I'm pretty confident my logic is solid but I'm just missing some intricate detail about `require` here. Just for reference: this is about reloading changed Garden CSS declarations within my REPL; Problem manifests itself when I have structure main style-ns / page style-ns / component style-ns &lt;- change to last one; I'm requiring the files in correct order, meaning that I first require namespaces which have no dependencies and from there I progress towards the main style-ns; But for some strange reason those changes are not applied; If however I go and reload those namespace manually within REPL in that same order the changes are applied"
244,1548166880.1181,Jasmine,:refresh is not a thing - you want :reload
244,1548166896.1184,Kandra,Ah sorry about that. Using :reload; So as much as I would have hoped that would have been my problem but alas it isn't :disappointed:
244,1548166929.119,Jasmine,:); you could also try :reload-all (which also reloads dependent namespaces)
244,1548167004.1202,Kandra,"Yeah, tried that. Only thing that changes is the CSS compilation time since requiring takes more time. No help; I'm just using normal Clojure vars here, nothing special really"
244,1548167049.1215,Jasmine,"I don’t know anything about garden, but state has to live somewhere, typically in a var, so I’d investigate where Garden state is getting cached"
244,1548167053.1217,Kandra,`def`s referring to other `def`s; Garden just takes a bunch of Clojure data structures in and spits out a string of CSS; I've debugged this so far that the actual data structures do not update; So the bug happens way before Garden steps into play; But apparently I'm not missing something special require magic here that I should be aware of
244,1548167227.1235,Jasmine,not much other magic to know
244,1548167255.1241,Kandra,Yeah. I actually also tried to use `remove-ns` before requiring but that proved to cause all kinds of nasty problems
244,1548167320.1248,Jasmine,other places where state hides in the runtime are in multimethods (dispatch table) and protocols
244,1548167349.1253,Kandra,"I'm wondering if I'm hitting garbage collection somehow; Meaning, my old vars are left dangling and old references are still there for some reason"
244,1548167375.126,Jasmine,doubt it
244,1548167401.1264,Kandra,"It's really strange since if I go and reload all namespace in order manually it works; But not if I do the same via require; (manually meaning via Cursive ""load namespace""); Ahem... Ok. Got it working.; Now using :reload-all; AND; I restarted my REPL...; Still confused what caused all this; I had tried restarting my REPL previously; I really need to dig in deeper into this at some point but I've wasted too much time already; Thanks for ideas!"
245,1548170755.1303,Gigi,"Hi! I’ve encountered an issue when a protocol is reloaded causing the implementing objects to no longer `satisfies?` the protocol.

Example:
```
(defprotocol A (foo [_]))
(def a (reify A (foo [_])))

(prn (satisfies? A a))        ;; =&gt; true
(defprotocol A (foo [_]))
(prn (satisfies? A a))        ;; =&gt; false
```

Is there any way to specify that the protocol object should not be recreated when reloading namespaces? Sort of like `defonce` does"
245,1548170758.1304,Karena,looks like something that <https://clojuredocs.org/clojure.core/split-with> could be useful for
245,1548171498.1309,Jasmine,"In short, no"
245,1548171758.1314,Clarine,"but you can wrap it in a defonce:
```
(defonce do-once (defprotocol ...))
```"
246,1548174402.1357,Gigi,"Thanks for your answers :slightly_smiling_face: It looks like this wasn't the cause of the problem after all, the protocol is only loaded once. The object that implements the protocol is loaded twice – why that would break things is very mysterious :man-shrugging: _edit: &lt;--- I now realize this doesn't make that much sense in the context of my example, sorry :sweat_smile:_"
245,1548176753.1373,Rosaline,"my guess would be you are aot compiling and somewhere you are importing the class created by a defrecord without requiring the namespace that defines it, so the import is loading the old aot compiled version"
245,1548177387.139,Gigi,"I think you are onto something with regards to aot. I will post the minimum code that breaks `lein uberjar` in thread.; ```
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; In protocol namespace
(ns protocol)

(defprotocol A
  (foo [_]))


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; In implementation namespace
(ns implementation
  (:require [protocol :as proto]))

(def a
  (reify proto/A
    (foo [_] "":)"")))

(println ""I get printed twice!"")
(assert (satisfies? proto/A a) ""I fail the second time"")                        


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;; In our core namespace
(ns core
  (:require [implementation]))
```; But this works fine in a fresh project though, so it must be something that's configured in my company's project"
245,1548177508.1395,Rosaline,what are you doing when it fails? running tests?
245,1548177519.1397,Gigi,Running `lein uberjar` (compiling)
245,1548177582.14,Rosaline,"if you see that printed twice, I would look for a require with :reload or :reload-all"
245,1548177837.1402,Gigi,"There are no `:reload`s or `:reload-all`s in our project; Using `defonce` instead of `def` fixes it:
```
(defonce a
  (reify proto/A
    (foo [_] "":)"")))
```"
245,1548178027.1406,Rosaline,"it gets rid of the symptom, but there is still something wrong somewhere; when was the last time you ran lein clean?"
245,1548178143.1411,Gigi,"Unsure, but this happens when building the app on AWS as well. I'll try to do a `lein clean` before `uberjar` locally just in case
_update: same error_"
245,1548178353.1416,Rosaline,do you have a user.clj or some plugin or something that loads your code?
245,1548178566.1418,Gigi,"We do have `user.clj` and we use `ring.middleware.reload/wrap-reload`, but these should only be enabled in dev"
245,1548178612.142,Rosaline,"I bet one of those is the issue; aot compilation *must* load the code, so if you load it first, then ask it to be compiled you will end up loading it twice (which breaks things)"
245,1548178907.1424,Gigi,"That makes a lot of sense. Thanks :slightly_smiling_face: I will have to look more into this tomorrow as it is getting late.; I have a good feeling about looking into the aot stuff, thanks again!"
247,1548189275.1434,Bart,"hm. is there some kind of practical difference between `seq` and `lazyseq` that i'm missing?; sorry, `lazy-seq`. to me it looks like they're basically equivalent"
248,1548189829.1443,Becki,they aren't similar much at all. check out the examples on <https://www.conj.io/store/v1/org.clojure/clojure/1.9.0/clj/clojure.core/lazy-seq>
248,1548190999.1454,Rosaline,"seq is for consuming seqs from things that are seq'able, lazy-seq is for constructing lazy seqs recursively"
248,1548191913.1458,Lee,"Thanks for your explanation, it helps!
(Honestly, I thought that type inference is capable of determining the correct type in many cases, e.g. in the case of getd2's return type, and Clojure does it IF it is ""hinted"" to do so: I thought that once I type hinted something, Clojure respects the explicit intention and avoids reflection in all cases where it can, based on the hint I gave. I understood the <http://clojure.org|clojure.org> reference (linked previously) in this way too. After the answers I got here I tend to suspect that Rich H. doesn't want to encourage the usage of type hinting, so limits its capabilities.)"
247,1548192543.146,Celestine,"Yeah, real world Clojure can get a lot done without type hints -- if you're not worried about the performance of reflection, you almost _never_ need type hints. If you decide to worry about performance due to reflection, it's still most often surprising just how few type hints you really need -- and they tend to be very localized, which I really appreciate."
249,1548193005.1462,Lee,"I agree, I never needed type hints, I ""decided to worry about it"" :)) just because I am working on a free sw whose usage I don't want to hinder by possible performance bottle necks. I found also that very few type hints were enough to eliminate all reflections -- just I didn't understand why exactly those type hints are needed / why exactly there... And the reference doc didn't help me here."
247,1548201385.1482,Alix,"Do any libraries exist where I can do collection transformations like (map, filter, reverse, rest, ect) but it keeps the type of collection; I know about `mapv` and `filterv` but more would be awesome."
247,1548201457.1493,Becki,that sounds like one of the core tenants of specter; <https://github.com/nathanmarz/specter>
247,1548201559.1508,Alix,I was thinking more of a library with heaps of sequence functions that would instead return vectors for example.
247,1548201584.1517,Dann,"for clojure's built in datatypes other than seq, you can use `(into (empty coll) (filter f) coll)` etc.; or if you just want to pick a specific result type: `(into [] (map f) coll)` etc."
247,1548201680.1529,Alix,<@Dann> I've also been using `vec` quite a bit.
247,1548201704.154,Dann,"the difference here is into doesn't need to build a lazy-seq, as it uses the transducing arity of the collection functions; and it can use `#{}` or `clojure.lang.PersistentQueue/EMPTY` or `{}` instead of `[]`"
247,1548201737.155,Rosaline,why do you need vectors?
247,1548201757.1556,Alix,A have dynamic tabular data; I don't know how many rows or columns I might have; So I'm accessing cells in this data by x and y index
247,1548201853.1581,Rosaline,"in broad strokes, lazy seqs can to some extent amortize the cost of traversals by being lazy so maybe you do a bunch of mapping opperations and only force them at the end, if you always concretely constructing vectors you lose that"
247,1548201887.1588,Alix,So I should probably just convert to vec in the final step?; Or can I avoid vectors entirely here?
247,1548201903.1598,Dann,it depends on the operations you are doing
247,1548201904.1599,Rosaline,"hard to say; I might look at another representation too, maybe `{[x y] data}`, depending on what operations you are doing; if you can describe your transformations as a transducer you pass to into, that is even better than lazy seqs"
250,1548202192.1643,Matha,"Hello! Quick q: is there a nice way in clojure to do a few `if-let` / `if` / `let` in a row (nested), but have them all branch out to the same fallback? For example when signing in a user you might want to fetch a user account (`if-let`), then check the password, etc, but if at any point the condition fails you want to branch out to some error message"
247,1548202258.1651,Celestine,"<@Matha> If none of the ""success"" expressions can produce `nil`, you can always wrap the whole in `(or ... (my-fall-back))`; (and use `when`/`when-let`); Also, I'd say that if you have a long enough chain of conditionals, you probably need to refactor it into smaller functions anyway (which then become a bit easier to chain together with `or` :slightly_smiling_face: ); (or threading or whatever)"
247,1548202980.1677,Yoko,<@Matha> hi. try these two different macros
250,1548202992.1679,Yoko,None
251,1548207110.169,Matha,Thank you!
252,1548209235.1698,Belle,"Can someone help me decipher one of the new clojure error messages? It’s this: ```{:type clojure.lang.Compiler$CompilerException
   :message Syntax error compiling at (plus_one_api/server.clj:38:1).
   :data #:clojure.error{:phase :compile-syntax-check, :line 38, :column 1, :source plus_one_api/server.clj}
   :at [clojure.lang.Compiler load Compiler.java 7647]}
  {:type java.lang.ClassNotFoundException
   :message clojure.spec
   :at [java.net.URLClassLoader findClass URLClassLoader.java 466]}]
 :trace```; Does this mean that `clojure.spec` is missing? I looked at line 38 in server.clj, and it is a comment. Not a spec related comment"
252,1548209300.1709,Diamond,"You might have a look at a library I’ve been working on which has pattern matcher designed to make this sort of thing easier to read without sacrificing (much) performance :point_right: <https://github.com/noprompt/meander>
```
(require '[meander.match.alpha :as r.match])

(defn find-password [data]
  (r.match/find data
    ;; Only binds ?password if data contains a :user key which points
    ;; to a map that has a :password key points to a string.
    {:user {:password (pred string? ?password)}}
    [:okay ?password]

    ?_
    [:nope]))

(find-password {:user {:password ""password""}})
;; =&gt; 
[:okay ""password""]

(find-password {:user {:password :wrong}})
;; =&gt; 
[:nope]

(find-password {:user {}})
;; =&gt; 
[:nope]

(find-password {})
;; =&gt; 
[:nope]
```"
252,1548209309.1714,Belle,This is a brand new Vase application
252,1548209457.1722,Diamond,"Sorry! I just Spectered the channel and didn’t mean to. :sob:; Err, jQueried it.; Please don’t send me hate mail. :laughing:"
253,1548213696.1733,Otelia,"meander looks really awesome, i intend to find some time to try it soon"
253,1548213953.175,Latonya,"<@Belle> Is there any mention of the Java class java.net.URLClassLoader and/or the method findClass in that file?  If so, note that findClass is a method, not a class.  If there is an import statement that contains ""java.net.URLClassLoader findClass"", perhaps it should be changed to ""<http://java.net|java.net> URLClassLoader""; The exception is a ClassNotFoundException, and since findClass is a method name, not a class name, that led to my questions above."
254,1548219067.176,Anisha,"hello, i am using kafka consumer in clojure and i keep seeing tons of these logs printed to screen:

 `DEBUG org.apache.kafka.clients.consumer.internals.ConsumerCoordinator - Group some-group committed offset 8 for partition test-0`
there are thousands of these, any one know how to turn them off?; settings i've tried:

`log4j.properties` in `resources` folder
```log4j.rootLogger=INFO
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.target=System.out
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=[%d] %p %m (%c)%n

log4j.logger.org.apache.kafka.streams=WARN
log4j.additivity.org.apache.kafka.streams=false```

also
```(set-logger! :level :warn
             :additivity false
             :pattern ""%p - %m%n""
             :filter (constantly true))```; i was able to solve this by adding a logback.xml file to my project"
255,1548220686.1777,Belle,Nothing I found. Did clojure.spec exist under a different name at some point? Is this a version issue?
253,1548222219.1782,Latonya,"I do not see any mention of clojure.spec, or anything that I know to be related to clojure.spec, in the error messages you sent.  What makes you believe it has something to do with clojure.spec?"
256,1548251188.1862,Leatha,"This might be stupid question but is there a way to process huge binary files/streams lazily? or partially ? or in chunks? and to save those parts/chunks to a file until stream is empty?

I need to save big binary data to a file system without realizing whole stream in memory/heap.

What i imagine is i have a reference to big input stream in java which i will use in clojure code as input stream which will take lets say
50mb &gt; save to file
take another 50 &gt; save to file
do this until stream is empty

i am doing this `(<http://clojure.java.io/copy|clojure.java.io/copy> input (java.io.FileOutputStream. (.getAbsolutePath tmp-file)))` but i am not sure if it's what i am looking for"
256,1548251789.1868,Jasmine,"the Java channel APIs are probably the most efficient way to do stuff like this - I’d just google up the best way to do it in Java, and then do the same via interop"
257,1548255086.1874,Cherise,"Does not short-circuit; ```
user=&gt; (some-nil [nil false (throw (Exception. ""no""))])
Exception no  user/eval149 (NO_SOURCE_FILE:7)
```"
258,1548256943.1883,Sixta,"I think it copy does what you want, in 2mb chunks. It's pretty efficient. "
257,1548257462.1885,Cherise,What problem are you trying to solve that you need this type of logical operator?
257,1548257595.1888,Clarine,"Suppose you’re reading a configuration option where false is a valid option. Then you could have:
`(or* (read-from-env …) (read-from-java-opts …) (read-from-file …) (throw. (Exception. ""no option provided"")))`
It’s no problem to write this macro myself, but I already solved it another way"
257,1548257659.189,Cherise,Ah I see
259,1548261630.1901,Matha,"By the way, was this feature simply not supported in v1? (1.0.5). (dynamic classes)"
260,1548262797.191,Clarine,Could the persistent data structures in Clojure be made as performant in idiomatic Clojure instead of Java?
257,1548263097.1913,Rosaline,<https://mobile.twitter.com/datomic_team/status/1088117920918577153>
260,1548263204.1917,Clarine,"yeah, that’s why I’m wondering :slightly_smiling_face:; why does pop throw for empty collections, but not for an empty queue?; <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/PersistentQueue.java#L106>"
261,1548265364.1943,Matha,<@Angila> ^
261,1548266048.1962,Darci,"Hmmm, don't see a more specific channel, so asking here. Has anyone used bidi <https://github.com/juxt/bidi> with http-kit? The claim is it is compatible with http-kit, but not sure how to use it via `http-kit/run-server`"
262,1548266534.1967,Ashlea,<@Darci> might be worth posting in <#C0CFGN25D|juxt>
263,1548267290.198,Brain,"Does anyone know how to correctly escape arguments to `lein` under windows powershell? I've tried variously `lein update-in :dependencies conj ""[nrepl \``""0.5.3\``""]"" -- repl`` and `lein update-in :dependencies conj '[nrepl ""0.5.3""]' -- repl`, but the first just prints the help banner and the latter blows up in the lisp reader claiming 0.5.3 isn't a valid number :slightly_smiling_face:; also I apparently can't escape backticks in slack markdown correctly, so that is compounding the issue..."
264,1548267792.2002,Becki,"if you have emacs and cider, you could jack in in a project and then check the `*Messages*` buffer which will have the lein invocation that CIDER uses. it has some escaped arguments there."
263,1548267826.2009,Brain,"yeah, looked at that already, but it appears that cider is invoking it some other way, to complicate matters :S; unfortunately I want to invoke lein from powershell, rather than from cmd.exe, which I (think) is approximately what is happening.  Either way, cider prints `:dependencies conj ^""[nrepl \^""0.5.3\^""]^""` which is definitely not right"
263,1548268113.2023,Angila,"No, looks like it was a bug that was only recently fixed. Specifically it's only an issue if you use the dot-notation *and* supply another class that's calculated dynamically."
263,1548268662.2025,Fredda,"I believe Rich has intimated in the past that it could be done, but the payoff wasn't clear. FWIW, I believe CLJS's data structures are within an order of magnitude performance of CLJ's and they're implemented in CLJS. Not sure if the performance difference is between js's vm and JVM, or between CLJS and CLJ though."
263,1548269399.2027,Clarine,good point
265,1548269887.2029,Matha,"<@Angila> ah, I see, thank you!"
266,1548273260.2043,Brain,"It seems the batch file works differently and can be sanely escaped. I suspect also that is why emacs works, since it isn't powershell aware iiuc."
267,1548273895.2051,Darci,"Thanks - you were correct, answer given there"
268,1548273985.2054,Leah,we should port clojurescript to graal/truffle and find out
268,1548274032.2057,Clarine,"well, since the code in clojurescript is “pure” clojure, it shouldn’t be too hard to port it to .cljc, so you can run them in the JVM"
268,1548274329.2059,Leah,:thinking_face:; can you recommend a resource about how clojurescript bootstraps itself?
268,1548274884.2063,Clarine,I don’t know that much about it. Personally I would start reading the source code.
268,1548274978.2065,Leah,"yeah, I'm doing that, still can't comprehend how little js there is in the repo, just a handful of boostrap files in <https://github.com/clojure/clojurescript/tree/master/src/main/cljs/cljs>"
268,1548275245.2069,Clarine,here is some emit code: <https://github.com/clojure/clojurescript/blob/master/src/main/clojure/cljs/compiler.cljc#L512>
268,1548275271.2072,Leah,"i see, that's all happening in <https://github.com/clojure/clojurescript/blob/master/src/main/cljs/cljs/core.cljs>; the `js*` calls i mean"
268,1548275340.2079,Clarine,I was wrong about that probably
268,1548275505.2082,Leah,"but the emit link is helpful.  I had searched for this without success a few times, thanks!"
269,1548277967.2084,Fredda,"Well, cljs's persistent data structures are built on js's arrays, which are pretty semantically close to java's imo. So it shouldn't be too hard to port them over"
270,1548288432.2095,Jina,`(take 100 (sort-by :timestamp &gt; @nf-chat-messages))` what am i doing wrong to get a null pointer exception o.o
270,1548288692.2101,Celestine,<@Jina> sounds like `:timestamp` is missing from one of those messages…; try `(every? :timestamp @nf-chat-messages)` and see whether it’s truthy — I bet it’s not.
271,1548300683.2133,Ronald,"Hi all,

By my understanding of <https://clojure.org/reference/reader>, `.1` should not be a valid identifier, since it is not an available symbol (""Symbols beginning or ending with '.' are reserved by Clojure""). And yet in my REPL:

```
user=&gt; .1

CompilerException java.lang.RuntimeException: Unable to resolve symbol: .1 in this context, compiling:(null:0:0) 
user=&gt; (def .1 0)
#'user/.1
user=&gt; .1
0
```; Am I misunderstanding the description of a symbol?"
271,1548301755.2146,Rosaline,"""reserved"" means you shouldn't use them, it doesn't mean clojure always cares if you do"
272,1548302742.2148,Jasmine,"in this case, I definitely would not"
271,1548303619.2159,Ronald,"Ah I see, I interpreted ""reserved"" as ""invalid as an identifier"", but that makes sense. Thanks!; And yes, I wouldn't define `.1` as anything unless you're in a Clojure obfuscation competition :sweat_smile:"
273,1548307513.2175,Diamond,Seems like the ~language~ wording could just be improved to say exactly what <@Rosaline> is said and leave no interpretation  up to the reader.
273,1548307691.22,Celestine,"<@Diamond> It’s common for languages to define a set of “reserved by &lt;the language&gt;” symbols — without giving more meaning than that.; Java does it, C/C++ both do it…"
273,1548307734.2212,Diamond,"But in those cases the symbols are reserved because they’re keywords.; The real reason why you *shouldn’t* define a symbol that leads with a dot in Clojure has everything to do with the how the reader reads list forms that have a symbol which leads with a dot.; ```
(def .a (fn [] 1))

.a
;; =&gt; 
#function[scratch/-DOT-a]

(.a)
;; Malformed member expression, expecting (.member target ...)
```"
273,1548307863.2238,Celestine,"No, in many languages, certain characters in certain positions are “reserved” — and may or may not work, and may change their meaning in the future."
273,1548307956.2254,Diamond,"Okay, sure, I’ll buy that. JavaScript is like that. But my point is regardless of who’s saying it, it’s still unclear."
273,1548307984.2262,Celestine,It’s got a very specific meaning in language definitions tho’…
273,1548307997.2267,Diamond,No.
273,1548308019.2278,Celestine,"It’s like in Standards, where unspecified/undefined/implementation-defined terms are used."
273,1548308027.2281,Diamond,The fact we’re having this discussion proves there’s a misunderstanding and that the language is not clear because it can be misinterpreted.
273,1548308028.2282,Celestine,(and shall/should/may/must)
273,1548308053.2287,Diamond,Right. But! In those cases the terms are defined up front.; And they’re defined up front for that very reason.
273,1548308107.23,Celestine,"Well, Clojure doesn’t have a “standard”, even tho’ it uses common standard words in its description."
273,1548308122.2302,Diamond,"Ha!; There’s a big difference between well defined and, well, defined.; :slightly_smiling_face:"
273,1548308166.2314,Celestine,"“Well, actually” :slightly_smiling_face:"
273,1548308169.2316,Diamond,:smile:; It doesn’t seem like defining terms up front would be a bad idea though. It’s useful.
273,1548308271.234,Celestine,"True, Clojure could add a Glossary… if it doesn’t already have one…"
273,1548308284.2343,Diamond,It’s a problem in software engineering in general.; Having to be clear is no fun. :slightly_smiling_face:
273,1548308483.2366,Celestine,"Having spent eight years on the ANSI C++ Standards Committee, I can assure you that “being clear” can seem overrated :slightly_smiling_face:"
273,1548308486.2367,Diamond,Back to the case with the reader though; it would be helpful to explain _why_ it’s reserved.
273,1548308514.2378,Celestine,All it could say is “reserved for future use”…
273,1548308522.2381,Diamond,"Or, at least, in that context, what “reserved” means.; The example I provided above is a good illustration."
273,1548308525.2383,Celestine,"That’s what “reserved” means.; It may work now, it may not. Even if it works now, it may not work in the future."
273,1548308556.2394,Diamond,I’m sure it has it’s drawback but we shouldn’t throw the baby out with the bath water.
273,1548308576.2403,Celestine,It may partially work (as the `.1` examples above show) or not at all or it may launch missiles :slightly_smiling_face:
273,1548308576.2404,Diamond,Specs and clear language are really useful.
273,1548308615.2411,Celestine,Would you be happier if it said “symbols beginning or ending with `.` have undefined behavior”?
273,1548308644.2417,Diamond,No. Because that would be lying. It has precisely defined behavior.; It’s precisely defined in the reader.
273,1548308710.2437,Celestine,I don’t know that you could accurately write down the situations under which `.a` would behave in every possible way tho’…; (and I don’t know that such a description would be _useful_ even if it were accurate)
273,1548308770.2456,Diamond,"Well, I suppose, if Rich decided that it’d be worth checking if the symbol can be resolved before treating it as a method call… we could say something along the lines of “this is it’s definition now”."
273,1548308792.2462,Celestine,"And the problem with writing it down is that then if the behavior changes accidentally in some situation in the future, the description may no longer be accurate — whereas “reserved” imparts no specific meaning and _would not be rendered inaccurate_ by such changes.; Clojure has a long history of only specifying partial behaviors — and leaving implicitly undefined a lot of behavior. In order to allow the implementation to change/improve and only be bound by the explicitly defined partial behaviors.; `clojure.set` is the classic example — the functions are defined for inputs that are sets. If you give them non-sets, you still get results, but they’re not specified by the docstrings — and could change whenever the implementation gets improved.; There are extremely good reasons in language design — and language specification — for _not specifying the behavior_ of a certain set of constructs."
273,1548308982.2509,Diamond,I’m not sure if that’s a good argument. Maybe I’m reading this wrong but are you suggesting deliberate usage of vague language?
273,1548309010.2519,Celestine,"No, I’m saying _undefined_ or _unspecified_ behavior is a valuable — and extremely common — part of language specification.; Those are _not_ “vague” terms."
273,1548309167.2548,Diamond,"Eh, I mean you could say that but in this case I don’t think there’s a lot of room for symbols that lead with a dot to do much else besides be resolved to vars.; I do think it’s better than “reserved”, however, I’ll give you that.; Regarding intentional partial behavior, I think it’s fine _up to_ not being open about it. That `clojure.set` does not tell someone up front that, hey, if you give me non-map stuff I can’t promise you it’s gonna work, is borderline dishonest."
273,1548309610.2606,Celestine,I think we’re just going to disagree.
273,1548309645.2618,Diamond,I’m not sure we’re in disagreement. I’m agreeing with you that “undefined” is superior to “reserved”.
273,1548309666.2625,Celestine,"For me, with a lot of background in language design and specification, what the Clojure reader page says about `.a` / `a.` etc is perfectly clear and reasonable.; The same goes for `clojure.set`.; It defines the behavior for specific inputs.; It therefore does not define the behavior for other inputs."
273,1548309717.2644,Diamond,"Sean, I have a lot of experience with language design and specification as well.; But, Sean, there’s no disclaimer on the namespace that says “GIGO for non-maps”."
273,1548309794.2661,Celestine,There does not need to be.
273,1548309800.2664,Diamond,And that’s the problem.; Many people think there should be such a disclaimer
273,1548309823.2673,Celestine,Many people are wrong :slightly_smiling_face:
273,1548309832.2676,Diamond,"I’ve been working with Clojure personally and professional for nearly 6 years and I’m one of those people.; I’ve seen people burned by that, by `merge`, and countless other so-call “GIGO” functions,; it’s punishment."
273,1548309882.2692,Celestine,"This is why I said we’re just going to disagree.; If the docstring says “Given A, the function does B / produces C” then you cannot expect any given behavior if you give it “non-A” as input."
273,1548309923.2708,Diamond,What are you disagreeing with?
273,1548309981.2725,Celestine,"Now, if you give it A and you don’t get C, then that’s a bug. But if you give it X and get C, that’s should not be unexpected.; If you give it X and get Y, that should not be unexpected either."
273,1548310058.2742,Diamond,"It’s still not clear to me why omitting the fact the functions _will_ accept non-set input and have undefined behavior.; We both agree that’s useful language, no?"
273,1548310107.2755,Celestine,"It’s superfluous. If the behavior is (only) defined for set input _then it is implicitly not defined for non-set input_.; Given that Rich and several other Clojure/core folks seem to abide by that line of thinking — and it’s common across many language definitions (both ANSI and otherwise) — I’m not sure why folks think the docstring will (or indeed should) change…?; Rich, in particular, is against over-specification — he’s said as much many times in his talks."
273,1548310229.28,Wai,This is fascinating. Is there a longer text anywhere on the design choice to have easily accessible undefined behaviors to such an extent in the language?
273,1548310230.2801,Diamond,Well you can’t be Clojure/core if you disagree with Rich.
273,1548310272.2817,Celestine,(I’m certainly not Clojure/core but given my background I tend to agree with him on a lot of stuff — not _everything_ but a lot :slightly_smiling_face: )
273,1548310322.2827,Diamond,And it’s not “over-specification” it’s just being clear about what you’re leaving operations on unexpected inputs undefined.; You can still do the whole GIGO thing while sparing everyone that’s ever used and will use Clojure the cost of having that WTF? conversation that inevitably crops up when “weird stuff” happens like `merge`ing two vectors.
273,1548310456.2851,Celestine,"Like I say, we’re just going to disagree on this. I think it’s perfectly clear.; <@Wai> I had hoped it might be referenced here <https://gist.github.com/reborg/dc8b0c96c397a56668905e2767fd697f> but it seems not (at least, not yet).; Perhaps this should be added to <https://clojure.org/guides/faq> somewhere? But I bet people would still complain that the _docstrings_ didn’t also include that same text… :neutral_face:"
273,1548310578.2873,Diamond,It’s par for the course for folks like me who have a differing view than that of Clojure/core et all to be marginalized.; We’re entitled!
273,1548310630.2889,Celestine,You’re not being marginalized. We’re just disagreeing.
273,1548310688.2899,Diamond,I’m fairly sure that if I submitted a patch to `clojure.set` which added to the docstring a disclaimer about undefined behavior for non-inputs it’d be given a pass.; Could be speculating though.
273,1548310705.2905,Celestine,Correct. Because Rich has explained his stance on that several times.; He is under no obligation to accept every patch nor even explain why he won’t.
273,1548310734.2916,Diamond,"Well, yeah, it’s his language."
273,1548310739.292,Celestine,"In that particular case, he has explained _repeatedly_ why he won’t.; I’ve asked for stuff in the past and he’s shot me down too. I don’t feel marginalized. I just accept he and I have different viewpoints on some things."
273,1548310792.2949,Diamond,"It doesn’t seem like a reason though. Like, there’s nothing, literally nothing wrong with explaining that `clojure.set` has undefined behavior in the docstring. Zero."
273,1548310820.2963,Celestine,I’ve explained above why adding that sort of stuff is pointless (from the project’s p.o.v.).; You just don’t agree.; And that’s fine. We don’t all have to agree. But sometimes we need to _accept_ that folks don’t agree.
273,1548310867.2979,Diamond,"I don’t because I’ve been a party to so much buggy Clojure code and long debugging sessions.; If it was a one of thing that happened once in a while, I’d be more likely to agree with you."
273,1548310959.301,Celestine,"I’ve had Clojure in production for almost eight years now. I’ve hardly ever run across “buggy Clojure code” in Clojure itself, nor much in most libraries to be honest. Bugs in _my_ code, sure. And very few _long_ debugging sessions. But, yeah, sometimes I chase my tail for longer than I’d like — because I did something wrong.; We’ve run prerelease builds of Clojure in production nearly all that time, from an alpha of 1.3 up to date."
273,1548311061.3036,Diamond,"Well, Sean, that’s a nice anecdote and I’m happy for you but at virtually every company I’ve worked at that’s used Clojure I’ve seen the issues that people bring up.; The stance to not put in a disclaimer because “it’s pointless” is void of any kind of compassion. But, again, we’re not entitled to compassion.; I remember having similar discussions about the horrible error messages years ago and being effectively told that it was _my_ problem.; We’re getting better error messages now so maybe, given a few more years, we might see some willingness to at least hear out these people (like me) who’d like to see some more transparency in the docstrings."
273,1548311685.3124,Colette,"idk, it’s pretty standard with ‘undocumented’ undefined behaviour. c++ comes to mind as notorious for this. you document your domains and co-domains, not everything that’s unsupported. Adding a docstring just add noise. For examples and other info refer to some 3rd party resource. Like <http://clojuredocs.org|clojuredocs.org> for example"
273,1548311783.3136,Diamond,So this phrase “it’s standard” seems like it’s a synonym for “that’s tradition”.; Kinda like bad error messages. They’ve always sucked and they’re gonna stay that way.
273,1548311803.3145,Celestine,"Well, in C++’s case, it’s literally “Standard” — as in ANSI/ISO :slightly_smiling_face:"
274,1548311823.3149,Colette,well there are plenty of good reasons why it’s standard; checking inputs cost cycles for one
273,1548311843.3159,Diamond,"Yeah, I’m not saying there should be checks.; I said the GIGO (garbage in garbage out) is fine.; I’m on board with domain/codomain as well."
273,1548311907.3183,Celestine,"OK, here’s a question then ```clojure.core/+
([] [x] [x y] [x y &amp; more])
  Returns the sum of nums. (+) returns 0. Does not auto-promote
  longs, will throw on overflow. See also: +'
``` The docstring does not define the behavior of `(+ 'a :b ""c"")` — do you think it should?"
273,1548311938.3189,Diamond,"That thing throws if you give it anything other than numbers.; So, right there, you’re analogy is missing the point."
273,1548311957.3198,Celestine,The docstring does not say that.
273,1548311964.3202,Diamond,Set will take non-set inputs and _not_ throw.
273,1548311973.3206,Celestine,It could do _anything_ if you give it non-numbers.
273,1548311982.3208,Diamond,:neutral_face:
273,1548312042.3212,Celestine,That is _exactly_ my point.; You “know” that giving `+` anything but numbers will throw an exception — but it doesn’t say that.; It could quite happily give you any result — or spin off into infinity — and still satisfy its docstring.
273,1548312103.3232,Diamond,"No, no, no. That is *not* analogous."
273,1548312117.3236,Celestine,"Again then, we’re going to disagree."
273,1548312128.3239,Diamond,`clojure.core/merge` and `clojure.set/union` would be good analogies.; Both will accept inputs that have undefined behavior for their outputs and not throw.; `+` on the other can surely receive invalid inputs but will throw given them.
273,1548312194.3259,Celestine,But their docstrings do not specify the behavior for non-maps / non-sets. That’s exactly the same as `+` not specifying the behavior for non-nums.
273,1548312240.3268,Diamond,"My point is that because they do not throw, those functions _should_ explain they have undefined behavior for unexpected input types.; `+` doesn’t need to because it will throw.; The error will tell you that you did something wrong."
273,1548312281.3286,Colette,why would you not assume everything has undefined behaviour for unexpected input?
273,1548312286.3288,Celestine,"Exactly.; ```(! 1374)-&gt; node
&gt; 1 + ""s""
'1s'
&gt; 1 + []
'1'
&gt; [] + {}
'[object Object]'
&gt; 
``` I don’t even know where to begin to explain that…"
273,1548312347.3302,Diamond,"Well, most people would assume the function would throw for bad input but that’s not “the way” for the reasons Sean mentioned above."
273,1548312380.3316,Celestine,“most people would assume the function would throw for bad input” — disagree.; Anecdotal at best.
273,1548312388.3323,Colette,<@Celestine> now try `{} + []`
273,1548312423.3342,Celestine,"<@Colette> Yeah, I know… JavaScript has a lot of weird behavior :slightly_smiling_face:"
273,1548312425.3346,Colette,"your examples make sense, that one does not"
273,1548312436.3353,Diamond,It also has a spec that tells you about it too.
273,1548312437.3354,Celestine,(for the curious `{} + []` produces `0`)
273,1548312451.3356,Diamond,jsfuck ftw! :slightly_smiling_face:
273,1548312526.3364,Celestine,<https://www.ecma-international.org/ecma-262/9.0/index.html#sec-addition-operator-plus>
273,1548312581.3373,Diamond,Yep. Tells you _exactly_ what it’s gonna do.
273,1548312615.3384,Celestine,And you think that would be better than Clojure’s docstring for `+`? :slightly_smiling_face:
273,1548312632.3391,Diamond,"Ah but, damn, if they had just decide not to do that they could have reserved the right to do whatever they wanted!"
273,1548312718.3416,Celestine,"To be honest, reading that ECMA spec for `+`, I’m not sure it says what should happen when either operand is neither a number or a string.; It’s pretty clear about num + num and str + str tho’…"
273,1548312777.3438,Colette,well `[]` is analogous to empty string; so `1 + '' == '1'`
273,1548312801.3451,Celestine,"(in particular, it doesn’t give any indication that swapping the left and right args gives different behavior)"
273,1548312842.3463,Colette,"and `{}` cant evaluate to a number, so it’s cast to it’s string representation which is ‘[Object object]’"
273,1548312901.3482,Wai,"Hmm. Undefined behavior is undefined by definition, ie the doc string definition. It is not immediately obvious why that information is kept as programmatically unactionable text. Had it been structured the reader/compiler/runtime could have used the same information (“-flagtomakeundefinedcallsthrowexceptions”). Is it a strength to keep the knowledge of what is undefined as docstrings (that are practically required reading)."
273,1548312994.3508,Celestine,"<@Colette> The spec says GetValue -&gt; ToPrimitive on both args and if either are strings at that point, then convert both to strings and concatenate them. Else if neither primitive type is string, convert them both to numbers and add them."
273,1548313005.3512,Wai,"Really fascinated by the topic, reading your discussion with interest. Thanks for the thoughtful (and patient) explanations :grinning:"
273,1548313116.3522,Celestine,…and ToNumber {} is well-defined (bizarrely) in 7.1.3
273,1548313125.3524,Colette,yeah but that does not explain the difference between `{} + []` and `[] + {}`
273,1548313145.3529,Diamond,I’ll rephrase my previous remark about “most people”’s expectation to throw as “many people”. Editing that now would be… weird.
273,1548313173.3533,Colette,it must mean that the left argument is evaluated first
273,1548313201.354,Diamond,I’d also accept a clojure spec for `clojure.set` functions and `clojure.core/merge`.
273,1548313237.3549,Colette,gotta go to bed it’s late here :disappointed: goodnight
273,1548313257.3553,Diamond,:wave:
273,1548313259.3554,Celestine,"It seems to be down to the difference between `ToNumber []` and `ToNumber {}` — but right now I am not convinced the spec actually defines the result and so we’re back in unspecified behavior territory (which was my point).; Yeah, my partner’s already gone to bed so I should probably join them…"
273,1548313367.3577,Wai,(I’m just about trying to get kids off to school :sweat_smile:)
273,1548313375.358,Diamond,Fun having this discussion with you <@Celestine>! :slightly_smiling_face:
273,1548313415.359,Celestine,"Heh, I’m always up for discussions about language semantics and standards etc — it’s what I’ve been doing on and off since the early 80's :slightly_smiling_face:"
273,1548313443.3596,Diamond,Maybe one day I’ll be in your shoes saying what you’re saying.; Ha!
273,1548313475.3605,Celestine,Then we’d have nothing to “argue” about :slightly_smiling_face:
273,1548313492.3609,Diamond,I secretly hope not because that’ll mean we’re still telling computers what to do with text. :sob:
273,1548313520.3621,Tammera,"meh, rather have computers be told what to do with text than with speech"
273,1548313527.3625,Celestine,"Could be worse. Could be switches, setting 0's and 1's… I remember doing that in the early 80's! Argh!"
273,1548313543.3631,Tammera,I am pretty sure I will never be comfortable talking to my computer and the thing actually talking back :’)
273,1548313556.3634,Diamond,"I’m going to be sad when I teach my son about the terminal. “Son, this thing’s been around since before I was born.”; <@Tammera> I regifted an Echo Dot because it’s just too creepy for me."
273,1548313628.3654,Tammera,"Yeah, yelling at my computer because my code is crap is one direction only"
273,1548313636.3656,Celestine,"<@Tammera> I must confess that I’m only very slowly getting used to talking to my phone… I still resort to thumb typing, even when just telling it stuff would be faster/easier!; :wave::skin-tone-2: :night_with_stars: :sleeping:"
273,1548313710.3662,Tammera,Good night!
273,1548313714.3664,Diamond,:wave:
273,1548313730.3669,Tammera,"while here in mainland Europe, its just starting to become light :’)"
275,1548319198.3681,Bree,"is there a way to permanently disable the namespace printing behavior? e.g. set `*print-namespace-maps*` to `false` for the whole process; specifically I'm trying to avoid this feature in kaocha test runs, and using `set!` just gives me `""Can't set! *print-namespace-maps* from non-binding thread""`; to answer my own question, I ended up creating my own `testing` macro that generates a call to `clojure.test/testing` that wraps the body in a `binding`. `alter-var-root` didn't seem to work either"
275,1548332911.3718,Doreatha,<@Bree>  You could redefine `print-method` somewhere <https://stackoverflow.com/a/53714036/3680995>
275,1548332986.3721,Bree,:+1:
276,1548344141.374,Meagan,"is anyone using cognitect’s aws-api library?; I’m wondering how I’m supposed to clean up / maintain my AWS client after I have created it; ex I found that just doing
```
(def s3 (aws/client {:api :s3}))
```
apparently creates some sort of long-lived connection that dies after awhile. so my service was working just fine after a deploy, but would eventually stop working :confused:; I could just create a new client every invocation, but I’m now afraid of creating too many of these clients if they do in fact create a connection that hangs around; there doesn’t seem to be any public way of stopping a client after use, either. There’s a `stop` function in the `cognitect.aws.client` namespace, but that’s documented as `""Impl, don't call directly.""`"
277,1548346266.3775,Latonya,"Some unofficial places where these things are expanded on a bit: <http://ClojureDocs.org|ClojureDocs.org> has examples of things that can go wrong if you give non-set args to clojure.set functions, warning about  them in English; This 3rd party library <https://github.com/jafingerhut/funjible> will throw exceptions if you pass non-set args to clojure.set functions, and has been designed as a fairly easy drop-in replacement for clojure.set functions.; <@Clarine> is working on specs for many Clojure functions, including those in clojure.set, over which there are quite a few fine points on what types they should be spec'd to accept: <https://github.com/borkdude/speculative>  as for example on this issue: <https://github.com/borkdude/speculative/issues/161>; I realize that these do not touch on your questions about official doc strings.  There are Clojure JIRA issues about clojure.set functions that are open, and some closed."
277,1548346515.3786,Clarine,There’s also an issue with a proposal to coerce to sets in set functions.
277,1548346580.3788,Latonya,"There are a few very vocal people working on things like this.  11 downloads over 7 years for funjible library, so how much do people really care?  On average, it seems not a lot."
277,1548346588.379,Clarine,"For fun, here are some examples of 4clojure functions that rely on set functions doing the right thing with their input. I changed them to conform with the specs.
<https://github.com/borkdude/coal-mine/commit/5c9a009dc326b0ab598a419777e71a04ab000ccd>"
277,1548346678.3792,Latonya,"Those were solutions written by people using 4clojure to solve its problems, or code that was used to implement the 4clojure site?  I am guessing the former."
277,1548346698.3794,Clarine,"The former, yes. And they work for their problem input and output; But we use this to verify the specs in speculative, so I’m fixing it to not see the same errors every time"
277,1548348470.3812,Diamond,"The small number of funjible downloads alone can’t be used to infer how much people care. For example, I care about the issue yet this is the first time I’ve heard about funjible.

Today is also the first time I’ve heard about speculative; I’m interested. :slightly_smiling_face:

<@Latonya> I noticed you’ve submitted a patch to add some `fdef`s for `clojure.set`. It looks like there’s some potential to get it merged. It would be great to see that happen."
277,1548348529.382,Clarine,Clojure set fdefs are already in speculative; (Typing from mobile )
277,1548348806.3827,Diamond,"<@Clarine> Yes, I noticed that. :slightly_smiling_face:; (Not that you were typing from mobile.)"
277,1548349575.3835,Clarine,"oh, you did not mean a patch for speculative but clojure.core?"
277,1548349610.3837,Diamond,<@Clarine> Yeah. Rereading my reply I can see the ambiguity.
277,1548350983.3839,Latonya,I am sharing this info with you <@Diamond> since you seem to be one of the few who care :slightly_smiling_face:
277,1548351006.3841,Clarine,A cult within a cult
277,1548351014.3843,Diamond,"It’s appreciated, for sure. :slightly_smiling_face:"
277,1548351063.3845,Latonya,"I could advertise the existence of funjible once per month, even if it doesn't change, but I think the Clojure Google group and/or announcements channel on Slack would quickly get tired of the repetition.; The existence of popular libraries with lots of common use cases are advertised by those other than their authors :slightly_smiling_face:"
277,1548351148.3849,Clarine,it’s surprising how infrequently I’ve been bitten by the current behavior of clojure.set; given the examples of what could go wrong
277,1548351210.3854,Diamond,"Once you’re burned you don’t forget.; Like `merge`. A few weeks ago I helped debug a situation where `(merge-with merge ,,,)` caused a bug that took, let’s just say, a non-zero amount of time to get to the bottom of."
277,1548351323.386,Clarine,speculative chooses to only allow maps as args of merge.; don’t know if that issue had to do with that
277,1548351497.3864,Diamond,That aligns with my intuitions and I think others’ as well. I’ve never heard anyone say they wanted to use `merge` as a substitute for `conj`.
277,1548351520.3866,Clarine,"that’s what I see a lot in the 4clojure solutions I test speculative with. merge -&gt; conj; it isn’t based on intuition though. first we had associative? but if you look closely at the implementation, a `{}` is substituted for a non-truthy first argument"
277,1548351830.387,Diamond,"I realize it’s not based on intuition. What I meant was that people I’ve worked with intuitively expect `merge` to work with maps alone and that, one way or another, for an exception to occur in other circumstances."
278,1548352124.3875,Marlyn,"<@Meagan> I couldn't reproduce that; what do you mean by ""long-lived connection""?; do you see an open socket?"
278,1548352267.3882,Diamond,Vectors are `associative?` :smile:
278,1548353334.3884,Latonya,"I agree that many people would wish an exception to be thrown in situations where you call a function with arguments it is not designed to do something reasonable with, and I am sympathetic with such wishes.  That doesn't mean Clojure core implementation is going to change to align with those wishes.  The options we have, that I know about, anyway, are what I've mentioned above: alternate docs, spec, and things like funjible.  That and perhaps performance measurements of approaches like funjible takes, on serious code bases, that may (or may not) convince Clojure core folks that the costs of the extra checks are acceptable."
278,1548353516.3891,Meagan,I’m honestly not sure. all I know is that my Datomic Ions can’t connect to S3 after a few hours unless I redeploy; it’s hard for me to tell what is actually happening. I got some advice in <#C03RZMDSH|datomic>
278,1548353538.3897,Rosaline,sounds like security credentials expiring
278,1548353551.39,Meagan,:point_up: that makes more sense!
278,1548353641.3916,Rosaline,"depending on how things are deployed and where you are getting credentials from aws, automatically rotates them after some time period (I think most libraries automatically roll over on to the new ones); <https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/credentials.clj#L53> looks like aws-api has some kind of support for that too"
278,1548354004.3926,Matha,Is there a shorter/nicer way to check if a map has no non-nil keys than `(empty? (into {} (filter x)))`?
278,1548354263.3941,Clarine,E.g. <https://dev.clojure.org/jira/browse/CLJ-2433>
278,1548354318.3948,Becki,`(every? (comp some? val) {:a :b :c nil})`
278,1548354324.3951,Dann,`(empty? (filter some? (vals x))` for non-nil values
278,1548354358.3954,Matha,ty!
278,1548354381.3964,Nadia,hmm; “has no non-nil keys” — so check that every value is nil? `(every? nil? (vals my-map))`
278,1548354585.3982,Clarine,"if you want to check the keys, you need `keys` :wink:"
278,1548354609.3988,Dann,for that you just need `(not= [nil] (keys m))`
278,1548354618.399,Nadia,heh yeah
278,1548355034.3995,Matha,<@Nadia> ah yes that’s what I meant; `(every? nil? (vals my-map))` is neat !
279,1548355601.3997,Ciara,added an integration to this channel: <https://clojurians.slack.com/services/BEUS0MAUS|outgoing-webhook>
280,1548358822.4018,Sharee,"Anybody using the Cognitect AWS library with CloudSearch (the cloudsearchdomain service specifically)? You have to supply an endpoint somewhere, but I can’t figure out how. In the JS library, it is part of the constructor - <https://docs.aws.amazon.com/AWSJavaScriptSDK/latest/AWS/CloudSearchDomain.html#constructor-property>. So I would expect it to be sent in the `aws/client` call."
280,1548359063.4035,Marlyn,We have a plan for tackling custom endpoints <@Sharee> . I don't believe it's possible right now.
280,1548359183.4041,Sharee,Thanks. I’ll go back to the old way and keep my eye out for updates.
279,1548360564.4042,Ciara,disabled an integration in this channel: <https://clojurians.slack.com/services/BEUS0MAUS|outgoing-webhook>
281,1548365639.4058,Tammera,"There is no such thing as strengthening your  specs, right. Lets say that I have a map with `::some-ns/a` `::some-ns/b` and `::some-ns/c` keys that _all_ functions promise to be `int?`, but _some_ promise to be `pos-int?`; (obvious simplified example); I basically want to say something like, this function adheres to the weak contract (`int?`), but as an added bonus, also to this stronger one (`pos-int?`) ^^"
281,1548366016.4073,Fredda,doesn't `int?` give you the added bonus of `pos-int?`?
281,1548366201.4094,Tammera,"sorry? I don’t quite understand, `-5` is `int?` but not `pos-int?`. So I would spec something like this right: `(s/def ::some-ns/a int?)` with `(s/def ::some-ns/my-map (s/keys [::some-ns/a]))`. Now I appear to have no way to write a spec for the stronger guarantee for the _same namespaced key_."
281,1548366236.4096,Rosaline,you shouldn't do that; it sounds like you want to add context
281,1548366260.4105,Tammera,"why tho, I am promising you strictly more, I am still adhering to the weaker contract"
281,1548366284.411,Rosaline,"say ""oh, in this context this key is X, and this context the key is Y""; spec removes context, it is all global; the point of spec is to be able to say ""for all maps, with this key, the key means X""; so if you want it to mean Y, add a new key to your map and spec it to be Y; if you want to say ""this key is X and Y"" s/and"
281,1548366408.4141,Tammera,"yeah, but Y implies X in this case. Every `pos-int?` is also an `int?`."
281,1548366433.4147,Rosaline,"then just say ""this key is X"""
281,1548366461.4154,Fredda,"said another way, you want to merge two specs and be allowed to choose the weaker or stronger one?"
281,1548366478.4159,Rosaline,"the issue isn't actually anything to do about ""stronger"" whatever; the issue is you are trying to define the same key to different meanings in different contexts"
281,1548366504.417,Jasmine,you can s/and in stronger criteria in some contexts
281,1548366512.4174,Rosaline,in one context you want it to mean int? but in another context you want pos-int?
281,1548366520.4177,Jasmine,but it’s admittedly pretty annoying to do so under s/keys
281,1548366522.4178,Tammera,"its for function contracts; I have some functions that have stronger guarantees than strictly required by the “global” map spec, so to say"
281,1548366544.4187,Jasmine,you could make a loose contract and a strict contract and combine with s/merge (then it has to satisfy both); but to some degree this is the kind of thing the select stuff will add in spec 2
281,1548366571.4196,Rosaline,you can't do that for the same key though
281,1548366573.4197,Jasmine,that Rich talked about in his keynote
281,1548366582.4201,Tammera,"yeah I watched it, was a bit afraid of that; or --- not :’). Because you guys are obviously thinking about it ^^"
281,1548366733.4209,Rosaline,"you can always and on arbitrary predicates that are not s/keys based, that can do whatever"
281,1548366764.4216,Fredda,that's true
281,1548366771.4218,Rosaline,(s/and (s/keys ...) #(pos-int? (get % :foo)))
281,1548366788.4222,Tammera,"yeah, I ended up doing that, but I wondered whether there was a better way"
282,1548369333.426,Isa,"Can you recommend articles to read about security in the context of integration to third party systems? The best related with Clojure solutions. I mean there is a SaaS, which needs to fetch data from many other systems (auth for this systems is mostly e-mail + password by API and there is no read only). The question is how to secure this things from hacking. I would like to read about good articles about solutions to secure third party systems authentication data."
282,1548369865.4265,Lenore,<https://github.com/funcool/buddy>   <https://www.owasp.org/index.php/Authentication_Cheat_Sheet>
282,1548370158.4269,Isa,I think the main issue is about store this data in DB
282,1548370279.4286,Lenore,"so database security best practices? and consider disk encryption (encrypted vols on aws, bare metal SED SSDs, ..)"
282,1548370285.4288,Isa,Hmm is there any way to outsource this responsibility? Integration with google password storage or similar magic? :wink:
282,1548370292.429,Lenore,auth0?
282,1548370323.4297,Isa,"only if third party system has it, but we are talking about systems, which have e-mail + password to auth"
282,1548370325.4298,Rosaline,sounds kind of like <https://github.com/hashicorp/vault>
282,1548370409.4308,Isa,hmm I was using vault for DevOps. Does it work without any issue for storing third party auth in Saas for users?
282,1548370448.4315,Rosaline,"no idea, I've never used it, it just sounds kind of like what you are describing, a store designed for storing secrets"
282,1548370474.4319,Isa,"yes, it can be on of choice maybe; <https://cloud.google.com/kms/> alternative from google; thanks, Clojure community always make me more creative :slightly_smiling_face: People who think by `(` `)` :wink:"
282,1548370790.4338,Lenore,is that their cloud HSM?
282,1548370879.4344,Isa,"<https://cloud.google.com/hsm/> I see google has something like that, but I am not familiar with that technology. It is also interesting.; Thanks. I am going to sleep. Good night :slightly_smiling_face:"
283,1548377450.4363,Madeleine,"QUESTION: How do you compile only gen-classes ? Like I don't even want to compile the namespace which has the :gen-class in it, but I only want the Java .classes defined by gen-class to be compiled? Using pure Clojure, not with lein."
283,1548377484.4368,Rosaline,you can't
283,1548377518.4373,Madeleine,"I see, so gen-class are kinda infectious then; You quickly devolve into basically full AOT; since compile is transitive"
283,1548377541.4383,Rosaline,there are things you can do; have your namespace with the gen-class require other code at runtime instead of when it is loaded
283,1548377610.4395,Madeleine,Hum; Like by putting a call to `require` inside a function?
283,1548377629.4401,Rosaline,yes
283,1548377632.4403,Madeleine,instead of using ns ?
283,1548377645.4407,Rosaline,"then you will have to manually resolve any vars you want to use; I mean, you still use ns, you just leave out calls to require"
283,1548377703.4414,Madeleine,"Right; Ya, that's a bit annoying; But thanks for the answer"
283,1548377786.4424,Dann,example of a java app that uses ~this~ a related approach (written so I could use the jsvc app launcher without using gen-class) <https://github.com/noisesmith/clj-jsvc-adapter/blob/master/src/java/org/noisesmith/Cljsvc.java>
283,1548377868.4431,Madeleine,"That seems different, you're just avoiding gen-class altogether here, and creating your own Java wrapper no?"
283,1548377898.4438,Dann,"right, but it's doing the same thing: require at runtime, then calling functions that should be made available by the required code; you can do the same thing from an ns that uses gen-class (I started out with that, but with that level of java interop writing a java file was cleaner)"
283,1548378060.4456,Madeleine,"It seems more complicated from Clojure, because then you need to have a flag which on compile does not cause things to be required, but does so otherwise; Where as in Java it is done from static initialization when the class is used; Though I guess the gen-class init could do it; And then it would be similar to what you're doing I guess"
283,1548378216.4478,Rosaline,"the thing is, clojure is live, so compiling the code has the same effects as loading it (because compiling subsequent code made depend on those effects); another thing you can do is just generate the bytecode for the class you want without dealing with the clojure compiler at all"
283,1548378538.45,Dann,"<@Madeleine> the clojure version of that code looked like:
```(ns foo.bar)

(defn -main [&amp; args]
 (require 'baz.quux)
 ((resolve 'baz.quux/-main) args))```; you can add gen-class to that, and it won't load baz.quux while compiling, this is directly analogous to what the java code is doing (just much less idiomatic)"
283,1548384426.4516,Madeleine,"Still could be problematic, if that namespace is also used from Clojure though"
284,1548384619.4539,Madeleine,"Which is why I was thinking something more like:

```
(ns foo.bar)

(when-not *hypothetical-compiling-flag*
  (require '[baz.quux]))
```"
284,1548392757.4548,Becki,wow i've never seen `with-precision` before from core
284,1548406307.4555,Clarine,what’s a good name or an option for a map transformation that’s not recursive? `no-recurse?` We already had a version that did recursion by default.
285,1548406712.4556,Chanelle,what about `linear`?
286,1548407628.4563,Renetta,"Hi guys, is there any way to format code in .clj files with pprint?"
287,1548410064.4567,Peter,"i would stick with `recurse?` without the `no-` because it's not necessary; other than that, it seems like an appropriate name"
287,1548410113.4571,Clarine,"well, we have a convention that options should take nil or false as the default, so I have to invent a name for non-recursive. I’ll probably go with that"
287,1548410136.4573,Peter,"in that case, just stick with `no-recurse?`"
287,1548410138.4575,Clarine,leaving out the option is the same as passing the option with false or nil; yeah
288,1548413299.4587,Raina,"Is there a string length function I can use both in clj and cljs? I can use count, but count is slow and generates ton of garbage"
287,1548413550.4594,Clarine,"<@Raina> this seems to work:
```
(defn str-length [s] #?(:clj (.length ^String s) :cljs (.-length s)))
```"
289,1548414126.4598,Raina,well obviously I can write my own :smile:; I was hoping for an official solution and I'm shocked that clojure.string namespace doesn't have one; hell even substring exists in clojure.core
289,1548418155.4611,Otelia,`count` works for both <@Raina>
290,1548418220.4614,Retha,Why do you think that `count` is slow? And what garbage?
291,1548418347.4635,Twanda,"Hi everyone, I'd like to get compiler warnings when a variable masks another one

So, for example in this case:
```
(let [[name] [""yay""]]
  name)
```
=&gt; warning: name already refers to clojure.core/name

anyone know if there is a way to turn that on, or if there is an open issue for this? If there is I haven't found via googling. thanks"
291,1548418977.4659,Clarine,"not that I know. joker (a linter) also doesn’t warn about this, but I think it could be a useful feature for it"
289,1548419027.4667,Raina,"<@Otelia> As explained, count isn't appropriate because it's slow and generates garbage"
291,1548419144.4675,Twanda,"<@Clarine> thanks, linters are probably the place to start investigating if it's not in the compiler"
292,1548420575.4679,Sixta,I actually quite like being able to shadow 
289,1548420778.468,Otelia,"<@Raina>, you may be thinking of the implementation of count for sequences."
291,1548420834.4683,Clarine,that’s why linters have config :slightly_smiling_face:
289,1548420935.4696,Otelia,"What would be useful to me is an option to only warn about shadowing clojure.core symbols, as in the example."
289,1548421038.4698,Raina,"I've improved performance a lot in some of my libraries by replacing count with explicit .length calls; Looking at the newest 1.10 code of count, directly invoking .length saves about 4 if sentences"
289,1548421180.4703,Retha,I’d say that this only makes sense when you have a real bottle neck.
293,1548422328.4709,Henry,This linter warns about (some cases of) shadowing: <https://github.com/jonase/eastwood>
294,1548424335.4725,Silvia,"Hi. I have an error with my simple module: <https://pastebin.com/bBy8htnT>  error: Exception in thread ""async-dispatch-88"" java.lang.NullPointerException  can anyone tell me why? I've spend on this some time and I really don't know why."
293,1548427196.4739,Henry,"You should check the full stack trace using `(clojure.repl/pst)`, but I can see a couple things wrong with that code. When you're using blocking `&lt;!!` you shouldn't wrap those in go blocks. Also by putting the ""store"" in a global def you're defeating the purpose of mount/defstate."
295,1548431866.4749,Jessia,Am I right in thinking libraries shouldn't include `org.clojure/clojure` as a dependency? Since it's just going to be provided by the application anyway?
295,1548431924.4753,Clarine,"a lot of libraries do it, it can be overriden by the consuming project; unless you’re making a cljs only lib or a Java-facing AOT-compiled lib, it doesn’t matter I guess; or maybe it does when your lib forces a newer version of clojure than the lib consumer wants to user? hmm. not sure how that is resolved"
295,1548432116.4769,Jessia,Thanks <@Clarine>
296,1548435289.4787,Hilary,I've also wondered how this works when multiple dependencies declare dependencies on diff versions of Clojure
297,1548437214.4819,Antione,"In the past, I've usually set the default uncaught exception handler at the top of a -main entrypoint for an application. I am ring uberjar'ing. Will setting the default uncaught exception handler at the top of, say, `server.clj` (the location of the ring handler) accomplish same?; ```
(ns server)
(Thread/setDefaultUncaughtExceptionHandler
 (reify Thread$UncaughtExceptionHandler
   (uncaughtException [_ thread e]
     (log/error e ""Uncaught exception on"" (.getName thread)))))
(def handler ...)
```"
297,1548437753.4831,Dann,"it's a mutable slot on an object, you can set it in any place at any time; top level side effects are run when the ns is loaded (even when using aot)"
297,1548437857.4845,Melissia,"Can I define a mutation over an ident, instead of declaring all the way walking through the tree?"
297,1548438054.4848,Dann,"by ident do you mean symbol or keyword? that's what `clojure.core/ident?` checks for, but if that's what you mean your question confuses me; do you mean a nested update as in `update-in` or `assoc-in` as opposed to a programmatic operation like `clojure.walk/post-walk` ?"
297,1548438686.4879,Melissia,"I mean, if I have a normalized table :people/people-list   and inside it    :person/by-id
Can I use a mutation directly for [:person/by-id 1] or do I have to go into [:people/people-list :my-list :person/by-id 1]"
297,1548438811.4892,Meagan,"<@Melissia> your use of the word “mutation” is confusing. If you are asking how to use `update-in` / `assoc-in` with a map, then yes you’ll have to put the full path; you could come up with your own function that uses clojure.walk to do what you mean, though. Again, assuming you’re using a map"
297,1548438914.4904,Melissia,"Oh, I messed up, I thought I was in the fulcro's slack. I'm sorry"
298,1548438927.4906,Meagan,:smile:
297,1548438942.491,Melissia,Thanks <@Dann> and <@Meagan> anyway
297,1548439058.4918,Somer,"In 1.10, is there a way to extend a map to be `Closeable` via metadata?"
298,1548439163.4925,Meagan,"is that `java.io.Closeable`? I think that’s an interface, not a protocol"
297,1548439209.4933,Somer,Yes. And I suppose a better question would've been: can you extend via metadata with an interface.
298,1548439220.4935,Somer,Sounds like no :slightly_smiling_face:
297,1548439279.4943,Dann,"metadata is a clojure thing - you can check metadata via java by using the clojure IMeta api (or using the Clojure api to call clojure.core/meta) but this isn't something you should expect normal java code to be doing, ever; and it's definitely not something that exists on the level of the Closable interface; you can use `defrecord` to make a hash-map that is also Closable"
297,1548439333.4958,Somer,I ended up doing that.
297,1548439347.4963,Meagan,I think there was a proposal to implement Closeable as a protocol
297,1548439364.4967,Somer,That would be convenient. It's nice to be able to `with-open` things.
297,1548439371.4969,Meagan,<https://dev.clojure.org/jira/browse/CLJ-308>
297,1548439523.4979,Dann,"that's a change to with-open so it can use things that aren't directly java.io.Closable, it doesn't change or extend Closable itself; what's the motivation for not using java.io.Closable - wanting to extend some class from outside the implementation?"
297,1548440040.4993,Somer,I have an API that returns a map and I wanted to use `with-open` in my tests to ensure that parts in that map are closed when the test finishes.
297,1548440224.5009,Dann,but then you'd be extending closable to map?
297,1548440238.5012,Meagan,I think that’s why he wanted to do it via metadata
297,1548440265.5018,Dann,you can implement protocols just via metadata?
297,1548440279.5022,Somer,Right. Wrapping in a record is fine. Just seemed cleaner if it was possible to do it via metadata.
297,1548440291.5025,Dann,"ahh, a new 1.10 feature"
297,1548440303.5028,Meagan,yep! it’s super cool
297,1548440319.5034,Elaine,"Why we can't vote closed issues?
<https://dev.clojure.org/jira/browse/CLJ-1623>"
297,1548440321.5036,Dann,so you could make a new IClosable and a new with-open; or you could pass the relevant vals to the current with-open (it allows N closables)
297,1548440405.5052,Somer,I suppose. This works for now - not critical. Was just trying to use a new 1.10 feature really :slightly_smiling_face:
297,1548440427.5056,Dann,"yeah, extending via metadata is opt-in on a per-protocol basis, interesting"
297,1548440702.5058,Meagan,I think that was for performance reasons
299,1548441750.5061,Latonya,"Probably part of the way JIRA works, either by default, or perhaps by custom configuration of this instance, but I don't know which.; Given the conversation on that issue, I would not hold high hopes that it would be implemented in core even if it got a thousand votes.; Votes get attention to an issue sooner, they don't necessarily change the decision made once it has been considered.; My suggestion would be making your own variant of the function that works as you wish, and use that.  Given the interest in it by some others, I wouldn't be surprised if Specter can do it, or medley, or one of handful of other utility libraries."
300,1548442708.5069,Elaine,I published a patch on Twitter then everyone can fix your codebase. :sweat_smile: 
299,1548450409.5074,Latonya,"Anyone can patch their own copies of Clojure all they wish, of course.  Not nearly as convenient as having it in a place where it can be used without a patch."
300,1548456648.5083,Brain,"<@Elaine> Just refer your update-in and exclude clojure's version. The current behaviour has been useful to me tracking down bugs that would otherwise subtlely succeed but mysteriously trash everything :) (consider, returning a dynamically generated path vs or nil for the second argument); Your semantics are equally valid of course, but clojure is extremely amenable to hacking, and guardrails are nice in general imo. Particularly in a dynamic language like a lisp."
301,1548457115.509,Madeleine,I think you can still comment though?
301,1548458165.5094,Otelia,"This is perhaps a different issue, but `get-in` does seem inconsistent and I wonder if the fact that it returns the entire map when [] is passed is intentional or it just happens to do that. There is no way to tell from the doc, since it just says ""ks is a sequence of keys"" and doesn't say whether it can be an empty sequence.; Oops, I meant `get-in` not `get`, fixed.; My guess is that the behavior with an empty sequence is accidental and the doc should probably say ""ks is a non-empty sequence of keys""."
300,1548460015.5103,Brain,"'Fixing' that asymmetry might break a lot of existing code. :grinning:; That's not to say clojure 2 might not fix this sort of thing, but pretty much everything in 1.x is backwards compatible for practical reasons.; The docstring change would be really helpful though. ; <https://www.conj.io/store/v1/org.clojure/clojure/1.9.0/clj/clojure.core/update-in> grimoire reports the correct signature though. Not a computer atm, but wonder if that is how it is defn'd"
302,1548476632.5123,Antione,<@Dann> thanks for your answer earlier.
303,1548496348.5127,Bridget,"I'm building a Clojure wrapper for a Java library and I'm wondering how I should add a dependency on that library from my wrapper. The thing is the Java library depends on a Java Agent JAR of the same version to provide the implementation through instrumentation. The library's public api is likely to stay the same, so my wrapper should work with any version of the library, but a specific library version can work with only specific version of the java agent.

What are the possible approaches here? Adding direct dependency to the Java library from my wrapper would work as long as the user goes with the same Java Agent version, but would likely break in the future when new agent versions are released. Of course, then users could exclude the library dependency and provide their own. Or I could release a new version of the wrapper for every library/agent version, but this might prove to be too much maintenance work.

Currently I'm thinking of going with adding the library dependency as 'provided', i.e. when including a dependency to my wrapper, users would also need to download the Java Agent (anyway required) and then add another dependency to the library. Any other ideas - preferably ones that don't require a ton of maintenance?"
303,1548497230.5132,Celestine,"<@Bridget> Sounds like New Relic?; We have a wrapper for that internally, and we assume the caller provides both the library and the agent and keeps them in sync. I think that's really the only sane approach here."
303,1548498490.5149,Bridget,"It's actually Elastic APM. Yeah, I guess it's the sanest approach to have the user provide both.; Btw,  have you noticed this New Relic Clojure wrapper: <https://github.com/Yleisradio/new-reliquary>"
304,1548499190.5183,Luci,"Can someone help me find the docs for sorted maps please?

The docs at <https://clojure.org/reference/data_structures> mention them, and say that they “are, well, sorted”. 

I want to know how they are sorted - by key, value, insertion order, etc. 

"
303,1548499703.5188,Bridget,Afaik you can supply your own comparator. See <https://clojure.github.io/clojure/clojure.core-api.html#clojure.core/sorted-map> and <https://clojure.github.io/clojure/clojure.core-api.html#clojure.core/sorted-map-by>; <https://clojuredocs.org/clojure.core/sorted-map-by>
304,1548500056.5212,Luci,I think the flatland ordered meal does what I need (I want to maintain insertion order). But my question is about the docs - I don’t see any mention of how a map is sorted if no comparator is supplied. ; Nor mention of what the comparator should return. Or what args are passed to the comparator. 
304,1548500855.5236,Bridget,I think it's ascending order by key by default. The args are `a` and `b` - i.e. the objects to compare.
304,1548500888.5247,Elaine,"<@Luci> comparator is a java concept. It returns -1, 0 or 1.
To keep insertion order, you should use a specific lib called ""orders""; <https://github.com/clj-commons/ordered>"
304,1548500945.526,Luci,"Thanks for the help. To be clear though, I’m wondering if there are docs on this."
304,1548501027.5266,Bridget,I can't find anything comprehensive. :disappointed: There's this: <https://clojure.org/guides/learn/hashed_colls#_sorted_maps> which gives tiny bit insight on the default comparator at least.
305,1548509709.5285,Luigi,Anyone have any examples of idiomatic Clojure libraries that wrap external APIs?
306,1548510512.5291,Luci,The new cognitect AWS wrapper?
305,1548522160.5319,Xiao,"Can anyone suggest a way to take screenshots of a webpage in clojure/java? I'm looking for the simplest solution possible, preferably with no extra dependencies."
305,1548522391.5325,Epifania,<@Xiao> I think the JavaFX WebView has a `takeSnapshot` or `snapshot` function you can use
305,1548522445.5326,Johnathon,"not exactly what you're asking for, but is clojurescript a possibility? <https://github.com/niklasvh/html2canvas>"
305,1548522551.5329,Xiao,"I've tried that with poor results (compared to how things actually look in a real browser).; Thanks, I'll take a look at that :+1:"
307,1548526487.5336,Latonya,"Clojure's default comparator, if you do not supply one explicitly, is `clojure.core/compare`; There is the output of `(doc compare)` that describes it briefly.; I haven't yet found any explicit lines in doc strings saying that, but in brief checking of source code it appears to be true.; I have written something a few years back, but not published in a well-known place, necessarily: <https://github.com/jafingerhut/thalia/blob/master/doc/project-docs/en_US/clojure.core/1.6.0/clojure.core/compare.md>; I am considering copying that to <http://ClojureDocs.org|ClojureDocs.org> page on the behavior of clojure.core/compare"
308,1548531441.5387,Bridget,"<@Xiao> If you're open to using external paid service, I would recommend url2png. It works pretty well and has some nice features, such as it allowing you to include custom css file just for screenshotting purposes. For a DIY solution, I'd probably go with something like headless chrome to get as close to desktop/mobile rendering as possible."
308,1548533333.5388,Min,If you're open to using an external service <http://urlbox.io|urlbox.io> is quite good. We've snapshoted pages with some crazy js/svg and all sorts of constraints (timers etc) with it
309,1548543299.5395,Celestine,"I had not. Thank you. It doesn't look as sophisticated as to what we're already doing (we have tracing via annotations, a bunch of metrics stuff, support for the New Relic Agent and periodic probe/reporting, middleware, and transactions).; Maybe at some point I'll extract ours as an open source project..."
310,1548548058.5404,Meagan,"is it possible to tell clojure.walk/postwalk not to descend into maps, only vectors?"
310,1548548410.5414,Latonya,"Not that I can think of.  You can copy and modify the source of clojure.walk/walk pretty easily, if you want."
310,1548548460.5421,Henry,"Or use `tree-seq`, that one gives more flexibility <https://clojuredocs.org/clojure.core/tree-seq>"
310,1548548763.5422,Meagan,"I think I’ll just call my function recursively and hope that no one passes me a huge vector ¯\_(ツ)_/¯; oh, that’s pretty much what clojure.walk does anyway; I thought it had something fancy that was preventing the stack from growing"
311,1548557034.5438,Latonya,clojure.walk/walk should work for arbitrarily large collections without blowing the stack.  It should only grow the stack when there is more nesting in the collection given.
310,1548566386.5443,Meagan,"i’m walking a hiccup-like structure, e.g.:
```
[:server/http {:port 8000 :join? false}
           [:router
            [:db/conn [:config]]]
           [:foo
            [:db/conn [:config]]]]
```"
311,1548569999.5466,Latonya,"Maybe not all, but most code that deals with nested structures - reading, printing, processing - will typically cause a number of levels of function calls that is proportional to the level of nesting of the data.  20 levels deep of nesting isn't going to blow the Java call stack.  1000 probably won't either.  If you've got 20,000 levels of nesting in your data, you will probably start blowing at least the default Java stack depth limits.; I am not aware of any reasons to have such deep nesting of data, except for artificially generated test cases that attempt to determine where the call stack depth limit is.; I should have pointed you here first -- it does explicitly document that `compare` is the default comparator, and has some notes on its behavior: <https://clojure.org/guides/comparators>"
312,1548599113.5479,Bridget,"That'd be cool :slightly_smiling_face: Yeah, it's not very sophisticated, but works for basic needs."
313,1548600295.5503,Jalisa,"How do I return an error code from my `foo.bar/-main` function, when starting it using `clojure -m foo.bar`? Just returning the error code does not work. Program always terminates with error code `0`."
312,1548600420.5508,Clarine,(System/exit 127)
314,1548614964.5518,Meagan,"I have a devtool that I want to allow people to easily install into their Clojure projects; atm, it relies on websockets to communicate with a web UI; I’m worried that installing the dependencies for and starting a webserver on behalf of a user is really invasive"
315,1548618496.5538,Latonya,"Continuing with my hopefully brief obsession, I have just updated the sorted-map entry on <http://ClojureDocs.org|ClojureDocs.org> to make the answers to some of your questions hopefully quick to answer: <http://clojuredocs.org/clojure.core/sorted-map>"
314,1548619953.5558,Aubrey,"<@Meagan> no other way around it, I guess. Unless you expose the WebSocket API as a core.async channel and allow people to override the WebSocket implementation with their own server."
316,1548621423.5562,Rosaline,"I mean, surely it is isn't a huge stretch to go from websockets to just sockets?; and that is just part of the jre"
316,1548622129.5573,Sixta,Figwheel does it :) 
316,1548622194.5577,Meagan,"hmm, well a browser page can’t talk _just sockets_; most people don’t run figwheel in the same process as their server-side app"
316,1548622320.5597,Sixta,"I've always seen it done that way fwiw, at least in dev. "
316,1548622365.5611,Meagan,"really? that seems strange. I guess I haven’t used figwheel in awhile, so maybe I’m missing some context"
316,1548622376.5615,Sixta,"However, I have wished that figwheel could be used without its server, so a _callback_ based API would be wonderful.; All our projects at work, and also Edge work that way. ; Most people won't mind you starting a Web server, and you can separate the API so it is easy to upgrade. "
316,1548622474.563,Meagan,"what do you mean by callback-based?; I think it would be nice, if the user already has a webserver running, to provide a way to serve the devtool through that instead of starting it’s own server; but i’m not sure how to do that generally"
316,1548622744.5647,Tammera,how would it know that that is the case?
316,1548622851.5669,Samual,"I like to run a web app with its own, you know, lein repl thing, and start lein figwheel in another terminal; so the l.f. terminal listens to port 3349 and the l.r. terminal listens to port 8088 or whatever the website is.  Amazingly it hangs together.  The js made by figwheel apparently has the 3349 baked in, and learns dynamically the origin of the page that embedded it (ie 8088)"
316,1548622955.567,Tammera,"I guess you would want to mount your dev tool into the running webserver.  That would mean having a companion lib per “possible webserver” plus one for apps that don’t have any; Like, `my-dev-tool-pedestal`"
317,1548625936.5691,Samual,"Is this the appropriate forum to ask about VS Code?  Or maybe Calva, I don't know whose fault it is.  When the point is adjacent to a paren or bracket or brace, the point is invisible. The two brackets are *outlined* and the point is apparently blended in with one edge of one bracket.  Hard to guess which.; Is cursor obviousness configurable?"
317,1548626187.5699,Meagan,<@Samual> try <#CBE668G4R|calva-dev>
317,1548626426.57,Sixta,"Your java thread will run a callback which will  write to whatever transport I use (websocket, sse, core.async, long polling, whatever). Same  thing on the frontend for responding to messages  that come in "
317,1548627715.5702,Samual,"Aha, editor.cursorWidth. Changing it from 0 to 4 makes it easy enough to see."
318,1548654910.571,Meagan,"anyone know why
```
(binding [*provided* (merge provided args)]
          (map (bound-fn [x] (walk! x)) children))
```
works, but
```
(binding [*provided* (merge provided args)]
          (map walk! x children))
```
loses the `*provided*` binding?"
318,1548655171.5725,Tammera,"Huh, don’t you mean `(map #(walk! %) children)` in the second case?"
318,1548656067.5731,Meagan,"oops, had a typo. I meant `(map walk! children)`"
318,1548657063.5747,Tammera,"Right, I had a case of ‘early morning’ and forgot about passing unary fns directly; With the chance of sounding stupid: could it be because your map returns a lazy sequence and therefore the binding is lost when it is realized "
318,1548657825.5763,Meagan,":thinking_face: I wouldn’t expect it to, but maybe; `clojure.lang.PersistentVector$ChunkedSeq`; hrmph. I changed it back to `(map walk! children)` and it works"
318,1548658808.5774,Tammera,"haha, sometimes you have those problems"
319,1548663790.5789,Deena,"Is there a way to define a function or variable that belongs to another NS?

```
(defn another-ns/foo [x] 3)
(defn another-ns/bar 5)
```

```
2. Unhandled clojure.lang.Compiler$CompilerException
   Error compiling src/---.clj at (14:1)
   #:clojure.error{:phase :macro-syntax-check,
                   :line 14,
                   :column 1,
                   :source ---
                   :symbol clojure.core/defn}

1. Caused by clojure.lang.ExceptionInfo
   Call to clojure.core/defn did not conform to spec.
   #:clojure.spec.alpha{:problems
                        [{:path [:fn-name],
                          :pred clojure.core/simple-symbol?,
                          :val another-ns/foo,
                          :via
                          [:clojure.core.specs.alpha/defn-args
                           :clojure.core.specs.alpha/defn-args],
                          :in [0]}],
                        :spec
                        #object[clojure.spec.alpha$regex_spec_impl$reify__2509 0x32a67584 ""clojure.spec.alpha$regex_spec_impl$reify__2509@32a67584""],
                        :value (another-ns/foo [x] 3),
                        :args (another-ns/foo [x] 3)}
```"
318,1548664062.5817,Deena,"I'm trying to use the `clj-ipfs-api` (<https://github.com/keorn/clj-ipfs-api>) but I cannot load any NS that refers to its functions without having an IPFS daemon running. Ideally, those functions would just fail if I tried to call them without the daemon running, but I get exceptions because the vars haven't even been defined.

My workaround is to check if the functions have been defined (using `resolve`) and replace them with a dummy function (that throws if called) if they're missing."
320,1548664914.5831,Mitch,"Hi, IntellijIdea and Cursive users, how do you make Idea to recognise HugSQL functions?"
319,1548672374.5838,Elaine,you can ask in <#C0744GXCJ|cursive> or <#C1Q164V29|sql> channel.
321,1548672573.584,Samual,in-ns before the def ?
319,1548672641.5842,Samual,"but beware that if the proper file for the ns is eventually loaded, the ns won't be strictly new so iirc it won't implicitly refer-clojure."
322,1548673096.5857,Marisela,"Hi, I have a hex string that looks like `01031000BB014727DB00000064009600C823C5` that I need to decode in to something human readable. Whats the best way of going about this? The first three bytes are meaningless but after that I need to read 2 bytes at a time?; I thought Buffy may have helped out but can't work out how to pass the whole string in."
319,1548673679.5885,Bart,anybody got a quick and easy way of writing a file sent through a http/POST to file?
322,1548673705.589,Bart,"to disk, rather"
319,1548673757.59,Bart,"i'm not quite sure what to use, if there's a convenient clojure library for it, or if I should just go straight to `FileOutputStream`; Ring seems to not be happy about that approach though; `java.lang.IllegalArgumentException: No implementation of method: :write-body-to-stream of protocol: #&amp;apos;ring.core.protocols/StreamableResponseBody found for class: java.io.FileOutputStream`"
323,1548675897.5914,Elaine,"```
(-&gt;&gt; (.getBytes ""01031000BB014727DB00000064009600C823C5"")
     (drop 3) ;; The first three bytes are meaningless
     (partition 2) ;; I need to read 2 bytes at a time
     (map (partial byte-array 2)) ;; Turn (1 2) back to byte[]
     (map slurp)) ;; turn byte pair into string again 
```; Using transducers (performatic)
```
(into []
      (comp (drop 3)                                        ;; The first three bytes are meaningless
            (partition-all 2)                               ;; I need to read 2 bytes at a time
            (map (partial byte-array 2))                    ;; Turn (1 2) back to byte[]
            (map slurp))                                    ;; turn byte pair into string again
      (.getBytes ""01031000BB014727DB00000064009600C823C5""))
```"
324,1548678245.5923,Marisela,Nice one! thank you
323,1548679187.5925,Elaine,share the final form :slightly_smiling_face:
319,1548683378.5928,Vita,this *is* something that happens. Lazy sequences might be realized outside of the scope of the binding. <https://cemerick.com/2009/11/03/be-mindful-of-clojures-binding/>
325,1548687842.5945,Sixta,"Is there an abstraction where something like `take` &amp; `drop` would avoid computation? I'm guessing it would utilize custom versions of `take`/`drop`, although maybe txors can do this? I'm thinking about computationally heavy pagination."
326,1548689264.5958,Lorita,"Hi, can someone confirm or deny, that gen-class generated code can't put java annotations on generated class methods?; I am utterly unable to find exampl exactly for gen-class... and not the methods which are new, but just well... extending abstract class, and dropping annotation on the abstract method implemetnation... I know it's possible for deftype (I think)"
326,1548689529.597,Roselle,Would this help? <https://stackoverflow.com/a/16114606/7182237>
326,1548689686.5973,Lorita,"No this is how to attach to the methods you are bringing as new, but if you have methods which are, for example, alerady in super class (like abstract method) and then you try to write the function and attach the annotation, it does not work...
Or should I also declare methods in the gen-class itself... I think you only do when you define new onews; I have java abstract class, which I try to extend, and there is abstract method ""call"" in that class, which I try to implement and add the annotation, in bytecode I see the method, but not the annotation; yea according to doc, the clojure will override all the public methods of super class, when extending, but it somehow clears and ignores all the annotations I put on the extendable abstract method"
327,1548692256.6004,Charlette,"hey people, anyone know where I can find more details about the mechanics behind the error handler function optionally attached to agents? Specifically, is it dispatched in the same thread as the `send` which was responsible for the failing call, so that IO should be avoided in that case (or `send-off` used in cases where the error handler has to do IO)? And is the return value from the error used at all?; Hmm, Clojure Programming suggests it's not handled in the dispatch thread, so IO should be fine :slightly_smiling_face:"
327,1548692833.6008,Jasmine,"It’s handled in the agent execution thread, not in the thread calling `send` / `send-off`. If doing I/O, I would use `send-off`. The return value is not used."
327,1548694913.6021,Charlette,thanks <@Jasmine>!
328,1548696534.6086,Andrew,"hey, don't know whether I'm in the right place for this:
i want to make some improvements to <http://4clojure.com|4clojure.com> but i think it lacks an active maintainer.
improvements i think of atm would be
• clean up issues/PRs on github
• oauth-login (afaik there would already be a PR that needs some love or rewrite, dunno yet)
• maybe a small face lift using cljs/reframe? i mainly think of this as an exercise for myself xD but i'd like to accomplish some goals like improvements on ""top users""/""follow"" page/features (performance-wise)
• mabye some browser-editor improvements
to name some of the starters; so my question is, who i need to contact to become maintainer and how i qualify to become the next warden of <http://4clojure.com|4clojure.com> :slightly_smiling_face:"
328,1548696747.611,Clarine,"<@Andrew> I don’t know the current maintainer, but I would also be interested in these improvments. I would also like to add better error messages through the use of speculative instrumentation (can be turned on and off). For browser editor improvements CodeMirror + parinfer could be used."
328,1548697382.6135,Andrew,if @danielwithmusic is right amalloy still has ownership. will look into possibilites to reach him and/or any1 on the contributors list tonight.
329,1548709310.6139,Adela,"isn't there a typo?
```
(doc clojure.set/rename-keys)
-------------------------
clojure.set/rename-keys
([map kmap])
  Returns the map with the keys in kmap renamed to the vals in kmap
```"
329,1548709401.6144,Dann,"if kmap is `{:a :b}` it renames keys of kmap (:a) to vals of kmap (:b); it's awkward, but correct; ""if a key in m is also a key in kmap, it is replaced by the corresponding val in kmap"" is a potentially clearer way to say that(?)"
329,1548709589.6174,Adela,"I would expect ""Returns the map with the keys in `map` renamed to the vals in `kmap`"""
329,1548709602.6178,Dann,"no, because keys that aren't in kmap are not touched"
329,1548709621.6183,Dorothea,"I think the tricky issue is tying the keys from `map` and the keys from `kmap` together, and what happens when they match.; I like your definition above <@Dann> more than the docstring, which tripped me up when I was first figuring out how to use it."
329,1548709766.6201,Adela,"examples from <https://clojuredocs.org/clojure.set/rename-keys> prove that my understanding is correct, but I'm confused by description"
329,1548709902.621,Ashlea,"<@Adela> You’re correct, that appears to be a typo; Oh shoot, no sorry; That’s not a typo; haha, it took me a couple of reads to understand the docstring"
329,1548710321.6239,Dorothea,"Running that top example in a `clj` repl doesn't replicate that behavior.; ```
user=&gt; (set/rename-keys {:a 1} {:a :new-a :b :new-b})
{:new-a 1}
```"
329,1548710345.6243,Adela,"btw, where's `clojure.data/diff`?"
329,1548710360.6245,Dann,it comes with clojure; you are missing the :b key in the input map
329,1548710452.6254,Becki,`(require '[clojure.data :as diff])`
329,1548710453.6255,Adela,`doc` returns `nil` to me
329,1548710474.6259,Dann,did you require its namespace?
329,1548710507.626,Dorothea,"Sorry, the behavior I was pointing out was that keys in `kmap` that aren't in `map` result in no behavior; there was an example on clojuredocs that showed an old behavior where the returned map would contain `:new-b nil` as a k/v pair.; That being said, upon rereading this thread I'm not sure if anyone was confused about that."
329,1548710538.6268,Becki,also in the examples that was a bug in clojure 1.1 and fixed in 1.2.1 ti thought i read
329,1548710548.6273,Adela,"```
Execution error (FileNotFoundException) at user/eval1484 (form-init8507139964286056300.clj:1).
Could not locate diff__init.class, diff.clj or diff.cljc on classpath.
```
sorry, I'm noob; thx Dan, it worked"
329,1548710584.6287,Dorothea,"Yep! I just like to verify those statements myself...; (too much time working front-line support, perhaps...)"
329,1548710620.6299,Adela,"oh, just noticed I'm in the wrong channel; sorry"
330,1548717016.6316,Rosalba,"in postgres, column names can't have hyphens (unless you escape them). I'm using hugsql and I'd like to create some middleware to convert snake_case keys to kebab-case for every query, has anybody done this already?"
330,1548717991.6459,Sebrina,There’s an exploit in Slack that allows you to change permissions and post as random user ids from the client side. Occasionally a troll comes in and uses it to post as random people and start something.
329,1548718039.6485,Bart,that's a pretty serious exploit
329,1548718059.6492,Sebrina,"Yes, yes it is. They disclosed the issue but apparently refuse to fix it."
329,1548718224.6543,Becki,`/collapse`
329,1548718575.6679,Bao,that's cute
330,1548718676.671,Mohamed,"<@Diamond> the admins have disabled that, the troll was using a well known exploit in slack"
329,1548718689.6714,Mohamed,"slack is very aware of it, and has not fixed it"
329,1548718701.6717,Diamond,This is the same exploit described previously?
329,1548718707.6719,Mohamed,probably
329,1548718727.6729,Diamond,I wonder what the rationale is for not fixing it.
329,1548718742.6741,Mohamed,:man-shrugging:
329,1548718746.6746,Celestine,Stop discussing this here. Go to <#C0CB40N8K|community-development> for that discussion please.
329,1548718753.6751,Mohamed,sorry
329,1548718776.6763,Celestine,Do not engage the trolls. Do not discuss it in regular channels. It just makes the noise worse.
329,1548719479.6871,Evonne,<#C03S1L9DN|clojurescript> has also been hit
329,1548719584.6873,Celestine,Thanks. I'll join there and clean up.
329,1548719986.6876,Sebrina,Oops sorry :sweat:
331,1548724452.6885,Meagan,does anyone have an example of a system (a la component/integrant/mount) whose resources _have_ to be stopped in order?; even just some hypothetical cases would help
331,1548724859.6904,Dann,"<@Meagan> hypothetical: using zookeeper for service discovery / leader election, you need to withdraw from any roles your instance took on, and do any zk bookkeeping, before shutting down your zookeeper component that manages your connection to the service; (of course if it's properly designed the failure case should handle that already, but you might be able to do something simpler if a node explicitly and gracefully leaves)"
331,1548725023.6932,Meagan,"nice! does that match what I’m talking about though? I mean that if component `A` depends on `B`:
```
start:
A -&gt; B
```
`B` must be started before `A`. I’m wondering how often it’s important that `B` also be _stopped_ before `A`; in this case, are you saying that you have two components (e.g. one for service discovery, one for the component itself)?"
331,1548725073.6946,Dann,"oh! - I thought you meant ""in order"" as in ""opposite from starting order"" which is how it's done..."
331,1548725111.6953,Meagan,"I guess? I actually haven’t used component in a while and it never mattered in my cases.; if I just stop things in random order, what goes wrong? :stuck_out_tongue:"
331,1548725132.6962,Dann,"<@Meagan> in my example the hypothetical service isn't the only usage of zookeeper, so the zk component is shared by 2 or more components; sometimes shutdown of B requires usage of A"
331,1548725185.6976,Meagan,"OK, so you’d probably want to withdraw before you shut down the rest of your system so you don’t get incoming requests during your shutdown; ah good point"
331,1548725206.6983,Dann,"if there's any tidying up needed - of course we usually try to build things so worst case we don't leave state dangling; another hypothetical: there's a lock file on a filesystem where two programs run (eg. an editor), you'd want to shut down the part of your app that wants to write the file before shutting down the part that does file locking and directory watching; and on startup you want to open the part that watches and locks files before the part that wants to write them"
331,1548725357.7003,Meagan,this is great!
331,1548725411.7009,Dann,"often we avoid this by not splitting concerns, but in a focused enough file management oriented app, I can imagine separate components"
331,1548725481.7014,Rosaline,"clean stopping is often more important during development then in production; so you can stop the app, and leave things in a good state were you can start it again without restarting the jvm"
331,1548725524.703,Dann,"oh, and a much more common / obvious example than the others: imagine if your http server was still running and handling requests, but your db access handler was shutting down"
331,1548725555.7035,Meagan,"I think that’s the example I’ve been running with so far, and I don’t really care that much"
331,1548725581.7043,Dann,I guess a spurious 500 error isn't hard to handle
331,1548725590.7045,Meagan,"I am thinking about this mainly for a dev POV like <@Rosaline> said though; so e.g. the file locking example was great, I hadn’t thought about things like that; not everything is a web app :stuck_out_tongue:"
332,1548736592.7073,Chiquita,"Hi everyone, I'm new to clojure and clojure.test so can anyone tell me how to write test cases for any project."
332,1548737236.7076,Patty,<@Chiquita> you can start here <https://clojure.github.io/clojure/clojure.test-api.html>
332,1548737572.7104,Chiquita,"Hey <@Patty>, Its like I have read that link and I've created a project in which I wrote a simple test and after running cider and using C-c C-t p, it is saying that ""Running test in all namespaces"" in minibuffer but it is not showing the output.; (ns testcase.core
  (:require [clojure.test            :refer :all]
            [ring.adapter.jetty      :as jetty]
            [ring.middleware.reload  :refer [wrap-reload]]
            [compojure.core          :refer [defroutes GET]]
            [compojure.route         :refer [not-found resources]]
   ))

(deftest addition
  (is (= 3 (+ 1 1)))
  (is (= 4 (+ 2 2))))
(defn -main
  ""A simple project to runtest case""
  [port-number]
  (jetty/run-jetty (wrap-reload #'addition)
        {:port (Integer. port-number)})"
332,1548739508.7116,Patty,<@Chiquita> that is happening because you have this in src namespace and not test namespace from the looks of things.
332,1548739541.712,Chiquita,Okay thanks.
332,1548739920.7122,Celestine,You'll find the <#C053AK3F9|beginners> channel very helpful -- people there have opted in to helping folks who are new to Clojure <@Chiquita>
332,1548740142.7124,Chiquita,Thanks <@Celestine> for the suggestion.
333,1548764798.7144,Kristyn,"Shouldn't <https://github.com/edn-format/edn/wiki/Implementations> also mention Clojure's built-in <https://clojure.github.io/clojure/clojure.edn-api.html>? For anyone trying to use EDN format from Clojure, it'd be really nice to get a pointer which one should use. According to <https://groups.google.com/forum/#!topic/clojure/d61ImK2VCag> the built-in is just fine."
334,1548768398.715,Jasmine,Feel free to add it 
335,1548775735.7172,Danna,"I have a repl with refs to datomic entities defined.
Periodically I wish to refresh these to include recent novelty.
A macro approach could look like
``` (defmacro refresh-datomic-entity-as-macro
  ""redefine ent-sym to latest version of entity""
  [ent-sym datomic-conn]
  `(def ~ent-sym
     (d/entity (d/db ~datomic-conn) ~(:db/id (deref (resolve ent-sym))))))
```
but  realised that I could alternatively write the function
```
(defn refresh-datomic-entity-as-fn
  [ent-var datomic-conn]
  (.alterRoot ent-var (fn [e] (d/entity (d/db datomic-conn) (:db/id e))) '()))
```

normally I would _always_ choose a function over a macro
but perhaps not if that required the interop call to `clojure.lang.Var/alterRoot`

How would you choose between them??
are they equivalently awful?"
335,1548777051.7186,Celestine,As opposed to `alter-var-root`? <@Danna> 
335,1548777221.7189,Danna,":ahem: hadn't spotted that function; thankyou; haha
I've never written a macro that I've ended up keeping"
336,1548778265.7223,Meagan,"I just want to profess the ridiculous feeling of joy and power I have when using Clojure. 200 lines to achieve what in my other proficient languages would be 2,000. I know it’s not a real measuring stick, but every once and awhile I come up for fresh air and look at some of the stuff people are doing, and realize how much more approachable Clojure code bases are. Thank you Rich/Stu/Alex/et. al.!"
336,1548778417.723,Clarine,What are your other proficient languages?
336,1548778519.7233,Meagan,"JS, Java, ReasonML/OCaml. in that order :slightly_smiling_face:"
336,1548778541.7237,Jasmine,tell your friends :)
336,1548778566.7239,Clarine,I’m curious about your findings about Clojure vs OCaml
336,1548778597.7245,Meagan,"well, I “made” everyone at work switch to it :stuck_out_tongue: doing my duty; I could probably write a long post about it :smile: one of bigger reasons, honestly, was that we started rewriting our systems at work last year and needed something to standardize on. Clojure was just a better bet back then. Still is; IMO Clojure(Script) is the best “blue collar” language out there"
336,1548778803.7255,Clarine,"I’d be interested in the longer blog post. For now, thanks :slightly_smiling_face:"
337,1548780033.7274,Salina,"it already happened a few times that we change something, everything works in the REPL and running tests, but then eventually you run the Uberjar generated and it blows up; is normally related to silly things like `slurp` of files not in `resources`, and similar, but it would be nice to find out earlier on; one way for example could be to run the uberjar generated for a few seconds and do an HTTP call to see if it started up correctly, has anyone done something like that?"
337,1548780294.7313,Hilary,"I came from an OCaml-ish language (F#) to Clojure and wrote something about the transition here <https://blog.taylorwood.io/2017/09/15/year-behind.html>
I also feel ridiculously empowered when writing Clojure. I did C#/Java/C++ for ~15 years before learning functional programming FWIW"
337,1548780357.7331,Gillian,i told a friend about clojure and he told me it sounded like i was in a cult
337,1548780370.7334,Wai,Blue collar probably doesn’t translate across cultures/regions with any precision. I’d be interested in the longer motivation? :slightly_smiling_face:
338,1548780485.7346,Clarine,"<@Wai> I interpret that as the daily work of an average programmer; <@Hilary> thanks, I already read that one and enjoyed it"
337,1548780649.7352,Meagan,it’s always useful to test things in a release-like environment before deploying. We use docker at work to do that; it’s also pretty standard practice to have health checks once deployed
337,1548780762.7364,Sonny,"Weird. I told my friend about a cult I joined and he told me it sounded like being a clojure developer.; <@Meagan> Absolutely love the, ""blue collar"" programming language metaphor, while I understand the response about it not translating it made deep and intuitive sense to me immediately and will now be stolen. Bravo."
337,1548781245.737,Celestine,"I've probably taken about a dozen languages to production -- and I've learned another dozen while doing that (and I came out of university fluent in about another dozen before that) -- and Clojure feels, for me, the most fun and productive of any language I've ever used.; I didn't know `.alterRoot` existed so that's TIL :slightly_smiling_face:"
339,1548781300.7374,Clarine,<https://twitter.com/borkdude/status/933699150453051394>
337,1548781306.7377,Salina,we also use docker; so I can run something on the docker image; was just wondering how to run for example jetty for a few seconds until it's up to try to do a HTTP call
337,1548781350.7385,Meagan,I can’t take credit for the analogy! I definitely stole it from somewhere :stuck_out_tongue:
337,1548781376.7387,Salina,"and we also have health checks, however when there are these issues marathon can't even deploy the changes, and it just loops forever"
337,1548781463.7389,Meagan,are you asking how to do this as an automated test in CI?
337,1548781473.7393,Salina,"yes; just wanted to know if I was the only one with this problem, and others solved it"
337,1548781566.7399,Clarine,<https://twitter.com/borkdude/status/819248075948625920>
337,1548781763.7408,Salina,writing Clojure with Emacs is a double cult then :smile:
340,1548783581.745,Evonne,All the best cults write clojure.
340,1548783709.7467,Emery,"Hi, has anyone used com.taoensso/carmine with Redisgraph? I can successfully `(car/PING)` my running Redisgraph Docker container, and I see four graph commands listed when I run `(wcar* (car/command))`. But, when I try e.g. `(wcar* (car/graph.QUERY ""social"" ""CREATE (:person {name: 'roi', age: 33, gender: 'male', status: 'married'})""))`, it tells me `No such var: car/graph.QUERY`. Haven’t used carmine or Redis much previously, but wanted to have a go."
340,1548784230.7481,Vinnie,":wave: any known lib/utils that given a string:
1. tell me if it's a valid uri
2. tell me if that uri refers to an image of any kind :question:; maybe a combination of <https://github.com/cemerick/url> for 1 and <https://github.com/michaelklishin/pantomime> for 2 :thinking_face:"
340,1548784587.7495,Sonny,"You can use the URI class constructor in the JDK to check for validity. It will throw an exception if it invalid (assuming you mean structurally valid, as opposed to the resource it points to actually existing).; Number 2 sounds hard though. <http://myserver.com/pictures/myface> is a valid URI. You'd have to do a HEAD at minimum to see what's there though."
340,1548784689.7514,Vinnie,"yep, makes sense. thanks for the suggestions"
340,1548784714.7518,Sonny,"np :slightly_smiling_face: I also could be wrong, it has been known to happen."
340,1548784736.7523,Vinnie,<https://github.com/michaelklishin/pantomime#detecting-mime-type> looks pretty good. planning to test it out on some edge cases
340,1548784740.7526,Dann,a warning about java.net.URI: simply creating one will talk to the network
340,1548784747.7529,Vinnie,yep
340,1548784765.7536,Sonny,"Oh yes, I vaguely remember that now. The JDK is bags of fun."
340,1548784772.7538,Dann,or maybe it's equality checks - but what I definitely remember is strange unexpected network interactions
340,1548784788.7541,Vinnie,"i remember it too :slightly_smiling_face:
do you even side effect?"
340,1548786006.7555,Ashlea,"<@Dann> do you know where that’s documented? I knew that was the case for `java.net.InetAddress`, but `URI` is surprising :S"
340,1548786151.7563,Dann,"<@Ashlea> thanks for making me double check: URL has this behavior, URI is safe(!)
&gt; Equality, hashing, and comparison are defined strictly in terms of the character content of the instance. In other words, a URI instance is little more than a structured string that supports the syntactic, scheme-independent operations of comparison, normalization, resolution, and relativization.
<https://docs.oracle.com/javase/7/docs/api/java/net/URI.html>"
340,1548786165.7566,Ashlea,:relieved:
340,1548786211.7575,Dann,"I is only four letters away from L, and looks very similar in most fonts, which is my excuse for my faulty memory"
341,1548793826.7591,Zenia,<@Evonne> gives a whole new meaning when you see someone joined <#C03S1KBA2|clojure> .....
342,1548794835.7598,Jasmine,"to join, just send me a check for $1000. riches will ensue."
341,1548795790.7609,Evonne,"Haven’t even sent in the money yet, and Riches are already ensuing."
342,1548795819.7611,Gillian,shut up and take my money
343,1548798138.7635,Sixta,"Is there a caching system where if the result is not available, then the old one is used until it is? Eg for a variable time api; Core.cache doesn't seem to have something like this. I feel like I could try something with a futures and deref, but state gets a little complicated, and utilizing someone else's state management seems reasonable."
343,1548798543.7666,Jasmine,"if the result is “not available”, then how can there be an “old one”?; sounds like maybe what you want is a map + a way to trigger a background refresh ?; I’m not sure I would call that a cache"
343,1548798836.7678,Darcel,"Is there a plan of releasing the new version of tools.deps.alpha with ’add-lib function? It’s needed to add hotload-dependency functionality to clj-refactor., because otherwise I’m unable to add the tools.deps.alpha using it’s hash."
343,1548799028.7698,Sixta,"<@Jasmine> you're right, I think an atom &amp; a thread is probably good here. My only slight problem is eviction."
343,1548799198.772,Becki,core.cache has a protocol. one of the functions is `evict`. maybe you could look at the LRU there and modify it so that evict did not evict but refresh?
343,1548799214.7722,Clarine,"<@Sixta> I have exactly this problem and solved it with an atom with a map of futures. I need a value for every user of the system. Each user has a future, either running or ready. I do a background refresh, so I don’t throw away the future that’s already done while the new one is running.; The problem is that futures don’t have a way to say: on-ready, put yourself in this map and swap out the other future. So I’m dereferencing it in the background, with a timeout. When done (or the timeout expires), I swap the old value."
343,1548799398.774,Jasmine,"it needs some more work before it gets added, which is likely not going to happen soon"
343,1548799398.7742,Clarine,I’m looking into manifold to see if there’s a better way for that last part.
343,1548799412.7743,Jasmine,"so, no there is no plan currently"
343,1548799479.7754,Vinnie,"&gt; if the result is not available, then the old one is used until it is
i seem to build or want this in every lang or system i work on :joy:"
343,1548799486.7755,Jasmine,"you could give the future the atom and then have it do the swap?; I don’t know the Guava lib well enough to know off-hand if this is covered, but it has a ton of cache variants and the code is very high quality"
343,1548799558.7766,Clarine,<@Jasmine> then I would need a way for the future to refer to itself
343,1548799567.7768,Jasmine,"why?; it’s waiting for something - when it’s done waiting, do the work"
343,1548799620.7778,Clarine,"because I store the futures, not the resulting values. if there’s already a future running (and not cancelled), I wait for that one. I could store the resulting values separately in another atom of course, but I still need the state of those futures."
343,1548800196.7801,Dann,<@Clarine> a future is effectively a Thread plus try/catch/finally that delivers to a promise
344,1548800225.7807,Dann,you could make a new version that lets the code in that Thread access the promise directly
343,1548800259.7813,Dann,"of course a clojure future also does some special var binding boilerplate, but it's a relatively small chunk of code"
344,1548800338.7818,Darcel,May I please take the code from add-lib branch and create a package out of it? At least for some time until the feature lands to tools.deps.alpha
343,1548800465.7832,Clarine,"<@Dann> so instead of storing the futures, I would store the promises?"
343,1548800501.7838,Dann,"yeah, which I think have the semantics you want - they are deliver-once, and you can tell if they've been delivered too; maybe you want a pair of promises - one for the thread itself (has this work started) and another for the result (has it completed / what did it return)"
344,1548800561.7853,Dann,"I'm a huge fan of delay and promise, you could also use atoms for what they do, but they have the extra guarantee that they never mutate once realized, a one time switch"
343,1548800694.7862,Clarine,"I’ll think about it some more, thanks for the idea."
343,1548800828.787,Rosaline,a pair of promises is almost always a way to get race conditions; <https://github.com/walmartlabs/lacinia/commit/62da37cd04353884a0a9d024402c3d2b80b3306d#diff-614737af318144d5501e3b4cf8abac02>
345,1548802391.7885,Jasmine,"It’s open source… just retain the license and copyright; that is, yes :)"
346,1548822463.7907,Donetta,"Is there a good way to convert a qualified map into an unqualified one?; Like, if I want to get some sample data via gen/sample or gen/generate and work on qualified specs, but turn that output into plain unqualified maps?; None"
345,1548823392.792,Fredda,None
346,1548823728.7935,Celestine,"If you know you have a flat map, with no nesting, `(reduce-kv (fn [m k v] (assoc m (keyword (name k)) v)) {} my-map)` will probably do. Never mind, just realized you explicitly asked about a nested hash map. But there's an argument for not nesting maps like that..."
346,1548823839.7944,Becki,beware that you can introduce collisions if you have something like `{:database/id 4 :somethingelse/id 6}`
345,1548823859.7947,Celestine,(indeed)
345,1548824285.7953,Fredda,"yeah, that should probably go in the doc string"
345,1548824417.7966,Becki,"also, be aware of keywords in values. `{errors/ui [:error/missing-payer]}` should that become `{ui [:missing-payer]}` or `{ui [:error/missing-payer]}`"
347,1548824676.7976,Meagan,how offended do people feel about the idea of composing server-side “components” (a la component/integrant/mount states) using hiccup?
348,1548831082.8025,Jonah,"Hi, I have a question about `defmulti` and `defmethod` in different namespaces. It seems that if you use `defmethod` in a separate namespace from `defmulti` then something in your app has to require this namespace, so `defmethod` actually runs. Is this true? And if yes, is there a best practice to avoid circular dependency in this case? Can't find the answer in docs or somewhere else..."
348,1548831740.8041,Tammera,Yeah I believe all ns’es that define `defmethod`s for a `defmulti` must be `require`d for the branches of the multi to be available
348,1548832043.8072,Jonah,"It does work when you require ""branch-namespaces"" but you can't require them from the namespace where `defmulti` is, due to a circular dependency. Requiring them elsewhere creates an implicit dependency that will eventually break with some changes.; Kinda puzzled how to overcome this."
348,1548832133.8086,Tammera,"Right, why do you want to use the `defmethod` that you are dynamically extending in the namespace that you are defining it in; could you maybe resolve that"
348,1548832288.8109,Jonah,"I have few text formats that I serialize/deserialize to the filesystem. They aren't all defined at this point and will evolve as an application evolves. So, my idea was to define multimethod for every operation and implement it for each format in the separate namespace."
348,1548832394.8122,Tammera,"right, I am not challenging the use of a multimethod. What I think what could resolve your circular dependency is moving the _definition_ of the multimethod away from its _use_."
348,1548832533.8135,Jonah,"Yes, but then namespace where I _use_ the multimethod has to require both the definition and the implementation namespaces?; or am I missing something?"
348,1548832609.8148,Becki,"i don't think that's actually true. the namespace needs to require the `defmulti` ns but it does not need to require the ns where the `defmethod` is defined. That namespace has to have been required already, but not necessarily here."
348,1548832622.8151,Tammera,"^right, that is true, thanks for that clarification"
348,1548832662.8157,Becki,so you could require all of the implementing namespaces in your start up and be assured that they are all ready to go
348,1548832797.8175,Jonah,"that will solve the problem, I'm just concerned that later someone can remove this ""require"" because they won't be explicitly used in startup namespace.; That what I meant by implicit dependency."
348,1548832850.8189,Tammera,"Also, I think my suggestion would work, I would have a ns `use` that depends on the namespace `define` + all namespaces `extend`, where each `extend` namespace depends on `define`. I don’t think there is a circular dependency there, but I am lacking some paper to draw it out ^^"
348,1548832862.8192,Jonah,"If there is no better way, I can live with this solution of course.; Yes, that will work. Thanks, <@Tammera> and <@Becki>"
349,1548838256.8206,Cecil,"hey i have a question about `letfn`; as i search around, i knew that `letfn` is for use of function that is not defined yet. (something like mutual recursion); but, if i try mutual recursion with `let`, it perfectly works!; why does this work?; ```
  (let [odd? (fn [n]
               (if (zero? n)
                 false
                 (even? (- n 1))))
        even? (fn [n]
                (if (zero? n)
                  true
                  (odd? (- n 1))))]
    (odd? 5))
```; so if `letfn` supports ahead-of-defintion use of function and `let` doesn't that code shouldn't work"
349,1548838444.8258,Diamond,Cause the first `even?` is `clojure.core/even?`.
349,1548838496.8273,Cecil,ahh; i got it
349,1548838511.8279,Diamond,Call the bindings f and g and it will :bomb:
349,1548838568.829,Cecil,"thanks; btw, then `letfn` doesn't use existing function if there is definition in it?"
349,1548838667.8306,Diamond,Only one way to find out. :smile:; Night! :sleeping:
349,1548838767.8314,Cecil,"gonna play with repl :slightly_smiling_face:; yup it ignores existing function; ```
(letfn
          [(odd? [x] (even? x))
           (even? [x] true)]
        (odd? 5))
;= true
```; it has weird naming but nvm"
350,1548843335.8373,Jalisa,"Hi. I am looking for an elegant way to construct a map based on multiple conditions. This is what I have: ```(defn build-foo []
  (let [m {}
        m (if cond-1?
            (merge m {:foo 1 :bar 2})
            m)
        m (if cond-2?
            (merge m {:x 1 :y 2})
            m)]
        ;; continue with cond-3 ... cond-n
    m))```"
350,1548843464.8377,Tammera,(use three backticks to format code spanning multiple lines)
350,1548843535.8383,Harris,`(merge m (when cond1? {:foo 1 :bar 2}) (when cond-2? {:x 1 :y 2}))`
349,1548844311.8391,Min,"`(cond-&gt; m (foo? x) (assoc ....) (bar? y) (assoc ..))` or `(cond-&gt; m (foo? x) (conj ....) (bar? y) (conj ..))`; imho merging with (only) 2 args is quite often a smell, especially when you are sure the first arg is a map (non nil)"
349,1548845667.842,Epifania,"Hm, so it seems `clojure.trace/trace-ns` doesn't accept a namespace as a string. I currently have a list of namespaces in a list with strings. I would like to pass them to `trace-ns` inside a `doseq`, but always get ""No namespace: n found"" (`n` is the name of my variable, seems `trace-ns` doesn't read the value of the var but instead the symbol itself); Guessing I'm looking for the opposite version of `ns-name`"
351,1548853251.8429,Cherise,"```
user=&gt; (find-ns (symbol ""user""))
#object[clojure.lang.Namespace 0x386f0da3 ""user""]
user=&gt; *ns*
#object[clojure.lang.Namespace 0x386f0da3 ""user""]
```"
351,1548853286.8431,Epifania,Many thanks. Will try it out in a bit and report back
351,1548853412.8434,Cherise,"So it probably works when you map `symbol` over your list of strings

`(map symbol namespaces)`"
352,1548854880.8449,Deloise,"hi folks, I have a clojure project that has been packaged with `lein jar`, how do I run it? :smile: I've only ever used `lein uberjar`"
352,1548856028.8479,Jasmine,"are you running it with lein or separately? if the former, lein run probably does the right thing. if the latter, you need to include the jar and all transitive dependency jars on the java classpath, then run the main class. `java -cp my.jar:foo.jar:bar.jar my.mainns`"
352,1548856617.8504,Deloise,I am using lein. Does `lein run` use java classes in `:java-source-paths`? I was thinking the instruction to use `lein jar` (from the creator of the project) was to also include a separate java class.
352,1548856813.8519,Jasmine,"I think lein run includes the class output target dir in its path and Clojure will use the classes if it finds them (before the .clj); oh, sorry you asked about java classes; I would expect it to only find java classes in the target output, not in java source paths"
352,1548856880.8534,Deloise,I've managed to get the project running with `lein repl`
352,1548856885.8536,Jasmine,"(but don’t take my word for it, that’s just my expectation)"
353,1548865747.8551,Nova,"I have a vector of hash-maps that I wish to namespace qualify, and I'm curious about how to do this idiomatically (`(map #(reduce-kv ...))`?), and why the first example here does not work:

```
(reduce-kv #(assoc %1 #:ns{%2 %3}) {}  {:k ""v""}) ;; =&gt; CompilerException java.lang.RuntimeException: No such namespace: ns etc..

(reduce-kv #(assoc %1 :ns/%2 %3) {}  {:k ""v""}) ;; =&gt; #:ns{:%2 ""v""}

(reduce-kv #(assoc %1 (keyword ""ns"" (name %2)) %3) {}  {:k ""v""}) ;; =&gt; #:ns{:k ""v""}
```"
354,1548867107.8563,Jasmine,"the #:ns{} syntax is a literal map syntax. that is, it’s not a property of the map, it’s just a syntactic alternative when writing literal maps.; similarly, :ns/%2 is a keyword whose name is literally %2; both of these are things happening at read time, with no eval; the last one seems like a fine solution; there are some common utility functions (often called `map-keys` or `map-vals`) that apply a function to all of the keys or vals of a map and that might be an easier way to think about it. You can find those functions in many of the utility libs (medley, useful, etc); something like `(map-keys {:k ""v""} #(keyword ""ns"" (name %)))`"
354,1548867364.8595,Nova,"excellent, thank you"
355,1548868962.8625,Arline,Is there any way to get a list of loadable classes on the classpath easily without relying on a library like `compliment`? The code in `compliment` is surprisingly complicated and this feels like something that the JVM should be able to do natively via the Classloader interfaces or something?
354,1548869261.8631,Jasmine,"classloaders generally don’t have a notion of what *can* be loaded, just what has been loaded; the classloader interface intentionally abstracts the notion of “where classes come from” and they could come over the network where there is no way to enumerate them all; or out of a database (I did one of those once)"
356,1548872454.8647,Cherise,"E.g., <https://weavejester.github.io/medley/medley.core.html>"
357,1548872666.8676,Floria,Hi all. I have a problem in my application. Some sort of classloader memory leak. I see that amount of classes is constantly increasing and heap dump is dominated by entries like `clojure.core$eval100009` with no instances. How can I figureout what is generating this classes?
357,1548872954.868,Rosaline,you are calling eval in a tight loop somewhere
357,1548873101.8683,Floria,"Well I guess I do :slightly_smiling_face:; but not explicitly apparenlty. My code have only one call to eval and it is not in any sort of tight loop...; that is why I ask ""how to figureout what is generating those"""
357,1548873186.8707,Rosaline,you are running that code over and over again more often then you think you are
357,1548873233.8715,Floria,"I doubt that this is in my code, but I'll double check..."
357,1548873302.873,Dann,"I would drop any library that uses eval outside some sort of start-up DI type scenario, runtime eval is a code smell"
357,1548873341.8735,Floria,This is easier said then done :slightly_smiling_face: how to detect which library?
357,1548873381.8746,Dann,you can (for debugging / local purposes only) replace clojure.core/eval with a function that logs stats about usage (including stack trace) then calls the real eval
357,1548873394.8749,Rosaline,"libraries are basically garbage, so just get rid of them all"
357,1548873397.8752,Dann,haha
357,1548873446.8756,Floria,"nice advice, cant follow unfortunately :slightly_smiling_face:"
357,1548873489.8766,Rosaline,just start naming off the libraries you use until we yell bingo
357,1548873491.8767,Dann,"regarding _how_ to replace eval with logging version, `alter-var-root` is pretty straightforward to use"
357,1548873572.8779,Floria,What if this eval is binded inside some function? Will alter-var-root help?
357,1548873602.8787,Rosaline,"but seriously, I would look at your own use of eval"
357,1548873608.8789,Dann,"yes, functions compile to code that looks up vars - the gotcha is if eval was provided as an arg to a first class function - which is rare; agreed with <@Rosaline> and logging eval usage would expose that this is the issue as well"
357,1548873717.8804,Floria,I doublechecked my usage of eval - it only happen once during initial app compilation
357,1548873728.8806,Jasmine,and a caveat that Clojure core itself is direct linked compiled so calls within core won’t see changes from alter-var-root
357,1548873771.8809,Dann,"```(ins)user=&gt; (alter-var-root #'eval (fn [v] (fn [&amp; args] (println ""calling eval on"" (pr-str args)) (apply v args))))
#object[user$eval151$fn__152$fn__153 0x158a3b2e ""user$eval151$fn__152$fn__153@158a3b2e""]
(ins)user=&gt; (eval '(+ 1 1))
calling eval on ((+ 1 1))
2
```; <@Jasmine> true but I think we can trust that clojure.core isn't using eval in a sloppy way"
357,1548873833.8823,Floria,<@Dann> let me try that
357,1548873841.8825,Rosaline,"I dunno, maybe he is using the socket repl as an rpc"
357,1548873846.8827,Jasmine,"Java profilers can also help you with stuff like this (YourKit, JProfiler, etc)"
357,1548873869.8829,Floria,Got it!; I found what is causing my issue. Thanks <@Dann>. Now have to think how to avoid that. Btw culprit is dynamic sql generator from yesql
357,1548874242.8854,Dann,"I would be surprised if whatever yesql is doing couldn't be replaced by a higher order function rather than using eval, I'm disappointed to hear it's doing things that way; also, hugsql is newer and supposedly addresses some design issues from yesql; (but works similarly); even yesql's readme mentions hugsql and the fact that hugsql is actively maintained unlike yesql"
357,1548874537.8909,Floria,"Well, problem is little bit deeper than yesql. I attached template engine (comb) to yesql that give me dynamic sql generation (yesql can't do that out of the box) and this lib is actually main culprit. I like this feature a lot, though I need to use it more carefully because of this problem... Hugsql is way too much rewrite for me, maybe I'll consider this later"
358,1548877000.8923,Arline,<@Jasmine> Ah that's interesting. I guess that's why `compliment` has all the code it has for finding jars and class directories and such and just lists them?
357,1548880708.8939,Georgine,"I spent way too much time getting lumo working on an older server without testing the clojure command to run scripts. It doesn't even take a second, and I can use all the java libs... Slow start-up time is barely noticeable if you aren't using lein and not too many deps."
359,1548903703.8954,Donetta,"is there an existing library for converting a swagger.json file or json schema file into spec definitions?  I know spec-tools supports spec to both formats, but I'm more interested in the opposite direction"
360,1548928025.8969,Alia,"Hello, does anyone know of a way to decode php laravel sessions in clojure?"
360,1548928462.8977,Brent,FYI I couldn't find any documentation (outside of the clojuresque api docs :)) on how to use prepl so I wrote some <https://blog.jakubholy.net/how-to-use-clojure-1.10-prepl/>
361,1548934132.898,Toby,maybe walkable? <http://walkable.gitlab.io/>
362,1548944253.8989,Zenaida,"Hi folks! My current task is to profile a Clojure app (with Aleph and core.async) and after googling for some time it seems that is not an easy task like in Golang... I need some metrics like ""how many goroutines are running"", memory, and cpu. Does anyone know a way to get these metrics?"
362,1548946825.9016,Henry,"<@Zenaida> I don't know about any tools to get stats for core.async specifically, but for memory and CPU profiling there's the usual JVM tools like <https://visualvm.github.io/>"
362,1548949721.9026,Sherril,<@Zenaida> also aleph exposes metrics of its thread-pool
362,1548950466.9028,Zenaida,Thanks! I will search for that now
361,1548952359.9044,Clarine,"ehm, I used metadata on a fn like this:
```
(defn ^String foo ([] """") ([a] (str a)))
(set! *warn-on-reflection* true)
user=&gt; (.length (foo))
0
```
Apparently that works too, although I can’t find it in the docs like this."
361,1548952402.9047,Jasmine,"you’re putting it on the var there, not the fn"
361,1548952422.905,Clarine,why don’t I get a reflection warning then?
361,1548952432.9053,Jasmine,because it’s using the var meta; it’s not reflecting
361,1548952451.9059,Harris,non primitive return type hints work on the var too
361,1548952457.9061,Clarine,"so this is cool, unless you use direct linking?"
361,1548952495.9066,Jasmine,"your use of “too” above seems like there is some prior conversation this is in reference to, but I haven’t read that; just mentioning that in case there is context I should be aware of"
361,1548952529.9074,Clarine,AFAIK there isn’t a prior conversation about this
361,1548952557.9079,Jasmine,"so “too” above implies there is something else that works, but not sure what that is"
361,1548952574.9087,Harris,I was referring to type hints on the argvec
361,1548952587.9092,Clarine,"to summarize, should I change my type hint, or does this work correctly?"
361,1548952589.9093,Jasmine,"not your “too”, <@Clarine>’s “too”"
361,1548952592.9095,Harris,ah :); we need name qualified words in english; borkdude/too
361,1548952623.9107,Clarine,"oooh, sorry :slightly_smiling_face: I mean instead of putting the return type hint on each arity"
361,1548952634.911,Harris,"it works, I hate it; it's fine as is, but it makes me sad"
361,1548952652.9117,Jasmine,"yeah, it works, but I agree with bronsa that putting it on the ret type is better"
361,1548952663.912,Clarine,so I need to repeat the type hint for each arity?; and why you sad?
361,1548952671.9124,Jasmine,yes; not every arity has to have the same return type
361,1548952693.9135,Clarine,"no problem, I’ll do it, just want to know why"
361,1548952699.9137,Jasmine,(not that I would recommend having different return types)
361,1548952719.9143,Harris,"it's just a matter of consistency, tagging return types on the argvec is guaranteed to work with any legal type hint and Do The Right Thing; there is a string of cases where tagging return types on the var doesn't do what you want, silently"
361,1548952733.915,Jasmine,I think it’s also the tightest scoping to your intent
361,1548952738.9152,Harris,yup
361,1548952777.9157,Clarine,ok - thanks `{::keys [:bronsa/too :alexmiller/too]}`
361,1548952989.9161,Jasmine,Syntax error macroexpanding clojure.core/let at (REPL:1:1).
363,1548953453.9167,Harris,"who said that's code, it's just data bruh"
361,1548953802.917,Clarine,it’s tha core specz yo: <https://dev.clojure.org/jira/browse/CLJ-2473>
364,1548957822.9181,Melania,how can I `spit :append` below whatever text already exists in a file?
364,1548958070.9183,Fae,<@Melania> <https://clojuredocs.org/clojure.core/spit#example-542692c7c026201cdc326975>
364,1548958104.9186,Melania,"<@Fae> thanks, interesting"
365,1548959368.9196,Arnoldo,Anybody aware of a walk-through describing how reagent components that deref an atom register themselves as watching that atom?
365,1548959582.9203,Dann,"<@Arnoldo> my memory is that r/atom deref itself does the registration, since the deref happens inside the component data literal; but I haven't touched reagent in ~year; <@Arnoldo> the magic is all here <https://github.com/reagent-project/reagent/blob/master/src/reagent/ratom.cljs#L43>; I think this is the line that literally answers your question: when you deref an ratom, your context is captured as a watcher <https://github.com/reagent-project/reagent/blob/master/src/reagent/ratom.cljs#L145>; or, more precisely: no walkthrough that I know of, but the code isn't that hard to read"
365,1548960018.9227,Arnoldo,<@Dann> thanks... yeah you're right I shouldn't be lazy and just read the source
365,1548960145.9232,Dann,"well, hopefully at least knowing the precise place the behavior is defined is a good start; I could imagine it eg. being part of the mounting code or the component loading code"
365,1548960169.9238,Arnoldo,"definitely saved me some trouble, appreciate it"
366,1548963186.9268,Isa,"<https://github.com/seancorfield/depstar>
<https://github.com/juxt/pack.alpha>
<https://github.com/luchiniatwork/cambada>

I found 3 uberjar maker for deps.edn with `clj`. Do we need 3 as community? I always like simplicity about Clojure tools and making choices. Which one is recommended?"
366,1548963214.927,Clarine,"if you want simplicity, make no uberjar :stuck_out_tongue_winking_eye:"
366,1548963298.9275,Isa,"What then? I want it for Docker image, so I don’t want to share source code"
366,1548963322.9278,Clarine,just mount the source code?
366,1548963357.9286,Isa,"&gt; I want it for Docker image, so I don’t want to share source code
:wink:"
366,1548963360.9288,Clarine,oh you DON’T want to share the source code; sorry :slightly_smiling_face:; so you want to AOT it and publish without the .clj files?
366,1548963384.93,Isa,no problem :slightly_smiling_face:; yes
366,1548963422.9312,Rosaline,I believe most of that tooling just zips up the source code and calls it a jar
366,1548963431.9314,Isa,"It was working perfect with lein, but I am moving with all new stuff to deps.edn; hmm"
366,1548963455.932,Clarine,"I’m still using lein to deploy for some projects, next to clj, I guess you could use both"
366,1548963517.9332,Rosaline,"the clj tooling has been explicitly called ""not a build tool"" over and over again, and aot compiling seems like a clear cut build step (of course so does building jars); the pack.alpha has some suggestions for adding aot compilation on top of it, but it seems pretty adhoc"
366,1548963623.9353,Isa,"Hmm I can use lein only to build jar from deps.edn, but I feel strange about that."
366,1548963675.9364,Rosaline,"cambada actually defaults to aot compiling everything because it larger looks it is for building graal-native stuff, which requires aot"
366,1548963704.9369,Becki,no worries about that. there's a lein plugin to gather deps from deps.edn so you can just use lein for build tooling and deps.edn for what you use it for now.
366,1548963728.9376,Isa,<@Becki> sure I know that plugin
366,1548963767.9387,Rosaline,"it just seems like, if you have some weird corner case (building aot jars) and it is well served with lein, why make the change to clj?"
366,1548963815.9401,Isa,I like clj more than lein :slightly_smiling_face:
366,1548963817.9403,Becki,"i understand lein and deps.edn use subtly different dependency resolution so i'm not sure that your built artifact is guaranteed to reflect what you developed. Need to find out what that plugin does, if it resolves everything in the way tools.deps.alpha would do (and i suspect this is what it does)"
366,1548963855.9409,Isa,And clj solve other corner cases easy like git dependency or local folder dependency
366,1548963875.9417,Celestine,"Why, specifically, do you not want a JAR containing `.clj` source files? That's how we package everything for production deployment at work."
366,1548963887.9422,Epifania,"distributing paid binaries?; (I'm not doing that so no idea really, just guessing)"
366,1548963915.9437,Clarine,like Datomic
366,1548963917.944,Celestine,"(we use my fork of `depstar` to build uberjars from source, and run them with `java -cp path/to/the.jar clojure.main -m entry.point ...` in production)"
366,1548963924.9442,Rosaline,"but you have to ask yourself, what are you trying to protect against"
366,1548963935.9447,Isa,for example security reasons and not free software
366,1548963942.945,Rosaline,"like, jvm bytecode is super high level and easy to decompile anyway"
366,1548963954.9454,Celestine,"Folks can always ... yeah, what <@Rosaline> said..."
366,1548963972.9463,Becki,bronsa built a pretty good decompiler from class files to clj in addition to the classfile -&gt; java decompilers
366,1548964000.9473,Isa,"sure, but decompile Clojure is probably much more difficult to debug, than Clojure code"
366,1548964006.9476,Celestine,There's no security provided by AOT compiling Clojure code.; (or compiling Java code)
366,1548964037.9485,Rosaline,<https://www.youtube.com/watch?v=2SGFeegEt9E>
366,1548964041.9487,Isa,"I know, just sharing source of the code sounds risky for me and second reason: not all code is for free :wink:"
366,1548964063.9491,Clarine,<@Isa> with who are you doing to share it?
366,1548964106.9501,Rosaline,"but, I mean, plenty of not free code is distributed everyday, right? that is what a license agreement is for"
366,1548964110.9505,Isa,"I don’t want to go deep into security topic, that was not the point of my question :stuck_out_tongue:"
366,1548964122.951,Celestine,"Software licensing is ... yeah, dammit, what <@Rosaline> said! (again)"
366,1548964128.9512,Rosaline,"I dunno, I mean it is standard industry practice and whatever, but it is so silly; <https://www.microsoft.com/en-us/sharedsource/>"
366,1548964170.9521,Isa,then you could make everything public :wink: For example source code of bank systems.; So I can agree only partially with you
366,1548964190.9533,Rosaline,the idea that not giving out the source code is some kind of barrier is silly; banks absolutely should be able to publish their source code; why not?
366,1548964232.9548,Jasmine,"next thing, you’ll want the source code for voting machines"
366,1548964236.9549,Dann,"I'm sure somebody out there has a Classloader implementation that loads encrypted resources based on a key that needs to be present at runtime, I bet it's a pain to actually use though"
366,1548964249.9556,Rosaline,linux is insecure because its source code is publicly available; qed
366,1548964271.9563,Isa,I am afraid if bank will publish they source code many people will lose they money :wink:
366,1548964286.957,Jasmine,"don’t tell anyone, but banks use a lot of open source software"
366,1548964289.9572,Rosaline,<@Dann> which is a key distribution problem not a source code problem; <@Isa> that is based on a deeply flawed understanding of the basis of computer security
366,1548964322.9585,Dann,"worse than that, they use fundamentally insecure things like FTP; they use legal means to fix the ensuing problems"
366,1548964377.9596,Marlyn,this is a neat idea
366,1548964406.9603,Isa,that is why we have distributions like `alpine`
366,1548964408.9605,Rosaline,"if you look at crypto these days, no one wants to use a crypto system that relies on the implementation being secret, only on the keys being secret, they want everyone to know the implementation; what does that even mean?"
366,1548964470.9612,Isa,<https://alpinelinux.org>
366,1548964506.9616,Rosaline,"I know what alpine linux is, I just don't see how it anyway addresses my point; alpine linux is insecure because the source code is publicly available"
366,1548964537.9626,Isa,So do you want to say me you publish source code of your all projects? Free and pay? I don’t believe.
366,1548964565.9634,Clarine,<@Isa> there’s a difference between a business model and security
366,1548964581.9642,Isa,<@Rosaline> blockchain idea is to be public. It is different topic.
366,1548964590.9645,Rosaline,"legally I am unable to publish the source code to the stuff I do for pay because the rights are not mine; <@Isa> by crypto I mean ""cryptography"" not digital ponzi schemes"
366,1548964650.9664,Isa,I am sure there is dependency between code publicity and number of trying hack. But it is besides of our topic.
366,1548964728.9674,Rosaline,"there are reasons not to provide source code, but if you put security on that list you have failed to secure anything"
366,1548964777.9675,Isa,"I mean because code is public and everybody know what system cointain, we needs solutions like alpine; I believe it reduce probability. Not making system secure. Just reduce attention and make things harder to hack."
366,1548964876.9689,Rosaline,<https://en.wikipedia.org/wiki/Security_through_obscurity>
366,1548964889.9695,Isa,But things are different for very popular public projects where security start to go on higher level.
366,1548964889.9696,Rosaline,"""Security experts have rejected this view as far back as 1851"""
366,1548964912.9702,Meagan,I think it's pretty proven-out that open vs closed source doesn't have much bearing on security; usually people want to keep their source closed for business reasons; i.e. I don't want a competitor to steal my codez
366,1548964975.9714,Isa,Anyway business reasons are enough to do it
366,1548964996.9718,Meagan,"but it's kinda silly, because that's what licensing and legal teams are for :slightly_smiling_face:; it's just putting a barrier in place. it's fairly easy to knock down"
366,1548965047.9727,Isa,So whole world is silly doing that :wink:
366,1548965115.9729,Meagan,plenty of businesses are based around JS applications that everyone downloads the source for ¯\_(ツ)_/¯
366,1548965297.9745,Isa,Why did you make depstar instead of use <https://github.com/juxt/pack.alpha> or <https://github.com/luchiniatwork/cambada> ?
366,1548965320.9754,Meagan,"anyway, not saying that everyone _should_ make their code publicly available. but that going to _great lengths_ to obfuscate it is probably not worth the time/money; AOT is great for perf if you need it. as obfuscation from a business/security perspective, it's not that great and in the case of Clojure can be work to make sure all code deals with it well"
366,1548965504.978,Celestine,AOT is great for _startup time_ -- not performance.
366,1548965521.9784,Meagan,fair!
366,1548965572.9798,Celestine,There is no difference in performance since Clojure source code is compiled when it is loaded anyway and the JVM will do its JIT thing over time as the application runs -- AOT just saves that initial compile time on load.
366,1548965601.9805,Clarine,"yeah, considering that we’re doing AOT for each deploy, it kind of defeats the purpose (you only benefit from it once) - except that we maybe have a little less downtime between deploys"
366,1548965661.9816,Celestine,"For us, the biggest chunk of startup time is New Relic's instrumentation agent processing all of the classes as they load. The difference between AOT and non-AOT for us is noticeable but relatively small in comparison.; Because `depstar` does what I want and is nice and minimal. And <@Marlyn> made `depstar`. I just forked it, fixed some bugs, and added the ""thin JAR"" creation feature."
367,1548965754.9819,Celestine,"Also, I'm pretty sure Cambada didn't exist when `depstar` was created?"
366,1548965783.9822,Isa,"not always true, if you run app in kubernetes to do a job or create new containers when needed, then it is not once"
366,1548965819.9824,Clarine,"I was referring to an app we run in production. In general (for libs, etc) you can benefit from it more."
366,1548965838.9826,Isa,"How does it work in the context of:
<https://clojurians.slack.com/archives/C03S1KBA2/p1548963422931200>"
366,1548965850.983,Celestine,"Juxt's `pack.alpha` came first (back in December 2017, it seems). Then `depstar` in early 2018. Then Cambada. Based on initial commits, not public releases.; Not sure what you mean by that question... that's _exactly_ what `depstar` does."
366,1548965985.9834,Isa,Sorry if I am asking about something stupid. But does it only pack source files or compile them into different format? As I understand compile to different format. But hiredman wrote “just zips up the source code and calls it a jar” and it make me confuse.
366,1548966018.9837,Celestine,"A JAR file is just a ZIP file with the extension `.jar`; Not sure what you mean by ""compile them into different format""."
366,1548966100.9841,Isa,hmm so how AOT is added?; Does it still need .clj files after that?; So then what source code doing there?
366,1548966446.9847,Celestine,"When you compile Clojure source `.clj` files, you get `.class` files. You don't need the `.clj` file present if you have all the `.class` files that it compiles into -- unless it does some action at runtime that would require the source (such as loading a specific source file). AOT is transitive (which is considered a bug by most people -- there is at least one open JIRA issue about it) which means it compiles the namespaces you specify _and any namespaces that are reached by loading those namespaces (recursively)_ -- which means that if your AOT'd code uses `require`/`resolve` at runtime on namespaces that were not part of the AOT pass, you still need their source files."
368,1548966554.9849,Isa,So all solutions like lein uberjar etc. include source files?
366,1548966628.9851,Celestine,"It depends on whether you configure them to AOT everything or just specific namespaces. And even at runtime, Clojure code can still pull in new dependencies (as source code) and load them (which compiles them into class images in memory).; I think it's a long-standing mistake that Leiningen chose to have as the default in its basic app template, a compiled main namespace and a `:gen-class` directive.; Leiningen does a lot of stuff by default that is not necessary."
366,1548966739.9857,Isa,So… do you suggest to always include source code? What about business?; Is there any right solution? How do you protect source code?
366,1548967057.9862,Celestine,Licensing. As several people said.
366,1548967203.9864,Isa,"It doesn’t protect source code in any way. It makes potential penalty if you can prove it.; ok so I assume you make source code public for all your apps (unless it is on cluster only, so they can’t read anyway); Thanks for explanation; Just to summary up what I wanted to say and avoid misunderstanding:
Not publish code doesn’t make code more secure.
But publish code increase a risk to be hacked. For example bot looking known bugs in public code, which will notice hacker you use dependency with security issue, have overflow bug etc."
366,1548968477.9894,Celestine,"All the code I have written for myself, that I own the rights to, has been open source -- for about thirty years. The code I write for companies, in general, is owned by those companies and it's up to them whether they release it publicly. Some code I wrote for Macromedia was open sourced (in the early 2000's). Some code I wrote for a client after I quit Adobe in 2007 was open sourced. Various companies I've worked for have open sourced some of their code. My current employer supports all of its developers contributing to existing open source projects -- and has allowed me to release a number of libraries as open source that were written internally, as well as having its own GitHub organization with some open source libraries.; We have some code at work that is proprietary in terms of containing internal business logic and/or algorithms -- but we wouldn't release that in compiled format. Nothing to do with source code."
366,1548968575.9898,Isa,"&gt; All the code I have written for myself, that I own the rights to, has been open source -- for about thirty years.
I envy you have such opportunity to do it :slightly_smiling_face:"
366,1548968598.99,Celestine,"A couple of our developers have given conference talks, going into some depth about how we use certain software and sharing code examples publicly.; The real reason most companies won't release their code as open source is that they don't want to have to maintain it as an open source project -- because that's a big commitment. We've had a lot of discussions about that internally."
366,1548968662.9916,Felix,"Anyone have a recommendation of a smalltalk written in clojure? I'm mainly interested in the ""liveness"" and ""object protocol"", not so much the parser.

EDIT: removed incorrect statement regarding Clojure / Protocols"
366,1548968707.9917,Isa,"oh yes, it is"
366,1548968718.9919,Celestine,"For a long time, we only had one official company library available as open source, and it was on BitBucket (an internal repo made public), and that was all about the potential drain on our time for maintaining it for the community if we put it up on GitHub for ""everyone""."
366,1548968796.9923,Rosaline,it isn't
366,1548968809.9924,Celestine,"With the primary delivery platform now being the web, there's no deliverable for backend code to clients, so compiling (to whatever format) is far less important. And of course all your client-side code _is public as JavaScript_ and the entire world can read it."
366,1548968831.993,Rosaline,"clojure doesn't have an mop, and protocols are not based on smalltalk"
366,1548968870.9938,Celestine,Anything delivered as a desktop app built on Electron etc -- all your source code is public there too. Because JavaScript.
366,1548968887.9944,Isa,hmm unless we use solutions like electron to make desktop app it is mostly true; hmm; good point
366,1548968935.9951,Celestine,Companies like Microsoft are now releasing huge swathes of code as open source. Closed source is pretty much dead as a concept as far as modern companies are concerned.
366,1548968946.9953,Isa,"so I would say it is issue / feature of Java / JavaScript world; &gt; Closed source is pretty much dead as a concept as far as modern companies are concerned.
That is interesting topic. I see this trend more and more, but I have never seen rationale for that.; Do you know good article about that?"
366,1548969021.9959,Celestine,"PHP, Python, Ruby... all delivered as source code, regardless of whether the code is open source or restricted by licensing."
366,1548969080.9968,Felix,I removed in correct statement regarding Clojure / Protocols. Regarding original question -- is there any readable impl of Smalltalk in Clojure ?
366,1548969118.9969,Isa,"licensing is ok, but is is hard to deal with people who don’t respect it; Maybe in US it is easier, I don’t know"
366,1548969154.9977,Jasmine,"re smalltalk, I think <http://cloxp.github.io/> is smalltalk inspired"
366,1548969159.9979,Celestine,That's always been true tho' even with proprietary closed source systems -- look at how widely pirated desktop software from Microsoft and Adobe is...
366,1548969225.9981,Isa,"Yeah, it is interesting move from MS to let run they system without cracks.; I think they did it"
366,1548969240.9985,Celestine,"Adobe has a specific software license enforcement team that work with law enforcement worldwide and they conduct raids on pirating organizations, as well as sue companies that use pirated versions of their products. I'm sure Microsoft, Oracle, et al all do as well."
366,1548969257.9987,Isa,"But on the other hand they power is in number of users, also this who crack they system"
366,1548969301.9989,Celestine,"Unless you're a giant mega-corp, with billions in revenue from closed source desktop systems, piracy is really not worth worrying about tho'..."
366,1548969306.9991,Isa,"I mean more people use they product, better for them, because more people will buy a licence."
366,1548969336.9993,Celestine,"Your ideas in software are not likely to be novel :slightly_smiling_face:; There's much less true innovation in software than a lot of people seem to think.; So the software you produce -- there's almost no benefit to keeping it ""secret"" in the vast majority of cases."
366,1548969428.9999,Isa,Still if somebody will do copy &amp; paste your system for which you spent a lot of money you will feel bad about that; This things can easy happen in Russia or China
366,1548969470.0003,Celestine,"If you really ""spent a lot of money"" and have a large amount  of business riding on it, sue for license infringement. That's what licenses (and courts) are for.; And if it's closed source, they'll just crack the product anyway. It's no defense."
366,1548969506.0007,Isa,I think Russia and China don’t care about that too much
366,1548969523.0009,Celestine,"Really, if you think closed source vs open source is some magic defense against piracy/cracking you're delusional :slightly_smiling_face:"
366,1548969525.0011,Isa,"but it is fair point; no, I don’t"
366,1548969559.0015,Celestine,"Exactly, Russia and China et al will do whatever they want with your software regardless of whether you release the source or not!"
366,1548969640.0017,Isa,Reversing situations: so why companies close they source code? Everything should be public.
366,1548969673.0019,Celestine,"Example: a Clojure open source library out there was made by a Russian as a copy of one of my libraries and they removed the license and copyright notices and passed it off as their own code. They announced the library on the Clojure mailing list and I called them out for license infringement -- and they recanted because they were caught in public breaking the rules.; Closed source is the old-fashioned model. Companies with old-fashioned thinking still follow that model. Companies still use COBOL, for example :slightly_smiling_face:; This is an interesting article on the thinking behind keeping things closed: <https://opensource.com/business/13/10/seven-reasons-closed-better-than-open-source>"
366,1548969809.0026,Isa,"To be honest I think I don’t have strong opinion in that topic; I think there is no answer for that; But for example turquoise model of managing business is new “fashion”, but I don’t believe it fits everywhere; &gt; You never have to fix components when something goes wrong.
haha I like this one"
366,1548970036.0051,Celestine,"&gt; But publish code increase a risk to be hacked. For example bot looking known bugs in public code, which will notice hacker you use dependency with security issue, have overflow bug etc.
A good, relevant example here is Slack. The JavaScript code is not open source but it is public because of the way web apps work and it has a stupid exploit in it that allows hackers to bypass security checks in the client. Slack have known about it for years but refuse to fix it. If their source code was actually open source, you can bet they'd be deluged with pull requests to fix security issues like that.; That's why open source code is often *more secure* and *less hackable* than closed source code -- more eyeballs, more developers wanting to help fix vulnerabilities."
366,1548970099.0061,Isa,Thanks for conversation. I think it changed my point of view a little.
366,1548970140.0063,Celestine,"You're welcome. As you can imagine, I'm very much an open source advocate, having been doing this for about thirty years :slightly_smiling_face:"
366,1548970232.0074,Isa,"I agree about all popular projects. Just not sure if it will work the same if you will publish the system, which only you maintenance. For example small SaaS or system which you use only in company X. I think true is not black and white. But I agree. It is fair point.; I can imagine. I would like to do more open source, but not so easy. Trends from US go to Poland after a few years :wink:"
366,1548970623.0104,Laurinda,"I've spent the last hours hunting down an obscure compilation problem with a cryptic error message. I still don't understand it, but it seems that if I mark a `(def q (into (sorted-set) [1 2 3]))` with a `^:const`, then *other* files that need `q` for their `(def)s` will not compile. And I now know that `sorted-set` and `^:const` are needed. A vector won't cause it.; Just wanted to check if this rings a bell with anyone."
369,1548970672.0108,Ciara,disabled an integration in this channel: <https://clojurians.slack.com/services/BEW89FKAA|outgoing-webhook>
366,1548970891.0119,Jasmine,const means inline at point of use (that explains the scope of where you see the issue); I don’t think sorted-sets can be const - they have an embedded comparator function that’s not representable as data
366,1548971061.0134,Laurinda,Hmm. I didn't know there are things that can't be const.
369,1548971088.0138,Laurinda,"The error messages are… suboptimal.
```
Exception in thread ""main"" Syntax error compiling at (/tmp/form-init5251724450573718419.clj:1:73).
 [...]
Caused by: java.lang.ClassCastException: Cannot cast clojure.lang.PersistentVector to clojure.lang.ISeq
```"
366,1548971162.0143,Jasmine,<https://dev.clojure.org/jira/browse/CLJ-944> is in the ballpark of this - it’s a really tricky corner of the compiler
366,1548971287.0158,Laurinda,"This is way beyond me. I searched the bugtracker before asking, but I wouldn't have recognized this issue as related. Anyway, it isn't a major problem, it's just that finding the cause is very difficult."
366,1548971408.0167,Jasmine,can you repost the root cause of that exception chain (the last one one)?
366,1548971491.0176,Laurinda,"Sure. I just abbreviated it, because it seemed rude to clog people's screens:
```
Caused by: java.lang.ClassCastException: Cannot cast clojure.lang.PersistentVector to clojure.lang.ISeq
        at java.lang.Class.cast(Class.java:3369)
        at clojure.lang.Reflector.boxArg(Reflector.java:552)
        at clojure.lang.Reflector.boxArgs(Reflector.java:585)
        at clojure.lang.Reflector.invokeMatchingMethod(Reflector.java:132)
        at clojure.lang.Reflector.invokeStaticMethod(Reflector.java:332)
        at clojure.lang.Reflector.invokeStaticMethod(Reflector.java:325)
        at clojure.lang.LispReader$EvalReader.invoke(LispReader.java:1322)
        at clojure.lang.LispReader$DispatchReader.invoke(LispReader.java:853)
        at clojure.lang.LispReader.read(LispReader.java:285)
        at clojure.lang.LispReader.read(LispReader.java:216)
        at clojure.lang.LispReader.read(LispReader.java:205)
        at clojure.lang.RT.readString(RT.java:1874)
        at clojure.lang.RT.readString(RT.java:1869)
        at partsbox.preferences__init.__init1(Unknown Source)
        at partsbox.preferences__init.&lt;clinit&gt;(Unknown Source)
        ... 34 more
```
The last 2 lines reference my file: it's the one that uses the `^:const` definition."
366,1548971545.0182,Jasmine,to get this you have to think about what the compiler is doing. it’s trying to inline a value rather than look it up via the var.; it’s going to include that value in the class compiled for the function using the inlined value
366,1548971696.0216,Rosaline,"I, and I am sure <@Jasmine> will disagree, would say never use ^:const; as far as I can tell, people reach for it because it has a similar name to things they use in other languages when they want things to behave correctly"
366,1548971764.0236,Laurinda,<@Jasmine> Right. I understand why this happens in the including file.
366,1548971775.0241,Rosaline,"but clojure already behaves correctly, and const almost certainly doesn't do what you intuitively expect"
366,1548971779.0243,Jasmine,"it has to store the constant value in a field of the class, but there is a limit to what you can store in bytecode. For simple values, this is easy, but iirc the fallback case is to pr the value to a string, that can be re-read back to a value in the consuming case."
366,1548971815.0252,Laurinda,Hmm. But sorted sets do not have a pr representation.
366,1548971824.0254,Jasmine,"sorted sets and maps don’t have a literal print syntax and no way to print/read the comparator function.; ```user=&gt; (binding [*print-dup* true] (pr s))
#=(clojure.lang.PersistentTreeSet/create [1 2 3])```; this gets into increasingly murky areas where reader eval is used; I’m not sure I’m getting 100% of the details correct on all this (it’s been a few years since I looked at it); as <@Rosaline> says, there are fewer places where this is worth doing than you might expect (I wouldn’t say none though); in particular using ^:const in tandem with ^long or ^double can be useful for inlining primitive long or double values"
366,1548972012.029,Rosaline,"if you don't say none, everyone wants to argue that they are special and should use, and they never should"
366,1548972037.0293,Laurinda,"In general, I really wish sorted sets and sorted maps with default comparators had a printable/readable representation. I run into this quite a bit, and I don't have a single custom comparator function.; As to this problem, what next? Should I work on a minimal reproducible test case, or is it unnecessary? It seems this is a known issue, and all that could possibly be improved is the error message, right?"
366,1548972149.0316,Jasmine,"I don’t think what you’re doing is a useful thing to do (that is, I can’t imagine how marking this ^:const well help you in any way); so I would recommend just removing that :); if you want to file a jira re the error message (or a clojure-site issue for better docs around ^:const), that seems reasonable; the docs around ^:const are, well, largely non-existent. there are a couple lines in the changelog when it was added"
366,1548972259.0343,Laurinda,"I did, I don't much care about the `^:const`. I just checked, and I have 253 `^:const` declarations. I use them mostly as a comment, really.; I guess I can simply remove them all and assume that every `def` is a constant."
366,1548972370.0368,Rosaline,"I'd suggest also maybe a re-evaluation of your relationship with sorted sets, if they are causing issues, maybe try and get a long without them (as a data point I am not sure if I recall ever using clojure's built in sorted sets outside of toy projects)"
366,1548972376.037,Laurinda,"<@Jasmine> By the way, I really enjoy your weekly journal blog posts. If this doesn't take too much of your time, it is worth doing and is much appreciated."
366,1548972426.038,Jasmine,I’ll +1 reevaluating sorted sets; I find using them means you are usually relying on order and linear searches rather than building indexes which will be a better solution
366,1548972548.0407,Laurinda,"Hmm. They are actually quite useful in certain places. I use them for things like a list of quantities (build/order/whatever). A list like that has 1-20 numerical items. A sorted-set is perfect, as it lets me declaratively specify that it should always be sorted. I could stop using it, but then I have to worry about re-sorting in a number of places.; But — indeed if they cause more problems than they solve, I can just make sure I always sort manually."
366,1548972647.0436,Tammera,"What’s the complexity of operations in a sorted set, membership and insert and such? Is it worse than a regular set? (I got intrigued… :) )"
366,1548972689.0447,Jasmine,"they’re red-black trees, so mostly O(n log n) I think"
366,1548972691.0448,Rosaline,"or treat it more like a graph, {somevalue #{next} next #{nnext} etc}"
366,1548972721.0456,Becki,is this really easier than using a simple data structure like a sorted set?
366,1548972729.0458,Rosaline,"if you are sorting just for display (as a todo list or whatever) then you don't need sorted data, you need a sorted view over something; it is more flexible in that it encodes the sort as data in the graph; vs. as a function; so it is better suited to things like serialization"
366,1548972886.0491,Tammera,Cool! I remember having quite a difficult time getting my head around RB trees when I got them in CS
366,1548973117.0504,Becki,is it? seems like you run into the same issue as the sorted set. you can serialize its current order but how do you serialize the instructions for inserting new elements into the graph? that would be the comparator in the sorted set and would seem to be an analogous point for the graph insertion
366,1548973321.052,Rosaline,"that is the point, you don't serialize instructions at all; is order a property of your data/information or is it a property of the particular data structure you are using to represent the data"
366,1548973636.0541,Marlyn,"(I would also agree about `:const` earlier -- 90% of the time I've seen it in the wild, it is incorrect.)"
366,1548973729.0547,Rosaline,"1. sorted sets are cool, most of my favorite things are built on them to some degree or other (<https://git.sr.ht/~hiredman/dset>) 2. if something is causing you trouble stop using it 3. always have a third thing"
366,1548975067.0566,Laurinda,"I would humbly suggest that the word ""incorrect"" is too strong. `^:const`, at a first glance, seems like an indication that something is a constant and will never change. Marking things this way is entirely reasonable; As for sorted sets, of course I don't require them. I can make sure that every function that needs the data sorts it before using (and no, it's not just ""a view"", there are multiple views, there is also logic that assumes the data is sorted). It's a tradeoff between declarative and procedural."
370,1548976033.0584,Dann,but that's not how const works
371,1548978022.0585,Latonya,"The constant factors for Clojure's sorted sets/maps are typically a fair amount larger than sets/maps that are not sorted, e.g. n log_2 n is a constant factor 5 more than n log_32 n."
372,1548979412.0587,Diamond,"Seems like it’d be easy enough to copy and paste the lines from `changes.md` over. Where would those go? I’ve seen this discussion come up enough that it’d be easier to just point someone to the site for reference.

There are also several other meta questions that come up too (myself and others have asked about `^:inline`)."
366,1548979562.059,Diamond,<@Laurinda> here’s a link to the aforementioned changelog entry explaining `^:const` <https://github.com/clojure/clojure/blob/master/changes.md#215-const-defs>
366,1548979792.0598,Laurinda,"Well, as an aside, I do understand how const works. The inlining is not critical in the code that I currently write, but I am aware of it. What I wasn't aware of are pitfalls, e.g. that not every Clojure data structure can be treated this way."
366,1548979823.06,Dann,"no data clojure structure does anything useful with const - it's an optimization for primitives; some data structures also error, none of them benefit"
366,1548979835.0604,Diamond,"<@Laurinda> I was trying to be helpful. I didn’t see anyone send you a link, etc."
366,1548979873.0606,Laurinda,"Yes, ""primitives"" is what I was missing, I guess.; As for ""useful"", isn't it true that if initialization is expensive, it would happen at compile time and the result would be inlined?"
366,1548979920.061,Diamond,This is the kind of the discussion that needs to be distilled into reference material so these discussions can just be collapsed into a URL.
366,1548979936.0612,Dann,"I don't want to come off as too strident here - I think given what const means in other languages it is poorly named and under documented; if your form is at the top level of the file, it's initialized during compilation, in clojure compilation happens when you load the file"
366,1548979996.0617,Laurinda,Right. And if I build an uberjar with AOT?
366,1548980128.0619,Dann,"the file is loaded when making the uberjar, anything at the top level is done again on ~app startup~ runtime load of that class file, otherwise def with side effects in it would break when using AOT; so you aren't saving as much time as you might think for defs at least; eg. `(def tracking (get-tracking-data (fire-missiles)))` - fires missiles when you make the uberjar, then does it again when you load the resulting class file in an app"
366,1548980478.0626,Laurinda,Thanks for explaining. I didn't think these definitions were evaluated again.
366,1548980828.0628,Dann,"it's surprising, but it's the least surprising choice - think of all the _potential_ bugs when people use def on eg. a db connection pool, or an http server etc. (of course best practice for devs is never do anything stateful in def)"
366,1548981751.0631,Laurinda,"No, what surprises me is that the same is done when there is a `^:const` metadata flag. I would not expect re-evaluation then."
366,1548982339.0633,Dann,"const doesn't really do anything with data structures, it enables a fast path for compiled code that uses the const var, if the const var is a primitive"
366,1548982911.0636,Jasmine,the inline stuff is primarily intended for use inside Clojure itself and is not considered a public feature that we wish to encourage (it may be removed in the future); <https://clojure.org/reference/compilation> is probably the best place to doc ^:const
366,1548982969.064,Diamond,Thanks! I’ve already forked the repo to patch my name/github name. :slightly_smiling_face:
366,1548982999.0642,Jasmine,"if you’re adding your name, you need to complete the CA form (but if you’re fixing a typo or something, that’s fine)"
366,1548983025.0644,Diamond,I completed the CA _years_ ago. :slightly_smiling_face:
366,1548983099.0646,Jasmine,cool
366,1548983147.0648,Diamond,"Also, regarding `^:inline`, I’m aware that it is not intended for public consumption; my suggestion regarding it is to make that fact public in documentation so that folks (you included) don’t have to keep having the same discussions."
373,1549017806.079,Salina,"when writing a clojure library, should we just have all the dependencies declared as `:provided`?"
373,1549017870.0801,Clarine,"I tend to make deps that are not strictly needed for the library to be usable provided.; An example would be in clj-http that cheshire is not strictly needed, unless you want to do json parsing; Sometimes people make these part of the test  / dev dependencies. I think provided is the intended use for this."
373,1549018044.0823,Salina,"nice thanks, I'm trying to add a library to a project now, and I get a million conflicts like
`[io.confluent/kafka-schema-registry ""5.1.0"" :exclusions [org.slf4j/slf4j-log4j12]] -&gt; [io.confluent/rest-utils ""5.1.0""] -&gt; [org.eclipse.jetty.websocket/javax-websocket-server-impl ""9.4.12.v20180830""] -&gt; [org.eclipse.jetty.websocket/javax-websocket-client-impl ""9.4.12.v20180830""] -&gt; [org.eclipse.jetty.websocket/websocket-client ""9.4.12.v20180830""] -&gt; [org.eclipse.jetty/jetty-client ""9.4.12.v20180830""] -&gt; [org.eclipse.jetty/jetty-http ""9.4.12.v20180830""]`; the actual version numbers from the main project will however still take precedence right?; would be nice to just exclude everything for that library"
373,1549018126.0844,Clarine,"the ones you define in your own project take precedence, I think; e.g. if your main project says clojure 1.10, but a lib says clojure 1.9, you will get 1.10"
373,1549019548.0878,Samual,"When deps A and B bring along distinct versions of C it's not too hard to exclude C from one or the other or to state a direct dependency on one particular version of C. The problem is, what happens later?! When updating A or B, will you notice the extraordinary measures, back them out, and reintroduce only if necessary? Or will your project stay forever pinned to C-version-1 long after A and B have moved on to C-version-6?"
374,1549019641.0886,Samual,"A deps-resolver syntax that makes clear both the problem and the solution, and applies the solution only when circumstances match the stated problem, would allow tidier engineering"
374,1549021845.0894,Salina,"yeah it's a fun problem in every ecosystem really; btw is there a library to generate a graph of the dependencies (with graphviz) that works?; vizdeps seems to be the best one but it's not working anymore, and I could not really find one that works apart from that"
375,1549023953.0943,Sonny,"Often wondered if (at least on the JVM), it would be possible to isolate all this stuff with some classloader magic. One CL for each dep and a CL graph that mirrored the dependency graph etc. There's a fun project for somebody who gets bored."
375,1549024065.0946,Clarine,<@Sonny> Maybe boot is already doing this with pods
375,1549024236.095,Sonny,"Oh, I didn't know this. Will investigate. Thanks."
376,1549027422.0967,Matha,"Hi! How can you match all routes with a specific prefix in Bidi? e.g. match all routes that start with `/app`. So all routes of the form `/app/*/*...`; nevermind, the answer was `true` (<https://github.com/juxt/bidi/blob/master/README.md#catch-all-routes>)"
376,1549027813.0993,Danna,"I am trying to implement `clojure.lang.ILookup` in a record like this
```
(defrecord StaticMapService [m]
  sim/Service
  (start_service [this process] this)
  (finalize_service [this process] this)

  IFn
  (invoke [_ ident]
    (get m ident))

  ILookup
  (valAt [_ k] (get m k))
  (valAt [_ k not-found] (get m k not-found)))
```
and I get a `Duplicate interface name ""clojure/lang/ILookup"" in class file compile__stub/services/entityid_service/StaticMapService` error

can't for the life of me see what I am doing wrong

Any suggestions?"
376,1549027957.0995,Mariela,my guess: defrecord already impls that interface. so you have to use the lower-level `deftype` or such
376,1549027989.1001,Jasmine,"
Records already implement ILookup"
376,1549027990.1002,Danna,ah of course
376,1549028020.1013,Jasmine,If you want custom lookup behavior you need to drop down to deftype
376,1549028020.1014,Danna,oh so I can just merge upon `start_service`; thankyou
376,1549028044.1025,Jasmine,"Yes, should be able to"
376,1549028056.1027,Danna,Thanks very much
377,1549034965.1042,Matha,Is there a nice clojure lib to go back and forth between UUIDs and base62-encoded (or similar) UUIDs? (to put in URLs)
377,1549035279.1049,Ciara,There’s the built-in murmurhash (<https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Murmur3.java>) - not sure if it would fit the requirements
377,1549035586.1055,Jasmine,I would consider that an implementation detail of Clojure and not something to rely on calling into
377,1549035755.1058,Ciara,ah - good to know!
377,1549036189.1095,Cecil,"i have something not quite understood while reading `Clojure Programming` (it's really a great book)
it explain one of the usage of `recur` is when performing mathematical operation.
&gt; In addition, because it allows you to work with numerics without the overhead of boxed representations, ...

what _overhead of boxed representations_ means?"
377,1549036237.1097,Korey,<http://insideclojure.org/2014/12/15/warn-on-boxed/>
377,1549036321.1103,Cecil,"ah, it was a java stuff"
378,1549044504.1134,Hugh,"Hey guys!
In clojure jdbc, I am trying to understand `:return-keys` How can I get only `[{:a … :b ...} ...]` returned?:
```
(db-do-prepared-return-keys
  db
  (into statement updates)
  {:multi? true
   :return-keys {:columns [:a :b]}})
```; `:return-keys [:a :b]` didn’t work for me either"
378,1549044647.1144,Rosaline,if I recall the behavior of return-keys is highly database dependent
378,1549044712.1147,Dann,"just checking, this is clojure.java.jdbc not clojure.jdbc right? - the name of the latter makes this unfortunately ambiguous; (in fact I think the naming is downright hostile)"
378,1549044984.1158,Rosaline,I don't think :return-keys is actually an option you can set on db-do-prepared-return-keys; it always returns keys
378,1549045080.1169,Hugh,yes clojure.java.jdbc; sorry; ok
378,1549045104.1177,Rosaline,"db-do-prepared-return-keys calls prepare-statement with return-keys set to the boolean true, regardless of any options passed in; you can change that by calling prepare-statement yourself and passing that in; the prepare-statement docstring has a blurb about the behavior being driver dependent"
378,1549045270.1188,Hugh,"ok, thanks"
378,1549045307.1189,Dann,np - I don't expect most people to know clojure.jdbc exists (I certainly don't recommend using it) - just checking in case there's been miscommunication ;D
378,1549045411.1195,Hugh,"ok, I can do `:row-fn #(select-keys % [:a :b])` though; interesting"
378,1549046999.1222,Henry,"<@Hugh> It looks like you only want to select specific columns. In that case you should do that in your SQL statement (instead of `SELECT * FROM` do `SELECT a,b FROM ...`). The purpose of :return-keys is to get keys generated by inserts from the DB."
378,1549048086.1226,Hugh,<@Henry> my statement is an `UPDATE` one though
378,1549048241.1253,Celestine,"<@Hugh> `:return-keys` can accept a vector of column names on some (but not all) databases. You should not use `db-do-prepared-return-keys` really -- it's very low-level (and, I think, assumes you already have a `PreparedStatement` -- where you would have set those options _prior_ to calling it!).; `insert!` and `execute!` should accept `:return-keys` with a vector (if your DB allows it).; Also, there's always <#C1Q164V29|sql> for deeper `clojure.java.jdbc` questions (I'm more likely to see it there)."
378,1549048306.127,Hugh,ok changing channel
379,1549051254.1306,Laurinda,<@Matha> I use a very nice library by <@Phebe> that produces compact 26-char UUIDs: <https://github.com/tonsky/compact-uuids>
379,1549051296.131,Matha,"ah brilliant, ty!"
379,1549051616.1317,Becki,i thought i remembered ghadi making or showing off someone else's uuid -&gt; words library? does that ring a bell with anyone
379,1549051694.1324,Marlyn,"ill post a gist of that, <https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki> is the spec"
380,1549052097.1333,Arnoldo,"If I wanted to hook into an existing protocol on a built-in type to provide some additional functionality, is there a better way than wrapping the protocol's method I want to extend?"
380,1549052379.134,Dann,"well, there are no protocols or methods there; (there are protocols and methods in the implementation of the object passed to swap!, and swap! itself is an object extending IFn but I don't think that's what you mean); but if you mean generally, you want to do an AOP style wrapping of an existing function, yeah that's what it typically looks like; though idiomatically `wrap-foo` means ""hand this thing a function, it returns a new one"", which isn't your semantics here, but that's a naming issue"
380,1549052567.1376,Arnoldo,"poor choice of nomenclature on my part... I basically just mean if I have a type that implements a protocol, and I want to do something extra with one or all of the functions implementing the protocol on that type, is that the best way; yeah i named it `wrap` but it's more a passthrough method, agree on the naming"
380,1549052653.1394,Jasmine,I don’t think protocols have anything to do with your question?
380,1549052696.14,Dann,"<@Arnoldo> once again that's not a method; method and function aren't interchangeable in Clojure, they mean specific things and we use both"
380,1549052772.1416,Arnoldo,"i didn't literally mean method, sorry... ""passthrough methods"" is just  naming convention for functions (or methods in other languages) that do nothing but delegate to another function"
380,1549052873.1426,Dann,"sure, most AOP style wrappers will take the original function and then use apply with a variable arg list like in your code; more commonly the function itself is passed as one of the args, which makes the wrapper more reusable (one reason functions are more flexible than methods); <@Arnoldo> this is also visible in the signature of `swap!` itself, and `alter-var-root` - the function signatures make it easy to pass in a function that exists already, and return an ""enhanced"" version"
380,1549053051.145,Arnoldo,I noticed that actually...
380,1549053079.1456,Dann,"oh, and I don't know why `a` is in your function signature there - it's valid to call swap! with a single arg function, and your definition makes that impossible"
381,1549053691.1469,Zenaida,"Hi! Is there a clever way to convert this `{:sku [111111111 22222222], :storeId 88888888}` to this `{:sku 111111111 :storeId 88888888}, {:sku 22222222 :storeId 88888888}`?"
381,1549054691.1472,Marlyn,do it the simple way with mapcat; or map
381,1549054906.1476,Bethel,"I am not sure about your expected result type. Perhaps you can use ((fn [m] (map #(assoc m :sku %1) (:sku m))) {:sku [111111111 22222222], :storeId 88888888})."
382,1549057082.1478,Arnoldo,"((fn [m] (map #(hash-map :sku %1 :storeId %2)
               (:sku m) (repeat (:storeId m))))
  {:sku [111111111 22222222], :storeId 88888888}); <@Jasmine> Stepped away for a minute... you're right I guess the question is less about protocols and more about conrete implementations.  Maybe an example would be better than me fumbling around with incorrect terminology:

If I have a single-function protocol implemented concretely by several different objects, and I want to inject some minor changes to one of the implementations (and don't have access to the code to modify it directly), is wrapping the way i've described generally the best way to go about that?  From an OO perspective, I would just subclass and then override the method of interest, do whatever extra stuff I needed to do, and then call the parent's overriden method from the child."
382,1549058923.152,Jasmine,"again, I don’t think the fact that this is a protocol function makes any difference; if there is a function, and you want stuff to happen before that call, wrap it in another function; Clojure intentionally abstracts invocation over functions, multimethods, protocol methods, macros (with asterisks), collections that are invokable, etc so that callers don’t know or care; in general in the core team we take it as a rule of thumb these days to wrap all protocol function invocations in an outer function that gives you a hook to handle special cases; for example, clojure.datafy/datafy is a wrapper function that calls clojure.core.protocols/datafy; protocols are best at the bottom, not at the top"
382,1549059524.1568,Arnoldo,"OK thanks for the clarification.; A general version (couldn't think of a good name for the function, gave it my best shot); (defn explode-key [m explode-key anchor-key]
  (reduce #(conj %1 {explode-key %2 anchor-key (get m anchor-key)})
          []
          (get m explode-key)))

(explode-key {:sku [111111111 22222222], :storeId 88888888} :sku :storeId)"
382,1549059639.1584,Dann,"if you want something that swaps atoms differently, you can wrap swap! to get a new function, if you want a new thing that swaps differently than an atom you can implement IAtom, and that implementation could even be done compositionally by allocating and using an atom internally; but good usable clojure code tends to wrap functions when possible, rather than extending protocols"
383,1549061668.1593,Otelia,"```
  (defn add-store-id-to-skus [{:keys [sku storeId]}]
    (map #(hash-map :sku %, :storeId storeId) sku))
```; <@Jasmine>, why do you specifically call out macros with asterisks? I thought the asterisk was just a way to name a variant of a function, like X and X prime, without any conventional meaning. But what you said makes me think there is a convention.; Oh, maybe you meant with exceptions."
383,1549078363.1607,Jasmine,"Yes, I just meant there were exceptions in the case of macros as you can’t use them as higher order functions; So the abstraction leaks"
384,1549088968.162,Gemma,"None; only when want to lein uberjar, with figwheel it works"
383,1549089664.1638,Gemma,if I don't use `(wrap-defaults site-defaults)` it doesn't throw this error
384,1549090467.1644,Celestine,"Base on that stack trace <@Gemma> it sounds like you're putting something invalid in the cookie ""scope""?"
384,1549090606.1652,Gemma,"I deleted all the wrappers, where am I putting something in a cookie other than there?; and why only with `wrap-defaults`?"
384,1549090786.1669,Celestine,"`wrap-defaults` adds a bunch of logic, and checks, around various parts of the Ring request/response so you wouldn't get the exception without it because not much is checked.; Without seeing all your code it's hard to say what the problem is, but that error suggests that it thinks you are putting ""bad attributes"" into the `:cookies` key of the Ring request/response..."
384,1549090921.1681,Gemma,"None; I also use sente, can it be the problem?; and why is this specific too compiling? with lein figwheel works well; I can show all my code, but it is a pretty big project, I just wanted to put it up on the server"
384,1549091546.1707,Celestine,I'd be surprised if Sente was incompatible with Ring defaults...; I would add some `println` debugging to see what the Ring request/response looks like and see if you can figure out what's the various submaps...
384,1549092226.1718,Gemma,"None; I don't even know how that ""_ga"" gets there, I dont have google analytics, I also remove google maps too; oh, it was in cache, same error, nothing in :cookies; None; well, it was a dependency problem; :exclusions [ring/ring-core] solved it; `[ring-transit-middleware ""0.1.3"" :exclusions [ring/ring-core]]`; thank you anyway, I never tried printing in a wrapper before, the more you know... :smile:"
385,1549109407.178,Jalisa,"I would like to use `tap&gt;` to debug. But since `tap&gt;` retrns `true`/`false` and not the provided parameter, this is not trivial. What would be an elegant statement, which calls `tap&gt;` whith my statement `(+ 1 2)` and then returns the value of my statement?; Looking for something shorter then `(let [result (+ 1 2)] (tap&gt; result) result)`"
385,1549109702.1799,Henry,<@Jalisa> `(doto (+ 1 2) tap&gt;)`; I usually define something like `(defn spy&gt; [x] (doto x tap&gt;))`
385,1549116194.1828,Jasmine,"Having tap&gt; return the val is a pretty good idea - if you write up a CLJ jira for it, that would remind me to talk to Rich about it; Or adding spy&gt; or something"
386,1549119910.1837,Mariela,"None; code above, error below; any workaround?; got it `(ns-unmap *ns* 'Compiler)`"
385,1549122145.1846,Otelia,thx!
386,1549138094.1871,Patrice,I’m trying to write a macro that will allow me to def a var with certain metadata attached. Using the reader macro in the middle of the macro doesn’t work!
386,1549138260.1879,Meagan,that’s true. I believe you can use `alter-meta!`
386,1549138491.1883,Patrice,"<@Meagan> thanks!; got it working! my motivation for this is to def a function in a namespace and preserve the docstring and arglists of a function from another namespace:
```
(defmacro def-with-doc [nom var-sym]
  (let [doc      (-&gt; var-sym resolve meta :doc)
        arglists (-&gt; var-sym resolve meta :arglists)]
    `(do
       ~(if doc
          `(def ~nom ~doc ~(-&gt; var-sym resolve deref))
          `(def ~nom ~(-&gt; var-sym resolve deref)))
       ~(when arglists
          `(alter-meta! (var ~nom) assoc :arglists (quote ~arglists))))))

(def-with-doc inspect ins/inspect)
```"
387,1549141096.1903,Henry,"this library has `import-vars` that does a similar thing, it keeps docstrings and works for fuctions and macros <https://github.com/ztellman/potemkin>"
388,1549142654.1906,Celestine,"Why not `assoc :doc` in the way you handle `:arglists`, then you don't need the `if` special case.; You can avoid the conditionals altogther, like this ```
(defmacro def-with-doc [nom var-sym]
  `(do
    (def ~nom ~(-&gt; var-sym resolve deref))
    (alter-meta! (var ~nom) merge '~(-&gt; var-sym resolve meta (select-keys [:doc :arglists])))))
```; If you want that to work for macros too, add `:macro` to the keys in the `select-keys` call."
389,1549169316.1929,Fredda,"You know what might be nice? An thread macro that can optionally escape forms, like `(-&gt; n dec #esc #(- 9 % 1) inc)`; such that, instead of the value being threaded into the beginning or end of the anonymous function, the fn is allowed to convert itself into its evaluated form, and the thread sees it as a one arg fn.; What would be an ideal notation for that thread escaping?"
389,1549169748.1959,Celestine,Why wouldn't you just use `as-&gt;` for that? `(-&gt; n dec (as-&gt; n (- 9 n 1)) inc)`
389,1549169802.1966,Fredda,"Cause then I could just use `-&gt;` for everything, and escape optionally"
389,1549169831.1972,Celestine,"Seems to me that `as-&gt;` _is_ the ""escape"" function...; `(-&gt; n dec (as-&gt; % (- 9 % 1)) inc)` if you prefer `%` for the argument name.; `(-&gt; n dec #esc   #(- 9 % 1)  inc)` it's not all that different -- and it's built-in, no language extensions needed"
389,1549169982.1995,Fredda,`(-&gt; n dec #~(- 9 % 1) inc)` that might look prettier... and I wouldn't have to switch between two different thread macro contexts; or `(-&gt; n dec #~#(- 9 % 1) inc)`
389,1549170301.201,Celestine,"Meh... you've saving so few keystrokes, and introducing non-standard syntax... I see no benefit."
389,1549170488.2027,Fredda,you could even switch some assoc's cleaner `(-&gt; n (- 3) dec #~#(assoc state :n %) keys)`
389,1549170513.2033,Celestine,"```
(-&gt; n (- 3) dec (-&gt;&gt; (assoc state :n)) keys)
(-&gt; n (- 3) dec (as-&gt; % (assoc state :n %)) keys)
(-&gt; n (- 3) dec #~#(assoc state :n %) keys) ; more cryptic and only one character shorter?
```"
389,1549170536.2036,Fredda,"Yeah, I use multiple thread macros some times; I hear you, I'm not completely sold on it either... I'd have to kick the tires on it some more.; And I'm not saying add a reader macro for `#~` language wide. Just add another thread macro that detects it, like `-#&gt;` or something"
389,1549170715.2061,Celestine,"Code golf. Doesn't make code any clearer.; Don't get me wrong, I find `(partial f a b)` to be annoyingly long, as well as `(comp f g)`, compared to Haskell's auto-currying and therefore `f a b` and `f . g` but it really isn't worth messing up the language syntax for a few characters of typing..."
389,1549170847.2083,Fredda,It's not about saving characters. It's about semantic context switching between various thread macro semantics
389,1549170864.2086,Celestine,"We're going to disagree on that.; I find this much more readable than your proposal `(-&gt; n (- 3) dec (-&gt;&gt; (assoc state :n)) keys)`; Especially when written indented: ```
(-&gt; n
    (- 3)
    dec
    (-&gt;&gt; (assoc state :n))
    keys)```; There's also a strong argument that such long threads are inherently hard to read already and should be broken into named segments with `let`..."
389,1549171051.2127,Fredda,hmmm. perhaps the idea could be further generalized and simplified... Perhaps `-#&gt;` could just evaluate all anonymous functions defined within the thread first ... then it's just `(-#&gt; n #(- 9 % 3) dec #(assoc state :n %) keys)`
389,1549171101.2131,Celestine,"Personally, I think that's horribly ugly. It's not even consistent.; You're mixing an implicit `-&gt;` with regular anonymous functions :disappointed:"
389,1549171163.2143,Fredda,It makes sense though... It's a thread macro that auto-evaluates anonymous functions first.
389,1549171175.2146,Celestine,It doesn't make sense to me. It's horrible.
389,1549171179.2148,Fredda,lol; I know you're just saying that to goad me into writing a library for it... And I'm not gonna do it!
389,1549171264.2165,Celestine,"`(as-&gt; n % (- 9 % 3) (dec %) (assoc state :n %) (keys %))` is also horrible but at least it's consistent (and, hey, already possible/legal in Clojure)."
389,1549171678.2179,Fredda,"well, I guess that `-#&gt;` is pointless, since it's basically just doing function application, just unwinding it, for less parenthesis"
389,1549171695.2183,Celestine,"Consistency has had me recently move to wrapping all the forms in `( .. )` in a threaded macro BTW.; So I'm more likely to write: ```
(-&gt; n
    (- 3)
    (dec)
    (-&gt;&gt; (assoc state :n))
    (keys))```"
389,1549171742.2191,Fredda,interesting; For visual clarity?
389,1549171773.2198,Celestine,"The more code I maintain, the more consistency and simplicity have come to matter.; And we're at ```Clojure source 280 files 65913 total loc,
Clojure tests 320 files 22004 total loc,
``` these days.; (nearly 88k lines... that's quite shocking to me, really, given where we were just a few years ago!)"
389,1549171981.2222,Fredda,"Yeah, that's pretty awesome"
389,1549172084.2229,Meagan,but I also hate nesting them. I think it's confusing; I like wrapping all my threaded forms in parens too
389,1549172098.2233,Celestine,"No `lein`, no `boot`. Just `clj` and `deps.edn` these days too.; (and, of course, Clojure 1.10 in production, and testing against 1.11 master :slightly_smiling_face: )"
389,1549172430.2255,Fredda,"I guess that last `-#&gt;` I described is really `comp&gt;`. It reverses the order of comp, so it reads like definition order, but allows you to thread in forms in the comp that are not functions."
389,1549172457.2259,Celestine,Like transducers? :slightly_smiling_face:
389,1549172491.2266,Fredda,"ooooh, `transduce-&gt;`"
389,1549172499.2268,Celestine,:rolling_on_the_floor_laughing:
389,1549172509.227,Fredda,lol
390,1549174208.2275,Tressa,things get pretty nasty when i abuse threading macros; so when i notice I'm Doing It Again i rewrite the whole thing with lets to see which is simpler
390,1549192069.2289,Henry,"When it comes to weird threading macros, this library is funny <https://github.com/rplevy/swiss-arrows>"
391,1549200839.2312,Shayla,"My issue with using `let`s instead of threading macros is it allows me to write more procedural/pythonic code, instead of finding a functional way to write it; I’ve been working on a lot of ETL pipelines recently, so extracting my complicated `let` conditionals into functions I can thread has been very helpful in maintaining the functional mindset"
392,1549202702.2338,Matha,"To store clojure data structures in a database (postgresql in my case), would you just store the EDN representation or encode it with transit?"
392,1549203164.2351,Min,If you dont care about querying use something like fressian or nippy
392,1549207101.236,Sixta,<@Matha> using transit json-pretty gives you the option to query it in the future if you please.
393,1549207108.2363,Sixta,We have done this on a project before.
392,1549207221.2368,Matha,"<@Sixta> oh I didn’t know that option, thank you; what is the json pretty option?"
393,1549208003.2371,Ali,I think it's supposed to be read as an n/m dash rather than a hyphen.
392,1549209474.2382,Matha,"When I try to require a namespace in the REPL but it fails because of a syntax error in said namespace’s file, how can I reload it after correcting the error? running require again throws a “namespace not found” error"
392,1549209664.2392,Sixta,<@Matha> guessing you might want to try `(require 'foo :reload)`
392,1549209677.2395,Matha,"<@Sixta> I tried that, it didn’t work :thinking_face:"
392,1549215922.2399,Isa,"<@Matha> <https://clojuredocs.org/clojure.core/require> see `:reload` and `:reload-all`; precise
&gt; it didn’t work :thinking_face:
:wink:"
392,1549215942.2405,Matha,"<@Isa> I tried `:reload` but that didn’t work. I’ll try again; ah, mwell; it threw the same error; hang on, I’ll reproduce it"
392,1549215993.2416,Isa,but normally you use editor shortcuts to do that
392,1549227586.2445,Meagan,"I have probably a silly question:
```
(let [foo (my-macro)]
  ...)
```

I want `my-macro` to know that it has been bound to the symbol `foo` in this context.
Impossible, yes?"
392,1549227653.2448,Harris,yes
392,1549227933.2456,Meagan,":sob: thought so; OK, followup: is there _any way_ (hacky or otherwise) to get at the let bindings inside of a function?; I have a lib where I’d like to provide some report of how it’s used inside of an opaque function; using some fancy tricks I can show what was passed in when the library functions were invoked, and the _order_ of invocation, but I’m losing some semantics because there’s no names attached to them"
392,1549228928.2494,Magdalena,[ANN] com.cognitect.aws/api-0.8.243  is released: <https://groups.google.com/forum/#!topic/clojure/wzEy8tSSKF0>
392,1549230294.2501,Fredda,<@Meagan> you can get the line number with `(-&gt; &amp;form meta :line)`
392,1549230807.2512,Meagan,"it would still be hard to know exactly what name it was bound to, but that could be hilariously hacky"
394,1549231611.2522,Fredda,"you can get the namespace in there too, but yeah :confused:"
395,1549274427.2555,Bree,"how can I find the approximate size (bytes of memory) of a piece of Clojure data?; alternately, what is the approx size of maps and keywords?"
395,1549275075.2566,Sixta,<@Bree> <https://github.com/clojure-goes-fast/clj-memory-meter>
396,1549275241.2571,Bree,"awesome, more than I could have hoped for :slightly_smiling_face:; :+1:"
397,1549286263.2591,Elaine,"There is some ""core utils"" with a `index-by` function, that do `(index-by :id [{:id 1}]) =&gt; {1 {:id 1}}`?? It's almost like group-by, but do not conj on value."
397,1549286364.2599,Clarine,"yes, there is, but often people write it themselves, using `(into {} (map (juxt f identity) coll))`; This PR for medley has been open for a while. I like the name `index-by` better. Propose it :wink: <https://github.com/weavejester/medley/pull/28>"
398,1549288147.2627,Vita,<https://github.com/vodori/missing> (a lib I maintain) has index-by and indexcat-by and groupcat-by :P
397,1549288554.2631,Harris,<@Elaine> not exactly but `clojure.set/index`
398,1549288562.2633,Harris,"```user=&gt; (set/index [{:id 1} {:id 2} {:id 1 :x 2}] [:id])
{{:id 1} #{{:id 1, :x 2} {:id 1}}, {:id 2} #{{:id 2}}}```"
399,1549292919.2641,Tracee,"Hello guys!! Do we have a channel for `Lacinia`? I have found one, but it is archived.."
398,1549294300.2645,Katherina,<#C4DLZKR9T|graphql> should be the one i think
399,1549294740.2647,Tracee,Thank you!!
400,1549295542.2695,Danna,"I am using `clojure.edn/read` to read an .edn file which contains `#object[` tags like `#object[java.io.File 0x6ae4aa5 ""hello-world.pdf""]`
Ideally I would like to  interpret these as a record, something like  `(-&gt;EdnObject clazzname identityHashCode string-description)`
at the moment I get an error
```java.lang.RuntimeException: No reader function for tag object```
Is the preexisting reader function that I can reuse to do this?
Do I have to write my own?; I was hoping to wire in the binding using
```(binding [clojure.core/*data-readers* (assoc clojure.core/*data-readers*
                                        'object #'dev/my-special-edn-binding)]```
does that only work for namespaced tags?; oh I see I can just pass in `:readers` in the options to `clojure.edn/read`
thus
```(clojure.edn/read {:eof eof-sentinel :readers {'object #'dev/my-special-edn-binding}} r)```"
400,1549296653.27,Roslyn,<http://insideclojure.org/2018/06/21/tagged-literal/>
400,1549296655.2702,Danna,top banana; thank vlaad; that good to know
401,1549307218.2722,Ronald,Why is spec imported as `spec.alpha`? Does this notation imply that the interface is liable to change?
401,1549307389.2727,Dann,"it has alpha in the name because it is alpha, yes"
401,1549307488.2739,Ronald,"It just seems odd to explicitly notate it, since AFAIK breaking changes have happened in Clojure core even when not notated alpha"
401,1549307498.2743,Dann,very rarely
401,1549307498.2744,Jasmine,trying to do better :)
401,1549307510.2749,Celestine,`(:require [clojure.spec.alpha :as s])` means that when it comes out of alpha you can just update that to `(:require [clojure.spec :as s])` and (hopefully) not having to change your code :slightly_smiling_face:
401,1549307511.2751,Jasmine,spec 2 dev is under way and will likely include some breaking changes
401,1549307518.2753,Celestine,Except for those breaking changes :slightly_smiling_face:
401,1549307525.2756,Jasmine,although we are trying to minimize those
401,1549307612.2768,Celestine,We're very heavy users of spec and I have almost everything running at work on spec2 -- and the code changes weren't too extensive. I'm still working with Alex on a couple of issues tho'... :slightly_smiling_face:
401,1549308239.2777,Jasmine,"more changes to come, although I expect a lot will be additive"
402,1549310256.279,Ronald,"Sounds good - really I was just curious about the choice of notation, I'm not concerned too about having to make small changes to keep using spec :slightly_smiling_face:"
402,1549310372.2797,Celestine,There was a good thread about the `alpha` naming here <https://clojureverse.org/t/are-clojure-core-alpha-namespaces-chosen-to-avoid-upgrade-conflicts/3722/5> -- relating to Rich's talk about semantic versioning and accretive design...
402,1549310431.2801,Ronald,Thanks for the link <@Celestine>
402,1549310793.2812,Celestine,Strong adoption of Clojure 1.10 in the State of the (Clojure) Union survey results! Already 54% on 1.10. That's awesome. And only 3% on 1.7 or earlier. Great news for library developers.
402,1549310909.2817,Bree,that's the result of caring about backwards compatibility :ok_hand:; stable software :heart:
402,1549310927.2823,Jasmine,I was actually disappointed it was so low :)
402,1549310943.2827,Bree,"agreed, should've been higher; but I'm more surprised at 3% on 1.7 or earlier"
402,1549310985.2839,Jasmine,in line with prior surveys - generally most people are on the last 2-3 releases
402,1549310986.284,Becki,"conversely, people who updated were much more likely to participate in the survey :slightly_smiling_face:"
402,1549311006.2843,Jasmine,always hard to predict the selection bias for respondents
402,1549311024.2847,Becki,agreed. really looking forward to the results. i like hearing from fellow clojure users
402,1549311114.2854,Bree,I'll throw in another data point: thanks a lot for the tireless great work you and your team put in <@Jasmine>!
402,1549311144.286,Becki,"agreed. immutable datastructures, a repl, and an alex. all features i value in Clojure"
402,1549311229.2862,Jasmine,tell your friends :)
402,1549311294.2865,Bree,I do that too :slightly_smiling_face:
403,1549313179.2874,Kirstin,"is this a pattern that people use?

```
#(do [:a :vector :or :other :literal])
```

or do most people opt for specific constructor functions (or `into` etc) ?; i tend to go with `do` because it's only two characters"
403,1549313268.2884,Clarine,I tend to go with `(fn [] [:a :vector])` or `(constantly [:whatever])`
403,1549313304.2892,Kirstin,"the question pertains specifically to lambdas; i.e., assume you are using a lambda then ...; there are reasons why i don't always use a lambda but if a lambda is available to me, then I do opt for it first."
403,1549313378.2913,Clarine,with lambda you mean a function literal?
403,1549313386.2917,Jasmine,"`#(vector :a :vector)`; ^^ if you want a vector constructor, use the vector constructor"
403,1549313408.2925,Kirstin,"<@Clarine> no, i mean the `#( ... )` shorthand syntax for a function literal; any reason for this preference? performance or aesthetic?"
403,1549313450.2936,Clarine,bikeshedding if you ask me
403,1549313458.2938,Jasmine,I think it is clearest way to say what you are doing here. you are invoking a function to make a vector from some elements
403,1549313470.2942,Kirstin,"<@Clarine> yea, probably. was just staring at some code and wondered what other people thought."
403,1549313479.2943,Meagan,"just FYI, things that start with `#` are referred to as ""literals"""
403,1549313488.2945,Jasmine,whereas #(do […]) is fewer characters but much weirder imo
403,1549313514.2947,Kirstin,"fyi... `{:a :b}` is a literal. `[:a :b]` is also a literal.; as are: `9`, `:a`, `""blah""` etc etc"
403,1549313547.2952,Clarine,<@Kirstin> #(…) is a function literal
403,1549313582.2954,Meagan,"OK, sorry; I'm just basing this off of the Clojure docs: <https://clojure.org/guides/higher_order_functions#_function_literals>"
403,1549313594.2956,Kirstin,"<@Clarine> ah, got it.; what would you call `(fn [] ...)` then?; just ""anonymous function"" ?"
403,1549313620.2962,Clarine,yes
403,1549313626.2964,Kirstin,[although technically it can be named too :)]; `(fn the-name [] ...)`
403,1549313645.2968,Meagan,"yeah. or a ""form"" maybe?"
403,1549313652.297,Clarine,function value?; just function maybe. don’t know
403,1549313701.2974,Kirstin,"lol, yea, i tend to prefer fewer characters unless it's really confusing"
403,1549313703.2976,Clarine,"the function’s name is only known to itself, so it’s still anonymous to the outside"
403,1549313776.2978,Kirstin,"another argument for `do` is that it is possible to return any literal that way, not just the ones which happen to have a nice constructor (like say `vector` or `hash-map`)."
403,1549313964.299,Lemuel,"I am seeing the weirdest thing:  (symbol x) returning nil, when we are passing it a valid string without a slash, and both `type` and `class` report java.lang.String.; I don't see how this can happen, though.  Has anyone seen this?"
403,1549314139.2999,Rosaline,"not possible, so it is something else"
403,1549314162.3003,Lemuel,"I agree that it is not possible, however, I am repeatedly demonstrating it."
403,1549314167.3005,Rosaline,I doubt it
403,1549314176.3007,Lemuel,heh.
403,1549314205.3013,Rosaline,are you literally doing `(doto (symbol x) (-&gt; class prn))` ?
403,1549314343.3017,Jasmine,don’t all of the literals have a constructor though?
403,1549314534.3022,Lemuel,"I'm going to see how far I can whittle down the example, but this is the current state: <https://gist.github.com/eraserhd/f4f8f52fb43a2e4a5b6fc740a1101c02>"
403,1549314582.3025,Rosaline,you are shadowing clojure.core/symbol with the argument name
404,1549314598.3026,Lemuel,hahaha!
403,1549314608.3029,Lemuel,It's OK everyone.  Compiler's not broken; <@Rosaline> thanks. :P
405,1549316605.305,Katharina,"So I'm trying to generate longs with `clojure.spec.gen.alpha/large-generator`. This works fine when using `generate`, but with `clojure.spec.gen.alpha/sample` it generates extremely low values (+-60 from 0). I need it to generate pretty much the full range of longs. Any idea why it has this behavior?"
405,1549316810.3051,Tammera,"it generates larger integers with a larger sample size; What I think it is trying to do is try the “edge” cases first, so zero, minus one, plus one, etc. Before actually switching to completely random longs"
405,1549316893.3055,Katharina,"Hmm, seems your right. The numbers get more random as I get more. Anyway I can force it to be random from the beginning?"
405,1549316928.3057,Tammera,"I am not sure, you can always define your own generator tho"
405,1549316952.3059,Katharina,"Alright, thanks!"
405,1549316988.3061,Tammera,"May I ask, why don’t you just increase the sample size?; Is there really no value in testing small values for you"
405,1549317078.3065,Katharina,"Yeah, I'm testing dates. So one low value is fine (Jan 1, 1970), but then I want to start seeing other values. Having to scroll past the first 10 values in the web app is just wasting space, but it may be the easiest solution. Or I guess I could drop the first 10 or so values"
405,1549317191.3068,Tammera,"Well - from a formal background - I understand why gen is doing this, bugs usually occur on boundaries. So testing for `0`, `-1`, `1` etc. is usually more valuable than testing complete random values. Further reading: boundary analysis"
405,1549317332.307,Katharina,Cool. Thanks for the input. I appreciate the help
406,1549320872.3075,Jasmine,"that’s not actually why - gen is designed to “grow” more “complex” values as it generates more samples, then has support for “shrinking” a complex test case into a simpler one; <https://github.com/clojure/test.check/blob/master/doc/growth-and-shrinking.md>; you can use `large-integer*` to generate longs with uniform distribution (note: spec’s `int-in` uses this so that’s another path); well, actually those might grow too; my memory was faulty"
407,1549327209.309,Lana,"I am eager to move to it, but am being held back by CIDER not coping with the change in error format. Normally I adopt much faster. :smile:"
408,1549329259.3098,Tammera,"Hah, interesting!; I stand corrected ^^"
408,1549335306.3167,Alix,"What strategies, if any, do people use to decouple sub systems within an application. For example decoupling a database access layer. I've been using protocols to group common functions and passing the instances down into subsystems using `stuartsierra/component`. I can also see people using `weavejester/integrant` and mapping single functions. I can also see directly coupling/referencing subsystems and segregating them in separate namespaces."
408,1549336389.3186,Milford,I have a project where starting a REPL with Java 1.8.0_192 takes 11 seconds and with Java 1.8.0_201 takes 44 seconds. I'm wondering if this is a known issue or something idiosyncratic to my project.
409,1549337362.3195,Milford,Looks like the Clojure portion ^ is easy to repro with a fresh React Native project; will check in <#C0E1SN0NM|cljsrn>
409,1549339319.3197,Mariela,"Protocols are a must for (clean) testability IMO. Also nice being able to change libraries in a future (e.g. Bidi -&gt; ataraxy)

At work we use separate directories for protocols and impls. At first I agreed but I came to realise this creates an awkward indirection.

90% of times there's just 1 relevant implementation for a protocol. So one's IDE's jump-to-def will take you to the protocol ns, not the impl ns. That's the awkward point, and a good reason to place protocols close to impls

bad:

```
protocols/
 foo.clj
 ...
impls/
 foo.clj
  ...
```

better:

```
components/
  foo/
    protocol.clj
    impl.clj
  bar/
  baz/
  ...
```

This becomes evident as the app size scales

I wouln't create proto and impl in the same ns, it forces you to choose different fn names to avoid clashes. Better to have it uniform; As for Component vs Int, Int has ""suspend"" capabilities which I believe can make the restart process more graceful and/or performant. Haven't tried it though.

<https://github.com/weavejester/suspendable> might work as well for Component

I like Component. With <https://github.com/stuartsierra/component/pull/62> now it's as lightweight and data-driven as Integrant (or even more so)"
410,1549339712.3204,Mariela,Answering to your question... at least 1 protocol (and 1 component) per sub-system. Each subsystem only talks to each other via protos
409,1549339960.3207,Alix,"<@Mariela> Thanks for your input. It's great to see how other people solve these problems. We are definitely on the same page with this. When using protocols, I've also grouped up the implementation with the protocol in the same directory. I use cursive so when I jump-to-def to the protocol, I can do another jump-to-def on the protocol name which takes me directly to the implementation. So using that it wouldn't matter if they're in the same directory or not. However, I do prefer them in the same directory."
410,1549357573.3227,Maryjane,Hello; Looking for jdbc that uses threadpool
411,1549367304.3254,Thuy,"Hi all, I'm new to Clojure I'm new to Java. :slightly_smiling_face: Can anyone point me to the right direction? I'm trying to serialize an <https://github.com/thi-ng/ndarray>"
412,1549372700.3284,Jalisa,How do I  `apply` a function `(defn myfn [&amp; {:keys [a b]}] ...)` to a map `m` (`{:a 1 :b 2}`)?
410,1549372771.3288,Clarine,"```
$ clj
Clojure 1.10.0
user=&gt; (def m {:a 1 :b 2})
#'user/m
user=&gt; (defn myfn [{:keys [a b]}] [a b])
#'user/myfn
user=&gt; (myfn m)
[1 2]
```"
410,1549372858.3293,Jalisa,"Sorry, I meant: `(defn myfn [&amp; {:keys [a b]}] ...)`"
410,1549372902.3296,Clarine,"then you probably need `mapply`; it’s a function that’s not in clojure, but in several helper libs:
```
(defn mapply
  ""Applies a function f to the argument list formed by concatenating
  everything but the last element of args with the last element of
  args.  This is useful for applying a function that accepts keyword
  arguments to a map.""
  [f &amp; args]
  (apply f (apply concat (butlast args) (last args))))
```"
410,1549387597.3347,Nubia,"noticed functions like `assoc` and `contains?` operate on vectors (by position), but `dissoc` throws an error. Seems like this should work as a complement to the aforementioned functions - no? Or is this an intentional omission for performance reasons?"
413,1549387776.3352,Becki,what would `(dissoc [:a :b] 0)` mean?
410,1549387791.3357,Dann,"removing something from the middle of a vector isn't a simple operation, so it isn't built in"
413,1549387798.336,Nubia,remove item at position 0?
413,1549387808.3364,Dann,"also if you find yourself wanting to do that, you should probably use a different datatype (eg. finger tree)"
413,1549387810.3366,Becki,the result would have an item at position 0; `(contains? (dissoc [:a :b] 0) 0)` would be true
413,1549387841.3377,Nubia,good points :slightly_smiling_face:
413,1549387845.3378,Becki,along with the non-constant performance of dissoc there; i hadn't realized that until you asked it so i like your question :slightly_smiling_face:
413,1549387912.3393,Nubia,"yeah I figured the performance would make it bad, just curious on the reasoning.- thx"
413,1549387994.3408,Shanell,you have keep-indexed tho `(keep-indexed (fn [k v] (when (not= k 0) v)) [:a :b :c :d])`
413,1549388012.3412,Dann,"see also the inability to check something sequential for a specific value (what people often naively think contains? would do) - it's possible, but there's no simple built in because doing so often indicates you should be using a different datatype"
413,1549388183.3441,Nubia,"for what it’s worth I was building a custom version of `assoc` that wouldn’t add nil values in order to reduce gc overhead (relative to pruning). it works as I expected, but in doing so I stumbled upon the issue. edit: note that I’m not even using vectors, but I was attempting to achieve feature parity… so it was really just a question."
413,1549388226.3448,Kirsten,<@Dann> wouldn't something like `some` count as a built in for that?
413,1549388235.345,Nubia,so it’s not a data type issue
413,1549388283.3453,Becki,i think he means without doing a linear scan
413,1549388321.346,Dann,"<@Kirsten> yes we have functions that do linear scans of collections, but nothing that specifically checks membership of a given value"
413,1549388340.3464,Kirsten,got it
414,1549394482.3483,Fairy,"Hi, does anyone have recommendations on how to get the length of a video in clojure... Sadly I must use windows."
413,1549394599.3493,Fairy,"i was using ffmpeg on a mac, and calling it with processBuilder, however I'm running into issues getting any output at all while using CMD  instead of bash; I tried loading the file as a media object using ffmpeg, but ffmpeg doesn't support MOV files ."
413,1549395640.3507,Dann,"<@Fairy> you should be able to pipe output between processes via InputStream and OutputStream, if all the executables are present; java does have multimedia libraries, that's the next thing I would look for; even if there was a clojure binding, using the lib via interop is likely a better choice"
413,1549395769.3534,Fairy,"right! <https://gist.github.com/jdkealy/65edec6c28a89f378c27803fb78be6d8> so this calls bash, would you know how to do this in windows ? I know you can call bash via CMD, eg. ""CMD"" ""C/"" ""bash"" but the stream just returns """"; None; or... if slurp is returning """", is there a silent error somewhere?"
413,1549395935.3543,Hilary,"could stuff be going to stderr that's not showing up? I remember from some old C#/.NET work there were some `Process` options for redirecting stderr to stdout, not sure if that'd be exposed via Java classes though; this is what I was thinking of <https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.processstartinfo.redirectstandarderror?view=netframework-4.7.2>"
413,1549396573.3556,Kirstin,"Perhaps. Set, vector, list &amp; hash-map do. ; Yes, that’s right. It allows self-reference. That’s about it. "
413,1549396773.3567,Jasmine,"sorted-set, sorted-map, queue; ok, queue doesn’t :)"
415,1549397654.3576,Ronald,I would look for a specific library in Java/Clojure before piping stuff to bash/cmd
415,1549399013.3578,Dann,Process allows accessing stderr; <https://docs.oracle.com/javase/8/docs/api/java/lang/Process.html#getErrorStream-->; in ProcessBuilder you have the option to join the out/err into one stream also
416,1549399958.359,Nathanael,"ffmpeg writes a lot of things to stderr rather than stdout, afaik <@Fairy>"
417,1549413218.3613,Velia,"Confirming isak's comment, I had to combine stderr with stdout, as follows, to get output from the shell command:
/usr/bin/ffmpeg -i myfile.mpg 2&gt;&amp;1 | grep Duration | cut -d' ' -f4 | cut -d, -f1; Also, you should not need to shell out to a cmd.exe or bash shell to run ffmpeg, provided you pass the arguments properly to the process execute command. (much later); I added a comment to the gist as an improved version, to remove cut/split/grep/bash dependencies. (I'm still a Clojure novice, so my code is not well-formatted)"
417,1549418059.3648,Dann,"<@Velia> fyi def inside a function alters a single global value, but it's easy to move those defs into the adjacent let"
415,1549418078.3652,Dann,"but yeah, def inside any other form is very rarely what you want"
417,1549421253.366,Velia,"I guess I liked def for testing in the repl, but should remember to reformat my code a little after my interactive testing/debugging"
417,1549429813.3661,Lana,"Oops, it looks like they fixed that issue and I somehow missed it. I thought I was tracking the issue on GitHub. It’s been a busy few months! I am trying again to move to 1.10."
417,1549430299.3687,Mariela,"I use Component + tools.namespace.repl and very occasionally I encounter these spurious errors:

`java.lang.IllegalArgumentException: No implementation of method: xxx of protocol: #'yyy found for class: zzz`

The code is certainly right, it's simply a code loading issue

Can one fix these without a JVM restart?"
415,1549442252.37,Roslyn,Using `:extend-via-metadata` and meta to implement protocols made these errors go away for me
418,1549446377.3736,Samual,"<@Roslyn> hmm... trouble might arise when most of the app reloads but the the via-meta protocol implementations do not, and therefore get out of synch."
419,1549449784.375,Jalisa,How to fill a vector like `[:a :b :c]` with seperators `:sep` to get this: `[:a :sep :b :sep :c]`?
419,1549449922.3759,Cherise,"```
(def v [:a :b :c])
(vec (interpose :sep v))
```"
417,1549468808.3777,Harris,<@Jasmine> looks like <http://insideclojure.org|insideclojure.org> is down
418,1549469046.378,Roslyn,works for me
417,1549469101.3782,Harris,yup it works now; must've been a blip
417,1549469159.3792,Jasmine,"It’s github pages, so not much I can do if it is"
417,1549469570.3796,Shayla,"<@Jasmine> Do you use a SSG? If so, which one?"
417,1549469594.3798,Jasmine,what’s an SSG?; (so I guess no) :)
417,1549469607.3802,Shayla,"Static Site Generator, like Jykell or Hugo"
417,1549469626.3805,Jasmine,"oh, it’s jekyll, just path of least resistance; if I wanted to spend time on it I’d use a Clojure one like stasis (Strange Loop site is done with that) or Cryogen; for something like this, Cryogen is probably ideal"
418,1549469916.3818,Shayla,"cool, thank you!"
420,1549502386.3852,Larissa,"Hello all, how do I handle with `java.util.Collections`? Is there any way to convert it to Clojure collection?"
420,1549503348.3869,Latonya,"If you have an arbitrarily nested java.util.Collections object, then you would need some kind of function that recursively 'walks' through it, converting each thing into a corresponding Clojure type.  If you have a java.util.Set, and you know its elements are things like integers, strings, etc., then you should be able to simply call `(set my-java-set)`, which will return a Clojure set.; I would bet that someone has written the recursive version of that for many kinds of java.util.Collections, but I don't know what library it might exist in."
420,1549503565.3884,Larissa,It´s kind of `Enumeration&lt;String&gt;`
420,1549503599.3889,Latonya,"If you know it contains String elements, then `(set my-java-collection)` should do the job just fine.; unless you want a different kind of result, e.g. if you want a vector, then `(vec my-java-collection)`"
420,1549503760.3902,Larissa,look the solution -&gt; `(java.util.Collections/list my-java-collection)`; it response as an array in Clojure; thank you for the help
420,1549504244.3923,Latonya,"You may want to assign the return value of that to a variable or let-bound symbol, and print out the value of `(type val)` to see if it really is a Clojure vector, if you truly _need_ an immutable Clojure vector, and not a Java mutable type.  Java mutable types can be printed at a REPL in a way that looks the same as Clojure collections.; ```user=&gt; (java.util.ArrayList. [1 2 3])
[1 2 3]
user=&gt; (type (java.util.ArrayList. [1 2 3]))
java.util.ArrayList
```"
420,1549504308.3928,Larissa,I see you point
420,1549504390.3936,Latonya,"java.util.Collections/list can convert the Enumeration type to a Java list, and from there you can call Clojure's `set` or `vec` on it to create an immutable value.; I was also just reminded while searching through the Clojure source code for ""Enumeration"" of the function `enumeration-seq`, which takes a Java Enumeration, and returns a Clojure sequence.; Using that instead of java.util.Collections/list might be a little more efficient, since it might not allocate as much memory"
420,1549505890.3962,Larissa,It worked with `enumeration-seq` too. That helped me a lot. Many thanks
421,1549531882.3978,Aubrey,"Some code golf — is there something that can simplify this a little bit? ```
  (let [results [{:_id 1} {:_id 2} {:_id 5}]
        lookup {1 ""a"", 2 ""b"", 3 ""c""}]
    (map #(assoc % :val (get lookup (:_id %) ""default"")) results))
;; =&gt; ({:_id 1, :val ""a""} {:_id 2, :val ""b""} {:_id 5, :val ""default""})```"
422,1549546992.4007,Cherise,"If you didn’t need a default you could have used
```
cljs.user=&gt; (clojure.walk/postwalk-replace lookup results)
[{:_id ""a""} {:_id ""b""} {:_id 5}]
```; Oh wait you could not :wink:; You also add `:val`; To me it looks perfectly idiomatic as is; Can also use `for`:

```
(for [{:keys [_id] :as e} results
      :let [val (get lookup _id ""default"")]]
  (assoc e :val val))

;; =&gt; ({:_id 1, :val ""a""} {:_id 2, :val ""b""} {:_id 5, :val ""default""})
```"
423,1549552348.4031,Ok,"I have posted the same question in the cljs channel, but am also posting here as the behavior is the same in clj.

I am exploring `extend-via-metadata` and I am getting this behavior:

```
(defprotocol Component
  :extend-via-metadata true
  (start [component]))

(def component (with-meta {:name ""db""} {`start (constantly ""started"")
                                        `clojure.core.protocols/datafy (fn [x] (:name x))}))

(start component)
;; =&gt; started
(datafy component)
;; =&gt; db

(satisfies? clojure.core.protocols/Datafiable component)
;; =&gt; true
(satisfies? Component component)
;; =&gt; false
```

So when extending with `datafy` protocol i get true when checking if the data `satisfies?` the protocol.
However with a custom protocol with `:extend-via-metadata true` I am getting `false` in the `satisfies?` check.

Is there something I am missing in the implementation?
thanks"
423,1549558414.405,Celestine,"<@Ok> `satisfies?` doesn't work via metadata -- what you're seeing with `(satisfies? clojure.core.protocols/Datafiable component)` is the _implementation_ of that protocol for `Object`, and `component` is an instance of `Object`."
423,1549560346.4054,Ok,"Thanks <@Celestine>, makes sense now."
423,1549562314.4056,Celestine,It took me a bit of digging in the REPL to figure out what was going on!
424,1549564593.4076,Scarlett,"is there a more idiomatic way to spread a map into map varargs? given `(defn foo [a b &amp; {:as x}])`
`(-&gt;&gt; {:a 1} (apply concat) (apply foo 1 2))` is hideous"
424,1549564840.4084,Becki,`(defn bridge [a b x] (apply foo a b (interleave (keys x) (vals x)))` ?; basically make a more graceful api? or is it a lot of functions so covering them doesn't really work?
424,1549564999.4096,Dann,"yes, it's hideous, I think apply concat is nicer than interleave, and my solution is to never use `&amp; {}`; (if I can help it); also I think `(apply foo 1 2 (apply concat x))` is nicer than the arrow form, but that's subjective of course"
424,1549565200.4125,Becki,agree on the never use `&amp; {}`. I think interleave would be more meaningful to me when i see this in the wild 3 months after writing it. also agree don't thread but context of actual use dictates that ¯\_(ツ)_/¯
424,1549565222.4128,Scarlett,i just run into apis out of my control frequently enough to be irritated by it.  wasnt sure if there was an `applym` or something cute to be done with the core libs
424,1549565250.4137,Dann,"no, there's nothing built in; <@Becki> perhaps as a compromise `(def unwrap-map (partial apply concat))`"
424,1549565317.4152,Becki,put it on clojars! #shipit
424,1549565324.4155,Dann,:D
424,1549565372.4159,Scarlett,ill import it right below leftpad :wink:
424,1549566098.4167,Dann,"<@Scarlett> quoting the bot on <#C03S1KBA2|clojure> irc: ```
You have to do something like
(defn mapply [f &amp; args] (apply f (apply concat (butlast args) (last args))))
, which just goes to show why unrolled keyword args are a bad idea```"
424,1549566206.4176,Becki,i just don't know what you gain either. I know common lisp used that style a lot but with map syntax so convenient it just seems worse in every regard
425,1549566315.4184,Shayla,why `(butlast args) (last args)`? What does that get you?
424,1549566457.4221,Becki,that's how the map gets flattened into a sequence. args = `(a b {:x 3})` `(concat (a b) {:x 3})` =&gt; `(a b :x 3)`
424,1549566468.4222,Scarlett,"yea i agree the syntax doesnt help enough, it just gets in the way of composition"
424,1549566505.4228,Becki,that's why i think the interleave makes a lot of semantic sense; `(apply f (concat (butlast args) (interleave (keys (last arg)) (vals (last arg)))`; makes it clear to me that the map gets turned into key value key value ...; but it is for sure more work
424,1549566582.4245,Dann,to me it's intuitive that concat on a map would turn it into a list of keys followed by their values
424,1549566853.4253,Scarlett,incase anyone else code golfing wants a macro: ```(defmacro applym [f &amp; args] `(apply ~f ~@(butlast args) (apply concat ~(last args))))```
424,1549566922.4255,Becki,why not a function?; saving on allocations?
424,1549567017.4273,Scarlett,presumably
424,1549567022.4275,Dann,"this doesn't work if the map isn't a literal, and a big reason to want something like applym is to reuse a default map for the args"
424,1549567111.4277,Scarlett,that would preserve a symbol
424,1549567168.4286,Becki,"it works?; ```
(let [thing {:a 1 :b 2}]
  (applym f 3 thing))
{:b 2, :a 1}
```"
424,1549567196.4292,Scarlett,"```(macroexpand '(applym foo 1 2 k))
=&gt; (clojure.core/apply foo 1 2 (clojure.core/apply clojure.core/concat k))```"
424,1549567199.4293,Becki,"```
(defn f [a &amp; {:as x}]
        (prn x))
```"
424,1549567313.4306,Jasmine,"I use kwargs and &amp; {} all the time, yet never have this issue. can someone back up and tell me a real scenario where you’re doing this?"
424,1549567355.4307,Becki,None; presumably programatically creating the args and then having to use a function that uses `&amp; {}`
424,1549567462.4334,Jasmine,"I guess I tend to use them on the outer layer where it’s people, not programs"
424,1549567483.4341,Scarlett,yea specifically im progmatically calling into an api with kwargs
424,1549567515.4356,Becki,and you prefer `(invoke :arg1 :a :arg2 :b)` instead of `(invoke {:arg1 :a :arg2 :b})` for humans?
424,1549567530.4358,Jasmine,I do; we’ve actually contemplated a small change that would make either automatically work in Clojure; if you use &amp; {} in the args
424,1549567630.438,Becki,that might be kinda nice
424,1549567632.4381,Scarlett,that would be cool
424,1549567649.4385,Jasmine,"it doesn’t invalidate any existing code, just a tweak in destructuring; well, maybe it’s in the compiler, I don’t remember; possibly 1.11 feature :) but don’t quote me on it"
424,1549567743.4398,Shanell,`(defn a [b &amp; [{:keys [c d]}]])` would be unaffected I guess
424,1549567781.4403,Jasmine,"correct, effect is allowing something new in the invocation"
426,1549570334.4419,Dulcie,"Anyone have any recommendations: I'd love something to ""organize"" my requires and imports. Remove unused, and alphabetize would be nice; I use Cursive, but I don't think it does this"
426,1549570440.443,Tammera,"I installed a plugin for line sorting and ended up putting a newline between `(:require` and the first actual require; needless to say, that makes that I now have about three different ways of requiring things"
426,1549570541.4439,Dulcie,Interesting. What's the plugin?
426,1549570567.4443,Tammera,I recall that there is also a leiningen plugin that can complain/fix requires; but its name left me
426,1549570576.4449,Becki,slamhound? is that still around?
426,1549570612.4453,Dulcie,"I think eastwood will do the job at complaining at me, but doesn't fix"
426,1549570631.4457,Tammera,"yeah there is a fixing tool, but remembering names is really challenging"
426,1549570674.4459,Becki,<https://github.com/technomancy/slamhound>
426,1549570686.4463,Shayla,"That's a great name, haha"
426,1549570736.4466,Tammera,<https://github.com/gfredericks/how-to-ns>; such a googleable name that I ended up searching for my coworkers slack message :’)
426,1549570870.4475,Dulcie,"Ha, yes too generic; thanks"
427,1549572609.4486,Jerome,There are some issues with slamhound and Clojure v 1.10 fwiw
428,1549572615.4488,Georgine,"Is there a way to define in the environment where deps.edn is located? Using nextflow and the workaround I'm using is to cp deps.edn to current directory, but it's messy/lazy."
428,1549572647.449,Jasmine,"no, not currently"
428,1549572712.4493,Georgine,"thanks, worth checking"
429,1549590816.4535,Johnathon,"this might be a silly spec question, but is there a way to use a def'ed collection of keywords with, say, the `:opt` group in `s/keys`? i'm trying to define a map with a large list of optional keywords defined elsewhere:
```
(def some-test-keys [:test/a :test/b :test/c ... +100 more])
(s/def :test/labels (s/keys :opt some-test-keys))
CompilerException java.lang.IllegalArgumentException: Don't know how to create ISeq from: clojure.lang.Symbol
```"
429,1549594108.4542,Celestine,"<@Johnathon> Not with spec as it stands, but programmatic specs are coming in the next version (aka spec2).; What you _can_ do is define the spec with the literal set of keys and then use `s/form` to get back the form of the spec and take it apart to get the list of keys in it. In other words, let the spec by the ""System of Record"" and extra your ""collection of keywords"" from it.; ```user=&gt; (s/def ::my-spec (s/keys :opt [::key1 ::key2 ::key3]))
:user/my-spec
user=&gt; (let [[_ _ ks] (s/form (s/get-spec ::my-spec))] (println ks))
[:user/key1 :user/key2 :user/key3]
nil
user=&gt; 
``` You can get fancier and check what you get back from `s/form` actually has `clojure.spec.alpha/keys` as the first element and `:opt` as the second element and/or handle `:req`/`:req-un`/etc as well."
430,1549595744.4589,Tamie,"is there an equivalent to `defonce` like `doonce`  I just want to execute some code only one time, not each time I reload my src file.; I'm currently doing `defonce ignore (blah....`"
429,1549596095.4603,Celestine,"Having code executing when a namespace is _loaded_ is generally a bad idea (since it will run if you compile the ns, for example when building an uberjar with Leiningen or Boot).; If this is for dev work, you're probably better off putting it inside a `(comment ..)` form and manually evaluating it when you need to <@Tamie>"
429,1549596242.4626,Tamie,"<@Celestine> thats a great point, thanks sean!  stinky code :wink:"
429,1549596314.4638,Celestine,"Many of my source files end with a `(comment ..)` form that contains all sorts of expressions to do dev setup and some testing, including `require`s that are only needed for dev work, setup for Components, etc."
430,1549602319.4639,Johnathon,ah clever! i did something similar to turn forms back into spec maps. it didn't cross my mind that i could use the same technique -- thanks for the suggestion. <https://github.com/joshkh/specalog/blob/dev/src/specalog/jig.clj#L9>
431,1549607476.4643,Sixta,"A bit out of context, but in clojurescript this is normal in order to activate your application."
432,1549609207.4656,Larita,"Hi all!

Is it possible to define mutually recursive functions _with metadata_ in a local scope?

I want to define `f` and `g`, and attach metadata (using `with-meta` or something similar) such that each can see the other's metadata within its body.; (This has come up while implementing a `fn`-like macro that creates a function and attaches some metadata to it. I'd like these ""fake `fn`s"" to be useable anywhere a real Clojure function can be made, which led me down the road of trying to create a `letfn`-like macro that attached metadata to all the functions declared in the `letfn`. But I ran into the issue of not being able to create a `letfn` that binds metadata to the functions it creates.); I guess something like this should work:
```
(letfn 
  [(f-thunk [] 
     (with-meta (fn f [] (meta (g-thunk))) {:b 3})) 
   (g-thunk [] 
     (with-meta (fn [] (meta (f-thunk))) {:a 2}))] 
  (let [f (f-thunk) g (g-thunk)] 
    [(f) (g)]))
```"
433,1549618792.4693,Melina,"Apologies if this is noise, but is there any plan to add metadata to EDN?"
434,1549620793.4703,Isa,"Ech I always forget this….
`(re-matches #""(?i)&lt;message&gt;(.+)&lt;/message&gt;"" ""&lt;message&gt;foo&lt;/message&gt;baz&lt;message&gt;bar&lt;/message&gt;"")`
How to get `foo` and `bar` from here? I am trying half an hour :slightly_smiling_face:"
435,1549621369.4732,Thersa,"Hi there!

Is there anybody, who knows about a problem with `slurp`? I try to fetch some websites, that I can reach via browser, but `slurp`throws an exception:

```(slurp ""<https://www.some.url>"")

FileNotFoundException <https://www.some.url>  sun.net.www.protocol.http.HttpURLConnection.getInputStream0 (HttpURLConnection.java:1836)```

Tested the same URL with `curl` and it works fine. Any ideas?"
435,1549622282.4733,Jessia,Any more useful information in the stack?
435,1549622382.4751,Thersa,"```lein version
Leiningen 2.8.3 on Java 1.8.0_91 Java HotSpot(TM) 64-Bit Server VM```
org.clojure/clojure “1.9.0”"
435,1549622566.4756,Jessia,"hmm, I get the same problem; `curl -i ...` shows it's speaking HTTP/2, maybe something to do with that?"
436,1549623141.4774,Samual,<@Isa> re-seq . But the regex is not quite right - the .+ is too greedy and may consume the end tag
435,1549623177.478,Samual,Try it at the REPL and you'll see
436,1549623239.4785,Isa,"sure, but the question is how right regex look :wink:"
436,1549623280.4788,Samual,.+?; The question makes it less greedy
436,1549623292.4792,Isa,"nope, it doesn’t help"
436,1549623314.4794,Samual,Did you try it at the REPL?  I did
436,1549623325.4796,Isa,oh it works with re-seq; I am after week 16h work everyday after breaking changes third party system update. My mind is almost turned off :slightly_smiling_face:; Thanks
437,1549625435.4806,Thersa,:man-shrugging: ; That's why I'm asking 
438,1549627816.4839,Alleen,"`definline` is still labeled as experimental in the docs, but it seems hardly ever used. what is its official status ?"
436,1549630356.4842,Cherise,"<@Isa> another approach:

```
(require '[hickory.core :as hickory]
         '[hickory.select :as select])

(def parsed-doc
  (hickory/as-hickory (hickory/parse ""&lt;message&gt;foo&lt;/message&gt;baz&lt;message&gt;bar&lt;/message&gt;"")))

(mapcat :content (select/select (select/tag :message) parsed-doc))
;; =&gt; (""foo"" ""bar"")
```"
436,1549630442.4843,Isa,Can it find all &lt;errors&gt;&lt;error&gt;&lt;messsage&gt;…..&lt;/message&gt;… in string? Because in reality it is very complex XML structure.; and this message can be everywhere; so not sure it will be more efficient
436,1549630520.4849,Cherise,Of course; It is bad practice to use regex for parsing XML :wink: See this famous answer: <https://stackoverflow.com/a/1732454/2609980>
436,1549630545.4854,Isa,"thanks; Sure it is, but in many cases it just work as simple 1 line solution; But I agree"
436,1549630756.4864,Cherise,Sometimes it can be easier; Alright let me know how it goes; <https://github.com/davidsantiago/hickory#selectors>
439,1549631898.4882,Jasmine,Would like to deemphasize - primarily used in Clojures implementation
439,1549632100.4885,Alleen,so better not rely on it ?
439,1549632127.4888,Jasmine,No
439,1549632459.4891,Isa,Unfortunately I don’t have time to try it now. But I wrote it in my notes to try later :slightly_smiling_face:
440,1549636419.4902,Jalisa,"I have a collection `c` which can be a list, a vector or a set. How do I remove an item from it while keeping the type of `c`?"
440,1549636470.4909,Jasmine,"those are different kinds of things so there is no common operation to do that; usually if I encounter a question like this, I step back and look at how I got to wanting to remove things from a non-indexed collection"
440,1549636593.4924,Jalisa,"<@Jasmine> So you mean, I should avoid having to remove individual items from lists or vectors? Just from sets?"
440,1549636648.4931,Jasmine,"yes, generally I try to never remove anything from the middle of a list or vector; sets are fine - they are designed for that"
440,1549636677.4941,Jalisa,<@Jasmine> Thank you. I'm going to think about that...
440,1549636867.4945,Alleen,thanks !
440,1549636906.4952,Roslyn,"<@Jalisa> if you are okay with O(n):
```
(let [xs [1 2 3] ;; or '(1 2 3) or #{1 2 3}
      el 1]
  (into (empty xs) (remove #(= % el)) xs))
```"
441,1549638159.4973,Haley,"How does Calva find test namespaces?

I have `[""src/a/b.cljc"", a.b]` and `[""test/a/b_test.cljc"", a.b-test]`, and `:source-paths [""src"", ""test""]`, but Calva says ""No tests found. :scream:"""
441,1549638396.4974,Isa,<#CBE668G4R|calva-dev> try here
442,1549644038.498,Dann,beware that `into` on a seq reverses order
443,1549648553.4986,Boyd,"Is there a more idiomatic way of doing an `or` check with multiple `=` checks involving the same variable?

```
(or (= panel-name :general-info) (= panel-name :permanent-address) (= panel-name :school-info))
```"
443,1549648627.4992,Becki,`(#{:general-info :permanent-address :school-info} panel-name)`
443,1549648644.4995,Dann,contains? at the front if nil or false are one of your cases; the set works because a set acts as a function returning an item if found in the set
443,1549648678.5002,Boyd,"Ah yes, I have used something like this before."
443,1549648683.5005,Becki,yeah. however it looks. but rather than `or` just do set membership check; which is semantically what you are doing
443,1549648747.5019,Dann,"also, depending on where the or is:
```(case panel-name
  (:general-info :permanent-address :school-info) (some-action))``` - but this only works if your matches are compile time literals; (the case would potentially replace if/cond here)"
443,1549649226.5028,Jasmine,"`(#{:general-info :permanent-address :school-info} panel-name)`; ^^ enumerate things in a set and use set membership; literally, is panel-name in this set of values; if you want to improve readability you can make that more explicit:
`(contains? #{:general-info :permanent-address :school-info} panel-name)`; oh sorry, I didn’t see <@Becki> s reply above, sorry to duplicate"
443,1549649363.5046,Becki,i'm always pleased when my recommendation aligns with yours :slightly_smiling_face:
444,1549649776.5047,Karren,Could you be more specific and given an example of url reproducing the problem?
445,1549653489.5063,Deangelo,"hi everyone. are there any isomorphic web frameworks for clojure, except `fulcro`?"
445,1549653711.5066,Shayla,what's an isomorphic web framework?
445,1549653820.5072,Deangelo,basically a combo of server - side rendering and a single page application; where you can use the same exact component on client and server
445,1549653959.5079,Shayla,"ah cool, okay"
445,1549653972.5081,Fredda,"rum; most cljs react wrappers can probably be retrofitted to work isomorphic style, with some elbow grease. But rum was able to do it out of the box when it first shipped (or pretty early)"
446,1549655461.5104,Tammera,"May I ask, I was wondering why this works, is a set somehow also a function?; I know it does work, but come to think about it I don’t know why :’)"
446,1549655496.5117,Arnoldo,"Yes, just like map"
446,1549655622.5123,Tammera,(I meant under the hood)
446,1549655672.5125,Arnoldo,"and I meant, similar to map, it implements IFn"
446,1549655703.5134,Tammera,"Right I see now, then we are on the same page. Thanks!"
446,1549655724.5136,Arnoldo,np...when I first came across this I was both puzzled and delighted
446,1549655790.5147,Tammera,"Yeah I know it works for months now, but I never stopped an thought about why"
446,1549655860.515,Becki,specifically this i think: <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/APersistentSet.java#L49>
446,1549655989.5168,Tammera,"What a curious interface iFn, it has invokes for 0..20 arity plus 20 arity and varargs"
446,1549656018.517,Arnoldo,That stuff is all performance related as far as I understand it; usually the interesting ones are at the bottom where it explicitly handles multi-arity
446,1549656065.5178,Becki,"there's some different between a form run in the repl, compiled in the repl and run normally too. invoke, run, etc"
446,1549656069.518,Tammera,Yeah I know that varargs are slow
446,1549656081.5182,Becki,but it's so hazy for me that i'm almost certainly wrong but just a grain of truth there; if you ask in <#C03S1KBA2|clojure> i'm sure someone could point you towards that; (if you're interested)
446,1549656186.52,Tammera,"Always interested in more knowledge,  but not always at the expense of time of others ;); If that makes any sense"
446,1549656257.5206,Arnoldo,"class clj_dict(dict):
	def __call__(self,item,default):
		return self.get(item,default)

f = clj_dict(a=1,b=2)
print(f('c','not_here!')); my python will never be the same :stuck_out_tongue:"
446,1549656322.5216,Tammera,"Same goes for equality, math ops, lookup, etc; I’ve seen python code that repurposes `**` for something clever"
446,1549656405.5228,Arnoldo,"yeah it has pretty convenient metaprogramming with it's ""magic"" methods; nothing beats macros though"
446,1549656543.5237,Tammera,Language design is such a fascinating subject
446,1549657140.5239,Arnoldo,definitely... also quite the rabbit hole; i prefer being a spectator and letting the adults play
446,1549657311.5243,Tammera,"hahaha, right"
447,1549661658.5258,Bree,"tooting my own horn here, but <https://github.com/cjohansen/dumdom> can render the same components server and client side on both the JVM (native, no JavaScript runtime) and Node"
448,1549666119.5302,Alyson,"I hope I'm not beating a dead horse, but I wanted to ask some conceptual questions about clojure startup time.  Some things I understand:
- The JVM startup time is a relatively small component
- Clojure itself has to evaluate all of its internal code when you start it up, which is the bulk of the time
- I've read that some lisp implementations are able to save an ""image"" of a system
- Subsequent invocations can start quicker by simply loading the image
- I think GraalVM supports a similar notion, but that might be only for compiled code (you lose `eval`?)
- Clojurescript / Lumo, etc have a faster startup time (on platforms for which Node is available); My question was: are there any technical limitations which would make it impossible for clojure to eventually support this notion of saving to / starting from an ""image""?; i.e. is there anything about the JVM which would make that impossible?; Startup times on machines I own, if anyone is curious :slightly_smiling_face:
```
startup times:
* macbook pro 2015: clojure(1.9):         ~1.2 seconds
* macbook pro 2012: clojure(1.9):         ~1.2 seconds
* HP i3@2.3GHz:     clojure(1.8,openjdk): ~6.1 seconds
* raspi 3:          clojure(1.8,oracle):  ~16 seconds
* OLPC:             clojure(1.6,openjdk): ~20 seconds
* raspi zero w:     clojure(1.6,oracle):  ~81 seconds
* raspi zero w:     clojure(1.6,openjdk): ~97 seconds
* pogoplug:         clojure(1.6,openjdk): ~98 seconds
* NSLU2:            clojure(1.9,openjdk): ~284 seconds
```"
448,1549666251.5323,Dann,what are you starting in each of those cases? lein? the clojure command line tool? `java -jar ...` ?
448,1549666273.5328,Alyson,"oh, sorry: `time echo '(System/exit 0)' | clojure`; not sure how scientific that is"
448,1549666285.5332,Dann,so the clojure command line tool
448,1549666291.5334,Alyson,yeah
448,1549666314.5342,Dann,just make sure it's not the first run from that directory (cached deps list / downloads)
448,1549666317.5344,Alyson,"(I should also state that I'm a clojure noob -- please point out any glaring mistakes I'm making); <@Dann> yeah, thanks, I did see a speedup on subsequent runs!"
448,1549666412.536,Dann,"there are a few things that can be sped up, where speeding them up removes desired dev-time features of the language (eg. redefinitions of vars) - some of them are provided by default for clojure.core but can be turned on for other namespaces"
448,1549666437.5362,Alyson,"oh interesting; for the ""image"" idea, I'm curious how that is implemented on other lisps.  literally dumping a copy of the stack / heap to disk?  seems like that would be large"
448,1549666500.5375,Becki,direct linking?
448,1549666558.5382,Dann,"<@Alyson> precisely, it's a space/speed tradeoff (java makes enough of those already that the size of allocations becomes a factor...)"
448,1549666576.5386,Alyson,<@Becki> this? <https://clojure.org/reference/compilation#directlinking>
448,1549666594.5389,Dann,"yeah, that's the one; <@Alyson> the jvm arg is `-Dclojure.compiler.direct-linking=true`"
448,1549666667.5398,Alyson,"_As of Clojure 1.8, the Clojure core library itself is compiled with direct linking._  oh interesting, so I should definitely be comparing 1.8 to other versions"
448,1549666703.5406,Dann,"I guess it doesn't apply to your test, as it defines no clojure code outside clojure.core"
448,1549666708.5408,Alyson,"might explain why the raspi zero w was way slower than I expected vs. the rasp 3 -- I was running 1.6 on one and 1.8 on the other; <@Dann> oh, if I don't use clojure.core then it doesn't get evaled on startup?"
448,1549666795.5421,Dann,what I mean is that the flag I menion above doesn't do anything if you aren't compiling anything - I guess your one interop call gets compiled but that should be minor
448,1549666803.5425,Alyson,oh gotcha
448,1549666834.5432,Dann,"if you had a significant app to compile and run, I would expect that flag to make a difference"
448,1549666980.5443,Alyson,"One the conceptual things I seemed to gather was that porting clojure to a different platform doesn't address the startup issue, because it is mostly due to the need to evaluate a bunch of clojure code on startup.  I grabbed a copy of clojure_py and observed similar results.; (so i.e. porting to C wouldn't help anything, and might even be slower the the JVM); The thing which struck me was the difference between clojure startup times and some common-lisp implementation startup times.  e.g. on my lowly NSLU2, gcl starts in 0.26 seconds.  So it must not be evaluating much on startup.; Anyway, just wanted to ask if there was any knowledge / current efforts around the idea of starting clojure from an ""image"" in a way similar to e.g. common-lisp (I think emacs does this as well?)  (related: <https://stackoverflow.com/a/7686350/7543271>)"
448,1549667304.5482,Celestine,"While there is ongoing work to help reduce Clojure's startup time on the JVM, the idea of an ""image"" is a non-starter, in my opinion, since you're talking about the JVM itself really -- you'd need to be able to save and load JVM images for Clojure to be able to leverage that."
448,1549667318.5484,Alyson,"ah, gotcha"
448,1549667371.5494,Celestine,Clojure just has a lot of `.class` files to load and initialize.; It would require a fairly fundamental change to the (Clojure) compiler to produce something that loaded and initialized faster for `clojure.core` (and the handful of other namespaces that actually get pulled in for `-main` to run) -- and that's just not a concern for server-based software which is really Clojure's target.
448,1549667496.5516,Alyson,thanks for the perspective <@Celestine>
448,1549667592.5535,Ronda,I would recommend watching this great talk from Gary Fredericks: <https://www.youtube.com/watch?v=-Qm09YiUHTs> - IMO there is no low hanging fruit (without introducing breaking changes)
448,1549667615.5544,Alyson,<@Ronda> thanks I'll check it out!
448,1549667619.5545,Celestine,"On a reasonably fast laptop/desktop, `clojure` _is_ fast enough for scripting for most purposes tho', unless you're looking for sub-second response times...; Gary's talk is excellent!"
448,1549667668.5559,Alyson,"yeah, I gather that most people are using a SLIME-style workflow anyway, so they infrequently see the startup time lag"
449,1549667693.5563,Celestine,I guess a lot depends on which languages you're coming from... I've been on the JVM primarily for about twenty years so... :slightly_smiling_face:
448,1549667743.5572,Celestine,"Aye, I start a REPL up and leave it running for days. In fact, I often have two or three REPLs running in different contexts, and switch my editor between them as needed.; And ""Welcome to Clojure!"" <@Alyson> :slightly_smiling_face:; (just scrolled back and saw your comment that you're new-ish to the language)"
448,1549668101.5594,Alyson,thanks!
448,1549668106.5595,Celestine,One difference between 1.8 and 1.9 is the addition of `clojure.spec` and `core.specs` so I suspect that's part of the slowdown from 1.8 to 1.9
448,1549668127.5597,Alyson,"ah interesting; yeah even though I'm new, I've been watching rich's talks for years and they have influenced my thinking in other languages.  my goal for 2019 is to get serious with clojure"
448,1549668200.5617,Celestine,"Locally, it looks like startup times were pretty consistent from 1.2 up to 1.7 (about 1.15 - 1.2s on my desktop), then dropped to just under 1s with 1.8, and went back up to about 1.1-1.2 with 1.9."
448,1549668241.5622,Alyson,"ah, so that reflects the change to direct linking in core and then the introduction of spec"
448,1549668283.5627,Celestine,"And 1.10 and 1.11 (master) seem about the same as 1.9 (again, consistent).; You might find the analysis here interesting <https://dev.clojure.org/display/design/Improving+Clojure+Start+Time>"
448,1549668412.5633,Alyson,oh thanks!
448,1549668530.5637,Celestine,"You can shave some startup time off for `clojure` with `-J'-Xverify:none'`; (per that wiki page -- but see the caveats around that); This is consistently 0.9s for me ```time echo '(System/exit 0)' | clojure -A:1.10 -J'-Xverify:none' -J-client -J-XX:+TieredCompilation -J-XX:TieredStopAtLevel=1
```"
450,1549673132.5653,Jasmine,"I don’t think that works anymore in modern jvms; Or has no effect; Correct. 1.8 had some cost from incidental loading from the socket server stuff; AppCDS does this on the jvm and it does help a lot, but kind of requires you to know everything you’re going to load"
451,1549673713.5687,Matha,what machine are you on?
450,1549674259.5689,Celestine,"A late-2012 27"" iMac with 16GB RAM and a 3.4GHz Core i7 with SSD drives.; `-J-Xverify:none` still seems to make a difference on OpenJDK 11 vs OpenJDK 8.  The `-client` and tiered stuff, not so much."
450,1549676273.5713,Jasmine,"I thought they didn’t allow you to turn off the verifier anymore, but been a while since I looked at it; In any case, don’t turn off the verifier :)"
450,1549679468.5722,Celestine,"&gt; (per that wiki page -- but see the caveats around that)
:slightly_smiling_face:"
452,1549729323.5747,Mireille,"seeing this error running an old version of a library (liberator 0.12.2) on java 11 using the clojure cli:
```CompilerException java.lang.ClassNotFoundException: javax.xml.ws.ProtocolException, compiling:(liberator/conneg.clj:1:1)```
is there a workaround for this? I believe it's a general issue running old libraries on java 11, and the answer is to add the dependency using `--add-modules` but I'm not sure how to do that. also, it's a regression test so I can't upgrade the liberator library"
452,1549736619.5802,Jessia,I think in Java 11 the better solution is to add the javax jaxb dependencies (available on Maven). ; See here: <https://stackoverflow.com/a/52502208>
453,1549738378.5836,Rosia,how do people typically deal with missing values NA or NaN type values when doing data science type stuff in clojure? Is using nil or ##NaN obviously better?; and checking for this everywhere?
453,1549738649.5876,Jessia,"Is there a best practice for namespaced keys in nested maps? e.g. I have this structure with namespaced keys but see it is rather verbose: 

```
{:document/entities 
  {:entity/extracted ... 
   :entity/tagged ... }}
```"
453,1549738754.5884,Rosia,"<@Jessia> you can do this to save a little repetition: ``` {:document/entities 
                #:entity{:extracted []
                         :tagged [] }} ```"
453,1549738823.5899,Jessia,Thanks - sorry I should have said I’m aware of that syntax but even then it doubles up on entity/entities in this example.
453,1549738975.5912,Rosia,"I'm not 100% what you mean, do you mean you want the `:entity` keyword qualifier somehow inferred from it being below `:document/entities` in the tree?; I think a lot of the qualified keyword stuff is a place where verbosity has been hard to avoid in my experience"
453,1549739027.5925,Jessia,"Yes, or if there’s some better way to design my data so it’s not necessary"
454,1549739889.5954,Tajuana,I’m working a testing framework but I’m struggling to filter/compare namespaced maps; ```#::step{:name 'some-name}```; with an arbitrary map that may be namespaced
455,1549740286.5965,Samual,clojure.data/diff ?
454,1549740714.5975,Tajuana,Not quite what I’m looking for. I want to ask.. is this map from this particular namespace
455,1549741061.5977,Oscar,"I think records could be useful for this. but, _gasp_, that means making use of types"
455,1549741156.5984,Rosia,will all keys in the map have the same namespace?
455,1549741170.5988,Becki,"just to point out, maps cannot be namespaced. there's a shorthand for when all of the keys share the same namespace but this is a property of those keys and not the map; however, could you walk over things and collapse maps whose entries are keywords which all share the same namespace into a single entry?"
455,1549741287.6005,Rosia,`(-&gt; #:step{:name 'some-name} first key namespace)` if you can count on the map's key entries to all have the same NS
455,1549741289.6006,Becki,"not sure what your goal is but you could walk and strip namespaces, or assert that all entries have the same namespace or something. But i'm not clear what your goal is and how namespace keys really affect that"
455,1549742230.6007,Samual,What does it mean for a map to be from a namespace?; Each key in a map may be namespace-qualified.; The utility of namespaced keys is precisely that one map can contain a variety of them
455,1549742345.6021,Tajuana,I think the answer is to just walk the keys and see if it conforms
456,1549742401.6024,Tajuana,"Okie, thanks"
457,1549780596.6029,Mireille,"<@Jessia> thanks, that worked for me"
458,1549792994.6032,Alease,is there anything like a static analysis tool to add type hints to a clojure file?; or at leas try
459,1549806736.6042,Rosanne,"Hi! The following code:
```(ns my-ns
        (:refer-clojure :exclude [def]))

   (alias 'c 'clojure.core)

   (c/def test 1)```
Gives an error: `RuntimeException No such var: c/def`. What am I doing wrong here?"
460,1549812308.6057,Shanell,`:refer-clojure` is outside `ns`
459,1549816634.6058,Rosanne,"You’re right of course, i mistyped it in Slack, but it’s correct in my code"
459,1549822663.6065,Argentina,"<@Jessia> If you want to reduce the verbosity in your code, I'd look at using tagged literals. I put together an example of doing that  <https://gist.github.com/shaunparker/c89ac63cba98d05d9586a837654b1c1e>. If you have clojure installed locally you can run `clojure -Sdeps '{:deps {keyword-tagged-literal-ex {:git/url ""<https://gist.github.com/shaunparker/c89ac63cba98d05d9586a837654b1c1e>"" :sha ""bb8513e88698c0cf12108b6df19a96679661c3cc""}}}' -m example`"
461,1549823469.6092,Deangelo,"hi everyone. I have a list of lists - ```((1 2 3) (1 0 6) (3 9 8))```
and I’d like to `interleave` these and put them in lists again, so basically my end result to be
```((1 1 3) (2 0 9) (3 6 8))```
I’m a bit stuck, because I ended up with something like
```(apply list (apply interleave my-list))``` and it obviously doesn’t work"
461,1549823860.6095,Argentina,<@Deangelo> `(-&gt;&gt; (apply interleave my-list) (partition 3))`
461,1549823899.6099,Deangelo,ah right! thanks <@Argentina>
461,1549823923.6106,Argentina,you're welcome
461,1549823928.6107,Latonya,"An alternative that should work for more then 3 lists of lists (I am not saying shaun's does not -- I just suspect perhaps maybe it is limited to that because of the (partition 3)):; ```user=&gt; (apply map list '((1 2 3) (1 0 6) (3 9 8)))
((1 1 3) (2 0 9) (3 6 8))
```"
461,1549824762.6117,Deangelo,:+1: nice one. they both work actually :slightly_smiling_face: I love the fact that there are many different ways you can approach things
462,1549828403.6125,Jessia,"Whoa, interesting stuff. Thanks Shaun, I shall have to give it a try "
463,1549832090.6144,Sixta,"Why does using a nested j.u.H cause a reflection warning? How can I do this properly?

```
(defn foo
  []
  (java.util.HashMap.
    {""baz"" (java.util.HashMap.
             {""foo"" ""bar""})}))
```

```
Reflection warning, NO_SOURCE_PATH:3:3 - call to java.util.HashMap ctor can't be resolved.
```"
464,1549832690.6147,Sixta,"I mean, I can reduce-kv, but other than that :slightly_smiling_face:"
463,1549833227.615,Becki,"there are two single arg constructors. need to indicate _which_ one?; not sure how to indicate `HashMap(Map&lt;? extends K,? extends V&gt; m)`."
463,1549833290.6157,Jasmine,"I don’t think that’s it; specifically the inner one does not  reflect, only the outer one; TBH, I can’t explain that without digging into the compiler more"
464,1549833885.617,Cherise,"<@Deangelo> another one :wink:

```
(require '[core.matrix :as matrix])
(matrix/transpose '((1 2 3) (1 0 6) (3 9 8)))
;; =&gt; ((1 1 3) (2 0 9) (3 6 8))
```"
464,1549854971.6188,Gracie,"Has anyone seen the following error when running 'brew install clojure'?  brew install clojure
Error: No available formula with the name ""clojure""
Clojure isn't really a program but a library managed as part of a
project and Leiningen is the user interface to that library.

To install Clojure you should install Leiningen:
  brew install leiningen"
464,1549855182.6195,Marlyn,you must be on a very old brew <@Gracie>; I can brew install clojure just fine
464,1549855729.6209,Gracie,"<@Marlyn> yes... turns out that reinstalling brew did the trick. brew update was also broken, which is how I ended up stuck on an older version.  Didn't realize it would affect the package index."
465,1549885256.0068,Kenny,"Is it possible to define a custom implementation of `toString` for `defrecord`s? I have already defined a `clojure.core/print-method` for the record-type in question, which helps in REPL, but is not useful when I try to generate formatted string with `format` functions. Looks like `format` function directly calls `toString`."
465,1549885397.008,Virgil,"I'm using `clojure.tools.deps.alpha` to `resolve-deps` but I get:
```Expanding javax.servlet/javax.servlet-api #:mvn{:version 3.1.0}
Execution error (ArtifactNotFoundException) at org.eclipse.aether.connector.basic.ArtifactTransportListener/transferFailed (ArtifactTransportListener.java:48).
Could not find artifact net.java:jvnet-parent:pom:3 in glassfish-repository (<http://download.java.net/maven/glassfish>)```"
465,1549885416.0081,Roslyn,"```
(defrecord A []
  Object
  (toString [this] ""AAAAA!!!""))
=&gt; user.A
(A.)
=&gt; #user.A{}
(format ""scary? %s"" (A.))
=&gt; ""scary? AAAAA!!!""
```"
465,1549885746.0083,Kenny,Thanks!
466,1549886281.0088,Virgil,"the solution was to ensure to have ``` :mvn/repos {""central"" {:url ""<https://repo1.maven.org/maven2/>""}
                ""clojars"" {:url ""<https://repo.clojars.org/>""}}``` in the deps map"
467,1549893979.0093,Tamisha,<@Boyd> try `(#{:general-info :permanent-address :school-info} panel-name)`
468,1549895837.0095,Suzann,"If you take a look at the publics for clojure.core you will see that def is not included.

```
(sort (keys
       (ns-publics 'clojure.core)))
```

That's because def is actually a special form. <https://clojure.org/reference/special_forms#def>"
469,1549898991.0101,Mariela,"From last week. Any luck?
It keeps biting me, especially after long sessions"
469,1549899578.0109,Clarine,I have had this problem too. Eventually I gave up on using tools.namespace refresh. I’m using the REPL more in the style of Stuart Halloway
469,1549899640.0116,Mariela,"swapping Stus... :grin:

what does the technique consist of?"
469,1549899665.0122,Clarine,"In short, just redefine forms yourself, one at a time"
470,1549899695.0129,Donita,Hi all does anybody know if a tool that would help to refactor function calls in a clj file that were created with a :refer :all to use a prefix?
469,1549899727.0137,Clarine,"You can watch this talk: <https://youtu.be/Qx0-pViyIDU?t=1751>
He talks about the difference in the second half of the talk if I remember correctly"
469,1549899793.0153,Donita,For example I have a file with (:require [korma.core :refer :all]))...   and within uses (update db-table (set-fields :myfield mydata) (where (:id id)))....
469,1549899795.0155,Mariela,"sounds tough... I'm used to refresh large projects ~100 times per session.

no way I could do that manually (and without errors)?"
469,1549899797.0157,Donita,to be:
469,1549899817.0161,Mariela,clj-refactor for emacs; it has the `stop-referring` command
469,1549899844.017,Donita,(:require [korma.core :as kdb]))....   (kdb/update tb-table (kdb/set-fields :myfield mydata) (where {:id id})))... etc.; ooh nice didn't see that!
469,1549899889.0175,Clarine,I use a lot of `(comment ...)` sections to try out stuff. those also get erased when I change something and then use tools.nrepl refresh. Also I use inline def sometimes to capture stuff. All this state is erased. Something which hampers my debugging. It’s a different trade off.
469,1549899894.0177,Donita,thanks #vemv; <@Mariela>
469,1549899953.0181,Mariela,:+1:if you don't use emacs you can use the underlying clojure code anyway
469,1549899987.0183,Donita,i have emacs yes. I will give it a wizz now. I don't normally use clj-refactor but have it installed
469,1549900020.0191,Mariela,"it's super sweet. especially with the Hydra menu, otherwise I'd forget all those commands"
469,1549900055.0197,Becki,The compiler will tell you about undefined symbols if you just update your import statement
469,1549900085.0205,Clarine,"you can also use the joker linter, which will tell you even without compiling; it’s a killer feature when using this as an editor plugin"
469,1549900205.0229,Donita,just removing and relying on the compiler might be a bit deceptive as there are some function names in the korma namespace that shadow clojure.core ones - for example update and so I am concerned that I may not get compiler errors in that case
469,1549900469.0234,Becki,ah good point
469,1549900755.0249,Donita,gunna try emacs / clj-refactor / stop-referring command
471,1549900860.0264,Roslyn,"tools.deps question: when I depend on git dependency, is there a way to also specify an alias defined in that library to be used?"
471,1549900870.0266,Jasmine,no
471,1549900881.0272,Roslyn,will there be such a way?
471,1549900883.0273,Jasmine,no; aliases are resolved first to determine what deps to traverse
471,1549900922.0287,Roslyn,but aren't they like a classifiers in poms?
471,1549900930.029,Jasmine,no
471,1549900932.0291,Roslyn,"kind of; &gt; aliases are resolved first to determine what deps to traverse
I meant to use alias defined in dependent library when specifying dependency, not using it in place where normal aliases are used"
471,1549901066.0309,Jasmine,oh; haven’t thought about it
471,1549901093.0316,Roslyn,"like that:
```
{:deps {git-dep/artifact {:git/url ""..."" :sha ""..."" :aliases [""blah""]}}}
```; this looks like classifier, and behaves kind of like classifier; (I mean expected to behave, not behaves)"
471,1549901156.0328,Jasmine,I don’t think it’s like classifiers; classifiers select an alternate artifact; this is about selecting an alternate sub-classpath
471,1549901196.0341,Roslyn,"right, this is more of a configure what bits to also include"
471,1549901220.0349,Jasmine,"well, feel free to file a TDEPS jira enhancement and I’ll think about it. not anything I’m going to do soon though."
471,1549901320.0362,Roslyn,"Thanks, I will! I have a use case for it, but it's not very urgent and workarounds are possible while it's not there"
472,1549902625.0376,Mauricio,"hi, i’m trying to process a hierarchy and i think i have things working the way i like, but i can’t seem to figure out how to avoid an atom i want to get rid of… any tips appreciated.

<https://gist.github.com/joefromct/0b017d43f381e3f861fc93d08e716213>

I think it’s trickier than just a recur with an accumulator because there is a couple of doseq’s in the middle there."
471,1549903212.038,Roslyn,<@Jasmine> created <https://dev.clojure.org/jira/browse/TDEPS-116>
472,1549904083.04,Jasmine,thx
472,1549904368.0401,Lonna,"Here’s a version that uses `reduce-kv` and `reduce` instead of `doseq`:
```

(defn recur-test [{:keys [acc val md5-list json-key]
                   :or {acc []
                        md5-list []
                        json-key []}
                   :as args}]
  (let [pretend-md5 (str (hash val))]
    (cond
      (map? val)
      (reduce-kv (fn [args' k v]
                   (recur-test (-&gt; (assoc args' :val v)
                                   (update :json-key conj k)
                                   (update :md5-list conj pretend-md5))))
                 (update args :acc conj {:md5-list (conj md5-list pretend-md5)
                                         :json-key json-key
                                         :val val})
                 val)

      (vector? val)
      (reduce (fn [args' v]
                (recur-test (assoc args' :val v)))
              args
              val)

      :else
      args)))

(:acc (recur-test {:val airplanes}))
```"
473,1549904426.0403,Lonna,"Although note, I extracted `:acc` from the final result, since the whole `args` is returned from every call."
473,1549904675.0406,Mauricio,thanks a bunch that is awesome.
473,1549905792.0421,Clarine,"Interestingly, TDEPS-116 could also open the way for a solution to managed dependencies. The lib/deps.edn is a file that describes managed deps via aliases. app/deps.edn consumes this lib and describes which managed deps (= alias in lib/deps.edn) it wants to include as deps."
473,1549906884.0425,Lonna,you’re welcome!
474,1549912033.0442,Clemente,"I just did a `(source promise)` and discovered there's an undocumented behavior; a promise can act as a function equivalent to deliver on the promise.  This is actually quite useful to me.  Is this an intentional part of promise and, if so, should it be documented?

```
(def p (promise))
=&gt; #'user/p
(p 37)
=&gt; #object[clojure.core$promise$reify__8486 0x5742bdca {:status :ready, :val 37}]
@p
=&gt; 37
```; I'll submit a patch to update the docstring if so."
474,1549912310.0459,Dann,"<@Clemente> for undocumented behavior you *definitely* shouldn't count on, I've seen `deliver` used to replace `(fn [f x] (f x))` which relies on that behavior"
474,1549912347.0463,Jasmine,the implementation seems to quite intentionally support that; (by implementing IFn)
474,1549912371.0471,Clemente,"So missing documentation: a bug, or leaving option open to remove this behavior?"
474,1549912393.0474,Jasmine,I’d call it a doc bug
474,1549912408.0479,Clemente,"Ok, patch coming up!"
474,1549912412.0481,Jasmine,"can’t imagine we would remove it; bleh; I would make the patch small by just extending “… with deliver _or by invoking the promise_”; looking at it again, clearly `deliver` is the intended entry point so I think I’d call it an enhancement"
474,1549913584.052,Clemente,"Interesting; looking at the source for deliver, it is just `(promise val)`.  My thinking is that this usage in not intentional, it was just easier for Rich to re-use IFn than to define a new IDeliver interface. However, I think it is quite worth documenting and even using when appropriate."
474,1549913648.0521,Tammera,"I have this ‘problem’ too, I initially thought it was because of refer’s, but sadly not so trivial"
474,1549914021.0523,Clemente,<https://dev.clojure.org/jira/browse/CLJ-2480>
475,1549916594.0549,Larissa,"hello all, Is there any exponentiation function of a double exponent? `(function 4.554 &lt;exponent_double&gt;)`"
475,1549916619.0553,Dann,for both clj and cljs you can use `Math/pow` via interop
475,1549916637.0555,Larissa,thansk
475,1549916650.0557,Dann,"```user=&gt; (Math/pow 4.554 Math/E)
61.61660979210404```"
475,1549916692.0561,Larissa,"worked, many thnaks"
476,1549918642.0589,Sebrina,"You know, once you get over the parenthesis there is a lot of power to appreciate. I was about to write `(defn min-&gt;ms [min] (* (* min 60) 1000)` then `(defn min-&gt;ms [min] (-&gt; min (* 60) (* 1000)))` then realized it’s just `(defn min-&gt;ms [min] (* min 60 1000))`."
476,1549918704.0596,Becki,honestly i would absolutely hate to work in a language without parens. text editing is so convenient with them. i think a paren beginner is equivalent to a vim master
476,1549918742.0602,Esther,once you have something like paredit as muscle memory it seems like you really have lifted off
476,1549918755.0605,Tammera,I am so lost in all editors that don’t sanely add parens lately; cursive spoiled me
476,1549918906.0621,Mauricio,i want to brush up on my paren editing skills… does anyone have a link to a good tutorial/docs?  I’m using doom emacs atm and smart-parens is mildly annoying at times… i think i had a better paredit setup years ago.
476,1549918933.0627,Esther,"i use lispy and there is a file in the package that is like vimtutor
<https://github.com/abo-abo/lispy/blob/master/lispytutor/lispytutor.el>; there might be something better out there though. Not sure if lispy is the best solution for clojure so would be interested in people's thoughts on that"
476,1549918956.0637,Sebrina,Personally I’ve been using parinfer which I really love. The code practically writes itself!
476,1549918979.0641,Mauricio,nice i’ll read up on those two.
477,1549923783.0745,Tandy,"In an attempt to understand datafy/nav a bit further (especially nav), I put together a very simple repo with an example here <https://github.com/markbastian/datafy-playground/>. The only example of significance is here: <https://github.com/markbastian/datafy-playground/blob/master/src/datafy_playground/datafy_file.clj>. I was wondering if some of the experts could weigh in on some questions I've had regarding these functions. Here are my questions:

 1. Is it appropriate or normal to auto-datafy as you nav? In my example, if I nav from a datafied file to its parent, is there any reason to not just datafy it on the fly?
 2. If a datafied item has a nested datafiable entity (in this case a datafied directory has a list of files) is it considered best practice to use collection functions to get at the item and then datafy it (e.g. ```(datafy (get-in datafied-directory [:files 2]))```) or is it acceptable to nav right to it (e.g. ```(nav datafied-directory :files 2)```).
 3. Finally, is it considered acceptable to nav to the contents of a thing if the key isn't present in the datafied coll? For example, if a file is a .csv file, is it normal to do ```(nav datafied-file :contents :csv)``` where the contents are implied?

The example I have above can be pasted right into a REPL if anyone wants to try it out. Hopefully it will be useful in both illustrating the above items as well as being something you all can use to experiment on."
478,1549925889.0802,Gemma,"Hello guys, how would you make a function run one at a time, even if it is called multiple times? I have a compojure route which makes a reservation, but first it checks if there is free-space. So this is a concurrency problem, how would you solve it?"
478,1549925921.0812,Dann,"if you use an agent, they enforce a queue on all sends"
477,1549925926.0814,Celestine,"<@Tandy> I don't know if this helps answer those questions, but the way I think about it is that you have some Thing (which is an arbitrary object -- Clojure or Java, whatever) and you explicitly call `datafy` on it to get a pure Clojure data representation of that Thing. Then you can navigate that as a pure Clojure data structure using regular Clojure functions and when you want to go back to the _corresponding arbitrary Thing or sub-Thing_ you call `nav`, mimicking the pure Clojure data structure navigation. Now you're back in Thing-land, and you would explicitly call `datafy` again to get to a pure Clojure data representation of that new Thing/sub-Thing."
478,1549926017.0834,Celestine,"In the case of REBL, it takes a Thing and calls `datafy` to get the data it displays in the view pane and when you ""drill down"", it calls `nav` to navigate into the Thing, and then calls `datafy` to get new data to display in the view pane."
478,1549926027.0838,Dann,"<@Gemma> alternatively, `compare-and-set!` or `swap!` with a function that conditionally aborts; (those functions work on an atom rather than an agent though, so if the source of truth isn't in memory an agent might still make more sense)"
478,1549926252.0851,Rosaline,"if you can model it in an atom as a compare-and-set!, you can do the same in a sql database, and other kinds of databases often have some kind of cas"
478,1549926294.086,Dann,"yeah, letting a db be source of truth for the transaction is smarter"
478,1549926313.0866,Rosaline,"I am a huge fan of a cas, so for a reservation system, cas not-reserved with reserved, and then it doesn't matter how often the function is run"
477,1549926472.09,Tandy,"<@Celestine> - So, in the cases of a File or a DB thing (a row in a resultset, for example), datafy takes you from File or Row to Clojure data (likely a map). This part makes sense to me. WRT nav, are you saying nav on a map would take me back to a File, Row, or other Thing-type corresponding to where you are navigating?"
478,1549926489.0904,Gemma,"<@Dann> the problem is the source is mongodb. Read and writes can't be atomic together, I just want to put functions in queque like in core.async, but I want to wait still one ends before the other starts"
478,1549926522.0918,Dann,"agents have this behavior, but it's going to be fragile; eg. what if two servers are running your app?"
478,1549926545.0935,Sonny,"<@Gemma> You may need to consider here, what is going to happen if you ever load balance over more than one server :slightly_smiling_face:."
478,1549926546.0936,Dann,"with no distributed reliable source of truth, bad things will happen"
478,1549926547.0937,Tandy,Or once you are in data-land do you capture the scope of the original thing (e.g. the FileSystem or DB) and just work in data?
478,1549926574.0947,Rosaline,you will need to stand up something like zookeeper or etcd to get cas on top of a non-transactional store
478,1549926600.0957,Dann,"yeah, a dedicated reliable source of truth is an option"
478,1549926604.0959,Celestine,Correct. `Thing` -&gt; `datafy` -&gt; data -&gt; `nav` -&gt; `Thing2` -&gt; `datafy` -&gt; data2
478,1549926615.0969,Rosaline,"(or implement a consensus algorithm yourself, which has hazards)"
478,1549926617.097,Gemma,"<@Sonny> I am way too amateur too consider this yet. This is my third full-stack application till now, and this one have real clients, so this is my first concurrency problem :smile:"
478,1549926618.0972,Dann,or a db that provides this while also storing your data - such things exist
478,1549926634.0977,Celestine,The Thing you start with either needs to have metadata for the `Datafiable` protocol or directly implement it.
478,1549926638.098,Rosaline,using a queue doesn't really enforce what you want
478,1549926664.0994,Celestine,"When you call `datafy`, the pure data structure produced has metadata for the `Navigable` protocol (or directly implements it)."
478,1549926675.1,Gemma,"well I just want to block other operations while I read, calculate then update the new value; so a queque with blocking :smile:"
478,1549926688.1007,Celestine,"When you `nav`, you get back a new Thing (with metadata for `Datafiable` or an implementation of it)."
478,1549926703.1017,Rosaline,a queue with blocking doesn't
478,1549926710.1022,Sonny,"<@Gemma> Well, here's an interesting option. If you choose to represent each ""ticket"" in your mongo database as an individual document, you should be able to use the mongo function, ""findOneAndUpdate()"", to find a ""free ticket"" and reserve it.; Then you can load balance later if you need to :slightly_smiling_face:"
478,1549926790.1053,Rosaline,the best thing to do is likely just not use mongo
478,1549926790.1054,Celestine,Have you seen my examples in <https://github.com/clojure/java.jdbc/blob/master/src/main/clojure/clojure/java/jdbc/datafy.clj>
478,1549926801.1061,Gemma,"<@Sonny> well this is a bit more complex, I store free-times in minute intervals `[[600 1000][1200 1440]]`... so I can't update with mongo logic, I need my clojure power to make new ranges of minutes etc.; my all reservation logic is about ranges, remove ranges from ranges, then keep the new ranges"
478,1549926907.1099,Sonny,"<@Gemma> Honestly, you might need to rethink that if you want a robust solution to this problem. It's not uncommon to have to do this, particularly with something like mongo. You often have to design your data storage around operational requirements.; You could also look at java.util.concurrent if nothing obvious to be found in clojure. Lots of ""locky"" type stuff in there, but locking your entire system while one person makes a booking strikes me as a... non-ideal solution."
478,1549927027.116,Jasmine,"Lot of good questions here, but I don’t have time or ability to answer atm and I might forget. If you put this on Clojure mailing list I will be more likely to give it the treatment it deserves"
478,1549927083.1181,Sonny,"Incidentally, many large systems solve this problem by just ""overselling"" and solving the problem later :slightly_smiling_face:."
478,1549927108.1188,Gemma,"I want to lock only the function. only adding reservation and modifying it, is a problem, which happens like 40 times a day, the problem is it happened at the same time once, so reservation overlapped each other."
478,1549927116.1193,Tandy,Moved to separate thread...
478,1549927117.1195,Gemma,"well, I thought it wont be a problem for a time myself; but in first week it happened 2 times :smile:; it is like 2 guys picking same date, same hour, at same guy, in the same 5 ms-es; well, anyway, I need an easy fix, because I can't make a new architecture in one night. For example storing a state in atom, setting it to true if running, false after the update, and the function should recur still it is false, so it can run and set it true and etc..."
478,1549927336.1229,Celestine,<@Tandy> `nav` should not automatically `datafy` things.; Did you see this thread? I was trying to answer in a thread to avoid cluttering the main channel.; <@Tandy> I answered in a thread to avoid cluttering the main channel.
478,1549927505.1243,Tandy,"Thanks, <@Jasmine> &amp; <@Celestine> - And I want to make sure I don't give you guys the impression that I expect you to get to it right away. If there's a ""best place"" to put examples for discussion please let me know and I'm happy to put them there. I want to provide as complete examples as possible to minimize everyone else's work load."
478,1549927559.1254,Sonny,"<@Gemma> Maybe look at `(locking)`, you can just def some kind of object in the namespace and lock on it. I am not sure I would advise this as an actual long term solution, but it will probably do what you need for now."
478,1549927566.1255,Celestine,"In your example, you would do `(-&gt; (io/file ""."") datafy :files)` to get your sequence of files, then you can either do `(get X 0)` to get an individual file representation or `(nav X 0 (get X 0))` to navigate to the corresponding file thing.; I'm happy to continue answering in the thread (where I already posted several replies)"
478,1549927622.1264,Dann,"btw my first suggestion, using an agent, is effectively a queue plus locking plus execution on a separate thread"
478,1549927640.1268,Tandy,"Pasted from main thread:; Using the ""recipe"" at <http://corfield.org/blog/2018/12/03/datafy-nav/>:
You can sum this up as:

Starting with a “thing”…
```(io/file ""."")```
…you convert it to data (with datafy)…
```
(-&gt; (io/file ""."")
     datafy) ;Let's say this produces a map with an entry :files which is a list of java.io.File
```
…and walk it with simple Clojure data access…
```
(-&gt; (io/file ""."")
     datafy
     (get-in [:files 0])) ;This is one way
```
…and, at each stage, you can navigate to the corresponding “new thing” by calling nav…
```
;Option 1
(-&gt; (io/file ""."")
     datafy
     (get-in [:files 0])
    (nav ? ?) ;Not sure how this works

;Option 2
(-&gt; (io/file ""."")
     datafy
    (nav :files 0) ;This could return a File or I could datafy this in my implementation
```
…which may return just that value or may do something more complex…
…and from that “new thing” you convert it to data (with datafy) and continue the process.

Do either of these make sense? I apologize if I am sounding dense and am taking too much of you guys' time. I've watched Stuart's video, read your blog post, and the source (all multiple times) and everything seems to click except for the correct way to invoke nav."
478,1549927651.1273,Celestine,I already answered that above.
478,1549927683.128,Sonny,"Yeah, or use an agent :slightly_smiling_face:"
478,1549927704.1284,Gemma,"looking in both, your help is much appreaciated :slightly_smiling_face:"
478,1549927757.129,Tandy,"Ok, I'll take another look at nav in your navize-row function. Thanks."
478,1549927779.1292,Celestine,"Specifically this answer:
&gt; In your example, you would do `(-&gt; (io/file ""."") datafy :files)` to get your sequence of files, then you can either do `(get X 0)` to get an individual file representation or `(nav X 0 (get X 0))` to navigate to the corresponding file thing."
478,1549928087.1298,Dann,"locking might be better, making things async via threads might just increase complexity here"
478,1549928186.1307,Sonny,"Yeah, in retrospect, not even sure how you do this with an agent, more asynchronity there, not less. Though in fairness I don't use them much, so might be missing something."
478,1549928225.1312,Dann,you `send` the reservation setting function to the data defining reservations; the setting functions are guaranteed to not run concurrently
478,1549928329.1321,Sonny,Really? Then why do they run in a thread pool?; I guess I really don't understand these things.
478,1549928363.1332,Dann,"they run async from the caller, but no two agent functions on the same agent overlap; as far as the agent itself is concerned, zero concurrency"
478,1549928378.1337,Sonny,"Oh, I see."
478,1549928459.1347,Dann,"so agents are perfect for a case where you need a single source of truth, no retries, no overlapping changes

as long as it's OK for all of this to be async from the perspective of the code doing the modification"
478,1549928528.1351,Sonny,"So, tricky to know if reservation has gone through I guess."
478,1549928578.1356,Gemma,well my customer will mention it for sure :smile:
478,1549928586.1358,Sonny,"Haha; Well, that does seem to be the airline model. Over sell and kick the can down the road to the poor customer service person at the airport.; There's always that approach :wink:"
478,1549928928.14,Fredda,"yeah, a given agent will wait for the result of its last execution before starting its next."
478,1549929222.1418,Sonny,"Definitely took me a while to re-grok that fact. References to, ""thread pools"" in the `(send)` docs are actually misleading because it does suggest that sends are done concurrently, but what is really meant here is that there is a single thread pool that is shared across *all* agents for `(send)`. I think I did know this once... but honestly, how often do you use this stuff? :slightly_smiling_face:"
479,1549930207.1432,Fredda,"Honestly, I mostly only remember those specifics because I reimplemented agents over web workers a while back. Turned out, atoms and immutable data solved 90% of our concurrency issues."
479,1549930231.1441,Maryann,$2^e$
479,1549930259.1445,Sonny,I think you are looking for #perl :wink:
479,1549930275.1448,Fredda,"Those last 10% though are usually solved by seasoned java devs, so I think they're more inclined to reach for native thread tools, instead of using agents (or even STM)"
479,1549930354.1458,Sonny,"Yeah, I have to say that includes me John. I can get most of this stuff done with core.async now, but I spent long enough in Java land to find reaching for java.util.concurrent a bit too easy. Nearly suggested a Semaphore for problem above."
479,1549930552.1484,Fredda,"Yeah, I think we should try to stay between the lines more often than we do there. Atoms and agents and stm all work in concert with one another wrt the snapshotting of data across a transformation. Seeing folks muddy the semantics makes me sad. But sure, sometimes you'll have to reach for a more specific tool."
479,1549930921.1496,Tandy,"I think I may have figured it out. Please let me know if this makes sense:
1. Use datafy when you have an object (non-pure data) representation of something and want to convert it to pure data. In some instances, datafy will produce a ""coordinate"" that links to something else (e.g. a foreign key or hyperlink).
2. Use regular Clojure navigation (e.g. get, get-in, keywords) to navigate pure data.
3. Use nav when you need to navigate to a referenced thing. This thing should be a pointer, link, etc. It is not used to transform data.
If I am getting this, places where nav would be appropriate would be foreign keys in a db, web navigation (key is :href and val is the url), or perhaps a symlink in a file system. The basic idea is there is a 1:1 link between the data and the thing you are navigating to."
479,1549930997.1519,Shonda,+1 for agents in this use case. My project uses an agent in one particular spot. We routinely schedule a task but want only one to run at a time. Works like a charm.
479,1549931127.1535,Gemma,"yep, I can confirm that it works well in my case as well, also much easier to implement than I thought, thank you guys."
479,1549931461.1557,Sonny,"Interested to know how you solved the problem of communicating back to the caller. Agents do seem a little, ""fire and forget"". The agent data will get updated with the return 'at some point in the future', and you do have `(await)` so I suppose if you do something like keep a vector of successful reservations you can `(await)` to see if it's there, but aside from your constantly growing vector there, `(await)` docs contains some concerning statements like, ""Will never return if..."" :slightly_smiling_face:"
479,1549931691.156,Tandy,"I think the only thing that seems fuzzy for me is how you might handle a directory. Suppose I datafy my current directory. I could do a couple of things (This is all dependent upon my implementation of datafy):
```
;Option 1: Pure data
{:file "".""
:files [""file0"" ""file1""]}

;Option 2: mixed - Pour .listFiles into a vector for :files
{:file "".""
:files [#object[java.io.File 0x5cc6922c ""./project.clj""] ...]}
```

With Option 2 you would do something along the lines of (-&gt; (io/file ""."") datafy (get-in [:files 0]) datafy) to navigate to the first file as data.

With Option 1 you would use nav. Something along the lines of (-&gt; (io/file ""."") datafy :files (nav :files 0) datafy).

Is this correct? If so, is there a preferred or canonical way of doing the implementation?"
479,1549931707.1565,Celestine,Pass in a closure over a promise that gets delivered when the function executes on the agent? :slightly_smiling_face:
479,1549931785.1578,Dann,"I was thinking that too, but was afraid that was just the first step to a bad rube goldberg machine - but perhaps it is that simple"
479,1549931797.158,Celestine,Neither is correct.
479,1549931812.1587,Sonny,"Hah, I have in my head a core.sync solution that looks a bit like that with channels."
479,1549931824.1589,Tandy,:disappointed: Sorry! Am I close?
479,1549931832.1593,Celestine,Thing -&gt; `datafy` -&gt; data -&gt; `nav` -&gt; Thing2 -&gt; `datafy` -&gt; data2.
479,1549931854.1602,Rosaline,(or just use an atom and compare and set)
479,1549931863.1605,Celestine,and it's `(nav &lt;collection&gt; k v)` where `v` is nearly always `(get &lt;collection&gt; k)`
479,1549931869.1608,Dann,"I mean what if the agent blows up so the promise delivery never happens, now your thread is deadlocked,

so then you put the deref of the promise in a future so you can use deref of that with a timeout

and then..."
479,1549931879.1609,Celestine,"`nav` mirrors the pure data ""navigation"" you do in Clojure"
479,1549931987.1626,Tandy,"oh, whoops, Is this correct:
(-&gt; (io/file ""."") datafy (nav :files 0) datafy).; I just noticed I had a double :files"
479,1549932011.1635,Sonny,Concurrency is hard
479,1549932053.1637,Celestine,"Directory -&gt; `datafy` -&gt; data structure that representations the (contents of the) directory, with metadata added for `Navigable` protocol (most likely on the collection of data that represents the files) -&gt; `(get (:files dir-data) 0)` produces the first file representation, so `(nav (:files dir-data) 0 (get (:files dir-data) 0))` would be the correct `nav` call here -&gt; a File (or Directory) object -&gt; `datafy` -&gt; data structure that represents that.; `(-&gt; (io/file ""."") datafy (nav :files 0) datafy)` -- no, `nav` takes collection, key, value. You can't do multiple levels of navigation with it, just one."
479,1549932220.1644,Meagan,this is why people use Node.js :wink:
479,1549932248.1651,Sonny,Haha! Touchè! 
479,1549932255.1654,Rosaline,pffft; the problem with people who write javascript is the tend to think that using a single threaded server and single threaded client will save them from thinking about concurrency
479,1549932319.1668,Celestine,Grokking how `nav` works is definitely the hardest part of this.
479,1549932326.1672,Rosaline,"of course that is already two threads in your system operating concurrently; then you get more clients and more servers, and databases"
479,1549932354.1683,Sonny,<@Rosaline> Datomic team also think this ;)
479,1549932369.1686,Rosaline,pfft; what makes you think they think that?
479,1549932423.17,Celestine,"It's intended to mirror `(get collection key)` or `(get vector index)`, and you pass it the actual value (returned by `get`) as well as the collection/vector and the key/index."
479,1549932443.1709,Sonny,"I’m partially joking, but lots said about transactional benefits of single writer. "
479,1549932464.1714,Rosaline,but the system is entirely designed thinking about concurrency; and clojure's reference model; datomic is a database as a value in an atom
479,1549932512.1725,Celestine,"From my blog post ""Given an associative data representation, it does `(get coll k)` first to get `v`, and then it calls `(nav coll k v)` to allow the underlying navigation to return an updated value."""
479,1549932544.1736,Sonny,"Indeed, but writes are single threaded in part so you don’t have to worry about isolation ; Are they still actually?; Not sure with cloud"
479,1549932606.1748,Tandy,"For sure. So, looking at ```(nav (:files dir-data) 0 (get (:files dir-data) 0))``` I could also do:
```
(let[{:keys[files]} (datafy (io/file "".""))]
    (nav files 0 (get files 0)))
```
The key being that dereferencing the bare data in position 0 (coll) with the key produces the value?; Which I think you just said."
479,1549932643.1759,Rosaline,"anyway, my point is, programming in javascript will damage your brain when it comes to concurrency, and concurrency is a fact"
479,1549932693.1765,Celestine,Yup.
479,1549932709.1769,Sonny,I am definitely not a JS evangelist. 
479,1549932716.1772,Celestine,But that's not `(-&gt; ... (nav :files 0) ...)` just to be clear.
479,1549932732.178,Sonny,"At least probably not, not sure what this weeks syntax is. "
479,1549932746.1782,Tandy,"Right, which is why I had to use a let to get the intermediate value.; Now I'm trying to understand why I need to provide the value."
479,1549932821.179,Celestine,"Because `nav` may just return that value, if the act of navigating is just the same as for pure Clojure data."
479,1549932866.1798,Sonny,“JavaScript will damage your brain” &lt;- next tattoo 
479,1549932883.1799,Celestine,"Specifically `(let [data {:foo ""bar""}] (nav data :foo ""bar""))` -- `nav` on a hash map is basically a no-op that just returns the value (so it's an assumption that the key you pass would refer to the value you pass).; That's assuming no metadata on that hash map."
479,1549932995.1805,Tandy,why not just return ```(get data :foo)``` in the default case?
479,1549932997.1807,Rosaline,when it comes to concurrency
479,1549933018.1813,Meagan,I agree. it was tongue-in-cheek :stuck_out_tongue:
479,1549933026.1816,Celestine,"In the `java.jdbc.datafy` case, it ensures that the updated `query` function returns something that is `Datafiable` and that `datafy` will add metadata for `Navigable` to each row, so that when you `nav` on a row, if the key matches a foreign key in the schema, instead of just returning the column's value, it fetches the related results from the DB (and starts the cycle over again)."
479,1549933036.1821,Meagan,"the truth is that while your language might be single threaded, your system is _not_"
479,1549933055.1829,Celestine,Because it's already been passed the value (from `(get data :foo)`)
479,1549933057.1832,Meagan,at least JS in the browser lets you not have to think about problems locally without concurrency issues. but too many people try and venture farther and run into issues early on; I was one of them!
479,1549933124.184,Tandy,"Ah, plain old get doesn't allow you to add metadata."
479,1549933143.1845,Meagan,"it gets even harder with threads, because of shared memory; (unless you have Clojure's fancy atoms/refs :wink: )"
479,1549933196.1852,Tandy,"And in the general case, some things will navigate and others will not."
479,1549933204.1857,Sonny,...or core.async
479,1549933221.1858,Tandy,In the case of a key-val being a foreign key vs. a scalar.
479,1549933229.1861,Celestine,"Yes. `datafy`/`nav` are a very generic way to implement laziness.; The docstring for `nav` tries to make the reason for the value clear <https://github.com/clojure/clojure/blob/master/src/clj/clojure/datafy.clj#L31> but it isn't entirely obvious.; In particular, for sequences, you might _only_ have the value, and not any matching key/index.; The default implementation of `Navigable` for all `Object`s is just to return the value passed in, ignoring the collection and key/index: <https://github.com/clojure/clojure/blob/master/src/clj/clojure/core/protocols.clj#L194>"
479,1549933434.1875,Tandy,"Ok, I think I am getting it. I suppose for a file list you might want to provide the value (file name) vs. the index since most people think in terms of a seq of names vs. a vector of filenames. Thanks!; Then you could use a filename filter in the nav protocol or something similar and not list all the files in the :files key in the datafied dir."
479,1549933589.1879,Celestine,"Yeah, the sequence/collection of files (filenames) would have metadata for `clojure.core.protocol/nav` to provide how to turn the data (filename) into the actual file ""thing"" so the fact its a vector is less important here.; Or the metadata could close over the path to the file and so just the ""filename.ext"" part would be enough -- no filtering needed."
479,1549933641.1883,Tandy,"ah, nice idea; Thanks so much for all of the help on this. It's making a lot more sense."
479,1549933712.1887,Celestine,"So `(nav (:files dir-data) nil ""filename.ext"")` would rely on the `nav` implementation in the metadata of `(:files dir-data)` being able to add the path to the directory in which the file lives."
479,1549933737.1889,Tandy,"yes, and that makes a lot more sense when you read it"
479,1549933752.1891,Celestine,"It's tough stuff. I spent hours playing with this at Conj, trying to get `java.jdbc` working with REBL after watching Stu's talk."
479,1549933846.1893,Tandy,"Yeah, I am sure being there helped a lot. Thanks again for passing on the knowledge."
479,1549934099.1895,Celestine,Happy to help any time!
480,1549937219.1897,Gemma,That was my approach after looking at my options.
479,1549953209.2008,Celestine,Go to <#C04V84U7G|slack-help> or <#C0CB40N8K|community-development> and alert an admin in either of those channels. Do *not* engage the trolls/spammers here please.
481,1549974818.2067,Hassie,"is there any way to add hint for returned value from function which is defined using `fn`?; ```
user=&gt; (set! *unchecked-math* :warn-on-boxed)
:warn-on-boxed
user=&gt; (defn abc ^double [] 1.0)
#'user/abc
user=&gt; (inc (abc))
2.0
user=&gt; (def abc* (fn ^double [] 1.0))
#'user/abc*
user=&gt; (inc (abc*))
Boxed math warning, C:\cygwin64\tmp\form-init496459974570346569.clj:1:1 - call: public static java.lang.Number clojure.lang.Numbers.unchecked_inc(java.lang.Object).
2.0
```"
481,1549974986.2079,Roslyn,"Did you know? You can put pre-post map in meta :scream:
```
(fn ^{:pre [(pos? i)]} [i]
  (inc i))
```"
481,1549975070.2081,Clarine,"```
(macroexpand '(fn ^{:pre [(pos? i)]} [i]
  (inc i)))
(fn* ([i] (clojure.core/assert (pos? i)) (inc i)))
```; cool, didn’t know"
481,1549975699.2087,Hassie,"ok... found a solution; ```
(def ^{:arglists '(^double [])}
  abc* (fn ^double [] 1.0))
```"
482,1549976206.2094,Hassie,"let's go deeper; what about such case?; ```
user=&gt; (defn make-me-aaa [] (fn ^double [] 1.0))
#'user/make-me-aaa
user=&gt; (let [aaa (make-me-aaa)] (inc (aaa)))
Boxed math warning, C:\cygwin64\tmp\form-init496459974570346569.clj:1:26 - call: public static java.lang.Number clojure.lang.Numbers.unchecked_inc(java.lang.Object).
2.0
```"
482,1549976239.2101,Harris,you can't avoid boxed math while crossing anonymous function boundaries; clojure only knows how to use the unboxed path when using primitively tagged functions stored in Vars; so to your initial question.. no
482,1549976337.2119,Hassie,ok...
482,1549976419.2126,Harris,invokedynamic could help with this if it ever lands in clojure \cc <@Marlyn>
483,1549979566.2162,Ronald,What's the status of the functions in the Clojure incubator? I'm mainly interested in `dissoc-in`. It looks like there's been no activity in incubator or on the issue (<https://dev.clojure.org/jira/browse/CLJ-1063>) in a while. I think it would be nice to have in core so I can stop putting a copy into each of my projects :slightly_smiling_face:
483,1549981258.2166,Shayla,create a package and then just pull that down! hah
483,1549981571.2168,Jasmine,incubator is dead; I think my comments at the end of 1063 summarizes my qualms about it
484,1549981803.2182,Jasmine,I don’t think there is a candidate impl that I would consider worth recommending right now
483,1549982041.2184,Ronald,Gotcha
485,1549982421.2193,Catina,"Does anyone else crash/hang Docker (on Mac) when running `lein uberjar`? Last night it just hanged. Now it terminated with `ERRO[0457] error waiting for container: EOF`.

I even bumped it to use 6 CPUs, 8 GiB RAM &amp; 3.0 GiB swap.; (It creates the `...-SNAPSHOT.jar` then hangs/crashes.)"
485,1549982572.2201,Marlyn,"<@Catina> is your uberjar running across a mounted volume?; sometimes it's painfully slow if $HOME/.m2 or the app itself is mounted; but if other containers are having issues, it's good to hit the Reset button in Docker for Mac preferences"
485,1549982842.2225,Catina,"<@Marlyn> Hmm, thanks — I believe it must be! (So the uberjar remains after the Docker dies. I didn't write this codebase, so I'll verify.)

(I've reset a few times, so unfortunately that doesn't work. :/)"
485,1549982969.2242,Marlyn,"yeah, Docker for Mac filesystems mounts are quite slow.  If you `watch -n 1 du your-uberjar.jar` you may see that it progresses, but at a crawl"
485,1549983159.2259,Catina,"Hmm, in that case I wonder if it makes sense to run Docker inside VMWare/Debian (atop MacOS). :stuck_out_tongue:"
485,1549983736.2297,Clarine,<@Ronald> medley has dissoc-in: <https://github.com/weavejester/medley/blob/master/src/medley/core.cljc#L20>; I usually write update-in + dissoc because I’m too lazy to use an extra dependency
485,1549983878.2325,Jeromy,"Greetings fellow clojurians!
Does anyone have experience with creating a jpeg file from a base64 encoded string extracted from html? (Inline image in html) I managed to get those image strings from a html page with hickory, but after that I tried to decode them with (String. (.decode (Base64/getMimeDecoder) to-decode)) and <http://clojure.java.io/copy|clojure.java.io/copy> them out to a folder with no success. When I try to open an image my viewer says: (Not a JPEG file: starts with 0x75 0xab)
I am pretty new to this, so got the idea to ask it here. I hope someone could help me.
Thank you in advance!"
485,1549984007.2332,Clarine,<@Jeromy> Could you post the base64 encoded string in a gist?
485,1549984149.2335,Jeromy,"<@Clarine> Sure, <https://gist.github.com/aaronpowered/6e2f2de74e2de9be7da52889c5452f4d>
(Have to leave now, will be able to reply after 3 hours.)"
485,1549984459.2337,Ronald,Yes I agree about the extra dependency. Doesn't update-in + dissoc leave empty intermediates though? For my use case I would want the other behavior (as in the incubator/medley versions)
485,1549984492.2339,Clarine,then use those versions :slightly_smiling_face:; I noticed there was a trailing slash in the base64 string. I recommend testing it in an online viewer first:  e.g. <https://codebeautify.org/base64-to-image-converter>
486,1549989012.237,Laurene,"Hi, I'm doing some interop with Java and I dont understand why `(.write javax.imageio.ImageIO bi ""jpg"" f)` works but not ` (.write javax.imageio.ImageIO bi ""jpg"" f)` ?
Before I did `(.fillRect g2d 20 50 10 30)` and it worked fine; Is it because ImageIO is a class and not an instance?; My question is about the interop syntax"
486,1549989160.2384,Becki,"```
(.write javax.imageio.ImageIO bi ""jpg"" f)
(.write javax.imageio.ImageIO bi ""jpg"" f)
```
the two forms you put are identical; (unless i missed something?); <@Laurene> did you figure out what was going on?"
486,1549995571.2407,Laurene,"<@Becki> hey sorry I was out, I meant `(. javax.imageio.ImageIO write bi ""jpg"" f)` is the correct way and `(.write javax.imageio.ImageIO bi ""jpg"" f)` didnt work"
486,1549995738.2415,Dann,"for a static method, `(javax.imageio.ImageIO/write bi ""jpg"" f)` is the recommended syntax; <@Laurene> you can see from the javadoc which methods are static, <https://docs.oracle.com/javase/8/docs/api/javax/imageio/ImageIO.html> and the clojure docs for interop describe static method calls <https://clojure.org/reference/java_interop#_the_dot_special_form>"
486,1549995913.2429,Laurene,"Thanks for the informations; but why would `(.fillRect g2d 20 50 10 30)` works and not `(.write javax.imageio.ImageIO bi ""jpg"" f)` ? Is that because write is static?"
486,1549995997.2444,Dann,"right, fillRect is a method on g2d, write is a method on javax.imageio.ImageIO, the rules for static vs. instance methods are different; in java they have the same syntax, but on the bytecode level they are implemented differently, and clojure distinguishes them"
486,1549996062.2459,Laurene,"Right, thanks for the clarification, It's an area to improve for me!"
486,1549996095.2465,Dann,"interop is a pretty small set of rules, and once you learn them you can use a lot of stuff for free, so it's rewarding :D"
486,1549996166.2478,Laurene,"Yeah that's why I was getting my hands dirty with it, leveraging Java libs is a great bonus to the already nice language; Thank you again for your help ! :slightly_smiling_face:"
487,1549998293.2512,Epifania,"Hielo all. I'm doing some experiments with streams (but not touching IO yet), but getting the following error randomly in my lein repl, anyone have a clue why?
```
IOException Resource temporarily unavailable
        java.io.FileInputStream.readBytes (FileInputStream.java:-2)
        java.io.FileInputStream.read (FileInputStream.java:255)
        java.io.BufferedInputStream.fill (BufferedInputStream.java:246)
        java.io.BufferedInputStream.read (BufferedInputStream.java:265)
        jline.internal.NonBlockingInputStream.run (NonBlockingInputStream.java:294)
        java.lang.Thread.run (Thread.java:748)
```"
487,1549998409.2516,Dann,does *e have the full stack trace?; did you open a file? if so how did you open it / access it?
487,1549998504.2532,Epifania,"nope, no open files. Not sure I can see what `*e` has as the process crashes when it happens; unless `aleph/manifold` automatically open files, I would hope it doesn't"
487,1549998682.2557,Dann,"you could set the top level uncaught exception handler to be more informative `(Thread/setDefaultUncaughtExceptionHandler (reify Thread$UncaughtExceptionHandler (uncaughtException [this thread error] (prn ""uncaught error\n"" thread error))))` (fixed error, added example) ```(ins)user=&gt; (Thread/setDefaultUncaughtExceptionHandler (reify Thread$UncaughtExceptionHandler (uncaughtException [this thread error] (prn ""uncaught error\n"" thread error)))
)
nil
(ins)user=&gt; (.start (Thread. #(/ 1 0)))
nil
user=&gt; ""uncaught error\n"" #object[java.lang.Thread 0x2d631a09 ""Thread[Thread-0,5,main]""] #error {
 :cause ""Divide by zero""
 :via
 [{:type java.lang.ArithmeticException
   :message ""Divide by zero""
   :at [clojure.lang.Numbers divide ""Numbers.java"" 163]}]
 :trace
 [[clojure.lang.Numbers divide ""Numbers.java"" 163]
  [clojure.lang.Numbers divide ""Numbers.java"" 3833]
  [user$eval215$fn__216 invoke ""NO_SOURCE_FILE"" 40]
  [clojure.lang.AFn run ""AFn.java"" 22]
  [java.lang.Thread run ""Thread.java"" 748]]}

```"
487,1549998686.2558,Epifania,"hm, might be related with autocomplete or something like that, as the error seems to happen when I write `(def my-stream (s/stream)` (notice the missing ending `)`); oh, thanks for the snippet, I'll give that a try"
487,1549998871.257,Dann,"haha, just fixed a missing paren then thought you were referring to it - noticed when I pasted into my repl -I'm proud that something freeform into slack was that close to correct honestly! :D"
487,1549998956.2575,Epifania,"hm, unfortunately that doesn't make the error any clearer <https://gist.github.com/victorb/304ed4cd9834ecb02ce1b37f641e7957>"
487,1549999019.258,Dann,so this happens before you even finish writing the form? what repl implementation?
487,1549999037.2583,Epifania,"yup, using lein"
487,1549999050.2588,Dann,"wait, just a regular lein repl in a terminal?"
487,1549999051.2589,Epifania,it crashes as soon as I finish the `(s/stream)` form; seems related with some autocomplete
487,1549999095.2603,Dann,you can use `lein upgrade $VERSION` to pick an arbitrary older version of lein - if it's a lein bug I bet going back a version or two would eliminate the error; nrepl stuff was radically changed recently; (and of course having the latest lein is just a question of using `lein upgrade` again)
487,1549999145.2619,Epifania,"good idea, I'm on 2.8.1 so I'll try upgrading before downgrading. Thanks for the suggestion"
487,1549999145.262,Becki,Cider in the mix?
487,1549999157.2623,Epifania,"no cider, just lein repl + one deadly form `(s/stream)`"
487,1549999242.2634,Dann,also OS mgiht be relevant here too (since IO bugs in IPC code that only affect one OS are relatively common...)
487,1549999245.2635,Epifania,upgraded to latest (2.9.0) and now it works
487,1549999250.2638,Dann,:tada:
487,1549999269.264,Epifania,I'm on Ubuntu 18.04.1 LTS for posterity; thanks <@Dann> for helping me out :slightly_smiling_face:
488,1549999709.2681,Jeromy,"<@Clarine> trailing slash was only a mistake of copy paste. I had another mistake, had to drop the head of the string, (data:image/jpeg;base64) so i can use Base64/getDecoder instead of Base64/getMimeDecoder, but image file is still not available to open. I leave this image here as the difference between my decoded file and the one decoded by Best Online Base64"
487,1549999915.2693,Jeromy,"BTW What is this nonsense, Slack? ""Your file was uploaded — it’s safe and sound in Slack. Unfortunately your workspace doesn’t have any storage space left. To get more space, you can upgrade to a paid account or delete some of your older files.""
Can you guys see my recently uploaded picture?"
487,1550000043.2704,Dann,"yes - I can see it - that difference almost looks like text encoding issues, which makes me wonder if you wrote the file using a String / text oriented function rather than a bytes / raw data function"
487,1550000044.2705,Laurene,Yes can see it
488,1550000110.2715,Jeromy,<@Dann> <@Laurene> Thank you! Yes good point
487,1550000110.2716,Dann,"<@Jeromy> OK I scrolled up - your mistake is using the `String` constructor; pass the byte array to io/copy, this isn't textual data"
488,1550000125.2722,Jeromy,aaah
487,1550000138.2725,Jeromy,Thank you again <@Dann>; I have to stop just copy pasting utility functions
487,1550000207.274,Dann,"<@Jeromy> one of my loose heuristics for bugs is doing any sort of String conversion during IO - text to text just works via the binary methods, string conversion in the middle breaks things"
487,1550000322.2747,Jeromy,Finally it works! You guys are always doing a great job here :slightly_smiling_face: I am very grateful
488,1550000466.2766,Jeromy,"I just wrote a function which extracts images from the output of a wysiwyg, make sha1 hash and store every image once and change the inline base64 string to the path to that image. It works brilliant :slightly_smiling_face:"
487,1550000475.2768,Dann,nice
489,1550002721.2784,Pearline,Could someone explain to me what is the common use of `var` in Clojure?
489,1550002910.2797,Ashlea,"You’ll often see it used via the reader macro `#'`. Usually to alter the metadata associated with a Var, or sometimes in test namespaces to refer to private vars"
489,1550003190.281,Pearline,"<@Ashlea> Thanks, I didn’t realise that metadata came with a var, not the associated object."
490,1550004175.2829,Noemi,"cross-posted from <#C077KDE3A|luminus>: does anyone know specifically where to put wrap-cors in a luminus app (which has swagger, if that matters)?; my various attempts in handler and middleware aren't working.; I need cors enabled locally for development on an app created with the equivalent of 'lein new luminus testapp +swagger'."
489,1550004607.286,Dann,"<@Pearline> another usage of var is to pass the container holding a function to a function that creates a long running closure (eg. starts a web server using the function you pass in) - if you pass a function, the higher order function won't see redefs, if you pass the var it always sees the current value"
490,1550004645.2865,Dann,the thing that makes this work is that calling a var attempts to call the value you put in the var
491,1550007730.2908,Kirsten,of the 3 `Design / usage benefits of transducers:`  in <https://clojure.org/guides/faq#transducers_vs_seqs> - don't the last two apply to `reduce` or `loop/recur` too?
491,1550007789.2914,Dann,"unlike transducers, reduce and loop/recur are syntaxes rather than units of composition; so they are eager and explicit about resource usage, but aren't in the same category of abstraction"
491,1550007857.2929,Kirsten,"<@Dann> yeah, that is why I said 'the last two' - excluding transformation composition"
491,1550007868.2932,Dann,"both transducers and sequences can be passed to functions to get a new transducer or sequence; right - what I'm saying is they aren't even in the same category - strings and io streams are also eager and explicit about resource usage, but would be out of place in the comparison"
491,1550008177.296,Pearline,"<@Marin> Actually, it’s a cool usage. Thank you"
491,1550008237.2971,Kirsten,"<@Dann> Ok, I see what you mean, yes, they are not the same, was specifically curious what do they have over `reduce` specifically and only for eagerness and resource control"
491,1550008339.2989,Dann,"transduce vs. reduce has two major improvements: formalizing a final ""collate results"" step after everything has run (very common pattern in my code to need that), and separating transducing (a transform applied across the input) from the folding operation itself; (aside from the previously mentioned fact that a transducer is a compositional abstraction in a way reduce isn't)"
491,1550008617.3009,Kirsten,"ok, your second point is about the 'transformation composition' in the FAQ, how often do you really use this? didn't understand your first one yet; Or your two improvements seem highly related"
491,1550008719.302,Dann,the most common usage is defining the transducer as it's own testable unit of code; sometimes I use comp to join them also
491,1550008929.3055,Kirsten,(about unit of code) can comp and partial be used to create the same effect (without transducers)? ignoring the performance benefits of removing all intermediate sequence and cached value creation.
492,1550008941.3058,Elanor,Anyone aware of any tools to identify/remove unused vars (not ns but mostly def and defn forms)? I can cook up a shell script to do so but would be nice if others have a tool to recommend.
491,1550009026.3061,Dann,"sure - but this gets heavy handed when you consider eg. transducing from a channel to another channel - the transducing version never needs to build a collection, the non-transducing version builds one collection of N elements per unit of composition; there's a lein-yagni plugin if that's what you mean - it scans your codebase and tells you about functions without callers"
491,1550009185.3069,Kirsten,thanks!
492,1550009215.3076,Kirsten,how do you remove an unused var manually?
491,1550009242.3082,Dann,"by editing the code or calling ns-unmap, depending on what you mean"
491,1550009276.3089,Elanor,last time I check yagni does not detect vars but ns only.
491,1550009308.309,Dann,"also, here's a contrived example of using the completion function ```user=&gt; (transduce (map inc) (completing
              (fn [acc i] (update acc i (fnil * 1) i))
              vals)
              {}
              [1 2 3 2 1])
(4 9 4)
``` - in real usage I often have ""secondary accumulators"" in a hash map that are needed while reducing, but not needed in the result"
491,1550009324.3094,Kirsten,<@Dann> from memory
491,1550009377.3102,Dann,"<@Elanor> I use it at work, it definitely checks for unused vars (and also is uptight about protocol methods and multimethods in ways that can be hard to make happy...); ns-unmap is what removes a var from a namespace"
491,1550009438.3112,Elanor,<@Dann> Will give it a try. Thanks.
491,1550011493.3113,Kirsten,"Ok, let me try to read that first hehe"
493,1550014520.3117,Kirsten,are you allowed to write code like that at work?
493,1550014577.3119,Dann,"I tend to avoid transduce because we aren't doing things where streams of data are the perf bottleneck; but I do use transducers because they help modularize operations on IO streams to be testable on seqs, without needing to turn io into a seq; eg. we have a minimal kafka topology definition that takes a transducer, we can test that transducer outside kafka with seq in / seq out"
493,1550015071.3125,Kirsten,"yes, that is super helpful, experienced that with datomic, ex: developing and testing functions with no database"
494,1550044848.3149,Lewis,"Hey, can we generate an Clojure Server from swagger definition? "
493,1550053592.3194,Shayna,"<@Lewis> don’t think so. Have been waiting for someone to take a stab at this. The thing missing is that swagger defines parameters &amp; responses in swagger json schema, while most Clojure web libs use Schema or clojure.spec as the idiomatic way to describe those. Generator would need to convert the params. Just the paths, libs like `org.zalando/swagger1st` and `metosin/reitit` both use the swagger path format, so the transformation should be quite trivial.; (co-authoring reitit, so happy to help if you would like to do the converter for it)"
495,1550064834.3255,Alaine,"A question related to the REPL:
I’d like to write a small Clojure program that opens an JSON file and allows me to investigate the content of the JSON as a Clojure object in the REPL.
I was thinking of creating a `core.clj` file with a `-main` function that receives the path to the JSON file as an argument and define a `core.data` var that contains the Clojure representation of the JSON file.
My problem is that I cannot when I pass `-m core` to the REPL, it runs the program and exits.
I’d like the REPL to stay open.
Is that feasible?"
495,1550065022.3261,Sixta,You could call clojure.main/repl in your main
495,1550069080.3268,Alaine,Yeah. I thought about that but somehow I was expecting to find a simpler solution <@Sixta>
495,1550069306.3273,Sixta,<@Alaine> you could use `-e` instead of `-m`
495,1550069379.3276,Jasmine,^^
495,1550072102.3281,Alaine,<@Sixta> can we have access to command line arguments with `-e`?
495,1550073585.3285,Jasmine,"you do; ```$ clj -e ""(println *command-line-args*)"" -m foo 1 2 3
(1 2 3)```"
495,1550084120.333,Alaine,"<@Jasmine> awesome
This is exactly what I was looking for"
496,1550084183.334,Alaine,"And with `-r`, I can open a REPL
```
➜  ~ clj -e ""(ns my.aa) (def a 1)"" -r
#'my.aa/a
my.aa=&gt; a
1
my.aa=&gt;
```

Now, I am wondering why `-m` is not compatible with `-r`?"
496,1550084812.3344,Jasmine,"-m starts a program, -r starts a repl; they are different modes; or you can pass a path to  run a clj script or - for stdin; -e is an initial option that happens before those (and can be used more than once)"
497,1550087898.3378,Shayla,Let's say I have a macro that defines a bunch of local variables for easy of use. Is it possible to conditionally bind them only if they're used in the body?
497,1550088204.3387,Matha,"Is there a built-in clojure function that has the following effect?
```
(f [] 0) ; =&gt; []
(f [1] 0) ; =&gt; [1 0]
(f [1 2] 0) ; =&gt; [1 0 2 0]
(f [1 2 3] 0) ; =&gt; [1 0 2 0 3 0]
```
Almost `interpose` but with the separator also added to the end when the sequence is not empty"
497,1550088500.3389,Ashlea,"There isn’t; &gt; added to the end
Does it have to be the last item in the seq, or should it be `conj`ed?"
497,1550088618.3399,Fatima,Would `(interleave [1 2 3] (repeat 0))` work?
497,1550088744.3402,Matha,<@Fatima> oh wow; that works; thanks!
498,1550098915.3432,Glayds,"I’m trying to figure out how to write a macro that will return a quoted vector of the arguments passed to it

Example
``` (quote-me [:user/id])
;;-&gt; ’[:user/id]

any ideas?"
498,1550098969.3434,Ashlea,"```
=&gt; (doc quote)
-------------------------
quote
  (quote form)
Special Form
  Yields the unevaluated form.

  Please see <http://clojure.org/special_forms#quote>
  Yields the unevaluated form.
```; ^ I think `quote` is what you’re looking for"
498,1550099112.3447,Dann,"<@Glayds> `'[:foo]` and `[:foo]` are already equal - there's a difference for symbols, the macro you want for that is `quote`, which is what `'` expands to; also that's not a quoted vector of the arguments, that's taking a vector and returning it"
498,1550099168.3459,Glayds,"This doesn’t seem to work for the function I’m trying to pass the return value into; as in, I need to pass it in as quoted"
498,1550099218.3478,Dann,"quoting is a compilation time operation that prevents evaluation of literal forms in your source code; it doesn't have a meaning at runtime, unless you are using runtime eval; I might be misunderstanding what you are trying to do here"
498,1550099509.3499,Deb,"Sounds like you're asking for an extra level of quote, like `(defmacro foo [x] ``(quote (quote ~x)))`
`(foo [:user/id]) ==&gt; '[:user/id]`.  Like your example.; Oh... looks like I don't know how to put code in slack."
498,1550099731.351,Glayds,"turns out didn’t need to use a macro; (deftrack a [b conn id]
  (b @(posh/pull conn `[~b] id))
  ); this did what I wanted; thanks"
498,1550099786.3526,Dann,"what do you expect ```
`[~b]``` to do that `[b]` wouldn't?"
498,1550099799.3529,Glayds,get accepted by datascript; ah
498,1550099881.3541,Dann,how would datascript see a difference?
498,1550099889.3544,Glayds,"yeah, think you’re actually right; I think it is more because datascript allows things in the pull and query that would otherwise get evaluted"
498,1550099964.3558,Dann,"sure, quote those things if you need their unevaluated meaning"
498,1550099984.3567,Glayds,for the toy example just putting it in directly works fine
498,1550099986.357,Dann,"and quasiquote can help build a partially quoted data structure with selective evaluation, without needing a macro"
498,1550099998.3574,Glayds,its for building up the more complicated queries and pulls that I need the ` and ~
498,1550100058.358,Dann,"right, and you don't actually want a macro for that - you just want a convenient syntax for selective quoting"
498,1550100100.3583,Glayds,"yeah, hadn’t realized I could use ` and ~ outside of macros; thanks"
498,1550124945.3595,Alaine,"<@Glayds> FWIT, I once wrote a tutorial about syntax quote <http://blog.klipse.tech/clojure/2016/05/05/macro-tutorial-3.html>"
498,1550150128.3627,Ferne,"if anybody wants to have fun with instaparse, regular expressions, and property-based testing, doing a totally-achievable and well-defined thing, you could work on making this code as robust as the clj-jvm version: <https://github.com/gfredericks/test.chuck/pull/54>"
499,1550158896.3697,Shayla,"I asked this yesterday afternoon but I don't think I did a good job of describing the question/issue, so I'mma try again but with actual examples this time.
I have a macro that accepts an atom (and some other parameters), and binds a lot of helper variables for use in the macro:
```
(defmacro req [&amp; expr]
  `(fn ~['state 'side 'eid 'card 'targets]
     (let ~['runner '(:runner @state)
            'corp '(:corp @state)
            'run '(:run @state)
            'run-server '(when (:run @state)
                           (get-in @state (concat [:corp :servers] (:server (:run @state)))))
            'servers '(zones-&gt;sorted-names (get-zones state))
            etc... ]
        ~@expr)))
```
This macro is used _a lot_ in the codebase, which means that all of these variables are being bound in every invocation. Most times, only a handful of the let-bound variables are actually used or needed in `expr`. Is there some way to write the macro such that it will only bind a given variable if that variable is used in `expr`?"
499,1550159005.3702,Becki,its anaphoric and you want to only create the binding if you can find a usage in the body?
499,1550159037.3706,Shayla,"I'm unfamiliar with ""anaphoric"" in this setting. What do you mean?"
499,1550159060.3713,Becki,the macro creates a symbol for the body to use seemingly without a binding creating it; the old common lisp ones would introduce a symbol `it` by convention
499,1550159103.3723,Shayla,Isn't `let` a binding?
499,1550159129.3729,Becki,yes but its created at macroexpansion time and therefore not visible in the code you actually write
499,1550159164.3737,Shayla,"Ah yes, that's correct"
499,1550159167.3738,Becki,`(req (run-server))` is an example. you create the symbol run-server that `expr` can use without itself creating that binding.
499,1550159208.3741,Shayla,"You are correct, yes"
499,1550159444.3762,Becki,"i bet <@Harris> has an easy way to do this with t.a.jvm. I'm thinking a naive version of walk your expr for the first form might work in practice but would miss things in let bindings, doseq bindings, etc. You don't care if someone shadows since you would create an extra unused binding in a few rare cases. I'm guessing you could run the analyzer over the form, find which things are used and intersect that with the few you have here"
499,1550159597.3767,Shayla,"Interesting idea, thanks!"
499,1550159677.3774,Becki,"its also possible you'll do a lot of work, hit rough edge cases, and after some tedious coding, realize you don't get any measurable performance difference."
499,1550159710.378,Shayla,"That's what I suspected, which is why I haven't worked very hard at finding a solution, lol"
499,1550159766.3786,Becki,"so if i'm reading the AST stuff correctly, you could perhaps figure out how to collect all vars (<http://clojure.github.io/tools.analyzer.jvm/spec/quickref.html#var>) from the AST of expr and then find which ones are your bindings; and tools.analyzer has an ast namespace with a `nodes` function to give a lazy sequence of nodes in the AST; there's also a really cool looking ast-&gt;eav function so you could do this in datalog.; that's amazing that you can query the AST of clojure code. like that's really cool; ```
  (let [ast (ana.jvm/analyze
             '(let [x 3]
                (+ x another-sym something-else)))]
    (into #{}
          (comp (filter (comp #{:var} :op))
                (map :form))
          (ast/nodes ast)))
```; ```
  (def another-sym 4)
  (def something-else 5)
  (let [ast (ana.jvm/analyze
             '(let [x 3]
                (+ x another-sym something-else)))]
    (into #{}
          (comp (filter (comp #{:var} :op))
                (map :form))
          (ast/nodes ast)))

  ;;-&gt; #{another-sym something-else}
```"
499,1550160630.3807,Shayla,That's wild. Thank you!
499,1550160755.3815,Harris,"if you want to go down this route, you'd need to collect local bindings that can't be resolved, there's a hook for that; I'm a bit busy right now but I can show you how to do that later; I do agree with <@Becki> though that it sounds like it could be just premature optimization"
499,1550160840.3833,Becki,"&gt; The analyze function can take an environment arg (when not provided it uses the default empty-env) which allows for more advanced usages, like injecting locals from an outer scope:

this style?; also thanks for this huge amount of work <@Harris>"
499,1550160898.3849,Harris,"honestly, I haven't used/worked on `t.a.jvm` in anger in years so I can't remember off the top of my head how to do it, just that it's possible :)"
499,1550160944.386,Shayla,"This is probably an unnecessary optimization (seeing as nearly every binding is either grabbing data from the map atom or performing minor calculations on the atom), but it's currently used 2344 times in the codebase, so it seemed worth at least peeking into"
499,1550160971.3861,Harris,"mhhhph, that requires knowing in advance the locals you want to inject; what I was thinking of was to disable the part of the validation pass that throws an error on unresolved symbol names; then collecting all those nodes; to figure out which locals are used in the body"
499,1550161035.3869,Becki,this is in a macro so i was thinking using &amp;env
499,1550161070.3874,Harris,but what you want to look for are locals that are used in `expr` that _don't exist yet_; they won't be in `&amp;env`; the context is inverted
499,1550161092.3884,Fredda,"You could do something like
```
(defn seq-has? [form namespace-qualified-quoted-sym]
  (when (seq? form)
    (not
      (empty?
        (filter #(= % namespace-qualified-quoted-sym) form)))))

(defn expr-has? [expr namespace-qualified-quoted-sym]
  (when (coll? expr)
    (not
      (empty?
        (-&gt;&gt; expr
             (tree-seq coll? seq)
             (filter #(seq-has? % namespace-qualified-quoted-sym)))))))
```
Adapted from some other code I have, so not tested...
(oops, didn't full adapt it... fixed)"
499,1550161115.3885,Harris,<https://github.com/clojure/tools.analyzer.jvm/blob/master/src/main/clojure/clojure/tools/analyzer/passes/jvm/validate.clj#L255-L262>; this is what I think is needed
499,1550161279.3903,Fredda,You just call `expr-has?` in your macro. You may need to check for both the namespace qualified and non-namespace qualified version of the symbol. But that's extra macro stuff.
499,1550161821.3927,Harris,"```
(require '[clojure.tools.analyzer.jvm :as j])
(require '[clojure.tools.analyzer.ast :as ast])

(defn find-undefined-locals [expr]
 (-&gt;&gt; (j/analyze expr
                 (j/empty-env)
                 {:passes-opts (merge j/default-passes-opts
                                      {:validate/unresolvable-symbol-handler
                                       (fn [_ s {:keys [op] :as ast}]
                                         (if (= op :maybe-class)
                                           ast
                                           (throw (Exception. """"))))})})
      ast/nodes
      (filter (fn [{:keys [op]}] (= op :maybe-class)))
      (map :class)))

(find-undefined-locals '(let [a identity] (a b))) ;=&gt; (b)
``` <@Becki> <@Shayla>"
500,1550161851.3932,Shayla,"That's cool as hell, thank you"
499,1550161859.3936,Harris,in your example if you use `(find-undefined-locals expr)` you should be able to find the set of locals that you need; it's quite the hammer though :); if I had a timemachine I would rename that node type to `:undefined-symbol` but alas
500,1550161941.3951,Shayla,"With something like this, is it happening at compile time or run-time? heh cuz I suspect the overall performance cost of doing this at runtime will overshadow the performance gain from skipping the unused variables"
499,1550162059.3955,Harris,you're invoking it from a macro; so compile time; this is assuming that you do something like `(defmacro whatever [body] (let [neded-locals (find-undefined-locals body)] (emit-only needed-locals body)))`; which afaict is the only way to do what you want anyway
500,1550162167.3971,Shayla,Where is `emit-only` coming from?
499,1550162236.3975,Becki,"that's what you write to create only the binding forms that are in the set `needed-locals`; it's the binding forms of your let form in the original macro, moved to a function to make it easier to test and the macro easier to reason about"
499,1550162451.3982,Harris,eugh don't do this in macros; traversing code like this is a recipe for broken edge cases
500,1550162491.3986,Fredda,Really? Like how?
499,1550162507.3988,Harris,it doesn't handle lexical scoping at all; if you run this over `(do a)` and `(let [a 1] a)` it would tell you that both expressions are using the undefined symbol `a`; for example
499,1550162555.3996,Shayla,"Ah okay, thanks, that's cool"
499,1550162559.3998,Harris,"or even worse, if you ran it over `'a`"
499,1550162564.4001,Shayla,I'll mess around and hopefully make it work!
499,1550162572.4002,Harris,"which is using _the symbol_ `a`, not the local `a`"
499,1550162580.4004,Fredda,"Ah, I see"
499,1550162586.4006,Harris,"it would just enter `(quote a)` ignoring that `quote` suppresses evaluation; and so on, dozens of edge cases like this; there's _some_ constrained cases where this is fine; like what `spec` does; but it's the exception rather than the rule :)"
499,1550162670.4016,Fredda,"That makes sense. Won't play nice if somebody intends to (or accidentally) shadow the sym; Well, I suppose you could fancy it up to not catch on quoted or binding forms of the symbol. But yeah, add in all that complexity and you might as well reach for the analyzer; I was implementing in cljs though"
499,1550162881.4023,Harris,exactly; well in cljs you have access to `cljs.analyzer` :)
499,1550162908.4027,Fredda,"The same should be doable with that, yeah?"
499,1550162978.4029,Harris,yep
499,1550162979.4031,Fredda,Doesn't have as many bells and whistles as your c.t.a.jvm I thought
499,1550163013.4036,Harris,it doesn't indeed but the AST format now matches `t.a` so you should be able to use the passes and the rest of the framework over the AST it produces; I haven't tried it but I think <@Laurette> does that
499,1550163050.404,Fredda,"Wait, you can use c.t.a.jvm on cljs forms?"
499,1550163064.4042,Harris,"no; you can use `cljs.analyzer`, get back an AST and feed that AST to `tools.analyzer` passes/traverse it using the t.a utilities"
499,1550163112.4046,Fredda,gotcha; Well that's awesome
499,1550163138.405,Harris,"don't know how easy or feasable that is, but some work went into cljs last year to allow this"
499,1550163300.4052,Fredda,Ain't nothin a little elbow grease can't fix; Big appreciation to you and bronsa's work on it
499,1550163480.4056,Harris,that would be the same person :simple_smile:
500,1550163606.4061,Fredda,lol ambrose I mean! :joy:
499,1550163612.4063,Harris,just added a slightly more performant version of `find-undefined-locals` to <https://github.com/Bronsa/tools.analyzer.jvm.deps/commit/8c7c3936e6f73e85f9e7cc122a2142c43d459c12>
500,1550163619.4064,Fredda,"bronsa, ambrose, tomato, tomato"
499,1550163622.4066,Harris,haha
499,1550163663.4072,Becki,"if you're gonna bump some stuff, the project.clj version is out of date with the pom. little confusing"
500,1550163677.4077,Becki,project.clj is 0.6.9 snapshot or something? and released is 0.7.0
499,1550163686.4081,Harris,this is `t.a.jvm.deps`; but I can fix that in `t.a.jvm`
499,1550163703.4089,Becki,i think that might just be t.analyzer
499,1550163706.4092,Harris,ok
499,1550163712.4094,Becki,i had to read t.a.jvm to see what version was actually out
499,1550163730.4096,Harris,"ouch; the stuff in the readme should be correct; it's just `project.clj` that sometimes gets out of sync because I forget, I think; I'll double check both and update though, thanks"
499,1550164598.4113,Gia,"I've never needed to have a caching in my Clojure program before, so I need some guidance.
I have a collection of entities (maps), that are calculated via some expensive functions using data-fetching from the database. Basically, I want to have it in cache as a big map with `entity-id` as keys and corresponding hash-map as values. I looked up idiomatic ways to handle caching in Clojure, it's suggested to use `clojure.core.cache` and atoms. It seems to me that none of eviction policies are suitable for my case, so I resorted to use `BasicCache`. Additional to my ""main"" cache, implemented as an atom which contains plain entries, I want to have a nested lookup map with same entities grouped in keys for fast access. I want to store this derived lookup map in some atom for future uses, rather than calculating it every time (it's ~ over a million values).
I have two questions:
1) Should I use `clojure.core.cache`'s `BasicCache`? It seems to me that it's just a wrapper over regular map, what benefits do I get using it?
2) Is it ok or idiomatic to use `add-watch` as a way to keep in sync two atoms? So that my derived-lookup-map in second atom is always relevant and in sync whenever plain data in first atom changes?"
501,1550168866.4135,Nathanael,"<@Gia> Not sure about BasicCache, but for 2, on the client a lot of people would just use re-frame subscriptions for that, which lets you achieve the same with more precision and less imperative code. Not sure if anyone uses that on the server, though"
501,1550169032.4136,Shayla,"Having messed around with this for a bit, I have a small question: how do you go about `let` binding the `needed-locals`?  I can construct a vector of the necessary forms, but I'm having trouble using that vector in a `let` as the bindings. Or is there some much easier solution to this?"
501,1550169123.4138,Becki,if you know the necessary forms its simple `(let [~@ forms] body)`; macro land you can just plop the pairs in there
501,1550169357.4142,Shayla,"Ah, okay, thank you, that was the part I was missing"
502,1550174794.4159,Dann,"Keeping atoms in sync is a domain error - it's not what atoms are for.  You can synchronize changes to refs to ensure that they stay coherent, but it's not something you can do generally / safely with atoms.; the advantage of BasicCache is that it uses the cache protocols, so you can swap in other caches with other behaviors without changing surrounding code; eg. you thought you needed a TTL cache, but now product says no more time outs, BasicCache is a simple change without rewriting surrounding code; or, you know you want a cache, but specific behaviors are going to be elaborated as needed, so you start with a BasicCache so you don't need to rewrite code to get the new caching behaviors in the final result; if a second atom is always tied to the state of a first atom, and isn't changed itself, you can replace it with a function on the first atom, or added fields in a map in one atom"
503,1550179940.4191,Somer,Is it possible to add a Java annotation to a Clojure function?; I've seen this: <https://clojure.org/reference/datatypes#_java_annotation_support> which sounds like the answer is no.
504,1550180189.42,Tammera,I am finding this: <https://github.com/clojurebook/ClojureProgramming/blob/master/ch09-annotations/src/main/clojure/com/clojurebook/annotations/junit.clj>
503,1550180382.4203,Tammera,it looks pretty magical tho
502,1550181610.4213,Dann,"I'd expect you'd want an annotation on a class, not a function per-se?"
503,1550181690.4215,Somer,"Well, a method would be more correct I suppose.; I'm trying to do this:
```
@Trace (dispatcher=true)
public void run() {
  // background task
}
```
without needing to do some crazy definterface &amp; deftype stuff."
502,1550181825.4219,Dann,"well, you need a class with a run method that's annotated, you can use gen-class and get a method without an interface, but the idiomatic thing in clojure is to use defprotocol (which defines an interface) then defrecord, deftype, or reify to get something implementing it"
503,1550181855.4221,Dann,"unless the method name doesn't actually matter, in that case functions have an `invoke` method, but there's no way to annotate it; you could reify or otherwise implement clojure.lang.IFn, and that way get something that calls like a normal function and also has annotations"
503,1550182029.4225,Somer,Hmm that's interesting.; The idea is to be able to add that annotation to any Clojure function.; Is IFn the only one I'd need to implement?
503,1550182144.4234,Dann,"yeah, one moment, I have an example somewhere"
503,1550182294.4236,Somer,"Can you dynamically set annotations on a deftype?; Something like:
```
(deftype TracedFn [traced-params]
  IFn
  ((with-meta 'invoke traced-params) [_]))
```; I don't think the deftype params are in scope. Even this doesn't work:
```
(deftype TracedFn [traced-params]
  IFn
  (^{com.newrelic.api.agent.Trace traced-params}
  invoke [_]))
```; I guess I can macro-ify that."
503,1550182505.4244,Dann,"when you say it doesn't work, you mean because you can't have a different set of annotations for each instance?"
503,1550182525.4246,Somer,"Sorry, I should've been more specific. I get this:
```
Syntax error compiling at (impl.clj:19:1).
Unable to resolve symbol: traced-params in this context```"
503,1550182530.4249,Dann,"even with java. I don't think you can have different annotations on methods each instance of a class; oh, yeah, it prevents capture in deftype; I'd just use reify unless you really need multiple instances (why? I don't make multiple instances of functions...); otherwise, yes, a macro that fills it in, since lexical capture is unavailable in deftype / defrecord"
503,1550182625.4257,Somer,"Right, makes sense. Thinking the IFn path is the easiest. No need for an extra interface here."
503,1550182645.4259,Dann,"be sure to define every applicable arity for invoke, plus applyTo; :thumbsup: (bad emoji autocomplete haha)"
503,1550182695.4264,Somer,It _seems_ to work without defining every arity. Is that just a REPL artifact?
503,1550182715.4267,Dann,"if you don't define applyTo, apply breaks; I'd rather take the time to define applyTo, rather than risk a really counterintuitive error if I ever refactor and use apply; you only need to define the arities you implement, of course"
503,1550182758.4273,Somer,So I could just define the `invoke` method(s) I need and applyTo?; Right
503,1550182782.4277,Dann,"yeah; if you need numeric perf, the method overloads for primitives are there too...; (where fn gives you  that ""for free"" if you satisfy the static constraints the compiler knows how to use)"
503,1550182839.4283,Somer,I was wondering what all those were. Looks like generated code at first glance.
503,1550182867.4285,Dann,"pretty much, yeah, the multiple overloads is how you get good fast paths (at the expense of human radability)"
503,1550183321.4287,Somer,"Is the typical way applyTo implemented with a case statement of the count of the args?; BTW, another reason you need `appyTo`: <https://dev.clojure.org/jira/browse/CLJ-1715>; Looks like that's how AFn does it: <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/AFn.java#L147>"
503,1550183565.4294,Dann,nice to see the kind of bug I was avoiding by just superstitiosly using applyTo even though I didn't think I needed it :D
503,1550183667.4297,Somer,"FWIW, ended with :
```
(defn- invoke-methods
  [bodies meta-map]
  (for [[args-list &amp; body] bodies]
    `(~(with-meta 'invoke meta-map) [~'_ ~@args-list] ~@body)))

(defn- make-traced2
  [deftype-name traced-meta fn-name bodies]
  `(deftype ~deftype-name []
     IFn
     ~@(invoke-methods bodies (default-traced-meta traced-meta fn-name))
     (~'applyTo [this# args#]
       (AFn/applyToHelper this# args#))))

```"
503,1550183786.4299,Dann,cool; with a bit of wrangling you could turn that into `fn-traced` or `traced-fn` or whatever
503,1550183847.4303,Somer,That's the end goal :slightly_smiling_face:; I wish Clojure had some helper functions for parsing defn args... going to attempt to do that with spec
503,1550183941.4307,Dann,so you can't just delegate by passing in the argslist as is? or is it that deftype methods don't support destructuring etc?
503,1550184007.4309,Somer,"It's just the complexity of the defn spec; Gotta take in all this stuff
```
'([name doc-string? attr-map? [params*] prepost-map? body]
                [name doc-string? attr-map? ([params*] prepost-map? body) + attr-map?])
```
and spit out a defn matching what I was given."
503,1550184041.4313,Dann,"ahh, if you want 100% compatibility I can see that...; I'd be tempted to just support what I consider ""normal"" in  defn"
503,1550184106.4317,Somer,"Yeah that wouldn't be the end of the work, I suppose.; I'm kinda surprised no one has a library for writing defn-esque things."
503,1550184290.4321,Dann,yeah - they made one for map-like things...
505,1550188356.4336,Denae,What do people think is the oldest clojure version a library should support?
505,1550188467.4339,Latonya,"For a brand new library, Clojure 1.9.0 would seem reasonable.; The latest Clojure survey results show that 97% of respondents were using Clojure 1.8.0 and later: <https://www.surveymonkey.com/results/SM-S9JVNXNQV/>"
505,1550188799.4352,Jasmine,"Well that was a multi select question so careful with the number; 3% said they were using something older than 1.8, but they could also have been using something newer"
505,1550188921.4373,Becki,"just as a datapoint, CIDER now requires a minimum of 1.8 to work. There are still a few cljx based projects out there that are in wide use. cemerick's url package and its dependency pathetic for example"
506,1550203616.4384,Gia,"Yeah, I was looking for something like signals/subscriptions, but on the server-side. Was thinking watches would provide same functionality.; <@Dann>, so if I switch to refs instead of atoms, it would be ok to use watches? I'm little bit reluctant to just use a function, as even getting derived lookup-index from data that stored in first atom requires to process over million rows, that's why I was thinking about caching it."
506,1550222061.4417,Clarine,"it seems <@Tamisha> is continuing that work here:
<https://github.com/wilkerlucio/test.chuck.sfr-cljs>"
507,1550226989.4432,Karren,"Trying some examples from SICP I've found that Ratio is pretty slow - is that expected?
E.g. using continued fraction to compute inverse of golden ratio:
```
(defn cont-frac-iter [n d k]
  (letfn [(frac-iter [i acc]
            (if (&lt; i 1)
              acc
              ;; WARNING: if you don't use double coercion then the procedure will be slow for large k
              (recur (dec i) (double (/ (n i) (+ (d i) acc))))))]
    (frac-iter k 0)))

;; this is pretty fast
(time (double (cont-frac-iter (constantly 1)
                              (constantly 1)
                              100000)))
;; ""Elapsed time: 14.10361 msecs""
;; =&gt; 0.6180339887498948

;; BUT!
;; Original version without doulbe coercion and k=5000 took more than 3 seconds!!!
;; ""Elapsed time: 3642.036658 msecs""
;; =&gt; 0.6180339887498948
```"
508,1550232450.4449,Sonny,"Folks, this strikes me as a question where I am sure that the answer is going to embarrass me, but I am drawing a mental blank. Is there a simple way to toggle a single item within a set. I.e. if it's there remove it, if not add it? Used to do this with set xor in my JS days."
508,1550232599.4457,Simonne,Besides `(if (contains? s i) (disj s i) (conj s i))`?
508,1550232620.4463,Sonny,"Yes, exactly the code I was trying to simplify.; Had a feeling there might be a (xor s #{i}) type thing.; No big deal but felt like it might be there."
508,1550232670.4478,Simonne,put that in a fn called `toggle-member`?
508,1550232731.4489,Sonny,"Yeah, can definitely do that. I just had this, ""I am sure there is an API function for this"" feeling. If not it's good, means I am not going crazy :slightly_smiling_face:."
508,1550232750.4493,Simonne,"not sure what you want to do, but `set/intersection` might help; `(set/difference s (set/intersection s #{i}))`?"
508,1550232907.4524,Sonny,"I think the first example is probably the most readable barring the existence of a `(toggle s i)` function or similar. I occasionally get this weird thing that happens in my brain where I think, ""Ok, I am sure that there is either a built in function for this, or an obvious pattern that I am missing"". No worries, thanks for your help."
508,1550232912.4525,Simonne,"hmmm… doesn’t do the “if it’s no there, add it part”"
508,1550232962.4531,Clarine,You might want to use a map: `(update {:foo true} :foo not)`
508,1550233089.4542,Sonny,"Hah! That's a neat trick. I think this is the kind of thing I meant by some pattern that I might be missing. Will explore whether converting to a map makes sense. This is all ""first world problems"", the contains check is not that complex anyway really."
509,1550233948.4549,Leana,Is it possible to write docstring in `defmethod` when using multimethod?
508,1550234000.4554,Sonny,"<@Leana> To my knowledge, no. Docstring goes on the defmulti."
510,1550235608.4577,Roberto,"I have this weird problem, where I get a `ClassCastException` when calling `(class x)` but no error when calling `(.getClass x)`. Here's the code:
```
(let [^Property src        (get-prop inst)
       [target-id target-prop] val
       target-inst (tree-search/find-nearest-by-id inst (str target-id))
       target-class (.getClass target-inst)
       get-target-prop (get-property-fn target-class target-prop)
       ^ObservableValue target     (get-target-prop target-inst)]

       (println ""Now binding"" src ""with"" target)

       (.bind src target))
```

This works, but when I replace `(.getClass target-inst)` with `(class target-inst)` I get: `java.lang.Class cannot be cast to clojure.lang.IFn`. What's going on here?"
510,1550236370.4584,Sonny,"<@Roberto> Have you shadowed, ""class"" somewhere else in the context? (def class ...) etc"
510,1550236526.4603,Roberto,"yes, I have. damn this has cost me something, why didn't I see it?; :rage:; thanks; I should take a break :slightly_smiling_face:"
510,1550236569.4614,Sonny,Not a problem. I only saw it because I have done similar things myself :slightly_smiling_face:
511,1550236669.4617,Leana,<@Sonny> Thanks a lot for your answer :slightly_smiling_face:
510,1550236686.4621,Leana,Guess I am doing something wrong if I need to have docstring in the method xD
510,1550236831.4641,Sonny,<@Leana> No worries. I actually quite often drop in a regular comment at the top of my multimethods in place of an actual docstring. Seems that I often find it useful to give a little explanation about what this specific case does. There is probably nothing to attach an actual docstring to though by the time all this stuff gets munged down to .class or .js.
510,1550241860.4659,Simonne,<@Leana> No you’re not doing it wrong. It’s a flaw IMO.; I needed this the other day. I’ll play around w/ it more real quick.
510,1550242174.4701,Shayla,"So I have a test helper function that checks to see if a given string is in hashmap `state`, which I use like `(is (last-log-contains? state ""Barrier""))`. This works fine when it's correct, but when it's not correct, the output is: `expected: (is (last-log-contains? state ""Barrier"")) \n actual: (not (last-log-contains? [FULL STATE CONTENTS HERE] ""Barrier""))`. Because of how this app works, the `state` hashmap can occasionally be _extremely massive_, which is tough to handle in test output.; ```
(defn last-log-contains?
  [state content]
  (some? (re-find (re-pattern content)
                  (-&gt; @state :log last :text))))
```; Is there any better way to write the function to avoid this? Is there any better way to write the `is` assertions to avoid this?"
510,1550242699.4722,Becki,"perhaps you could check `(select-keys state [""Barrier""])` for the key rather than the full map. When you are wrong you will be presented only with the value of the thing you are checking"
510,1550242871.4725,Shayla,That's not a bad idea! Let me try that; And thank you <@Becki> and <@Harris>! Your help yesterday was fundamental to me getting my PR up
510,1550242963.4739,Harris,great!
510,1550242989.4744,Becki,"that's awesome. was there any performance gain? measured or just ""felt""?; or just feel better that you are doing things more correctly. that's always a win too :slightly_smiling_face:"
510,1550243174.476,Shayla,"haha Mostly the last one. Compile times seem to take a bit longer, and the tests were already pretty quick, but this is a major win for DRY; We had 3 macros that did similar but slightly different things, and this allows me to extract the main `let` bindings that were shared between the 3 into a single spot"
510,1550243475.4774,Simonne,"<@Leana> yeah ok; so a couple things; you _could_ use the meta reader macro anywhere you want; e.g. `(defmethod ^{:doc ""foo""} foo* :bar [args])`; the problem with that^ is; You basically can’t get back to that docstring at runtime. It’s attached to the symbol `foo*`.; You could also do something more drastic, like re-implement `defmethod`:
```
(defmacro defmethod*
  [multifn dispatch-val mymeta &amp; fn-tail]
  `(. ~(with-meta multifn {:tag 'clojure.lang.MultiFn})
      addMethod
      ~dispatch-val
      ~(with-meta `(fn ~@fn-tail)
                  mymeta)))
```; Then you could get back to your docstring via: `(meta (get-method foo* :baz))`; However, it’s odd, because the docstring is attached to the _function_. Whereas the docstring of the multimethod is attached to the _var_."
510,1550243780.4822,Jasmine,there's a jira about this btw
510,1550243781.4823,Simonne,"i.e. you get the multimethod docstring like so: `(meta #'foo)`; ah good to know; So the unfortunate truth is, as <@Sonny> deduced, there’s no consistent place to hang a method’s metadata."
510,1550243868.4837,Jasmine,"well, I thought there was, not seeing it now. I know I've had some conversation about it in the last 6 months"
510,1550243986.4861,Sonny,"It doesn't seem like there is much point in supporting it because defmethods have no real identity. All of the tools that give power and usefulness to docstrings rely on being able to talk about a named thing, but defmethods are not named things.

Perhaps if things like the `(doc)` function were changed to optionally support a dispatch value in the case of multimethods or something, but otherwise... why bother? :slightly_smiling_face:"
510,1550244055.487,Jasmine,"but yes, that's the tricky bit"
510,1550244159.4882,Sonny,"I would say, in my case it would only be supporting docstrings in the usual ""docstring location"", even if they were ignored entirely at runtime, but all that is really for is consistency of documentation in the code itself.; It's not really a problem to drop in a standard comment, they just look different in cursive and I don't get the pretty green :slightly_smiling_face:"
512,1550246009.4894,Leana,Thanks a lot for all your answer!
513,1550248752.4896,Elida,"```(def valid-guid?
  (s/with-gen
    #(int? %)
    (constantly 1)))
=&gt; #'test-ns/valid-guid?
(s/form valid-guid?)
=&gt; :clojure.spec.alpha/unknown```; is this expected behavior?"
513,1550249102.4905,Clarine,"```
$ clj -A:test
Clojure 1.10.0
user=&gt; (require '[clojure.spec.gen.alpha :as gen])
nil
user=&gt; (require '[clojure.spec.alpha :as s])
nil
user=&gt; (s/def ::guid (s/with-gen int? #(gen/return 1)))
:user/guid
user=&gt; (s/form ::guid)
clojure.core/int?
user=&gt; (gen/generate (s/gen ::guid))
1
user=&gt;
```"
513,1550249105.4906,Elida,"```
(def valid-guid?
  (s/with-gen
    int?
    (constantly 1)))
=&gt; #'test-nss/valid-guid?
(s/form valid-guid?)
=&gt; clojure.core/int?```; right, anonymous functions in with-gen breaks s/form"
513,1550249394.4922,Clarine,"In spec-alpha2 that won’t work at all anymore, so you better get used to it :wink:"
513,1550249584.4929,Sixta,"Is there an existing pretty printing socket server repl I can utilize? Or do I need to write my own using `clojure.pprint/pprint`, is `clojure.pprint/pprint` even suited to pretty printing in a repl?"
513,1550249621.4932,Becki,doesn't CIDER offer that but default to fipp?; meaning it should be fine?
513,1550249648.494,Min,yeah and fipp as a specialized fn that's repl friendly if I recall
513,1550249864.4955,Sixta,"I'm happy to use fipp for dev, but I'm not so sure about production with fipp. I don't want to conflict with someone else's version of fipp.; Cider offers a clojure.pprint integration too though"
514,1550252755.4973,Mariela,"Is it possible to check whether a given symbol corresponds to a protocol method?

e.g. `(protocol-method? 'my-method) =&gt; true`, `(protocol-method? 'inc) =&gt; false`"
514,1550252883.4981,Marlyn,"resolve it, and inspect the var, if it resolves"
514,1550252952.4984,Elida,form won’t work at all with with-gen specs?
514,1550253072.4994,Mariela,"right, metadata of such vars has a `:protocol` key. thanks!"
514,1550253151.4996,Elida,or you won’t be able to pass anonymous functions to with-gen?
515,1550255171.501,Hans,<@Sixta> Fipp is very stable. It should be safe to just forcibly use the latest version.; I promise stability.
515,1550255312.5013,Clarine,you cannot do `(s/form int?)` in spec 2. you must write `(s/form (s/spec int?))`
516,1550255861.5015,Elida,would `(s/form (s/spec #(int? %)))` work?
516,1550255900.5017,Clarine,"This is what I get:
```
user=&gt; (s/form (s/spec #(int? %)))
(fn [%] (clojure.core/int? %))
```; minor, but why are you writing #(int? %) instead of int?"
516,1550256201.5021,Elida,just a simple example
516,1550256212.5023,Clarine,k
516,1550256376.5025,Latonya,"Clojure Ratio values are exact, and I believe that every single arithmetic operation you do on one also does a greatest common divisor calculation to reduce the numerator and denominator integer values to lowest terms, changing the type to an integer if the result happens to be one.; Because the results are exact, if the numerator and denominator get large, then all calculations will be doing exact arithmetic on large integers."
517,1550257269.5029,Dann,"sounds like what you want is a cache, and then an atom used to derive the cached values, and clear of (parts of) the cache if the atom changes; you might want to check out core.cache, and for that usage a cache used by a function over an atom would make sense, where alterations to the atom might clear some or all of the function's cache; using two atoms together isn't generally doable in a correct way, but a cache of a function over an atom is doable"
518,1550258741.5041,Sixta,"<@Hans> your word is sufficient, fipp it is! "
518,1550259076.5046,Hans,"if you ever have a problem w/ that, feel free to complain to me directly and i’ll get a fixed build out"
519,1550266652.506,Matha,Is there ever a legitimate use of a map from keywords to functions instead of using a multimethod?
519,1550266792.5069,Shonda,"I suppose if the function to be called can change at runtime based on context. Meaning you have one keyword, but the fn associated with that can change."
519,1550267146.5081,Fredda,"If your multifn is just dispatching off of keywords, seems like mostly the same thing to me. You're just able to define your dispatch map across multiple namespaces and downstream projects.; If all dispatch logic fits in one ns, a simple map would be just as good imo"
519,1550267379.5103,Matha,"<@Fredda> yeah… basically, when dispatching on some function of an argument, a multimethod seems natural (or when there is a need for extensibility). But in my project I found myself passing a keyword as the first argument to my multimethod (a dispatch key) which is then totally ignored by the body of the function. It seems odd / a map would be cleaner"
519,1550267534.5121,Fredda,"Yeah... IMO it would be cleaner, in some cases. The multifn approach is just so extensible - let's you build out that dispatch mechanism across namespaces.; and let's downstream authors extend your dispatch map"
519,1550267591.5127,Matha,fair; makes sense. Ty :slightly_smiling_face:
519,1550267659.5134,Fredda,"np. Feel free to check out dispacio if you're looking for any more inspiration around dispatch strategies <https://github.com/johnmn3/dispacio>; The finest-grain control might be to plug in interceptors, for manually constructing dispatch strategies"
519,1550267756.515,Matha,Ah; I’ll definitely check this out! I had a similar question some time ago about using pattern matching v.s. multimethods; I think the answer is the same; it depends on how much you care about extensibility
519,1550267768.5153,Fredda,aye
519,1550268366.5162,Matha,"Why do a lot of clojure functions on sequences return lists? e.g. `(rest [1 2 3])` returns `(2 3)`, forcing me to write `(into [] (rest [1 2 3]))` to get a vector back. Am I doing something wrong?"
519,1550268419.517,Antwan,"Well, more specifically they return sequences"
519,1550268431.5174,Fredda,"FWIU, the list is the underlying data type of the `seq` abstraction, which all functions that operate over sequences recognize."
519,1550268487.5191,Jasmine,<https://clojure.org/guides/faq#seqs_vs_colls>
519,1550268511.5197,Antwan,"If you are using rest for your computations things will be more efficient with linked lists (probably, by guestimate); Maybe; I dunno; Either way there is always subvec"
519,1550268638.5219,Jasmine,<@Matha> <@Fredda> protocols are implemented as a map of names to functions; but special in having call-site optimizations
519,1550268683.5226,Fredda,"Well, there ya' go :slightly_smiling_face:"
519,1550268725.5237,Jasmine,"there's plenty of places where a map of ""name"" to function is a better simpler choice than a multimethod or protocol"
519,1550268750.5245,Matha,"Ah. Am I doing something wrong by assuming in my code that I have a vector? Because, say, if at some point in my code I assume that I have a vector and use `conj` to append an element to the end, I now have to add `into []` or similar to all sequence operations I do on that vector, to ensure it remains a vector; Thanks <@Jasmine> for the extra explanation on multi-methods"
519,1550268789.5255,Fredda,"You have to know, yeah. Otherwise `conj`ing may do the different thing."
519,1550268799.5258,Jasmine,why do you need to ensure it remains a vector?
519,1550268811.5262,Matha,Well otherwise `conj` might behave differently on it
519,1550268834.5264,Jasmine,"in practice, I'd say this is not a problem I ever have"
519,1550268888.5277,Matha,"hmm, maybe I am thinking of it as a problem but it wouldn’t be in practice. I’ll try to ignore it and see"
519,1550268888.5278,Antwan,If you want to not worry about it you can always whip up your own fn
519,1550268902.5282,Jasmine,I would not do that
519,1550268913.529,Antwan,I'm a bad programmer so I would; But I would feel bad afterwords
519,1550268924.5297,Matha,"<@Antwan> yeah, but I found myself bumping into it over and over and I thought that if the standard library behaves in that way then I might be doing something wrong"
519,1550268924.5299,Jasmine,as you will then just build your own bespoke collection handling that is different than what is done everywhere else
519,1550268935.5305,Matha,"since I doubt all clojure devs re-write those functions, otherwise they would be in the std lib"
519,1550268946.531,Jasmine,"if you're having this issue, back up and explain how you got there; generally once I have sequences, I am never ""conj""ing to them, I am manipulating them at the sequence level with sequence functions"
519,1550269003.5322,Rosaline,"it is usually a problem if you are trying write what is an imperative algorithm using arrays in clojure; which, if you are doing that, don't use vectors, clojure has arrays"
519,1550269063.5333,Jasmine,"I think you're maybe off down a side path from where hmaurer started; I rarely use conj directly; <https://github.com/clojure/tools.deps.alpha> is probably something visible I work on regularly. it has tons of data structures and data structure manipulation. I use conj twice in the whole code base.; or I should say, in two functions"
519,1550269210.5374,Fredda,"Rarely does a clojure programmer not know obviously what the type being passed to conj is, I suppose. I rarely find myself getting bit by this either."
519,1550269218.5379,Rosaline,"for example, if you where directly translating some javascript code, js allows you to call push or whatever (I guess an arraylist would be a better analogue to that in clojure) to push a value on to the front of an array; and basically all the clojure collection code is not built to support that style of usage"
519,1550269270.5398,Matha,"Well, I started like this. I have a map which I pass down some function, a “step”. This map contains a special key, e.g `:remaining-steps [:a :b :c]` with the steps left to execute. What I do is I take that map, and run it through all those steps until that array is empty (so first `:a`, look up the corresponding function, run it on the map, and keep going). Those functions can also push elements to the beginning of  the vector under that key, adding more steps."
519,1550269281.5401,Rosaline,"so if you were trying to use it like that, you would end up doing something silly like (into [] ...) everywhere"
519,1550269308.5403,Jasmine,so it's a queue
519,1550269336.5409,Matha,I guess? I wasn’t thinking of it that way. It’s more like a bag of information that I run through a sequence of stages; like a bunch of middlewares; sequence of steps *; basically like a middleware chain except that instead of directly calling the next one I add a keyword under a special key and some functions “above” is in charge of calling them in order until there are no more to call
519,1550269461.5452,Jasmine,"it's unclear from what you said whether you want a stack or a queue. if you want a stack, the fastest option is to use a list (and cons/peek/pop). You can also use a vector as a stack with insertion point at the end, but that's slower than a list."
519,1550269478.546,Matha,stack
519,1550269491.5465,Fredda,"`(update amap :remaining-steps into :extra-step)` or `conj`. But you already know it's a vector, so you know which direction conj works in in that case.; Oh you want to push it to the front?"
519,1550269517.5475,Matha,yep
519,1550269520.5477,Rosaline,just don't start with a vector and your stack will be great
519,1550269530.5479,Fredda,aye
519,1550269537.5482,Matha,"alright, fair enough; ty"
519,1550269554.5486,Fredda,or #queue; But some seq ops will lose your queue type
519,1550269605.5498,Jasmine,note that that syntax is cljs-only
519,1550269616.5503,Fredda,ah
519,1550269643.551,Jasmine,"clj has a queue, but not the literal for it, you just use clojure.lang.PersistentQueue/EMPTY to get an empty one"
519,1550270266.5517,Matha,Folllow up question: is there a cleaner way to prepend a list of elements IN ORDER to a list than doing: `(into some-list (reverse elements-to-prepend))` ?; e.g. pretend `'(4 5)` to `'(1 2 3) ` to get `'(4 5 1 2 3)`
520,1550270632.5527,Rosaline,concat (with caveats)
520,1550270675.5535,Matha,said caveats being?
520,1550270717.5542,Rosaline,"but what you are talking about is concat, the caveat with concat is becuase it builds lazy seqs if you are using it without care you  will blow the stack when you go to realize it; you may want to reformulate how you keep your queue; instead of a list of items, keep a tree"
520,1550270879.5556,Matha,tbh performance matters 0 in my case
520,1550270922.5565,Rosaline,"I would just use concat; one way to think of something like your remaining steps is as a program, and what you have is the simplest kind of program, a linear list of instructions; so you could support more complicated trees of instructions, so something like clojure's do"
520,1550271180.5597,Matha,"sorry, what do you mean by this? (as a program)"
520,1550271216.5604,Rosaline,"it is a sequence of instructions for some abstract machine; you have `[do-x do-y do-z] and some program (the abstract machine) takes do-x off the control stack and does it, possibly pushing other things on to the control stack"
520,1550271394.5627,Matha,yep that’s pretty much what I have; except that my do-x do-y do-z are keywords
520,1550271409.5634,Rosaline,so you might have something like `[[:do-2-things do-x do-y] do-z]` and have your abstract machine support do-2-things by pushing the 2 things back on to the control stack
520,1550271571.5651,Matha,"hmm, I see; I don’t need that flexibility (for now) though, I think; Basically at first I was just piping something through functions with `-&gt;`, but I needed to add some machinery between every step, so I wrote this simple abstract machine because"
520,1550271691.5674,Lura,"when reloading a namespace with a defprotocol, Is there a way to avoid the dreaded `IllegalArgumentException No implementation of method: :foo of protocol: #'com.example.foo/IFoo found for class: com.example.foo.FooRecord clojure.core/-cache-protocol-fn (core_deftype.clj:527)` by unloading the protocol somehow at the repl?; the readme for toolsnnamespace says “To avoid this problem, always create new instances of records after a refresh.” which doesn’t make sense to me, defprotocol is the thing that is throwing on reload"
520,1550271768.5689,Rosaline,"if you support some kind of `do` operation in your machine, and add continuations, you can process trees of instructions without having to do annoying concats of instruction sequences"
520,1550271786.5693,Matha,<@Rosaline> what do you mean by continuations in this context?
520,1550271811.5697,Rosaline,the continuation of your abstract machine
520,1550271826.5701,Matha,as in? picking up evaluation again at some state?
520,1550271831.5704,Rosaline,yeah
520,1550271834.5707,Matha,yeah I do support that
520,1550271890.5718,Rosaline,"if you have that, then instead of having to implement do by pushing things back on to the control stack, you push a new continuation that continues with the old control stack after the new control stack executes"
520,1550271927.572,Matha,:thinking_face:
521,1550272777.5722,Tammera,"what they probably mean is that you need to refresh your instances of your `FooRecord`, because if they keep surviving post refresh they refer to the old protocol; one way this can happen is if you `def` them in a namespace, which you `:refer :all`."
520,1550272818.5726,Tammera,"That said, I have very similar issues often, so there is definitely more going on"
522,1550279995.5738,Laurene,"Hi, is there a convention for writing docstring for a wrapper function wrapping a Java library?; Like should I use the Javadoc in the docstring, link to it? Any ideas?"
522,1550289272.5756,Celestine,"<@Laurene> No conventions. There's no formatting associated with Clojure docstrings. They're usually just short statements of what a function does, occasionally with examples of usage. There are some documentation tools that will render Markdown in a Clojure docstring..."
523,1550293957.5767,Mariela,"Looking for a function `f` that makes the example `=` true...

```
&gt; 'component/start
component/start
&gt; `component/start
com.stuartsierra.component/start
&gt; (let [s 'component/start] (= (f s) `component/start)) ;; &lt;--- looking for an f
```"
524,1550294470.5769,Celestine,`resolve`?
523,1550294542.5776,Mariela,"`(resolve 'component/start)` is nil

(in any case I want a symbol, not its resolved value); got it `(symbol (ns-resolve *ns* 'component/stop))`; thanks for the hint!"
523,1550294954.5781,Celestine,"You need the alias in scope to resolve the symbol: ```user=&gt; (require '[com.stuartsierra.component :as component])
user=&gt; (-&gt;&gt; (resolve 'component/start) meta ((juxt (comp str :ns) :name)) (map name) (apply symbol))
com.stuartsierra.component/start
user=&gt;   ```; Depends on the context you're trying to resolve symbols in I guess...; Interesting shortcut... FWIW, `(resolve 'component/start)` produces a Var for me: `#'com.stuartsierra.component/start` -- not sure why you didn't get that <@Mariela>"
523,1550295108.5799,Mariela,"&gt; `(resolve 'component/start)` is nil

I probably said (and eval'ed) that wrongly. getting the var indeed; so yeah `(symbol (resolve 'component/stop))` is the shortest way"
523,1550295178.5808,Celestine,"Oh, I should have tried that first... that's a recent addition that you can go from a namespace object to a symbol I think...; Yeah, new in 1.10; ```seanc@DESKTOP-QU2UJ1N:~/clojure$ clj -Sdeps '{:deps {:com.stuartsierra/component {:mvn/version ""RELEASE""}}}' -A1.9
Clojure 1.9.0
user=&gt; (require '[com.stuartsierra.component :as component])
nil
user=&gt; (resolve 'component/start)
#'com.stuartsierra.component/start
user=&gt; (symbol *1)
ClassCastException clojure.lang.Var cannot be cast to java.base/java.lang.String  clojure.core/symbol (core.clj:579)
user=&gt;
seanc@DESKTOP-QU2UJ1N:~/clojure$ clj -Sdeps '{:deps {:com.stuartsierra/component {:mvn/version ""RELEASE""}}}' -A1.10
Clojure 1.10.0
user=&gt; (require '[com.stuartsierra.component :as component])
nil
user=&gt; (resolve 'component/start)
#'com.stuartsierra.component/start
user=&gt; (symbol *1)
com.stuartsierra.component/start
user=&gt;           ```"
523,1550295388.5818,Mariela,"nicely 'scienced'! and good to know :slightly_smiling_face:; I asked about this problem in this channel a couple times very recently. no luck...

my conclusion (as suggested by someone else) is to resort to metadata-based protocol extension. I find the feature nifty anyway.

You can `vary-meta` either defrecords ('thin'  defrecords: implementing no protocols), or plain maps"
525,1550305107.5823,Karren,"Great, thanks for enlightenment"
526,1550335902.5858,Laurene,Thanks again Sean!
527,1550349760.5885,Doreatha,"Is there a library like chime, but for java-time instead of clj-time/joda-time?; <https://github.com/jarohen/chime>"
528,1550352640.5894,Meagan,I want to add a custom `Datafiable` implementation to a function created with `defn`; I tried doing `(alter-meta! #'my-fn-name assoc 'clojure.core.protocols/Datafiable my-datafy-impl)`; doesn’t seem to work
528,1550353067.5914,Celestine,"The metadata needs to be keyed on the function name, not the protocol type.; `(alter-meta! #'my-fn-name assoc 'clojure.core.protocols/datafy my-datafy-impl)`"
528,1550353090.5919,Meagan,ahhh; yep just realized
528,1550353105.5925,Celestine,I got that wrong too when I first tried it at Conj :slightly_smiling_face:
528,1550353206.5931,Meagan,"OK, so that answers one question. the next is: is there a way to attach it to the function itself without rewriting `defn`? :grimacing:"
528,1550353242.5942,Celestine,I'm not sure what you're trying to do here... why do you want a _function_ to be datafiable?
528,1550353245.5943,Meagan,"because now, `(datafy #'my-fn-name)` works but `(datafy my-fn-name)` obviously does not, since the meta is on the var not the fn; reasons :stuck_out_tongue:"
528,1550353313.5953,Celestine,"You could `alter-var-root` to put in a new definition with metadata (wrapped on the function value, rather the Var) maybe?"
528,1550353384.5955,Meagan,ahh hmm; I lose some other nice properties if I do that it looks like; like the REPL prints it as “clojure.lang.AFunction” instead of the var name
528,1550353907.5969,Celestine,"Oh, because you no longer have access to the Var metadata itself?"
529,1550359286.5977,Matha,is there an idiomatic way in clojure to check if a list has *one and only one* item? Other than `(= (count my-list) 1)`
529,1550359698.5979,Jasmine,No
529,1550360783.598,Henry,Could also use `(= 1 (bounded-count 2 my-list))` to avoid fully realizing large lazy sequences :slightly_smiling_face:
529,1550361400.5987,Matha,<@Henry> ouh; good call; thanks!
530,1550380539.6,Meagan,what’s the state of the art for setting up tests in a deps.edn project?; specifically I want something I can run from within Emacs. I’ve never bothered to set it up before :x
530,1550380877.6008,Madeleine,"Hum, just use Cider then <https://cider.readthedocs.io/en/latest/running_tests/>; Kaocha seems state of the art. For simple test running, there is test-runner from cognitec-lab; <https://github.com/cognitect-labs/test-runner>; <https://github.com/lambdaisland/kaocha>; Both have a CLI, so you.can run them from emacs in theory, but you dont have ab emacs mode or anything integrating them first class inside emacs"
530,1550381124.602,Meagan,awesome! thanks
531,1550401162.6062,Sharen,"I'm stuck trying to write this macro:
```
(ns myns.util
  (:require [herb.core :refer-macros [&lt;class]]))

(defmacro defstyled [fn-name bindings el stylem]
  `(defn ~fn-name [~'attrs &amp; ~'body]
     (let [body# (if (map? ~'attrs) ~'body (conj ~'body ~'attrs))
           attrs# (if (map? ~'attrs) ~'attrs nil)]
       (letfn [(~fn-name ~bindings ~stylem)]
         (into [~el (merge {:class (herb.core/&lt;class ~fn-name attrs#)}
                           attrs#)]
           body#)))))
```
I want to make it so the call to `&lt;class` only includes `attrs#` if it's non-nil.
So in the above example, if `attrs#` is nil it should be `(herb.core/&lt;class ~fn-name)` instead.
I've tried many ways to do this; with a simple if or concat, but I can't get it to work."
532,1550411205.6122,Isa,"Today I get an idea to focus 80% of my time on open source / documentations / tutorials , because I like make solutions for other developers. But I don’t see how I could survive doing this considering money vs contracts. I didn’t think how to monetise open source before too much. Does it make sense? Probably not :slightly_smiling_face: Anybody here (as a person, not corporation) make money doing mostly open source? :slightly_smiling_face:"
532,1550411382.6127,Clarine,Nice discussion for the <#C03RZGPG3|off-topic> channel
531,1550411947.6139,Jasmine,"Sounds like a place where you want to unquote splice a collection instead ; `~@(when attrs# [attrs#])` ?; The trick being that unquote splicing an empty collection yields nothing, not nil"
531,1550412357.6168,Sharen,"that's cool to know! sadly I get a compiler exception syntax error, and my linter tells me it's unable to resolve the symbol attrs# inside that form. could it be because attrs# is defined when the returned function is run, not the macro?; I feel I'm a bit closer with `(apply herb.core/&lt;class ~fn-name (if (map? attrs#) [attrs#] []))` but I get `Can't take value of macro herb.core/&lt;class` so I guess I'm messing up the quoting somehow?"
533,1550416521.6178,Nigel,Why doesn't `(doseq [f [inc dec +]] (doc f))` print doc?
533,1550416631.6183,Jasmine,the symbols are being resolved to functions and doc takes symbols. quote to avoid evaluation
533,1550416793.6188,Nigel,Thanks <@Jasmine>
533,1550417039.6194,Jasmine,"actually since doc is a macro, you might need to do more than that to get doc evaluated with the actual symbol"
533,1550417054.6196,Nigel,"Yeah. That didn't work :slightly_smiling_face:; ```
user=&gt; (doseq [f `(inc)] (println f)(doc f))
clojure.core/inc
```; Hee hee. Sometimes, these things are trickier than you assume; `clojure.repl/print-doc` isn't public"
533,1550417510.6212,Jasmine,"oh right, attrs# is defined inside the code you're generating so isn't available to unquote; I mean you could just put an `if` around the call to &lt;class in the generated code; ```(defmacro defstyled [fn-name bindings el stylem]
  `(defn ~fn-name [~'attrs &amp; ~'body]
     (let [body# (if (map? ~'attrs) ~'body (conj ~'body ~'attrs))]
       (letfn [(~fn-name ~bindings ~stylem)]
         (into [~el (merge {:class (if (map? ~'attrs) (herb.core/&lt;class ~fn-name ~'attrs) (herb.core/&lt;class ~fn-name))}
                           attrs#)]
           body#)))))```"
534,1550424547.623,Leticia,whats the best library to consume chunked/streamed http responses? something that takes a callback or returns a channel and can automatically parse json chunks
535,1550428005.6241,Scotty,I'd like to serialize some data structure in EDN. `(spit)`-ing it loses `M` suffix on `BigDecimal` objects. Is there a way to avoid that (or maybe I'm using a wrong tool?)
535,1550428351.6242,Becki,None; also works for me if i use `(BigDecimal. 17)`; the screenshot is a split of the outputted edn file
535,1550428936.6254,Scotty,"Hmm, I'm doing something wrong then.; ```% clojure -e '(spit ""foo.edn"" 3M)'
% cat foo.edn
3
% clojure -e '(spit ""bar.edn"" {:number 3M})'
% cat bar.edn
{:number 3M}
%
```; Weird."
535,1550429175.627,Becki,check `str` on 3 vs {:number 3M} is your issue
535,1550429195.6272,Scotty,"Yes, that's different."
535,1550429222.6274,Becki,which is what spit is calling
535,1550429311.6277,Scotty,Which is `.toString` on the argument.
535,1550429456.6284,Becki,"so the difference is that RT.java prints bigdecs with the M added. so if you str a map you end up here but if you just str the big dec you get the bigdec's version of what a string is; ```
		else if(x instanceof BigDecimal &amp;&amp; readably) {
			w.write(x.toString());
			w.write('M');
		}
```"
535,1550429496.629,Scotty,Right. Now I need to trace why it happens inside a large Clojure structure as well.; Don't have a small reproducer yet.
535,1550429558.6297,Becki,any chance you have a stringbuilder anywhere and you're building up the string yourself?
535,1550429602.6306,Scotty,"Nope, I'm getting the data from API endpoint, `clj-http.client` passes it through `cheshire`, I wrap it into top-level map and spit."
535,1550429603.6307,Mariela,"Patreon is working quite nicely. Some software devs are making a proper salary out of it. Personally I donate to a handful of Patreon projects.

I would mix that with a ""N versions back"" model. It's briefly mentioned here <https://ayende.com/blog/186147-A/making-money-from-open-source-software-how-we-do-it> (the author doesn't like it, I do)

i.e. open-source n-versions-back releases on a continuous basis, while the latest-and-greatest release is closed-source and paid"
535,1550429677.6318,Becki,"can json express BigDecimal? and are you sure that its coming out of cheshire correctly? Also, is perhaps cheshire doing that? are you keywordizing the keys? maybe cheshire reduces over vals and strs them manually which would exemplify this behavior"
535,1550429716.632,Scotty,JSON numbers are size-less.
535,1550429735.6326,Becki,"```
(reduce (fn [acc [k v]] (assoc acc (keyword k) (str v)))
        {}
        {""number"" 3M})
{:number ""3""}
```; if cheshire does something like this"
535,1550429741.6329,Scotty,"Cheshire has a specific option, and I use it: `(binding [cheshire.parse/*use-bigdecimals?* true] ...)`; Hmm, I wonder if `clj-http` has a pool inside that might interfere with that... Let me check."
535,1550429885.6342,Becki,its kinda worrying that the string representation of BigDecimals changes on context due to RT
535,1550429887.6343,Scotty,"Hah, `*use-bigdecimals?*` works only if the number has a decimal dot."
535,1550429909.6349,Becki,makes sense
535,1550429995.6359,Scotty,"So that's the crux of the problem, one of numbers was an integer and hasn't got converted.; So I need to accept both bigints and integers down the line. Not a big deal.; I would expect that `str` calls into `RT.print` (that falls back to .toString for types it does not know) instead of `.toString`. Perforrmance? ¯\_(ツ)_/¯"
535,1550430169.6387,Becki,yeah it seems like it. but i don't know the details of pr-str vs str and print-dup and all that machinery. but i'm surprised that (str 3M) and (str {:x 3M}) are so different. It _feels_ wrong but maybe this usage is above a simple `str` call; hard to know if foot gun or bug
535,1550430220.6392,Scotty,I'll file a bug and we'll see.; `(str nil)` and `(str {:a nil})` are inconsistent as well.; characters too.; Classes too.; bigints too.; patterns too.; Most of special cases in `RT.print` produce output different from their built-in `.toString` function.; <@Becki> <https://dev.clojure.org/jira/browse/CLJ-2485> — I don't expect it to be fixed though.
535,1550431042.6424,Becki,we'll see. I expect thoughtful discussion. I don't know what the conclusion of that will be.
535,1550431532.6425,Isa,thank you for feedback
536,1550431552.6427,Isa,Do you know anybody from Clojure community who success with it?
537,1550432861.6429,Mariela,"Not really. Cognitect and bbatsov are only collecting a couple hundred dollars / month.

But my thinking is, if you go boldly for it why would it not succeed?

i.e. when you give people an incentive to use Patreon (or other), they will do it"
538,1550437445.6431,Sharen,"thanks, that did the trick!
by the way, I really enjoyed your book clojure applied [="
537,1550437861.6439,Mariela,can I prevent commas from being printed in repl evaluations?
539,1550442834.644,Isa,"Hmm even if I will do super great tools as open source it is for free, so who will pay for that? :wink:; you see my concern; I am afraid it is way to do things only for fun, but not as everyday job, because of money."
537,1550443228.6447,Mariela,"I don't think many are doing n-versions-back. I'd give a think to that. Not apt for libraries, but yes for things like IDEs DBs etc"
540,1550456586.6452,Vita,Shouldn’t you use `(pr-str {:number 3M})` if you want to write edn?
537,1550464682.6467,Nigel,"Is there a way to refer to an unevaluated form inside a macro without doing the following ?
```
(defmacro debug [form]
  `(do (println (list ~@form)) ~form))
```"
537,1550465697.647,Mariela,"```
(defmacro debug [form]
  `(do
     (println ~(list 'quote form))
     ~form))
```
?"
537,1550467159.6472,Nigel,<@Mariela> Thanks. I guess you can’t do it without somehow making a list of it again.
537,1550468036.6474,Mariela,"that's not a list, in the same way that `'x` is not a list

(clojure implements `'x` as a list though... which is why my macro looks like that)"
537,1550468483.6477,Nigel,<@Mariela> got that.
541,1550473172.6487,Latrina,"I love how approachable the core.async src is. I mean, 90% is way over my head, but it’s like 1000x less scary than I imagined it for what it’s accomplishing."
541,1550473771.6492,Becki,watch tim baldridge's videos on the macros. they are well worth the time
541,1550483665.6493,Cherise,"I thought you would be able to use `print-method` for this to change the printing of the various types, but trying to inspect the actual object leads to a StackOverflowError for some reason:

```
(defmethod print-method clojure.lang.PersistentArrayMap [o ^java.io.Writer w] (.write w ""changed""))
#multifn[print-method 0x41358378]
user&gt; {}
changed
;; Trying to change the print method by using the actual object leads to StackOverflowError:
user&gt; (defmethod print-method clojure.lang.PersistentArrayMap [o ^java.io.Writer w] (.write w (str o)))
#multifn[print-method 0x41358378]
Exception updating the ns-cache #error {
 :cause nil
 :via
 [{:type java.lang.StackOverflowError
   :message nil
   :at [clojure.lang.Var deref Var.java 197]}]
 :trace
 (...)
```; <https://github.com/clojure/clojure/blob/06097b1369c502090be6489be27cc280633cb1bd/src/clj/clojure/core_print.clj#L229>; There’s the comma"
542,1550485846.6504,Mariela,Epic find :v:
542,1550486117.6523,Raina,"Is there a good writeup about `#=` reader conditional? I tried using it and it has very confusing semantics:
```
'{:a #=(vec (list [1 2 3]))}
=&gt; {:a [list [1 2 3]]}
{:a #=(vec (list [1 2 3]))}
=&gt; {:a [#object[clojure.lang.PersistentList$Primordial 0x488c6b35 ""clojure.lang.PersistentList$Primordial@488c6b35""] [1 2 3]]}
```
It's like it evaluates first function but quotes the argument list of the said function"
542,1550487051.6531,Jasmine,It’s happening at read time so no evaluation has occurred on the args; It’s intentionally not doc’ed because it’s not a public feature
543,1550496460.6557,Marybeth,This message was deleted.
542,1550497177.656,Gilberto,`(assoc m :foo (or (m :foo) (compute-foo)))`
543,1550497327.6568,Jalisa,But this would invoke (compute-foo) even if :foo is already set. :disappointed:
542,1550497387.6571,Gilberto,"I had `or` in my first response, then changed it to a map-get operation, then back to `or` because of this. `or` is lazy."
542,1550497454.6573,Jalisa,`or` is lazy? Thanks!
542,1550497477.6576,Gilberto,"```
user=&gt; (doc or)
-------------------------
clojure.core/or
([] [x] [x &amp; next])
Macro
  Evaluates exprs one at a time, from left to right. If a form
  returns a logical true value, or returns that value and doesn't
  evaluate any of the other expressions, otherwise it returns the
  value of the last expression. (or) returns nil.
```"
544,1550501324.6579,Eufemia,None
544,1550501573.6583,Cherise,<http://blog.fogus.me/2010/01/22/de-chunkifying-sequences-in-clojure/>; <https://markhneedham.com/blog/2014/04/06/clojure-not-so-lazy-sequences-a-k-a-chunking-behaviour/>
542,1550502469.6618,Eufemia,thanks
544,1550502496.6623,Shayla,"I have a vec of symbols and quoted function calls to be used in a let-binding macro that I've quoted, and I want to turn it into a map so I can use the symbol as the key and get the quoted function back. I currently have the vec quoted, and in a thread macro I call `(partition 2) (map (juxt first identity)) (into {})` which neatly handles what I'm looking to do. My question is, why do I need to call `(map (juxt first identity))`?; If I leave it out, I get the `clojure.lang.Symbol cannot be cast to java.base/java.util.Map$Entry` error, but if I put it in, I've just created a list of `['symbol '(symbol (function call))]`, right?; What am I missing in this situation?"
545,1550504047.6641,Esther,"`(into {})` expects a sequence of 2-vectors, `[key val]`, that will become key-val pairs in your map. So, `(map (juxt first identity))` puts them in that form."
545,1550504307.6662,Laurene,"I used `float-array` to pass a Java array of float to a Java method. That method returns me back an array of float. Is there a sister function of `float-array` that does the inverse, so that I can use the array of float with Clojure? Or am I misunderstanding something?; Like how to print the array?"
545,1550504565.6672,Becki,i believe `vec` can take arrays and knows how to make PersistentVectors from them
545,1550504731.6675,Laurene,"Yes that work, thanks a lot!; I added an entry into clojuredocs to make it more visible <https://clojuredocs.org/clojure.core/float-array>; `(into [] f)` works as well (with f a Java array of floats)"
545,1550506559.6688,Shayla,"Ah, okay. Thanks"
546,1550510967.6716,Rosia,"I need a way to use  `partition-all` with a step of 1 but as a transducer... is there some way to get this by composing the transducer producing functions available in clojure.core or am I best off just sort of ""copying"" the  transducer portion of the `partition-all` source code to meet my needs"
546,1550511287.6723,Leticia,whats a good http client that allows a callback per chunk for streaming requests?
546,1550516679.6737,Doreatha,"<@Rosia> You can use the `partition` from the xforms library.
```
(require '[net.cgrand.xforms :as xfs])

(= [[0 1 2] [1 2 3] [2 3 4]]
   (into [] (xfs/partition 3 1) (range 5)))
```"
546,1550516709.6742,Rosia,<@Doreatha> thanks! I just found this a minute before your response
547,1550520874.6752,Meagan,"is there a trick to turn a clojure form into a list recursively at macro-time?; ex:
```
(defn foo [])
(defn bar [])
(defn baz [])

(my-macro (foo (bar (baz))))
;; =&gt; (#function[user/foo] (#function[user/bar] (#function [user/baz])))
```"
547,1550521876.678,Nathanael,"<@Meagan> how about this: `(defmacro my-macro [xs] (flatten xs))` and then ""(macroexpand `(my-macro (foo (bar (baz))))"" ?"
547,1550521931.6786,Meagan,"ah sorry, I probably didn’t explain well. I don’t want to flatten, I want to retain the nested-ness; I just don’t want it to be evaluated"
547,1550521986.6799,Nathanael,"oh sorry, i misread. But in that case the macro can just return it without calling flatten, and the rest is the same"
547,1550522077.6802,Meagan,"I went with this for now:
```
(defn listify [f]
  (if (seq? f)
    `(list ~@(map listify f))
    f))

(defmacro my-macro [&amp; body]
  `(list ~@(map listify body)))
```"
548,1550522930.6815,Debora,"hey all, so nil is considering less than everything else when comparing two things. is there a value that's considered more than everything else?"
548,1550522992.6818,Becki,across all types? seems like a tough order
548,1550523000.682,Debora,yea
548,1550523293.6822,Jasmine,42
548,1550523373.6824,Becki,"the greatest number; there's the obvious
```
(defn my-compare [x y]
  (cond (= x y) 0
        (= x :value/max) 1
        (= y :value/max) -1
        :else            (compare x y)))
```; I wanted to do something like this:
```

(deftype MAX []
  java.lang.Comparable
  (compareTo [this _]
    1))
(def absolute-biggest-thing-ever (MAX.))
```
which works for `(compare MAX 3)` but not the other way around. you get class cast exceptions"
549,1550529077.6856,Raina,"im probably missing something obvious but why

```
(meta ^:x 'x)
``` returns nil"
548,1550529098.6858,Rosaline,"'x =&gt; (quote x); (quote x) =&gt; x; <@Becki> you have to use a custom comparator instead of relying on the default one that uses Comparable; if you attach metadata to the form (quote x), then evaluate the form and get x, the metadata isn't on x, it is still on the form from before evaluation"
548,1550529438.6884,Becki,like the `my-compare` example i gave or something else?
548,1550530535.6901,Latonya,"<@Debora> In Clojure's clojure.core/compare implementation, is there some value that is greater than everything else?  No.  There is a greatest Long (Long/MAX_VALUE), and a greatest Double value (+Inf), but there is no single value that is comparable to all other values, and greater than all of them.  nil is special that way.; Why?  Probably because Rich new that nil-punning was going to be common in Clojure, and didn't want exceptions raised when sorting collections using clojure.core/compare that contained nil mixed with other types.  That is just my guess, though.; You are free to write your own custom comparator function that does whatever you like.  If for some reason there is some value you wanted to be comparable to, and greater than, all other values, it isn't clear to me what would be a reasonable choice for such a value. You could choose `nil` for that, but then it would be greater than all other values, not less than all other values."
550,1550534433.693,Vinnie,has anyone hit clojure jira's api? i tried a few paths under <http://dev.clojure.org|dev.clojure.org> but getting 404. not sure if it's enabled.
548,1550534466.6934,Latonya,I use it every week to collect numbers of votes on each JIRA ticket.
550,1550534508.6939,Vinnie,sample path i tried `GET`ing <https://dev.clojure.org/jira/rest/api/3/user/assignable/multiProjectSearch> (with auth) getting 404
548,1550534520.6942,Latonya,The URLs I use are in this code somewhere: <https://github.com/jafingerhut/clj-prescreen/blob/master/src/clj_prescreen/presc.clj>  Search for occurrences of http and you should see them.
550,1550534529.6945,Vinnie,"awesome, thanks!"
548,1550534543.6948,Latonya,I do not necessarily exercise parts of the API that you want to use...
548,1550534560.6951,Vinnie,sure. i will poke around and see if i can figure it out
548,1550534619.696,Latonya,"I notice that my code never uses 'rest' in any of its URLs.  Also note that Clojure JIRA may be an older version than the most recent, by several years."
548,1550534636.6964,Becki,<@Rosaline> built a neat looking way to query jira with core.logic but mentioned that the clojure jira doesn't send a lot of stuff back in the api
548,1550534659.697,Vinnie,"yeah i don't recognize the `sr` in the urls, or the `jira.issueviews` fragment"
548,1550534661.6971,Becki,i'm assuming it is quite old and unloved
548,1550534682.6975,Latonya,"Well, loved by a few, and stable.  Updating it can be a pain, I am sure."
548,1550534692.6978,Vinnie,apparently `Atlassian JIRA (v4.4#649-r158309)`; circa 2011
548,1550534737.6984,Latonya,"I am sure it gets more fun to update to the latest version, the more intermediate versions there are :slightly_smiling_face:"
548,1550534775.6987,Vinnie,good reason to use a service and let someone else worry about upgrades :smile:
548,1550534866.6994,Latonya,Until and unless they break APIs you use without telling you
548,1550534867.6996,Vinnie,"looks like we're on `v7.6.6` at work, which is what i've developed against previously. so i bet none of my code will work against clojure's; ha parts of it work :slightly_smiling_face:"
551,1550536912.7019,Jasmine,"When you’re using the api, please be kind. It’s not on a mammoth server or anything; I’ve unsuccessfully spent weeks trying to upgrade this jira instance to their cloud version. It’s a nightmare."
552,1550558892.7044,Ali,"Jira is brilliantly engineered in that it's extremely hard to get out of once you're in. On the other hand, the same indeed applies to Jira itself."
553,1550583286.7055,Melynda,Where is the difference between clojure.edn and clojure.tools.reader.edn?
548,1550584448.7061,Marlyn,"The latter is implemented in Clojure; The former in Java.  The Clojure library that tools.reader.edn lives in, also works in ClojureScript"
554,1550585438.7081,Noma,"Hi, I reinstalled Java and lein, but lein seems to be broken: ```lein
clojure.lang.Compiler$CompilerException: Syntax error compiling at (cider/nrepl.clj:1:1).
#:clojure.error{:phase :compile-syntax-check, :line 1, :column 1, :source ""cider/nrepl.clj""}
...
Caused by: java.io.FileNotFoundException: Could not locate clojure/tools/nrepl/server__init.class, clojure/tools/nrepl/server.clj or clojure/tools/nrepl/server.cljc on classpath.
 at clojure.lang.RT.load (RT.java:466)```"
548,1550585543.7087,Noma,"```java --version
openjdk 11.0.2 2019-01-15
OpenJDK Runtime Environment 18.9 (build 11.0.2+9)
OpenJDK 64-Bit Server VM 18.9 (build 11.0.2+9, mixed mode)``` but same issue with java 8"
554,1550585560.7089,Noma,lein installed with brew and I tried from the cli command tool
548,1550586086.71,Jasmine,the latest cider has moved to a new nrepl - that exception indicates the old nrepl. I don't know quite enough to point you at where things are amiss; I think things that would help someone answer this better would be which leiningen version and cider version you have
548,1550586227.7116,Becki,usually lein 2.9.0 is enough. check your deps for the presence of tools.deps.nrepl which is poisonous to have now
548,1550586418.712,Sixta,Looks to me like an old cider version? the error is that t.d.n can't be found. You might have cider in your ~/.lein/profile.clj
548,1550586685.7134,Noma,"Yes, you are right, I completely forget this file `~/.lein/profiles.clj` which was pointing to an old version of cider, I put the version displayed on clojars and it worked. Thank you."
555,1550588616.7136,Melynda,Thanks!
556,1550589549.7145,Debora,"thanks <@Latonya> <@Becki>, I was asking for a ""max value"" value only out of convenience; i just ended up writing my own comparator for the specific use case"
557,1550596880.7161,Madeleine,"So, anyone knows what's up with pRepl and what is it?; Given there is already nRepl and unRepl. I'm not sure what it can bring to the table; Though I would like it if it was more like unrepl; Or it seems maybe it can be used in conjunction with unRepl?"
557,1550597543.7195,Marlyn,"it cannot be used with unrepl; it does framing on output -- unrepl expects a raw stream; anyways, it's used in REBL and various other things
<https://github.com/clojure/clojure/blob/master/changes.md#25-prepl-alpha>"
557,1550597745.7227,Celestine,It'll be nice to see more tooling using prepl so less dependencies need to be involved.
558,1550597772.7229,Zenaida,Hi folks! Is there a way of compiling clojure files to clojuresctipt/js ?
557,1550597856.7237,Madeleine,"Hum, I'm not sure I'm onboard with pRepl then. Unrepl seems just all around better; Which already allows for zero dependencies"
557,1550597943.7247,Jasmine,"Actually, I’d say prepl is not framing, but data over a stream"
557,1550597976.7254,Madeleine,Is the data also streamed though? Otherwise it would be less efficient no?
557,1550597994.7257,Jasmine,What else could it be?
557,1550598047.727,Madeleine,"Well, I mean. Say you return a long printed string. Can you start decoding the characters before the full string is returned?; If it is packed in a data notation, I feel you'd need to wait for the whole thing ; Where as with unrepl bytestream, you can do whatever you want. You could return streaming video for that matter"
557,1550598134.7295,Evonne,"Well, the usual caveats apply--JS doesn’t support Java interop or Java-style threads. If your Clojure code isn’t running into any Java/JS incompatibilities, it probably compiles as CLJS already."
557,1550598149.73,Gillian,Would replacing a node in a tree with clojure.zip be an example of path copying?
557,1550598179.7301,Evonne,I may not have understood what you’re asking for tho.
557,1550598282.7325,Gillian,"```With the path copying method a copy of all nodes is made on the path to any node which is about to be modified. These changes must then be cascaded back through the data structure: all nodes that pointed to the old node must be modified to point to the new node instead. These modifications cause more cascading changes, and so on, until the root node is reached.```
I think it pretty much describes zipping up a tree. Just realized that stuff I’ve been reading about Scala is described as path copying rather than anything related to functional zipper."
557,1550598304.7332,Madeleine,"I guess pRepl is more a replacement for nRepl then. Which would be bundled with Clojure. It seems like the advantage over unRepl might just be easier for tooling to build on, because of the defined data-format."
557,1550598370.7333,Zenaida,"No, you understand correctly. =D But, just because I have the org.clojure/clojurescript dependency it will compile to cljs? (if I have no incompatibilities)"
557,1550598778.7356,Jasmine,"It’s packed in an edn string, so in general you would wait to read the whole data structure response (unless your client was very clever); But the key here is that in general your interactions with a repl are short, not a streaming video"
557,1550598847.737,Evonne,"I would tend to expect so, that was one of the goals of CLJS. You might also want to use .cljc files if you’re interested in code that compiles to both."
557,1550598896.7378,Jasmine,I see all of them as different approaches
558,1550598898.7379,Evonne,Here’s the link if you haven’t seen the docs for this: <https://clojure.org/guides/reader_conditionals>
557,1550598955.7395,Jasmine,Prepl and unrepl are built over streams and certainly Rich has expressed at great length the heritage and benefits of streams for composability and portability
557,1550599042.7408,Madeleine,"I guess I'm not seeing the value proposition of pRepl over nRepl except for it being bundled in the Clojure jar.; Sure, there's some implementation details differences. "
557,1550599113.7432,Jasmine,"Every Unix thing already knows how to work with character streams; Stream repls compose, so you can nest one inside another"
557,1550599187.7454,Madeleine,Maybe I don't know enough about nRepl then. What does it return if not a stream?
557,1550599209.7458,Jasmine,It’s a framed protocol
557,1550599331.7459,Madeleine,What does that mean?
557,1550599450.746,Sixta,I think this is untrue
558,1550599469.7464,Zenaida,Thanks! I am using lein-cljsbuild. Is there better one?
557,1550599501.7468,Sixta,Unrepl can start a nested session within a single frame of prepl
557,1550599533.747,Evonne,"That’s what I’ve always used, I haven’t really looked for a better one."
557,1550599575.7472,Sixta,"I think, anyway "
557,1550599590.7479,Zenaida,Just to clarify: I have an application written in Clojure and I would like to compile it to cljs/js and run it in a Node VM.
557,1550599593.7481,Jasmine,Probably better for you to go read their well written docs than for me to explain
557,1550599663.7482,Zenaida,"This is possible, right?"
557,1550599676.7488,Jasmine,It’s bencoded messages over a socket
557,1550599690.749,Evonne,"Sounds plausible, but you’ll have to port the code that works with dependencies, so anything to do with, say, databases or web servers; That can be a bigger rabbit-hole than you might think because you may have Clojure libraries that depend on something Java-specific internally, meaning you’ll have to find a CLJS replacement for the whole library."
557,1550599824.7496,Rosaline,"that is not strictly accurate; nrepl in practice is mostly bencoded messages over a socket, but you can define different transports"
557,1550599877.7504,Evonne,"Depending on the application, it may prove to be simpler/faster to use the Clojure implementation as a reference, and write the CLJS from scratch. But that’s a worst-case scenario."
557,1550600080.7531,Rosaline,"I must admit I am some what baffled at the turn prepl has taken, because it has been my experience that tunneling framed messages is easier to do both over on framed message protocols (like websockets) and over streams (like a socket), and when nrepl as a project started I seem to recall rich suggesting looking at STOMP(a message bus protocol) for inspiration"
557,1550600136.7541,Zenaida,"Right, make sense! Thanks! Do you have any doc/post about compiling clj to cljs? I just would like to run some "" lein comile clj to cljs"" and see some exceptions popping up (because of some Java/JS incompatibilities)."
557,1550600145.7543,Rosaline,"(tunneling is near and dear to me because at work I do a lot with an nrepl tunneled over <http://socket.io|socket.io>); but then, like reading the doc string on prepl, most of the doc string is example framed messages that out-fn is called with"
558,1550600470.7564,Rosaline,"so the idea that that you can differentiate between prepl and nrepl saying one is framed messages and the other is streams, rings rather hallow"
558,1550600522.7567,Eugena,"What is the best possible way to generate list using clojure on a map like

 ```(def somemap {:name 'John Doe' :gender 'male'})```

and generate
 ```(some-ns/property :name 'John Doe')(some-ns/property :gender 'male')```"
558,1550600675.7569,Evonne,"I would just start by copying the files into a `cljs` directory instead of `clj`, and changing the file extensions from `clj` to `cljs`. (Actually, I’d inspect them as I copied them just to see what I was getting into.)"
558,1550601241.758,Dann,if you want a list of those lists `(map (fn [entry] (cons 'some-ns/property entry)) somemap)`; but often lists aren't the right data type
558,1550601288.7587,Rosaline,generate is kind of an ambiguous word there; and the def isn't even valid clojure
558,1550601675.7599,Eugena,"<@Dann> <@Rosaline> , I m trying to generate this form from a map ```(traverse g (add-V :person)
              (property :name ""John Doe"")
              (property :gender ""male"")))```"
558,1550601702.7602,Rosaline,"generate is again ambiguous; but, assuming traverse is a function, and property is a function, and what you want to do is call the traverse function with those arguments (instead of creating a that as a datastructure); `(apply traverse g (add-V :person) (for [[k v] somemap] (property k v)))`"
558,1550601850.763,Eugena,yes traverse and property are functions
558,1550601851.7632,Rosaline,assuming you fix the broken quotes on somemap
558,1550601915.7639,Madeleine,I
558,1550601917.7643,Rosaline,"although, my (wild)guess is you are using clojurescript, not clojure, and for in clojurescript might not work on maps like that"
558,1550602027.7668,Eugena,<@Rosaline> I m dabbling with ogre library for JanusGraph and trying to create a graph traversal in clojure
558,1550602043.7676,Marlyn,i don't see how that could work
558,1550602057.7685,Dann,"""generate this form"" makes me think you might be trying to do a macro - is traverse a function where you can precalculate args, or a macro that needs another macro around it?"
558,1550602065.7689,Rosaline,I saw single quoted strings and swung for the fence
558,1550602107.7701,Lemuel,philosophical design question: what makes some data metadata?
558,1550602127.7704,Madeleine,"I'm not sure I see the difference between bencode, and EDN. Both sound framed to me. And neither seem to be streamable protocols. They both require the full payload to be received before decoding can proceed. That said, EDN in Clojure-land seems more natural. So I still feel pRepl is more like a new take on nRepl, with Clojure jar bundling. Which is fine, better then nRepl. But unRepl still seems like the wholy grail to me. That said, I recognize it might be harder to implement a tool with unRepl, since you're left implementing the protocol you want on your own. So, maybe pRepl is the right compromise in this case."
558,1550602207.7715,Rosaline,I haven't seen anything in unrepl that couldn't be done in nrepl; in fact technomancy had a proposal for using hypermedia kind of things to build emacs/vim/whatever uis for tooling on top of nrepl instead of having to build them again for every editor
558,1550602335.7732,Eugena,"so, here is how ogre lets us create a vertex in Janusgraph with traverse function. so I am wondering if there is a macro approach  - <https://github.com/clojurewerkz/ogre/blob/master/test/clojure/clojurewerkz/ogre/suite/add_vertex_test.clj#L22>"
558,1550602385.7742,Madeleine,"Well, for me the differentiator for unRepl, is really just the idea that you inject your repl code through a standard socket repl or clojure.main repl.; So if nRepl injected itself like that, to bootstrap, instead of requiring hard dependencies. Then it would be totally fine"
558,1550602453.776,Lemuel,"<@Rosaline> I've seen hints of this in nREPL, but not sure where this was going.  Do you know of a blog post or something?"
558,1550602482.7764,Rosaline,"I don't recall, it was a billion years ago"
558,1550602499.7768,Dann,"don't use a macro if you dont' need one - if traverse is a function, use a function like hiredman demonstrated"
558,1550602504.7771,Rosaline,I think he even proposed a talk at the conj about (I don't recall if it was accepted)
558,1550602554.7772,Dann,"macros can do a few things a function can't, but are less flexible / usable in other code, so if either a macro or a function would work, use a function"
558,1550602560.7775,Rosaline,<https://github.com/technomancy/nrepl-discover>
558,1550602586.7777,Vernia,"Equality and hashing ignore metadata, so it’s best used for annotations that you would not consider part of an object’s value"
558,1550602587.7779,Eugena,"sure, thank you. I will check his approach"
558,1550602653.779,Madeleine,It's like ultimate REPL reification
558,1550602683.7797,Rosaline,nrepl if I recall shipped with a teletype transport which was a socket repl
558,1550602738.7808,Jasmine,"prepl being streaming means that you can connect remotely and still nest new repls, which you can't with nrepl afaik. I think cgrand was even looking at deploying unrepl that way over prepl?"
558,1550602769.7817,Teodoro,I started working on injectable nRepl.
558,1550602777.782,Rosaline,"depends what you mean by nest repls, but nrepl middleware can pretty much do whatever it wants"
558,1550602790.7826,Jasmine,I mean like run `clojure.main/repl`
558,1550602815.7833,Rosaline,"I have a repo somewhere that runs swim (clustering) over nrepl, and then lets you proxy in to different members of the cluster"
558,1550602821.7834,Madeleine,"Yes! Awesome, I was just thinking that in theory, unrepl could inject nRepl or even pRepl (:p), though that one is just part of Clojure so no reason to do so. That's great.; By the way, is there currently a way to start the socket repl from within a REPL? Or you need to have the JVM arg on app startup ?"
558,1550602919.7844,Jasmine,it has a programatic api; so you can start it yourself if you like; <http://clojure.github.io/clojure/clojure.core-api.html#clojure.core.server/start-server>
558,1550602990.7852,Madeleine,"Ah awesome, I was looking for that, but couldn't find it.; So, does each socket repl get a dedicated thread?"
558,1550603052.7862,Jasmine,"each socket server has a thread, and each incoming client gets its own thread; you could just go read the code for this too, it's pretty straightforward"
558,1550603087.7867,Madeleine,"Ah yes, I see from the source. Cool; So, what does the ""p"" stand for, just curious?; in pRepl; :stuck_out_tongue:"
558,1550603320.7879,Jasmine,"program; as in not, designed for humans but for programs (like rebl) to talk"
558,1550603356.7889,Madeleine,"I see, that makes sense."
558,1550603376.7894,Jasmine,<https://groups.google.com/forum/#!msg/clojure-dev/Dl3Stw5iRVA/IHoVWiJz5UIJ> is some stuff from rich when the socket repl was added that you might find useful to read if you're interested in his opinions on it; it's a long thread
558,1550603426.7899,Madeleine,I see that haha.
558,1550603469.7905,Jasmine,this pre-dates prepl but I think you can project most of what's said there to prepl as well
558,1550603587.7917,Madeleine,"Hum, havn't read it all. But I wonder if pRepl is a realization that no one used the Socket Repl. And thus, a thin RPC, or lets call it more, a easier time building REPL based programs was needed to gain more adoption. Thus pRepl"
558,1550603646.792,Jasmine,"it's important to separate the socket server from the socket repl; the socket server is the more important bit imo; the socket repl is the clojure.main repl, with a few minor tweaks, over the socket server; to some degree, it is mostly a minimal example to be in the box - we never expected it by itself to be used much; we expected more people would build interesting custom remote repls (unrepl is a great example); stepping away... need to get some work done :)"
558,1550604014.7974,Rosaline,"the whole thing is so frustrating to read, the stream vs. messaging framing because streams are an ordered sequence of messages, the rpc vs. repl framing because after saying a repl is not an ""Eval RPC Server/Window"", rich turns around and releases prepl, which I mean, a programatic repl, how is that not an rpc server?"
558,1550604265.7996,Jasmine,"It supports streamed messages which are independent. If you have a thread pumping out, you’ll keep getting messages independent from the repl"
558,1550604314.8002,Marlyn,like tap messages get pushed
558,1550604615.8039,Madeleine,"I'm taking this bit: `With the improved read-ability of REPL output, I think an edn-based REPL makes a fine RPC server for program-to-program communication, especially since the set of 'verbs' supported is bounded only by what you can evaluate, and the types of things you might discover is open.` This sounds a lot like pRepl. And I feel it is. I can see how the Socket server is the true primitive. And then unRepl, happened to be the only take on it. So maybe, it is true that people seemed to have been baffled by how bare bones socket server was, and just having to decide of a serialization format to exchange was too hard for tooling to adopt it. So maybe pRepl is trying to solve that. Adding a basic edn serialization on top."
558,1550604630.8042,Rosaline,"Which is that a response to? I can see how that could be used to argued against it being rpc, but then again plenty of rpc frameworks have someway to stream information. As for streams vs. messages you can't describe what the stream is doing without calling it messages, so I dunno.; I feel like my parents got divorced so I get more toys (so many repls) but then they keep making digs at the toys the other parent got me; and like, it is pretty clear they are all legos"
558,1550604782.8075,Marlyn,"It's really important to separate Socket Server vs. Socket REPL

Socket REPL is `clojure.core.server/main` running as the ""connection accept"" function for a Socket Server
You can conceivably run a JSON-RPC endpoint, or some HTTP server as your ""connection accept"" function; prepl is another thing you can run on a Socket *Server* -- specifically `clojure.core.server/io-prepl` would be the accept function for that"
558,1550604924.8092,Rosaline,I am not sure what point you are trying to make?
558,1550604944.8099,Marlyn,just re-articulating a previous point
558,1550604997.8116,Rosaline,"diverse transports? nrepl has them (as I said nrepl ships with bencoded data over sockets and a plain socket repl, and there are throd party transports for things like message queues and http)"
558,1550605052.8132,Madeleine,"Right, I see that. I guess the thing is. Once you have a socket server, and an accept function that can take a char-stream and eval it, and return a char-stream of the result. You have all the power as a client. So now, you can send to be evaled the entire code of pRepl if you wanted. And eval a swap of the socket server accept-fn to be the one you just sent.; That to me is fantastic. And from my understanding, its the idea behind unRepl; Now, pRepl, or nRepl, or wtv else. Those are just protocols or middleware, etc. over your foundation. Maybe as a tool writer, I prefer to exchange EDN back and forth. Or maybe I prefer bencode.; unRepl lets me choose which; That said, its also an added responsibility to the tool writer. So maybe, I don't care. And its best that Rick just says, it'll be EDN from now on."
558,1550605225.8167,Marlyn,transport encoding is the least interesting part of this.  How the REPL handles `*in*` is really important
558,1550605244.8173,Madeleine,"Hum, go on"
558,1550605327.8191,Marlyn,"I haven't looked recently so I don't know if this is out of date information w.r.t. nREPL,  but that old thread above brought up some difficulties with issuing `(read *in*)`  in nREPL; ```(defn user-prompt [s]
  (println s)
  (read *in*))```"
558,1550605401.8209,Rosaline,"yeah, it is tricky, but doable"
558,1550605413.8214,Marlyn,so that is _fundamental_ to a REPL
558,1550605417.8217,Becki,"```
""Returns a LineNumberingPushbackReader suitable for binding to *in*.
   When something attempts to read from it, it will (if empty) send a
   {:status :need-input} message on the provided transport so the client/user
   can provide content to be read.""
```"
558,1550605419.8219,Rosaline,but it also illustrates the problems transporting streams over messages
558,1550605421.822,Marlyn,"and shouldn't be tricky; nesting repls, etc.; transport encoding is as  simple as swapping the R and P in REPL."
558,1550605461.824,Rosaline,"and most intresting protocols these days (http, websockets, etc) are message based; so defining a repl entirely on streams limits its reach outside of a single machine"
558,1550605489.8248,Becki,"I remember Stu saying something like that on the apropos cast i think? His daughter was making a program and requested the users height or something. And he said it should read from in, not send a message.; But i don't see the full importance of that"
558,1550605516.826,Rosaline,"as I have said in the past, I have a nrepl repl tunneled over <http://socket.io|socket.io>; and I just typed (read) in to it; emacs prompted me for input; I typed ':a'; the result was :a; like, even tcp socket ""streams"" are not streams; they are sequence of messages; so framing streams as some fundamental answer that will give us super powers is kind of silly"
558,1550605621.829,Marlyn,there are molecules too but we're talking about the user-facing abstraction; <https://clojurians.slack.com/archives/C03S1KBA2/p1550605401820900>; what was that in reference to? ^
558,1550605642.8298,Madeleine,Rich sais: &gt; There must be some source (stream) of things read. That source is the same source that should be used should the code being evaluated call 'read'.
558,1550605655.8302,Rosaline,the read input
558,1550605661.8307,Madeleine,And that seems hard to argue against. But maybe nRepl supports this now.
558,1550605678.8312,Rosaline,"when I said ""tricky but doable"" and then did it, I was imply it is tricky but has been done; not ""it is tricky, and you kind of have to hack around to make it work"""
558,1550605724.832,Madeleine,"I think streaming matters. But I'm not sure pRepl qualifies as streaming.; When I think streaming, I think, partial.; Like if I wanted to return a big image from the REPL, and have it rendered in my tool."
558,1550605756.8331,Rosaline,"what you mean is you want results split over multiple messages; ""streaming"""
558,1550605795.8343,Madeleine,"Yes, where the messages don't add considerable overhead to the stream. And where you can begin to deserialize very early."
558,1550605815.8348,Rosaline,you can write an nrepl middleware that recognizes java Image objects and starts and a webserver and serves them over http and just sends a link to the client repl
558,1550605830.835,Madeleine,That's a lot of roudabout; If my REPL just returns bytestreams. It could just return the image bytes with a byte header and done
558,1550605880.8366,Rosaline,I think you think more about it that is not enough; but you can also certainly write an nrepl middleware that detects java Image objects and sends them back as a bunch of bytes
558,1550605923.8377,Becki,ardem added this to cider-nrepl i believe
558,1550605929.8381,Rosaline,"(but for example, if you are transporting over something that json encodes things will be tricky); yeah"
558,1550605954.839,Madeleine,"Yes, but now I'm having to add middleware dependencies ahead of time. So to use a tool, the user is forced to add code to their program. That's why I love unRepl; With unRepl, the tool is in full control. And can choose to be as sophisticated, or as little.; With no pre-req from the user, appart for starting a socket repl."
558,1550606023.8409,Rosaline,"all critiques of nrepl I have seen so far instead of making me think ""well nrepl could be better"" leave me thinking ""oh, I guess so and so hasn't used nrepl much"""
558,1550606050.8413,Madeleine,My critique seems very real. I don't want to have to add nRepl to my code.; Or any additional middleware
558,1550606075.8421,Rosaline,you can add it the way you use any other library
558,1550606106.8427,Madeleine,"Yes, but that is a burden.; Which I don't want."
558,1550606128.8434,Rosaline,"if you want to inject it right in to an existing repl, I don't know if I buy there being a lot of demand for that, but if there is, while nrepl can't do that now, I don't see why reason why it couldn't do that"
558,1550606149.8438,Madeleine,"If it were to do that, it basically becomes unRepl."
558,1550606193.8446,Rosaline,"at one point, and this may predate nrepl in the slime/swank days that is how a lot of the functionality was done, it would inject code in to the clojure process; version that is a nightmare, and making sure extensions work together, etc"
558,1550606219.8455,Marlyn,what did it use to inject code into the process?
558,1550606237.8461,Rosaline,"the swank-clojure repl; so of course there was a backlash, and now I guess we are scheduled for a backlash to the backlash"
558,1550606330.8482,Madeleine,"Ya, so this is where unRepl comes into play as well. Once you say, let's inject things into a socket repl. You have so much freedom, that you can also mess up, and different tools could inject incompatible things. Which is where, you want a framework around it. That's where unRepl goes beyond just the idea of injecting REPL functionality into a socket repl, into an actual library to use.; That said, nRepl isn't free of that issue also. Different middlewares need to play well with each other."
558,1550606402.8494,Rosaline,"they do, but atleast if you have to included them in a versioned manner in your project.clj or deps.edn or whatever you can try to pin them to something that works together; but if we just have a free for all of all your tooling just evaling whatever"
558,1550606465.8504,Madeleine,"Well, I can't speak of more details, since it is beyond my knowledge. But in my experience, I've had less issues overall with unRepl then nRepl."
558,1550606482.8507,Rosaline,because unrepl is new and the field is empty; I don't use any middleware with nrepl and have also never had the problem
558,1550606529.8517,Madeleine,"Yes, possibly. I'm just not sure that it would create a worse field.; For tooling, nRepl seems non ideal to me."
558,1550606560.8529,Rosaline,"the idea that unrepl is better because people haven't written terrible tools around it yet, well, just wait; and in a year or two you can move on to the next repl; what tooling have you written for unrepl and nrepl?"
558,1550606622.8547,Madeleine,"Oh, you want refactoring, add this to your project.clj file. Oh, you don't want the refactor lib deployed to prod, okay, figure out a way to use profiles, or aliases to only depend on it in dev. Oh but now, you actually do want to connect to a prod remote repl, and miss your auto-complete? Well too bad, maybe just include that middleware when going to prod?; By the way, I'm not bashing on nRepl.; It is great, and does a lot. The functionality is what matters to me."
558,1550606680.8561,Rosaline,I am not interesting in being the defender of nrepl
558,1550606682.8563,Madeleine,Which one gives me a better user experience.
559,1550606691.8566,Elaine,"my generator generates invalid `inst` 's
Is it a know issue?
`clj -Srepro -Sdeps '{:deps {org.clojure/test.check {:mvn/version ""0.10.0-alpha3""}}}' -e ""(do (require '[clojure.test.check.generators :as gen] '[clojure.spec.alpha :as s]) (gen/generate (gen/vector (s/gen inst?)) 120 6))""`
`[#inst ""1970-01-01T01:24:38.462-00:00"" #inst ""1969-12-06T11:54:24.666-00:00"" #inst ""820499-07-18T05:28:23.398-00:00"" #inst ""1969-08-08T01:04:53.430-00:00"" #inst ""1970-01-01T00:00:00.000-00:00"" #inst ""1970-01-01T00:00:00.001-00:00""]`
The `3` one: `#inst ""820499-07-18T05:28:23.398-00:00""` the reader can read it."
558,1550606708.857,Rosaline,"I take issue with people making bad comparisons to bolster their preferred solution; I get it, you like whatever, everyone likes things"
558,1550606771.8583,Madeleine,"Well, I'm not feeling like I'm making bad comparisons. I'm only stating a difference, which I think is not mistaken. nRepl requires hard dependencies to it and its middlewares. UnRepl does not.; And others seem to say that nRepl handles input and output in a way that makes certain code not behave normally. I can't speak to that fact. Maybe nRepl is handling all that correctly now, so it isn't an issue anymore.; Finally, I feel neither nRepl nor pRepl can allow for streaming data. So there use case suffers when you need to return gigantic results. Obviously, no tools needs this as of yet. But I like that UnRepl doesn't limit that, because the tool could choose its own mechanism.; Or might be more fair for me to say, limited streaming capabilities; I'm not totally sure about that last one though. I might be wrong about both nRepl and pRepl in that regards, I admit.; I also understand that, none of these might seem like good enough differentiator to warrant splitting the REPL ecosystem in three. And ya, maybe that'll end up worst, now having some tools use nRepl, others pRepl, and some more unRepl.; Anyways, I just wanted to understand where pRepl differentiated itself from nRepl, or unRepl. So thanks everyone for helping me understand that better."
558,1550607366.8639,Jasmine,"not a known issue, file a jira"
558,1550607664.865,Vernia,"nrepl can “stream” evaluation results over one or more messages since 0.6, and it was always possible with middleware (cider’s pretty printing middleware has done that for a long time). So you can interrupt an evaluation while printing a large (or infinite) result"
558,1550607906.8676,Madeleine,"Hey thanks for that piece of info <@Vernia> I know you've been hard at work on the cider orchard and nRepl. I love all the improvements being done. And actually agree with <@Ingrid> choice to stick with nRepl and double down. Lots of good stuff uses it, and it makes sense to just keep improving and making better what we already have."
558,1550608008.869,Vernia,"I think it’s a good thing if there are other REPL implementations tbh, tooling ecosystems can be diverse without being fragmented. If nrepl makes tradeoffs that dont make sense in some circumstances (i.e. how it handles `*in*` / `*out*`) then we _should_ have other options; Would you really rather inject some tooling code into prod than include it as a normal dependency though?; I agree that sideloading/upgrading is a cool feature but having to add a dep or two surely isn’t a blocker. lein and boot bundle nrepl anyway :slightly_smiling_face:"
558,1550609281.8704,Celestine,"I think once the nREPL clients can side-load the `nrepl` dependency over a Socket REPL or pREPL, no one will really care about the differences.; It'll just become more and more common to start from a simple Socket REPL or pREPL, initiated by Clojure itself based on JVM options, and any and all tooling will start from that point and build up.; For me, that's the main benefit: you can start an arbitrary JVM process (that contains Clojure), using JVM options to start a basic REPL, and then connect to that process from any editor, command-line tool, whatever, using whatever set of tooling features you like best."
558,1550609439.8733,Fredda,"WRT nrepl to a cljs target, interrupt doesn't actually work."
558,1550609786.8749,Vernia,That depends on which cljs repl you’re using – e.g. Nashorn handles interruption how you’d expect since it’s in the same runtime. Any kind of browser or foreign runtime and it gets complicated
558,1550609824.8751,Fredda,aye
558,1550610062.8752,Elaine,<https://dev.clojure.org/jira/browse/CLJ-2486>
560,1550610929.8784,Rosaline,"I spent lunch thinking about streams vs. messages, and it seems like what differentiates nrepl and socket repl/prepl in that regard is, nrepl has different message types for ""user input"" and ""forms to evaluate input"" where as for socket repl/prepl there is effectively one ""input"" message type for both"
561,1550611685.8788,Ferne,are there any libraries that modify clojure.test output for exceptions to also show the `ex-data`?
561,1550611806.8795,Jasmine,"clojure 1.10 does now I think; yeah, that was CLJ-1209"
561,1550611847.8802,Ferne,does it print _everything_?; is it pretty printed?; `*print-length*`?
561,1550611871.8815,Jasmine,"what do I look like, a go-try-it-machine?"
561,1550611872.8816,Ariel,"Dear Clojurists, any recommendations for DynamoDB API's?
So far, Faraday <https://github.com/ptaoussanis/faraday> looks the most promising, even though last commit was on 2017 :thinking_face:"
561,1550611916.8826,Jasmine,you could use the new cognitect-labs aws-api; <https://github.com/cognitect-labs/aws-api>
561,1550611933.8832,Ariel,thanks <@Jasmine>; I will give it a shot
561,1550611954.8839,Jasmine,<https://github.com/cognitect-labs/aws-api/blob/master/examples/dynamodb_examples.clj>
561,1550612054.8855,Rosaline,"I've used faraday a little, ended up ripping it of a project in favor of the java sdk (and ultimately getting rid of dynamo altogether and the deployment target changed). faraday was a little too magic for my taste, if you try and do anything actually database like with dynamo vs. just using it as a key value store, a lot of the decisions faraday makes with regards to serialization will bite you"
561,1550612196.8861,Jasmine,"aws-api doesn't use java sdk, just makes web calls, so it's much lighter weight"
561,1550612223.8865,Rosaline,"yeah, that example looks great; working with the java sdk is also frustrating because you can tell it is all json under the hood but you have to build all these java objects, which the aws-api stuff avoids"
561,1550612548.8887,Jasmine,"what, you don't like needless data -&gt; object -&gt; data transformations?"
561,1550612775.8897,Ferne,"I first parsed that as ""needless data"" -&gt; ""object"" -&gt; ""data transformations"" and that was much weirder"
562,1550613085.89,Dann,that's like the spring module for monads right?
561,1550614752.8909,Herlinda,"<@Eugena> Luckily you don't have to try to chain `property` calls together as they mutate the underlying traversal object. Something like
```(defn add-properties
  [traversal m]
  (doseq [[k v] m]
    (o/property traversal k v))
  traversal)``` will work. That saves you from a fairly nasty macro that I didn't enjoy trying to write"
563,1550614795.8912,Herlinda,For once I was happy with mutable state :man-shrugging:
563,1550614935.8924,Kirstin,Is there a way to expose an nrepl port (remote) to cider for a clj/deps instantiated repl?
563,1550615020.8927,Ferne,ssh port forwarding?
563,1550615085.8934,Rosaline,there is a lot to unpack there
563,1550615087.8936,Meagan,"<@Kirstin> are you asking how to use CIDER to connect to a remote REPL, or how to setup your project to include nREPL"
563,1550615097.8938,Rosaline,what is a clj/deps instantiated repl?; the clojure.main repl? the socket repl? a nrepl server in your code?
563,1550615142.8955,Kirstin,<@Meagan> the former. I know how to do it generally just not for a repl started via `clj` (with a backing deps.edn)
563,1550615170.8964,Meagan,`M-x cider-connect` or something to that effect
563,1550615172.8969,Kirstin,<@Rosaline> it’s literally what you get if you just run the ‘clj` executable ; I know how to do it on the cider/emacs side. But doesn’t the repl server have to somehow include nrepl?
563,1550615214.8987,Meagan,"oh, okay, so you meant the latter"
563,1550615214.8988,Rosaline,the old nrepl project has a great readme that explains how to embed an nrepl server; the new project has moved it all in to some fancy docs site that doesn't work without javascript; <https://github.com/clojure/tools.nrepl#embedding-nrepl-starting-a-server>
563,1550615313.9003,Kirstin,So no one has made this automatic as it is for Leiningen?
563,1550615314.9004,Rosaline,<https://nrepl.org/nrepl/0.6.0/usage/server.html>
563,1550615337.9006,Becki,"```
    (nrepl-server/start-server :bind ""0.0.0.0"" :port nrepl-port
                               :handler cider-nrepl-handler)
```"
564,1550615357.901,Kirstin,<@Becki> thx! :+1::skin-tone-2:
563,1550615369.9013,Becki,i did this about two hours ago at my new job :slightly_smiling_face:
563,1550615392.9016,Kirstin,Good timing lol
563,1550615425.9018,Madeleine,"`clj -Sdeps '{:deps {nrepl/nrepl {:mvn/version ""0.5.3""}}}' -m nrepl.cmdline`; <https://nrepl.org/nrepl/usage/server.html#_using_clojure_cli_tools>"
563,1550615727.9022,Sixta,"Sorry, my fault! "
563,1550615752.9024,Madeleine,I would actually yes.
563,1550615755.9026,Sixta,"Although I expected antora not to be js dependent, I might report this upstream "
563,1550615796.9028,Madeleine,"Normally my flow is, have issue, ssh to prod host, start a second instance of my app with socket.repl flag. Connect to REPL and debug.; Well, actually, I start a second instance into clojure.main to be more precise. And then I use unRepl to enhance the clojure.main repl to support all kinds of cool features.; That bypasses my server from instantiating, and thus avoids binding to an existing port, as well as make sure it is not serving traffic; I don't think the dependencies are a huge ordeal. But, its a pain point. Especially to newcomers. There's a reason cider-jack-in choose to inject them into lein."
563,1550619455.9045,Kirstin,<@Madeleine> that's what i was looking for. thx!
565,1550619769.9058,Celestine,That (and a whole lot more) is in my `.clojure/deps.edn` file <@Kirstin> <https://github.com/seancorfield/dot-clojure/blob/master/deps.edn#L47> as some inspiration of what you can do with CLI / `deps.edn`
565,1550619825.906,Kirstin,"cool, thx; what does your `clj` invocation to utilize the `main-opts` look like?; is it just: `clj -R:nREPL` ?"
566,1550622910.9066,Celestine,"I pretty much just use `-A` for everything -- so for aliases where I might want just the dependencies sometimes and also the main opts other times, I tend to break them into two aliases. Hence `-A:test:runner` for example, and the ability to combine the REBL aliases with others to add dependencies, start a Socket REPL Server, and so on."
565,1550623890.9074,Kirstin,"Hmm, I’ll have to learn about that. My clj usage is rather shallow at this point "
566,1550627549.9077,Celestine,"Happy to answer any questions -- we switched over from Boot to CLI / `deps.edn` completely last year, after being on Boot for three years (we were on Leiningen for four years before that). Feel free to DM me about it."
565,1550628112.9081,Kirstin,:+1::skin-tone-2:Thanks!
567,1550633765.9099,Nigel,"On a lein of  2.9.0 on Java 1.8 and a cider/nrepl of 0.21, I am unable to ctrl-D to interrupt infinite loops. Anyone else see this? It was perfectly fine until 0.20"
567,1550634316.9103,Becki,can you open an issue with a simple repro? I understood it was supposed to be better in this release; also <#C0617A8PQ|cider> might be a good place to discuss
568,1550638245.9116,Kirsten,How do I provide the missing arg?  `(instance?  ?  (int-array [1 2 3 4 5]))`
568,1550639283.9124,Jasmine,"`(Class/forName ""[I"")`"
567,1550672953.0009,Becki,anyone know of a way to programmatically upgrade lein that skips the confirm? i'm doing `yes | lein upgrade 2.9.0` but i once made a 3GB file this way so i'd prefer a flag if it was available
569,1550677777.002,Darcel,Is there a way to call a static method from native binary compiled via graalvm native-image command?
569,1550678389.0055,Laurene,"Can anybody provide a little assistance please? I have this function
```(defn color
  [r g b]
  (java.awt.Color. r g b))```
that wraps the java.awt.Color constructor.

When I use the function like this `(color 255 255 255)`, this `(java.awt.Color. 255 255 255)` and this `(java.awt.Color. 1.0 1.0 1.0)` it works, but not `(color 1.0 1.0 1.0)`

It throws an exception `IllegalArgument ... No matching ctor found for class java.awt.Color`; But when calling directly the constructor it works, any idea how to deal with it?"
569,1550678463.0073,Marlyn,"turn on reflection warnings and you'll see that your call inside the body of that function is reflective.; you'll need to hint either the args to the function or the args to the constructor (both are not necessary); <https://docs.oracle.com/en/java/javase/11/docs/api/java.desktop/java/awt/Color.html>
there are two constructors and clojure can't tell your intent statically"
569,1550678620.011,Meagan,interesting. how would you make the `color` function polymorphic (like the Java constructor is)?
569,1550678629.0112,Laurene,"I thought I could use the dynamism of clojure to have both constructor wrapped in the same function.
And I thought I can't have multiple definition of the same arity? Like how to differentiate one constructor from the other? (appart from creating two functions); ```(defn color
 ([r g b]
  (java.awt.Color. r g b))
 ([rf gf bf]
   (java.awt.Color. rf gf bf)))
```
I cant do that can I?; nor
```(defn color
  ([^long r ^long g ^long b]
   (java.awt.Color. r g b))
  ([^double rf ^double gf ^double bf]
   (java.awt.Color. rf gf bf)))
```"
569,1550678839.0143,Lemuel,"<@Laurene> no, but you can do (if (double? rf) (java.awt.Color ^double rf ^double gf ^double bf) (java.awt.Color. ^int rf ...))); You are asking Clojure to make a decision at runtime, in any case, but it doesn't know how."
569,1550678884.0155,Laurene,"<@Lemuel> oh I see, doing runtime type checking to select the right constructor; Thanks, didn't thougt about that"
569,1550679002.0165,Lemuel,"<@Darcel> as long as it's not reflective, or you've configured reflection for that class, it should work."
570,1550686486.0193,Laurene,"Hey i'm back with question about wrapping the `java.awt.Color constructor`; ```(defn color
  [r g b]
   (cond
     (instance? java.awt.color.ColorSpace r)
       (let [cspace r
             components g
             alpha b]
         (java.awt.Color. ^java.awt.color.ColorSpace cspace (float-array components) alpha))
     (float? r)
       (java.awt.Color. ^double r ^double g ^double b)
     :default
       (java.awt.Color. ^long r ^long g ^long b))```; In the case with the ColorSpace parameter, I can't make it work as I believe I need to add typehint but I don't know how; I try to use it like this
```
(defn get-components
  ([^java.awt.Color color]
    (vec (.getComponents color nil)))
  ([^java.awt.Color color comp-array]
    (vec (.getComponents color (float-array comp-array))))
  ([^java.awt.Color color cspace comp-array]
    (vec (.getComponents color cspace (float-array comp-array)))))
(def cspace (java.awt.color.ColorSpace/getInstance  java.awt.color.ColorSpace/CS_sRGB))
(construct-color cspace (get-components white) 1.0)
```; and `white` is defined as `(def white  java.awt.Color/white)`; When I try to construt the Color, I het the error:
```(construct-color cspace (get-components white) 1.0)
Execution error (IllegalArgumentException) at joy-of-clojure-exo.clj-awt.color/construct-color (color.clj:61).
No matching ctor found for class java.awt.Color```; It's kind of the same error I got earlier (<https://clojurians.slack.com/archives/C03S1KBA2/p1550678389005500>), and the fix was to add more typehint; Here I add `^java.awt.color.ColorSpace cspace` and I thought it was enough, but apparently not, any idea?"
570,1550686936.0256,Celestine,"`(java.awt.Color. (float r) (float g) (float b))` should work. By default, Clojure uses `Double` and `Long` only (boxed) and you need `float` primitives here."
570,1550687023.0262,Rosaline,"the error mentions construct-color, which you haven't shared the source of; my guess is you switched to calling that function color, and then didn't update the calling code to call color instead of construct-color"
570,1550687073.0273,Laurene,"how sorry I renamed color to construct-color in between..; But the error still stand, but adding the suggestion of seancorfield helps!; wrapping `alpha` in `(float alpha)` resolve the problem"
570,1550687167.0296,Celestine,"`java.awt.Color` has seven constructors and three of them take three arguments so you need to provide assistance so the correct constructor is selected.; In particular `(java.awt.Color. 1 1 1)` and `(java.awt.Color. 1.0 1.0 1.0)` produce completely different colors (the first is very dark gray, the second is white)."
570,1550687317.0315,Laurene,yes eraserhd provided assistance with that <https://clojurians.slack.com/archives/C03S1KBA2/p1550678839014300>
570,1550687324.0318,Celestine,Your Clojure code will need to distinguish between which version you actually need based on something other than just three arguments.
570,1550687385.0328,Laurene,"He told me that I could do a `cond` with typecheking as predicate to differentiate the constructor, and add typehint to help the compiler; the result is as follow
```(defn construct-color
  ""Creates either:
  - (int) an opaque sRGB color with the specified combined RGB value consisting of the red component in bits 16-23,
    the green component in bits 8-15, and the blue component in bits 0-7
  - (int, boolean) an sRGB color with the specified combined RGBA value consisting of the alpha component in bits 24-31,
    the red component in bits 16-23, the green component in bits 8-15, and the blue component in bits 0-7
  - (float, float, float) an opaque sRGB color with the specified red, green, and blue values in the range (0.0 - 1.0)
  - (int, int, int) an opaque sRGB color with the specified red, green, and blue values in the range (0 - 255)
  - (float, float, float, float) an sRGB color with the specified red, green, blue, and alpha values in the range (0.0 - 1.0)
  - (int, int, int, int) an sRGB color with the specified red, green, blue, and alpha values in the range (0 - 255)
  - (ColorSpace, float[], float) a color in the specified ColorSpace with the color components specified in the float array and the specified alpha
  (depending on the number of arguments and their types).""
  ([rgb]
   (java.awt.Color. rgb))
  ([rgba has-alpha]
   (java.awt.Color. rgba has-alpha))
  ([r g b]
   (cond
     (instance? java.awt.color.ColorSpace r)
       (let [cspace r
             components g
             alpha b]
         (java.awt.Color. ^java.awt.color.ColorSpace cspace (float-array components) (float alpha)))
     (float? r)
       (java.awt.Color. ^double r ^double g ^double b)
     :default
       (java.awt.Color. ^long r ^long g ^long b)))
  ([r g b a]
   (if (double? r)
     (java.awt.Color. ^double r ^double g ^double b ^double a)
     (java.awt.Color. ^long r ^long g ^long b ^long a))))```; But i need to remove `^double` and replace them with `(float x)`; Thanks <@Celestine>"
570,1550687546.0345,Marlyn,your function arity that takes `[r g b]` isn't typical; it should be a different function IMHO that takes the colorspace arguments; being extremely forgiving with arguments leads to confusion
570,1550687594.0361,Celestine,I agree. I would use different function names to avoid the ambiguity that Java creates.; The problem you have with the above is if you accidentally call `construct-color` with a mix of `Long` and `Double` arguments now -- you're internally dispatching on only the type of the first argument. So `(construct-color 1 1.0 1)` and `(construct-color 1.0 1 1)` are going to create very different colors...
570,1550688103.0397,Laurene,<@Celestine> and <@Marlyn> so create function with differents name to call the same constructor but with different type?; `(defn construct-float-color [r g b] (java.awt.Color. (float r) (float g) (float b))` and `(defn construct-int-color [r g b] (java.awt.Color. (int r) (int g) (int b))` etc?; Also I have never used `spec` but would it help in that case?
570,1550691985.0427,Celestine,"I would give them better names more aligned with the problem domain but, yes.; I'm not sure about the use of `clojure.spec` here since I don't know much about your problem domain (it's clearly more than just writing a very thin wrapper around a Java API?).; (I would start with looking at how you need to create RGB(A) colors in whatever code you're writing and only create wrapper functions for those -- and even then it might not be worth the effort: it's idiomatic Clojure to just use Java interop directly for a lot of things)"
570,1550692424.0461,Laurene,"Right now it's only wrapping java.awt, then I use it to create images, just a toy project to learn Java interop"
570,1550696989.0492,Celestine,"<@Laurene> I'd probably just `:import (java.awt Color)` and invoke `(Color. ...)` directly as needed rather than trying to wrap it in Clojure functions. There are other things in AWT that would likely benefit from wrapper functions, and probably higher-level abstractions you could build."
571,1550697519.0495,Clarine,How do I use the clojure slim jar in a project? what should my coordinate look like?
571,1550697795.0501,Marlyn,why do you want to use it <@Clarine>?
571,1550697842.0504,Clarine,I want to use a non-directly linked version of clojure to test out some spec stuff.
571,1550698007.0506,Marlyn,"ah; need the `:classifier ""slim""` in lein"
571,1550698190.0518,Jasmine,`org.clojure/clojure$slim` in deps
572,1550699168.052,Clarine,thanks!
573,1550700457.0521,Laurene,"Could you elaborate a bit? I'm still fairly new to both Java (and especially java.awt) and Clojure, and I'd love to learn about Java interop, and writing wrapper while also doing something that could benefits others"
573,1550700627.0526,Sixta,"Has anyone ever run into a case of the global-hierarchy being reset/cleared?; Requiring a namespace which transitively loads a lot of things is causing it, but I can't see any code in my whole jar which calls `underive` or `global-hierarchy`"
571,1550701085.0537,Jasmine,different classloader?
573,1550701398.0543,Sixta,"it's the same repl, so unless my clojure is changing inside the repl, I don't think so"
571,1550701508.0554,Jasmine,just telling you one way that could happen...; the global-hierarchy is a var - you could attach a watcher to it
573,1550701721.0561,Sixta,"I did. All I see is it going clear, not something inserting itself.; I think I have managed to manually whittle it down, with a little luck, the problem was high in the list.; it appears to be something between manifold &amp; core.async; and maybe something else, not sure. blugh."
571,1550702392.0579,Jasmine,are you seeing something weird inside a go block?; did you have your watcher dump its stack when it goes clear?; I think the watchers are fired in same thread doing the alter
573,1550702601.0613,Sixta,"Oh really? I didn't know that, I'll print the stack.

I don't think it's inside a go block, just that requiring manifold.stream in my repl causes the global hierarchy to reset; Although I'm afk now, so it will be some time before I can try the stack thing, but that sounds perfect."
573,1550703093.0625,Rosaline,are you sure you aren't loading clojure.core twice somehow?
571,1550703737.0628,Celestine,"It's hard to be specific for this case, as I'm not familiar with AWT, but in general writing a wrapper that has close to a 1:1 mapping from Clojure functions to Java methods doesn't add much value -- it's just syntactic sugar.; A good example of a higher-level wrapper is Seesaw (a wrapper for Swing). <https://gist.github.com/daveray/1441520>; It tries to map Swing operations to a simple set of primitives with data describing things."
571,1550704041.0634,Laurene,"Thanks I'll take a look at that, thanks very much!"
574,1550723513.0644,Kirsten,is `with-open`  clojure's TWR version?
574,1550724241.0654,Rosaline,"more or less, with-open predates try with resources by some number of years; so with-open predates autocloseable"
575,1550729421.0688,Sixta,"I think that you're right hiredman, doing a require of clojure.core is causing the global hierarchy to reset. I think one of the manifold namespaces aliases clojure.core, so that's why the finger is pointing there.

Why would clojure.core be loaded twice?!"
574,1550730577.0692,Jasmine,shouldn't be; it's loaded on RT initialization and should never be loaded again after that; (unless you're in an isolated classloader chain)
575,1550731450.0714,Sixta,I'm using onejar class loader. So I think I will need to figure out the details.
575,1550731688.0718,Jasmine,that seems like an important detail you omitted :)
575,1550731929.0734,Sixta,"You're right, I was a bit hyper focused on ""require is causing my program to break"" and was a bit lost.; I'm aware of <https://dev.clojure.org/jira/browse/CLJ-971> and I'm setting the factory; But I'm not aware of any other things I need to do for clojure to work with onejar."
575,1550732685.0758,Jasmine,"you could collect info about the classloader chain at points where things look good and bad and compare; the classloader thing is a hypothesis, so try to prove/disprove"
575,1550732881.0776,Sixta,"I have a clojure.main repl in my jar, so this should be easy. How could I collect info about the chain?; The context class loader is the same before and after requiring clojure, for example."
576,1550735841.0784,Wilfred,"The closest I could get to seems to be this: <https://github.com/dakrone/cheshire/issues/62> (mixing stream and laziness is confusing)…; As for the underlying stream itself, look like manifold is a widely supported substrate (you can convert it to other representations, such as core.async, later)… then use the client side of aleph/http-kit to read. (http-kit is old though); (btw… anyone know if there’s activity in this space? my general feeling is that things almost/mostly “work”, but are not as polished as the more mainstream use case)"
575,1550736754.0793,Sixta,"If I turn on verbose logging, I can see it searching for clojure__core when I do require; But I'm a bit confused why it wouldn't be the same as what clojure.main is using, maybe I need to do a custom build of clojure with some logging in.; Into clojure.main/main I added a print of the context class loader, then I compared it to what I have at the repl, exactly the same:

```
#object[com.simontuffs.onejar.JarClassLoader 0x7a79be86 ""com.simontuffs.onejar.JarClassLoader@7a79be86""]
Clojure 1.11.0-master-SNAPSHOT
user=&gt; (.getContextClassLoader (Thread/currentThread))
#object[com.simontuffs.onejar.JarClassLoader 0x7a79be86 ""com.simontuffs.onejar.JarClassLoader@7a79be86""]
user=&gt; 
```; ```
#object[com.simontuffs.onejar.JarClassLoader 0x7a79be86 ""com.simontuffs.onejar.JarClassLoader@7a79be86""]
Clojure 1.11.0-master-SNAPSHOT
user=&gt; (clojure.lang.RT/baseLoader)
#object[clojure.lang.DynamicClassLoader 0xeccaf1b ""clojure.lang.DynamicClassLoader@eccaf1b""]
```

clojure.lang.Compiler/LOADER is bound then, but I don't really know what that means?; (I confirmed the binding); Oh, but that isn't too useful anyway:

```
user=&gt; (.getParent @clojure.lang.Compiler/LOADER)
#object[com.simontuffs.onejar.JarClassLoader 0x7a79be86 ""com.simontuffs.onejar.JarClassLoader@7a79be86""]
```; I'm a bit defeated really, I'm going to need some direction on the clojure internals to puzzle out what's going on here I guess.; I modified doInit so I could check the class loader before `load(""clojure/core"")` is called, and `com.simontuffs.onejar.JarClassLoader@7a79be86` is the classloader there, and `#object[com.simontuffs.onejar.JarClassLoader 0x7a79be86 ""com.simontuffs.onejar.JarClassLoader@7a79be86""]` is the one loaded when clojure.main/repl is running.

I also modified `load` so that I could see which ClassLoader it was using when loading ""clojure/core"", and I got `com.simontuffs.onejar.JarClassLoader@7a79be86`; So class loader doesn't seem likely to me. I can't see where the caching is.; *loaded-libs* doesn't contain clojure.core at the point of me having a REPL...

```
user=&gt; @*1
#{clojure.core.protocols clojure.core.server clojure.core.specs.alpha clojure.edn clojure.instant clojure.java.browse <http://clojure.java.io|clojure.java.io> clojure.java.javadoc clojure.java.shell clojure.main clojure.pprint clojure.repl clojure.spec.alpha clojure.spec.gen.alpha clojure.string clojure.uuid clojure.walk}
```; Looks like clojure.core is never in loaded-libs:

```
❯ clj                    
Clojure 1.10.0
user=&gt; @@#'clojure.core/*loaded-libs*
#{clojure.core.protocols clojure.core.server clojure.edn clojure.instant clojure.java.browse <http://clojure.java.io|clojure.java.io> clojure.java.javadoc clojure.java.shell clojure.main clojure.pprint clojure.repl clojure.spec.alpha clojure.spec.gen.alpha clojure.string clojure.uuid clojure.walk}
```; So, I think I'm onto something here. OneJar always returns ""0"" for the last modified. I have a suspicion this might be because I'm not setting the last modified of the jar itself, and maybe that's what onejar uses.

Anyway, when I use `clj`, this passes as true:

```
	if((classURL != null &amp;&amp;
	    (cljURL == null
	     || lastModified(classURL, classfile) &gt; lastModified(cljURL, scriptfile)))
	   || classURL == null) {
```

However, in my jar lastModified is 0, hence `0 &gt; 0` is false. So we end up going to `	if(!loaded &amp;&amp; cljURL != null) {`  which I'm guessing doesn't look at the same caching path as the first `if` to determine whether the namespace is already loaded or not"
577,1550754239.0826,Jasmine,Isn’t this the same issue as the ticket you linked to earlier?
578,1550758992.0885,Machelle,"Small rant:

I've had the hardest time working with `deps.edn` over the last few days. Nothing to do with the workflow or the principle - it's the tooling that did for me. Was trying to build an uberjar for a Cloud Foundry deploy - this pretty much means that it needs to have AOT compilation and run with `java -jar uberjar.jar`. I tried using `depstar`, `cambada` and `Pack` as listed on the tools page of the deps wiki.

Depstar doesn't support AOT or a manifest file out of the box and I'm nowhere near skilled enough to work out how to add them in. Both `pack` and `cambada` did not stop building the uberjar - literally, both of them filled the disk up and exited them. Thought it might be the code, but then I try `lein uberjar` and it just worked. Really disappointed - kinda think it'd be worth packaging up the leiningen uberjar code as a separate library?

&lt;/moan&gt; Other than that I'm having a lovely day. :smile:"
575,1550759073.0892,Jasmine,someone was just using lein as a library under deps.edn to call lein stuff so that might be a path
578,1550759096.0899,Machelle,"That's what I was thinking - who, where, how?! :smile:"
578,1550759108.0902,Jasmine,having tools be reusable things rather than bound into plugins for a single build tool is generally a great idea imo; <https://github.com/oakes/full-stack-clj-example>
578,1550759165.0914,Machelle,I agree as well - it's _instinctively_ where I want to get to as I've always been put off by Leiningen.; Nice: <https://github.com/oakes/full-stack-clj-example/blob/master/prod.clj>
578,1550759282.0924,Jasmine,that's from <@Josue> if you have questions for him
578,1550759484.0939,Machelle,I like it - makes sense!
578,1550760473.0948,Josue,yep i started using this technique in most of my projects. if you want to use other lein commands you can make a multimethod like this <https://github.com/oakes/Nightlight/blob/master/prod.clj>
578,1550760827.096,Machelle,Have you considered extracting the pattern out into a library after the fashion of `depstar` or `Pack` - or do you consider it too trivial?
578,1550761499.0978,Josue,for me i’d rather use it directly and avoid the layer of indirection. i’m ok with a little code duplication. might be an interesting library idea if others want to try it though
579,1550761508.0981,Marlyn,"it's also really easy to AOT with `depstar`, but it's not ""baked in"""
578,1550761715.0985,Machelle,could you show me an example?; (as I liked `depstar` - in that it actually finished building...)
580,1550767106.1023,Ronald,"Is there a way to create a function literal of a Java function? The following does not work:
```
user=&gt; (def func Integer/parseInt)

Syntax error compiling at (form-init730605430373361324.clj:1:1).
Unable to find static field: parseInt in class java.lang.Integer
```
So I've been playing with making Clojure wrapper functions and using those for higher-order needs. Ex:
```
(def parse-int #(Integer/parseInt %))
```"
580,1550767282.1031,Cherise,"I don’t think there is one because it’s a static method; For instance methods you can use `memfn`; ```(map (memfn charAt i) [""fred"" ""ethel"" ""lucy""] [1 2 3])
;; =&gt; (\r \h \y)```; <https://clojure.org/reference/java_interop#_alternative_macro_syntax>"
580,1550767384.1044,Ronald,"Ah cool, I hadn't seen `memfn`. Thanks!"
580,1550767429.1046,Cherise,Me neither before I tried to answer your question :wink:
580,1550767499.1053,Ronald,I had even made it to that Java Interop page before but must have missed it
580,1550768311.1071,Jasmine,note that memfn introduces reflection so an anonymous literal wrapper is often better
581,1550768352.1077,Ronald,Interesting. Just because of overhead of the reflection?
580,1550768453.1081,Jasmine,"presumably if you are setting this up, you're going to invoke  it more than once"
580,1550768574.1088,Ronald,"I just didn't know that reflection was costly enough to make a difference. But on looking it up, it does appear to be very very slow"
580,1550768792.1094,Jasmine,"if you're calling it once, you probably don't care, but if you're calling it a lot, you will"
580,1550768905.1097,Ronald,"Got it, thanks"
580,1550769384.1104,Marlyn,"memfn can take a hint on the symbol and avoid reflection, no?; No one uses memfn in the wild"
582,1550772917.1115,Nigel,Any test runners that can spit out JSON?
580,1550775268.1121,Sixta,memfn is something I used a lot to implement a datafy thing.
583,1550776197.1184,Wesley,"<@Celestine> or anyone: `tools.cli` will parse e.g. `-for` as `-f -o -r`.  Is there a way to turn this functionality off?  I personally like this GNU behavior, with double-dash for verbose options, but there's also Java convention that uses single-dash for multi-character options.  I'm using a Java lib that does that.  I use `tools.cli` for the options that my code provides, but I don't want to reinvent the wheel for the options that the library provides.  However, this means that if I use `tools.cli` to find errors using `parse-opts`, my code has to distinguish between real errors in option specification on the command line, as opposed to ""errors"" due to `cli/parse-opts` thinking that the user has provided `-f -o -r`.  I am trying to add code to filter out the Java lib options, but without turning off the single-dash/multi-character expansion, it's very difficult.  (I'm also trying not to simply reinvent tools.cli's parsing.)  Thanks-; Or maybe I should look more closely at the tools.cli innards and maybe I can build something from the functions there...."
583,1550776443.1204,Celestine,<@Wesley> I'm not sure that you could support both styles of options -- it would be ambiguous -- and this is a change that was made explicitly in `tools.cli` to support GNU-style options (prior to me taking the library over).
583,1550776494.1214,Tammera,many linux utils take multiple “flags” together
583,1550776498.1218,Celestine,So I think my position here is that `tools.cli` supports the GNU behavior by design and will not support the Java convention.
583,1550776501.122,Tammera,"for example `tar  -xvf`; really, Java is the oddball here"
583,1550776524.1228,Celestine,"Yes, that's the ""standard"" GNU/*nix behavior.; I agree. And `tools.cli` was changed deliberately in the past to the GNU/*nix behavior :slightly_smiling_face:"
583,1550776598.1243,Wesley,"Right, one couldn't support both in the same application.  But you could have a flag that turns the single-dash/multichar behavior on and off.  But I (doh!) just realized that I can address my problem pretty simply by just requiring that the Java lib options be put after `--` to stop option processing by `tools.cli`.  The lib ignores `--`."
583,1550776642.1254,Celestine,"Ah, OK. So this was just a case where you need to pass _additional command-line options_ directly to an embedded library? I missed that."
583,1550776646.1255,Wesley,The rationale for turning it off would specifically be compatibility with Java conventions.  But maybe it's not worth the trouble.
583,1550776668.126,Tammera,"is there a story here btw, Unixes were widespread when Java came about right"
583,1550776680.1265,Wesley,"Oh, sorry.  I didn't explain clearly enough then.  Yes, the library also sees the command line, and ignores options it doesn't know, but processes the ones it does know.; Maybe it will only be a real problem if the `--` trick isn't enough for a situation."
583,1550776929.1278,Celestine,I wouldn't expect command-line parsing libraries to be very composable if they're both parsing the same command-line data :slightly_smiling_face:
583,1550777058.1292,Wesley,"Yah, I know.  It actually works just fine in this case, as long as you ignore misspelled options and that sort of thing.  And I have been misspelling them lately, and then thinking I have a bug. :slightly_smiling_face:"
583,1550777093.1297,Celestine,This seems to delve into the Java vs GNU argument parsing differences <https://softwareengineering.stackexchange.com/questions/70357/command-line-options-style-posix-or-what>
583,1550777250.1314,Tammera,Your google fu is better than mine!
583,1550777262.1317,Wesley,Thanks.  That's helpful to read.  I may think about it further and come back with some ideas for tools.cli down the road if I think there's something worth doing that's potentially worth the trouble.  Obviously an isolated use case isn't worth trouble.
583,1550777268.1318,Tammera,or better filter bubble :stuck_out_tongue:
583,1550777357.133,Wesley,I think this application is unusual in other ways too.; Yeah.  Well it helps to know that Java is following Posix.  I didn't realize that.; Oh no that's wrong.
583,1550777608.1335,Tammera,"yeah, X11 style :stuck_out_tongue:"
583,1550777966.1337,Celestine,My _Bing_ fu :slightly_smiling_face:; I haven't used Google for years.
583,1550778260.1341,Tammera,‘google fu’ as in ‘velcro’ :wink:.
584,1550782290.1369,Madeleine,"Quick question about gen-class. The :name value in the doc says it has to be a `package-qualified name of the class to be generated`. Which I assume means it is not a Clojure namespace name, but a Java one. Which means, since that it should not contain hyphens, but underscores instead, since Java doesn't allow for hyphens. Now, here's the thing, it seems that if you put hyphens, it will work, and generate a file with hyphens in the folder and classname, and somehow, that will work from Java as well. What's happening here?; For example, the following:
```
(:gen-class :name screening.whirlpool.update-investigation-poller.Main)
```

Will generate the directories: `screening/whirlpool/update-investigation-poller/Main`

And the Main class generated has as its package name: `screening.whirlpool.update-investigation-poller`

But it does: `Util.loadWithClass(""screening/whirlpool/poller/update_investigation_poller"", Main.class);` in its static initializer.

Yet, somehow, I can use that class fine form Java."
583,1550783449.1393,Dann,"that looks like something accidentally working, at first glance"
583,1550784491.1411,Tammera,"I am trying to check whether some val that implements a protocol via metadata `(satisfies? ...)` that protocol. That sadly doesnt work. then I found <https://dev.clojure.org/jira/browse/CLJ-2426>, and I tried inlining that proposed `satisfies?` function in my code, but also no success.; None"
583,1550784663.1423,Marlyn,"the most straightforward solution is to check for the symbol inside the meta, as it does around line 9"
583,1550784709.143,Tammera,"sorry, which symbol, there are only function names in the meta?"
583,1550784726.1435,Marlyn,"no they're literal symbols inserted -- see line 21; ```
`bla-bla == test/bla-bla
```; the function is checking for the existing of the correct symbol within the metadata, on Line 10; I don't think using `satisfies?` is a good idea _in general_; it runs counterproductive with polymorphism; the whole point of protocols is not to care about doing type-tests; _in general_"
583,1550784838.147,Tammera,"Right, but `(symbol (:var proto))` is `test/BlaFactory`, thats not `test/bla-bla` right?"
583,1550784863.1477,Marlyn,"I didn't read the details, but check for the name of the protocol function, not the protocol var"
583,1550785010.1479,Tammera,"I dont use it as a type test, I use it in s/fdef’s to do some rudimentary argument checking in development. Maybe not the best usecase, but it has found some bugs for me ^^; hmm I’ll try that. Thanks as always!"
585,1550787156.1532,Lesa,"Hi all - I have a `spec` question. I'm writing a spec describing some JSON that is getting posted to one of our endpoints (which we do not have control over, it is a callback from another system). The callback can be in one of two shapes, depending on if the operation was successful or not. So I have my spec looking essentially like `(s/def ::callback-post (s/or :success ::success-spec :failure ::failure-spec))`. All that is fine and dandy - what I am stuck on, is that the callback has a `success` flag, which will be either `true` or `false`, and I'm not sure of the best way to represent that within the `::success-spec` and `::failure-spec` specs; I have a higher level `(s/def ::success (s/org :true true? :false false?))` spec, but without using some manual namespacing I'm not sure how best to specify within the `::success-spec` that `::success` ought to be only `true`"
585,1550787320.1553,Tammera,"First of all, `(s/def ::success boolean?)` ^^"
585,1550787347.1555,Lesa,"yup, that's a :picard-facepalm:"
585,1550787382.1557,Dulcie,"Multi-spec?; <https://clojure.org/guides/spec#_multi_spec>; ... where the success field indicates the ""type"", and hence which spec to use"
585,1550787547.1564,Lesa,"yeah, that looks like it could be the answer, thanks :slightly_smiling_face: I hadn't come across `multi-spec` before"
585,1550787576.1566,Dulcie,You're the second person I've suggested it to this week. I'm a big fan of it!
585,1550787606.1568,Tammera,"I used it to do payload validation before, mighty useful"
585,1550787636.157,Dulcie,"I posted this in <#C1B1BB2Q3|clojure-spec>, it might be useful as an example; ```
(s/def ::email string?)
(s/def ::username number?)
(s/def ::request-type #{:change-email :show-username})

(s/def ::change-email-request (s/keys :req [::email] :opt [::username]))
(s/def ::show-username-request (s/keys :req [::username] :opt [::email]))


(defmulti request-type ::request-type)
(defmethod request-type :change-email [_] ::change-email-request)
(defmethod request-type :show-username [_] ::show-username-request)

(s/def ::body-params (s/multi-spec request-type ::request-type))

(s/valid? ::body-params {::request-type :change-email ::email ""boop""})
=&gt; true
(s/valid? ::body-params {::request-type :change-email ::username 1234})
=&gt; false
(s/valid? ::body-params {::request-type :show-username ::email ""boop""})
=&gt; false
(s/valid? ::body-params {::request-type :show-username ::username 1234})
=&gt; true
```"
585,1550787824.159,Lesa,"thanks, I was just doing a little headscratching over the docs"
585,1550787840.1595,Jonas,"I'm looking for a way to mock out a `defrecord` that implements several protocols. empty implementations that just return nil are fine for most functions; a few others need to be replaced with code I will supply. <https://github.com/alexanderjamesking/spy> has `protocol/spy` but that only seems to work for one protocol. (though its code looks like it could handle more? maybe I should patch it); is there an alternative library, or am I misapprehending something?"
586,1550788935.1602,Cherise,Interesting. Thanks
585,1550789055.1609,Dann,<@Jonas> what's the use value for a stubbed method with no real logic vs. not implementing the method at all?
586,1550789088.1618,Dann,because clojure is happy to let you define only the methods you care about and throw an error at runtime if others are called
585,1550789133.1628,Jonas,"no particular reason, then. in this case, I need three functions that are split across two protocols; nothing else is called anyway."
585,1550789871.163,Lesa,"Thanks, that did the trick :slightly_smiling_face: Hopefully spec2 makes this kind of thing a little more straightforward"
585,1550790091.1632,Dulcie,:thumbsup: you're welcome!
587,1550790559.1639,Jasmine,`boolean?`
586,1550797010.1641,Lesa,"Yup, that was one adjustment, though the major problem (choosing a spec based on the value of that boolean) was solved using `multi-spec` on suggestion from butterguns"
588,1550804770.1665,Keenan,"If I have an arbitary number of functions I want to run just for effects, is there a handy function for that?

So rather than

```
(do
  (f1)
  (f2)
  (f3))
```

just

`(dofn f1 f2 f3)`"
588,1550805183.1671,Wesley,<@Keenan> look at `run!` and `juxt`.
588,1550805235.1674,Keenan,Will do <@Wesley> -- thank you
588,1550805432.168,Wesley,"With `run!` you'd have to do something like this: `(run! (fn [f] (f)) [(fn [] (println ""yo"")) (fn [] (println ""ya""))])`.  `juxt` is probably better for what you want."
589,1550834260.169,Machelle,"So... anyone seen this before?
```
Exception in thread ""main"" java.lang.ClassCastException: cm_metrics.main$_main$fn__8935 cannot be cast to java.base/java.lang.Thread
	at cm_metrics.main$_main.invokeStatic(main.clj:30)
	at cm_metrics.main$_main.doInvoke(main.clj:21)
	at clojure.lang.RestFn.invoke(RestFn.java:397)
	at clojure.lang.AFn.applyToHelper(AFn.java:152)
	at clojure.lang.RestFn.applyTo(RestFn.java:132)
	at cm_metrics.main.main(Unknown Source)
```; it's from an uberjar; happens when the `-main` function calls `(Runtime/getRuntime)` (I think)"
589,1550842253.1726,Josue,"<@Machelle> i dont know what your code looks like but i’m guessing you’re trying to add a shutdown hook? if so, the addShutdownHook method wants a Thread object not a function: `(Thread. (fn [] ...))`"
589,1550842275.173,Machelle,You're obviously a mind reader :smile:; Thanks!
589,1550842328.1734,Josue,haha np
590,1550844682.1776,Isidro,I'm trying to get a clojure cli tool I wrote a while back to compile and run under java 6. So far I've downgraded leiningen and the clojure version and I'm now in the process of trying to find a permutation of the dependencies which would actually compile under java 6 (currently playing with tools.cli) . Just figured I would ping this channel to see if this is even worth it...i.e. is this doomed to fail from start or is there a chance this might actually work in the end?
590,1550844842.178,Jasmine,why?
590,1550844881.1788,Isidro,<@Jasmine> I'm trying to get the tool to run in a controlled server environment which only has java 6
590,1550845273.1828,Kyong,"Has anyone used a recent core.memoize with a cache backend out of process (like leveldb or redis where you need to serialize the objects)? Since I last used it, it seems to make heavier use of custom delay objects and I wondered if anyone else has encountered issues"
590,1550845319.1834,Jasmine,<@Isidro> that's what I was asking. I don't think it's hopeless (but might not be fun)
590,1550845375.1843,Isidro,"<@Jasmine> ok thanks! ...yeah, not fun which is why I figured I would ask first before banging my head against the wall"
591,1550853705.1872,Leeann,"On a phone, so not tested, but (apply reduce (fn [_ f] (f)) f1 f2 f3); Should probably work. "
592,1550854044.1883,Onita,"hey everyone, this might be more of a java question but i’m looking to store a hex number, for example 1ff as a byte-array"
591,1550854056.1887,Onita,"namely, 0x00 0x01 0xFF; casting to and from bigintegers results in truncating the 1, and i’m not quite sure how to get around that"
592,1550854092.1897,Onita,any ideas?
591,1550854152.19,Onita,i guess the super hacky route would be to mod the number of hex characters against 8 and supplement zeroes..
591,1550854672.191,Jasmine,you might look at java.util.BitSet; not sure if it's exactly what you want as an api but prob good code to build on
592,1550855164.1917,Onita,"cool, i’ll have a look - thanks"
592,1550855495.1924,Rosaline,"0x00 0x01 0xFF isn't a ""hex number"" it is 3 bytes, so when you try to store it as 1 byte it is truncated to 0xff; 3 bytes is kind of an odd size to work with, usually it will be some power of two, 2 or 4 would fit, and match the sizes of some primitives on the jvm (short and int); are you sure this isn't just a signedness thing tripping you up?"
592,1550855810.1957,Dann,if you want  a byte array with the contents describing some Long / Int / whatever you can use ByteBuffer <https://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html#putInt(int)>
592,1550855862.1966,Rosaline,"bigintegers will add an extra byte to track the sign sometimes, where if you are mostly concerned with bytes but sometimes with numbers you often want to assume unsigned and not have the extra byte"
592,1550855971.1968,Dann,"```(cmd)user=&gt; (def bb (ByteBuffer/allocate 16))
#'user/bb
(ins)user=&gt; (seq (.array bb))
(0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0)
(ins)user=&gt; (.putLong bb 42)
#object[java.nio.HeapByteBuffer 0x640f11a1 ""java.nio.HeapByteBuffer[pos=8 lim=16 cap=16]""]
(cmd)user=&gt; (seq (.array bb))
(0 0 0 0 0 0 0 42 0 0 0 0 0 0 0 0)
(ins)user=&gt; (.putLong bb Long/MAX_VALUE)
#object[java.nio.HeapByteBuffer 0x640f11a1 ""java.nio.HeapByteBuffer[pos=16 lim=16 cap=16]""]
(cmd)user=&gt; (seq (.array bb))
(0 0 0 0 0 0 0 42 127 -1 -1 -1 -1 -1 -1 -1)
```; this is the most straightforward way I've found for converting between the internal representation of primitive types and the actual values (for every putFoo method there's a getFoo method); <@Onita> were you trying to use the toByteArray method? <https://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html#toByteArray()>"
592,1550856353.1985,Onita,i was using clojure’s byte-array
592,1550856407.199,Dann,so what was your actual task? turn a byte array into a number?
592,1550856427.1994,Onita,"no, i was trying to store a series of bits that may or may not fit neatly into bytes in a byte array; so, right, it wasn’t really a ‘hex number’, i was using hex to specify a series of bits"
592,1550856450.2002,Dann,"OK - you can write bits (or any other type of course...) one by one with ByteBuffer, then read out whatever types you like"
592,1550856466.2007,Rosaline,putShort on a bytebuffer is almost certainly what you want
592,1550856645.202,Onita,"yeah, i hadn’t thought about that; i’ll dig into it and see what i can do. thanks guys, appreciate the help"
593,1550864358.2031,Dulcie,"Why isn't `group-by` ""transducable""? Is it because it needs to scan the entire coll?"
593,1550864640.204,Rosaline,"group-by is itself a reduce, not a transformation of a step function; you can do something similar as a transformation of a step function if you have input sorted by your grouping key and a transducer version of partition-by"
593,1550864846.2053,Jasmine,"it can't produce any intermediate results, so not really any point"
593,1550864920.2061,Dulcie,"OK, so my group-by is in the middle of a long chain of transformations; my only option, it seems, is to have 2 transducers"
593,1550865013.2077,Dann,"I could imagine a hypothetical case where a groups-by function might be useful, and that could be a transducer (reductions : reduce :: groups-by : group-by); reductions gives a lazy seq of all accumulator values for a given reducing function and input, so groups-by could give all the intermediate groups as you consume inputs - but there's few places that would be useful, if any"
593,1550865140.2093,Jasmine,have you considered what it means to  have a group-by in the middle of a long chain  of  transformations?
593,1550865194.2105,Rosaline,<https://github.com/aphyr/tesser> has a group-by operation with slightly different semantics that is very interesting; it basically splits the step function to separate reduction steps for each group
593,1550865333.2117,Dann,None
593,1550865364.2123,Dulcie,"<@Jasmine> My feeling is that it's not a single sequence of transformations. Rather, two, unrelated map-reduce piplines; <@Rosaline> Thanks. My understanding of how transducers work is still very basic, so I'll have to read more about this"
593,1550865402.2133,Jasmine,that seems healthy :)
593,1550865469.2145,Rosaline,"tesser has a slightly different model of folds then transducers does, but is very useful for inspiration, and speaking of map/reduce tesser can run the folds as hadoop jobs; ```
(defn groupy-by-transducer [key-fun]
  (fn [f]
    (fn
      ([] (f))
      ([x] (into {} (map (fn [[k v]] [k (f v)])) x))
      ([accum value]
       (let [k (key-fun value)]
         (assoc accum k (f (get accum k (f)) value)))))))

(transduce
 (comp
  (groupy-by-transducer :type)
  (map :mass))
 +
 {}
 [{:name :electron, :type :lepton, :mass 0.51}
  {:name :muon,     :type :lepton, :mass 105.65}
  {:name :up,       :type :quark,  :mass 1.5}
  {:name :down,     :type :quark,  :mass 3.5}])

;;=&gt; {:lepton 106.16000000000001, :quark 5.0}
```; that kind of works, but I think it might run afoul of the internal mutations that some transducers do"
594,1550871218.2162,Sage,"I'm trying to add metadata to a function, but it's annoying because it erases the function name in the print-out:
```
binja.util&gt; (fn hey ([x] x))
#function[binja.util/eval9096/hey--9097]
binja.util&gt; (with-meta (fn hey ([x] x)) {:x ""x""})
#function[clojure.lang.AFunction/1]
```; does anyone know how I can add meta data without erasing the name?"
594,1550871523.2167,Rosaline,you can't; I recommend not putting metadata on functions because they have reference equality but value metadata
594,1550871731.2186,Sage,"can't it be done ""under the hood"" somehow?"
594,1550871780.2193,Dann,"you can implement IFn / IMeta and have any toString you like via reify, deftype, whatever; or fork clojure, but implementing IFn and IMeta is a lot less work"
594,1550871919.2201,Rosaline,it cannot; what is printed there is the jvm type of the object; adding metadata to a function results in wrapping it with an instance of another function with that metadata; which is part of why `(= x (with-meta x {}))` which holds true for other types with-meta works on fails for functions
594,1550872157.2229,Sage,"hmm well that's disappointing. maybe i can figure out how to store the metadata inside the function and fetch it somehow when I need it; it won't be very ""meta"" then"
594,1550872455.2239,Dann,"```cmd)user=&gt; (def f (reify clojure.lang.IFn (invoke [this] :a) (applyTo [this _] :b) Object (toString [this] ""f"")))
#'user/f
(ins)user=&gt; (def g (with-meta f {:foo :bar}))
#'user/g
(ins)user=&gt; (meta g)
{:foo :bar}
(ins)user=&gt; (meta f)
{:line 53, :column 8}
(ins)user=&gt; (f)
:a
(ins)user=&gt; (g)
:a
(ins)user=&gt; [f, g]
[#object[user$reify__233 0x36676c1a ""f""] #object[user$reify__233 0x5b408dc3 ""f""]]
```; (reify is already IMeta so no need to implement)"
594,1550872893.2256,Sage,"thanks <@Dann>! But I mostly need it for stack trace errors so it needs to show up as a function, not just a reify"
594,1550872908.2261,Rosaline,"the original function will show up in the stacktrace; because the wrapper just calls it; but, again, metadata on functions is kind of silly, metadata is more or less extra data you want to attach to an object without changing the equality of that object; but I doubt you are comparing equality on a functions; so use a map"
594,1550873019.2289,Sage,"```
b.util &gt; (def f (reify clojure.lang.IFn (invoke [this] :a) (applyTo [this _] :b) Object (toString [this] ""f"")))
#'b.util/f
b.util&gt; (f 3)
Execution error (AbstractMethodError) at b.util/eval9131 (form-init14739800243932352027.clj:2461).
Receiver class b.util$reify__9129 does not define or inherit an implementation of the resolved method abstract invoke(Ljava/lang/Object;)Ljava/lang/Object; of interface clojure.lang.IFn.
```"
594,1550873032.2293,Rosaline,{:my other-data :f some-function}
594,1550873038.2295,Dann,you need to define the arity you call; you only defined the 0 arg ~applyto~ *invoke*
594,1550873075.2305,Rosaline,just don't put metadata on functions
594,1550873105.2311,Sage,"well i'm storing the type information of the args and return value for a function, which I can check with a spec, so I just need some way to get that out of a function. i could hide it in the function so if you call it with the magic incantation it returns the type; but the only arity I consistently have available is zero args, so I could have that return the type information, but that will result in sloppy errors; Oooh I see what you were saying @hireman. My function names do show up in the stack trace, just not when i print out the function. that'll work!"
595,1550925685.2345,Henry,Is there a predicate to check for a multimethod? Something like `fn?` (which returns false for multimethods)
596,1550926913.2366,Mira,"Hi can you guys recommend a good open source *application* code to read? especially in the context of slightly more intermediate/advanced, clojure techniques i.e. transducers, use of spec, use of namespace-qualified keywords etc., cheers!"
597,1550932783.2379,Lemuel,"well, there’s `methods`, but I’m not sure what happens when you call it on a non-multimethod "
597,1550932873.2382,Emilia,"I need a dynamically sized collection of agents, but the size of that collection will be managed by another agent (changes to the size of the collection will be significantly less frequent than changes to the underlying agents).  Is nesting agents in this case appropriate, or am I missing a better way to structure this?  eg. (def things (agent {:thing1 (agent 1) :thing2 (agent 1)})) , then (send (:thing1 @things) inc), and (send things assoc :thing3 (agent 1))"
598,1550933195.2387,Sterling,"hi, it seems to me it's not possible to specify a *mandatory* option for toosl.cli"
597,1550933253.2393,Sterling,"the only thing i can do so far is to:    :default-fn #(if (nil? (:id %))
                   (throw (IllegalArgumentException. ""--id is mandatory""))
                   %)"
598,1550934148.2406,Epifania,"Trying to spin up a old (eh, ~two months) project of mine, and when running `lein ring server-headless`, I get the following endlessly long stack trace: <https://gist.github.com/victorb/81eb2afacce8ca8d1731f399bbeb34d0>
As far as I can tell, the error is not related to my code, as it's not part of the stack trace. But I'm unable to find any entrypoint or obvious place to start looking for issues. Could someone provide some pointers?"
598,1550934629.2427,Jessia,I think options are always optional unless you do something like that. Use arguments for mandatory arguments. Sorry that sounds a bit tautological. 
598,1550934880.243,Vita,"Looks like it’s probably related to an old version of clojure.core/unify that does something incompatible with clojure 1.10 / spec. It looks like Alex probably fixed that here: <https://github.com/clojure/core.unify/commit/a5f60d74e1df61291535be43dab7bd2f2eaceb32> and that you could resolve it by explicitly declaring a version of `[org.clojure/core.unify ""0.5.7""]`"
598,1550934916.2432,Epifania,"Huh, that's super helpful! Thanks a lot for taking a look and even coming up with a solution :thumbsup:; Hm, doesn't seem to resolve the issue though. Specifiying it in my `project.clj` still has the same error. Also worth mentioning, I'm on clojure 1.10.0, and `0.5.7` of core.unify seems to have been released 2016.07.25 so I expected it to be used already"
598,1550935150.2437,Vita,"There’s not a predicate in core afaik because Clojure chooses to treat them transparently the same as functions everywhere and discourages doing otherwise. However, you could always do something like `(instance? MultiFn thing)`"
598,1550935153.2439,Fatima,"Are you using cider? If so, update to latest version."
598,1550935191.2441,Epifania,"nope, no cider. `lein ancient` also tells me `all artifacts are up-to-date` so everything is updated"
598,1550935213.2443,Fatima,How about updating lein itself?
598,1550935215.2445,Vita,do you have a ~/.lein/profiles.clj that might be interfering ?; or that ^ :stuck_out_tongue:
598,1550935229.2449,Fatima,I remember bumping into that same stack trace but updating all deps resolved it.
598,1550935234.2451,Epifania,"already on latest lein. Thanks for the `profiles.clj`, will check that out; hm, no luck, commented out everything in profiles.clj, ran `lein clean` and still same error; gonna try downgrading lein instead, have solved issues in the past"
598,1550935365.2457,Vita,i still think you have an old version of unify on the classpath. just a question of how it’s getting there
598,1550935365.2459,Fatima,Mmm lein plugins in `project.clj`? Especially `lein-ring`; <https://github.com/weavejester/lein-ring/commit/b787f66a70993b52487fcafcc906e3875b4726ac>
598,1550935410.2463,Epifania,"<@Vita> seems so. `lein deps :tree` does not list unify anywhere, but guess it's possible it's embedded somewhere somehow; <@Fatima> yeah, had three plugins there but commented them away; yeah! Thanks <@Fatima>! Upgrading lein-ring solved the issue!; My assumption that `lein ancient` upgrades everything was wrong, as it doesn't update plugins (by default at least); the Clojure community continues to surprise me with it's helpfulness! You're all awesome folks! :beach_with_umbrella:; thanks a lot for helping me tracking it down"
598,1550935592.2478,Fatima,No problemo!
598,1550935630.248,Vita,np!
598,1550938637.2493,Evangeline,Is there a designated channel <@Jasmine> posts his weekly update blog post link on? I can never find it reliably. 
599,1550938700.25,Evangeline,Ps. Those posts are great. 
599,1550939185.2501,Henry,"If they were treated the same, then I'd expect `fn?` to return true for them, that would work for me as well :slightly_smiling_face: I just want to distinguish non-function values (including collections) from functions. Thanks for the ideas, the instance check seems like a good way."
599,1550939944.2506,Becki,i've seen them reliably show up on reddit
599,1550940102.2517,Alfonso,And in the reddit thread today it was mentioned he is posting about them on a zulip stream: <https://clojurians.zulipchat.com/#narrow/stream/187050-inside-clojure-journals>  I haven't quite wrapped my head around this zulip thing yet myself
598,1550940570.2526,Jasmine,I have been posting on reddit and now on Zulip and erratically here :)
600,1550946599.2544,Rolanda,"I have started subscribing to RSS feeds again, mostly to keep up with interesting Clojure news. <https://feedly.com> seems to be a good choice for me."
601,1550949557.2555,Matha,"Is there a format to give examples in docstrings/elsewhere for (pure) clojure functions that can then be exploited by other tools? (e.g. to check the examples, etc); Also, another question: in my current project I find myself wanted to use maps with namespaced keywords over records because they have a lot of very nice properties (play well with specs, serialise well, are extendable, etc), but I really, really miss having something like protocols. Is there anyway to get the best of both worlds?"
598,1550951326.2572,Jasmine,have you experimented with multimethods?
601,1550951375.258,Matha,"<@Jasmine> it depends what you mean by experimented. I am aware of them and have used multimethods in a few places, but I wouldn’t say I have a good intuition on how they can be used to address a variety of problems; for example, I have a datastructure in my application that is essentially a tree. If I implemented it using a record I would make it extend a “ITree” protocol (or similar) and define some standard tree functions on it, but because I am using maps it seems like I am forced to define all those tree functions specifically for that datastructure"
601,1550951477.2598,Roslyn,With clojure 1.10 you have `:extend-via-metadata` on protocols so plain maps can implement protocols using meta
601,1550951490.2601,Matha,holy moly really?
601,1550951492.2603,Jasmine,^^ although there are some caveats; <https://clojure.org/reference/protocols#_extend_via_metadata>
601,1550951519.2608,Matha,what are the caveats <@Jasmine>?
601,1550951536.2613,Jasmine,`satisfies?` doesn't work with it (although generally you should steer away from that anyways); and they are slower than record protocol impls although how much that matters to you will depend
601,1550951619.263,Matha,"out of curiosity do you (<@Jasmine> and others) shy away from using records for application code? I know they’re used for clojure core / libairies (e.g. seq, etc), but their incompatibility with specs seem.. discouraged; slower doesn’t matter at all to me; and Clojure seems to be very much the spirit of using attribute granularity (as illustrated by spec using namespaced keywords, etc), which records are not; sorry not protocols; records*; and if you use protocols, do you use them with maps?"
601,1550951811.265,Jasmine,"I'd say records are good in their niche, but that niche is relatively small; definitely use protocols, but don't extend to generic map type"
601,1550951892.2659,Matha,to generic map type?
601,1550951907.2663,Jasmine,I don't typically use protocols with maps
601,1550951954.2669,Matha,"hmm, and so do you not define generic functions on map? e.g. using generic tree functions on a map that represents some kind of tree; (e.g. map, fold, etc)"
602,1550953340.2674,Kirsten,"In clojure applied, examples use records instead of maps :stuck_out_tongue_winking_eye:; but I'm still in the first chapter"
602,1550953490.268,Jasmine,"I don't typically have those kinds of data structures; but usually stuff like `tree-seq` or `clojure.walk/postwalk` are useful with trees; yeah, I wrote it :); a second edition would probably be different"
602,1550953817.2693,Kirsten,"yep, hence my curiousness, your comment here vs the book"
603,1550985993.2709,Nigel,This issue with the REPL not breaking on Ctrl-C/Ctrl-D while evaluating an infinite lazy sequence is sort of getting in my way.
604,1550986211.2711,Becki,which repl?
604,1550986463.2715,Rosaline,(my guess is it isn't evaluating but printing)
604,1550987198.2721,Nigel,<@Becki> off my `lein repl` which is the default. So repl-y I guess?; <@Rosaline> - possible.
604,1550987419.2735,Becki,`lein repl` and i evaluated `(range)` and it just sat there and spun. it obeyed a control c and gave me the prompt back. `(prn (range))` and it was time to kill :slightly_smiling_face:; check `(set! *print-length* 100)` and then try `(prn (range 1e5))`
604,1550987578.2748,Nigel,"<@Becki> thanks. That certainly helps; Is there a good use case for `with-redefs`; in actual code that is, not tests.; ```
(defmulti foo class)
(defmethod foo ::collection [c] :a-collection)
(defmethod foo String [s] :a-string)
```; that’s an example given on the Clojure site; It says that if I execute a `(foo [])` then I ought to get `:a-collection`; Earlier on it derived a bunch of things from :a-collection; Ah, ignore. I did something wrong; <@Becki> The repl thing works when its just a print, but here’s where it breaks `(drop-while (partial &lt;= 0) (range))`; And I distinctly remember that working earlier"
605,1550991811.2852,Domingo,"Hi, everyone
I was wondering If I could write a macro to turn a map into a function defintion that resolves the keys in that map into its corresponding value using case form ... but couldnt quite get it right. (This is as far as I got ....)
How is it possible (or am I getting something terribly wrong ?)"
604,1550994382.2864,Latonya,"Not sure if you were aware, but you can ""call"" a map value in Clojure, like a function, passing a first argument that is some value, and it will look up that value in the map, and return the corresponding value, e.g. ```user=&gt; (def my-map {:a 1 :b -2 ""c"" 42})
#'user/my-map
user=&gt; (my-map ""c"")
42
```"
605,1550995300.2865,Domingo,"Thanks, but yeah I knew.; But the question of how to turn into a case statement using macros was just teasing me"
606,1551018489.292,Angele,"Hi everyone,
I’m working on gRPC server running in Clojure.
This is an example of simple method creating server:
```
(defn build-server [config info-service]
  (let [port (:port config)
        server (-&gt; (ServerBuilder/forPort port)
                   (.addService ^BindableService info-service)
                   (.build)
                   (.start))]
    (println ""gRPC server started listening on port"" port)
    server))
```
In the snippet below I’m trying to pass to the server a vector of handlers and add them to the server sequently.
```
(defn build-server [config handlers]
  (let [port (:port config)
        server (-&gt; (ServerBuilder/forPort port)
                   (as-&gt; builder
                         (do (doseq [h handlers]
                               (.addService builder ^BindableService h))
                             builder))
                   (.build)
                   (.start))]
    (println ""gRPC server started listening on port"" port)
    server))
```
The thing is that the piece
```
(as-&gt; builder
      (do (doseq [h handlers]
            (.addService builder ^BindableService h))
          builder))
```
doesn’t look elegant. I have briefly a few months of experience with Clojure and I feel there might be some handy macro or practice I’m missing."
606,1551018802.2922,Jasmine,"check out `doto`; all this looks fine to me btw, but doto can help when doing a lot of java factory stuff"
606,1551019916.2942,Angele,"Thanks <@Jasmine>, I know `doto` but in this piece is not going to help very much as I can’t use it with doseq. If there were a doseq returning a result of last execution :thinking_face:"
607,1551022340.2966,Dreama,"Howdy,  I am trying to send a pdf ( as ByteArrayOutputStream )  back to front end in the body of the http response. In our middle wear stack &gt;&gt; Transit &lt;&lt;  is barfing on that ( NullPointer )     so I am wondering if there is something I am missing.  Do i have to make custom handler for transit or something?; my response looks like this  {:status 200 :body pdf-output-stream :headers {""Content-Type"" content-type}}; where pdf-output-stream is the byte array output stream"
608,1551026043.2991,Matha,What would be an idiomatic way to return the keys of a map for which the values match some predicate?; e.g. `(map first (filter #(predicate? %2) my-map))`; is there a more idiomatic way?
608,1551026217.3004,Becki,return the keys or key/value pairs?
608,1551026225.3005,April,(for [[k v] my-map :when (p? v)] k) ??
608,1551026240.301,Matha,<@Becki> keys only
608,1551026248.3012,Becki,`(filter predicate? (keys my-map))`?
608,1551026264.3013,Matha,ah that’s nice; thanks!; the predicate is on the values
608,1551026297.3017,Becki,"""for which the values"". gotcha"
609,1551026408.3027,April,"Hi!
random question :stuck_out_tongue: why metadata impact on equality for functions?
```
(let [f (fn [])
        m {}]
                  (println ""fn withMeta == fn""  (= (with-meta f {1 1}) f))
                  (println ""m  withMeta ==  m"" (= (with-meta m {1 1}) m))) 

fn withMeta == fn  false
m  withMeta ==  m true
```"
608,1551026588.3028,April,:grin:
608,1551028242.305,Jasmine,Functions have identity equality semantics. Generally you shouldn’t be comparing them for equality in the first place.
608,1551028312.3053,April,"ok :pensive:, thanks!!"
610,1551037021.3069,Clarine,"Function equivalence is reducible to the halting problem which cannot be solved:
<https://stackoverflow.com/a/1132167/6264>"
610,1551037806.3097,Latonya,"Where ""cannot be solved"" is the general case, for an arbitrary pair of functions.  There are special cases that are decidable, but Clojure's `=` makes no attempt to help you find those.  But I agree that point is getting fairly far from the original question :slightly_smiling_face:"
608,1551038488.3104,Rosaline,"functions have reference equality, but implement the value metadata interface, and implement it by wrapping"
611,1551038880.3119,Tammera,"You gotta love those proofs tho, suppose we have x, if we define x’ and y, we would have to solve the halting problem. That’s not possible"
612,1551044238.3124,Sixta,How can I analyze a directory of files using tools.analyzer?
610,1551046801.3139,Angele,"Answering my previous question (<https://clojurians.slack.com/archives/C03S1KBA2/p1551018489292000>) I found a more elegant approach of expressing the same:
```
(defn build-server [config handlers]
  (let [port (:port config)
        server (-&gt; (ServerBuilder/forPort port)
                   (as-&gt; builder (reduce #(.addService %1 %2) builder handlers))
                   (.build)
                   (.start))]
    (println ""gRPC server started listening on port"" port)
    server))
```"
610,1551097998.3169,Simonne,"<@Angele> At first I was going to suggest getting rid of the `as-&gt;` threader, but after looking at it, I think the following is most straightforward:

```
(let [b (ServerBuilder/forPort port)]
  (doseq [h handlers]
    (.addService b h))
  (.start (.build b)))
```; In general, I prefer using side-effecty constructs for side-effecty operations.; For example, `doseq` for adding services to a mutable object.; If you wanna keep the startup msg, I would do:; ```
(let [b (ServerBuilder/forPort port)
      srvr (do (doseq [h handlers]
                 (.addService b h))
               (.start (.build b)))]
  (println ""gRPC server started listening on port"" port)
  srvr)
```"
613,1551100640.322,Drucilla,"One thing I've found useful to build into functions like these is a promise that is delivered once the service has started. It can either be passed in by the caller, or returned as part of a map that wraps the server object. This makes it possible for tests to use it to ensure the service is ready for requests before the test starts hitting it."
614,1551109120.3232,Harriet,Anyone has an experience with Multi-part uploads with Amazonica ? Context: I am trying the merge 30K+ files into a single file in a Lambda function.
615,1551110876.3233,Vita,I would expect `fn?` to return true as well. Kinda surprised it doesn’t.  It looks like MultiFn extends AFn implements IFn and the fn? implementation is ```(instance? clojure.lang.Fn x)``` …. so difference between IFn and Fn. I don’t know why
616,1551116952.3249,Ronald,"Why does `transit-cljs` allow you to read/write directly from/to strings, but `transit-clj` require the construction of `ByteArrayInputStream`/`ByteArrayOutputStream`? Is there a way to read and write strings directly in the Clojure version?"
617,1551117912.325,Dann,"```Clojure 1.9.0
(ins)user=&gt; (defmulti foo identity)
#'user/foo
(ins)user=&gt; (ifn? foo)
true
```; <@Ronald> because String is the right abstraction in a js runtime, but not in the java runtime. It's simple to call the String constructor on a byte-array, but you end up doing a bunch of pointless work in common use cases if you convert to string (because often your target isn't a String in memory, it's an output destination like a File or socket which provides and OutputStream to write to directly). Similarly for input, the thing that you get the transit data from will almost always offer an input-stream, getting a String first then translating reduces flexibility and adds pointless layers of work."
617,1551118738.3284,Wanita,How to automatically construct spec from data structure?
617,1551118901.3288,Ronald,"That's fair. It just seemed very non-Clojurey to be creating and mutating this odd Java object, but it makes sense in that context. I'll just make a wrapper for my purposes that dumps to an in-memory string.; Thanks for the response <@Dann>"
617,1551118991.3293,Dann,"yeah - it's very easy to convert a byte-array to string or string to byte-array; I think there's a good comparison to the various collection operations here - it would be trivial to provide a function that scans a collection for a matching key, but it's not provided in order to make using a set or hash-map the low-friction path; (compare to common-lisp or scheme which have sets/hash-maps but many programs use lists instead with O(n) access because it has less friction with a normal coding style)"
617,1551119203.3301,Ronald,It makes a lot of sense from that perspective
618,1551121652.3315,Eugenio,is that even doable for a highly dynamic and flexible thing like spec?
617,1551125268.332,Suzann,<https://github.com/stathissideris/spec-provider>
619,1551125431.3327,Scotty,Is there a Markdown parser in Clojure (or Java) than can parse Markdown with GH extensions?
619,1551125761.3343,Jonas,I'm pondering what best to do with a vanilla `java.util.concurrent.Future` I'm getting from the Firebase API. trying to `.get()` it seems to be blocking my REPL thread forever? not sure.; is there a way to wrap it into a Clojure future that will play nicer?
619,1551125887.3349,Dann,"the functions that work on a clojure future also work on that object; `realized?`, `deref` (with optional time-out arg), `future-cancel`"
619,1551125935.3357,Jonas,"oh, I didn't think I could deref it."
619,1551125961.3362,Dann,"deref will block the same way .get will, except you can optionally provide that time-out arg"
619,1551126019.3363,Meagan,google found me this: <https://github.com/atlassian/commonmark-java>
619,1551126139.3368,Dann,"I was wrong about `realized?`, but `deref` will work ```egret.run=&gt; (doto (java.util.concurrent.FutureTask. #(+ 1 1)) (.run))
#object[java.util.concurrent.FutureTask 0x2fa829be ""java.util.concurrent.FutureTask@2fa829be""]
egret.run=&gt; (def f *1) 
#'egret.run/f
egret.run=&gt; (realized? f)
ClassCastException java.util.concurrent.FutureTask cannot be cast to clojure.lang.IPending  clojure.core/realized? (core.clj:7453)

egret.run=&gt; @f
2
```"
620,1551126971.3373,Scotty,"<@Meagan> That's what I'm playing with (via `commonmark-hiccup`), though it does not seem to be handling tables in my test files even after adding an extension ta parse them."
621,1551127860.3387,Ariel,"Hi, I am trying to use DynamoDB (dockerized local) with com.cognitect.aws/api.
I am struggling to override the endpoint to match the local one.
I am doing this:
```
(def db (aws/client {:api :dynamodb :endpoint-override ""local"" }))
(aws/invoke db {:op :ListTables})
```
But I get:
```
=&gt; #:cognitect.anomalies{:category :cognitect.anomalies/not-found, :message ""local""}
(meta *1)
=&gt;
{:http-request {:request-method :post,
                :scheme :https,
                :server-port 443,
                :uri ""/"",
                :headers {""x-amz-date"" ""20190225T205047Z"",
                          ""x-amz-target"" ""DynamoDB_20120810.ListTables"",
                          ""content-type"" ""application/x-amz-json-1.0"",
                          ""host"" ""local"",
                          ""authorization"" ""AWS4-HMAC-SHA256 Credential=AKIAIEJE6SPXIMLB7VRA/20190225/us-east-1/dynamodb/aws4_request, SignedHeaders=content-type;host;x-amz-date;x-amz-target, Signature=2099f67eb5a11b49446bf3cbcf89202d94f3d0cf9973d1d6f5c37e85db202e63""},
                :body ""{}"",
                :server-name ""local""},
 :http-response {:cognitect.anomalies/category :cognitect.anomalies/not-found,
                 :cognitect.anomalies/message ""local"",
                 :body nil}}
```"
621,1551128250.3391,Dann,"is ""local"" a placeholder here? I'd expect at least a valid name like ""localhost"" otherwise; and the credential pointing to something on us-east-1 is suspicious"
621,1551128436.3396,Jasmine,I believe this is a known issue; <https://github.com/cognitect-labs/aws-api/issues/59>
621,1551128796.3403,Ariel,"I have tried ""<http://localhost:8000>"" but it gets interpreted as a IPv6.
I am suing ""local""due to an entry on
<https://github.com/aws/aws-sdk-java/blob/master/aws-java-sdk-core/src/main/resources/com/amazonaws/partitions/endpoints.json>; ```
 ""dynamodb"" : {
        ""defaults"" : {
          ""protocols"" : [ ""http"", ""https"" ]
        },
        ""endpoints"" : {
          ""local"" : {
            ""credentialScope"" : {
              ""region"" : ""us-east-1""
            },
            ""hostname"" : ""localhost:8000"",
            ""protocols"" : [ ""http"" ]
          },
```; Thanks <@Jasmine>"
622,1551131834.3413,Angele,"make sense, thanks"
623,1551157832.3438,Marlon,"Anyone who has experience with http-kit: how do you send ""multipart/form-data"" parameters? I'm currently working with the discord api and that's what it's asking for, but I can't get it to send properly. I've tried putting the data directly into the :form-params key of the request map but that didn't do it, and I've tried putting the data directly into the :body as well, also no luck.; I think I've figured it out."
623,1551158341.3448,Celestine,<@Marlon> Let me know if you still need assistance with that. We use `http-kit` in our test suite to POST images etc into our API for processing.
623,1551158446.3453,Marlon,"Oh, thanks! Only issue I'm running into now is actually getting file contents into it. Not sure what's causing problems with it honestly.; I've gotten it figured out now though"
624,1551182304.3482,Frederick,"hey guys can I get an extra eye please? I have this `ns` form failing with spec on clojure 1.10:
```(ns af-rematcher.deeplink
  (:require [clojure.string :as s]
            [cemerick.url :refer [query-&gt;map]]
            [cheshire.core :as json]
            [version-clj.core :as ver]
            [com.taoensso/timbre :as timbre]))```
generating: `clojure.lang.ExceptionInfo: Call to clojure.core/ns did not conform to spec. {:clojure.spec.alpha/problems [{:path [], :reason ""Extra input"",`
What am I doing wrong?"
624,1551182387.3486,Harris,`com.taoensso/timbre`
624,1551182419.3492,Frederick,oh it should be `taoensso.timbre`; thanks <@Harris>!
623,1551188258.355,Mireille,"I have a tree traversal problem: I'm trying to substitute values in a tree according to a substitution map in the tree. for example, if the node `[:expr {:x 1} ...]` should substitute all `:x` child nodes with 1. here's an example: ```(subst [:a [:b [:expr {:x 1} [:d :e [:f :g :x]]]] [:expr {:y 2} [:h :y]]])
=&gt; ([:a [:b [:expr {:x 1} [:d :e [:f :g 1]]]] [:expr {:y 2} [:h 2]]])
```
I'm aware of clojure.walk but I'm having trouble using it with ""memory"". any pointers?"
623,1551189142.3558,Harris,<@Mireille> you can use a thread local to propagate the context down the recursion
623,1551200521.3571,Ariel,<@Mireille> do you know <https://github.com/nathanmarz/specter>? ```transform``` might help.
623,1551200868.358,Mireille,"<@Ariel> thanks, i was reading <https://github.com/nathanmarz/specter/wiki/Using-Specter-Recursively> but it'll take a while to get my head around it"
625,1551204017.3588,Jonelle,"I’m trying to translate this from java to clojure:
```
int alpha = (pixel &gt;&gt; 24) &amp; 0xff;
int red = (pixel &gt;&gt; 16) &amp; 0xff;
int green = (pixel &gt;&gt; 8) &amp; 0xff;
int blue = (pixel) &amp; 0xff;```
but I don’t know how to do the `&amp; 0xff` part, anyone point me in the right direction?"
625,1551204296.3593,Marlyn,`(bit-and .....   0xff)`
625,1551204344.3596,Jonelle,"sweet, I had just gotten there myself :slightly_smiling_face:; thanks!"
626,1551207968.3607,Lowell,"Hi fellas, this mind-boggling error is consuming me `Can't make API call blobstore.CreateEncodedGoogleStorageKey in a thread that is neither the original request thread nor a thread created by ThreadManager`
It's happening with me trying to do an interop where the original is
```
BlobstoreService blobstoreService = BlobstoreServiceFactory.getBlobstoreService();
BlobKey blobKey = blobstoreService.createGsBlobKey(""/gs/"" + bucket + ""/image.jpeg"");
```
to
```
(.createGsBlobKey (BlobstoreServiceFactory/getBlobstoreService) ""/gs/crowd-hm.appspot.com/users/5644647548321792/profile/0eb6082b-f67d-46b4-ad2c-d2ef2b737ee5.jpg"")
```"
626,1551208174.3614,Dann,<@Lowell> sounds like that method whitelists specific threads for the call and you are trying to call it outside the allowed thread
626,1551208366.3621,Lowell,"Never stumbled in that before, how do I handle it?"
626,1551208613.3627,Dann,"you could send a function (which is a Callable) to be executed in an app-engine thread pool / thread <https://cloud.google.com/appengine/docs/standard/java/runtime#threads>; I think that would satisfy it (based on a common sense reading of the error message and docs at least); it wants to impose extra coordination over what you get by default with network calls and threads I guess(?); &gt; if you want to call App Engine APIs (com.google.appengine.api.*), you must call those APIs from a request thread or from a thread created using the ThreadManager API.; <@Lowell> ~to clarify about the above, if something hands you a Thread you can use `(.run t f)` where f is any clojure function taking no args~ -- not quite right...; so I think the solution is to ask the google ThreadManager for a thread, and pass your 0 arg function to the run method of that thread; the root issue might be that you are in eg. an http server or go block some other context where new threads are created or allocated automatically to call your function"
626,1551208908.367,Lowell,"And I thought that would be just a silly mistake, sounds I need to go deeper :smile:; Your explanation was awesome <@Dann> so much thanks!"
626,1551209110.3684,Dann,"<@Lowell> I need to correct myself - you can pass a function to the `Thread` constructor, but you can't pass one to its `run` method - so the real fix is different"
626,1551209127.3686,Lowell,:open_mouth:
626,1551209152.3691,Dann,"but I'm sure ThreadManager does have the thing you need; <https://cloud.google.com/appengine/docs/standard/java/javadoc/com/google/appengine/api/ThreadManager.html#createBackgroundThread-java.lang.Runnable-> - this is the method you need, a clojure function of zero args is a Runnable; so it's still straightforward, just not how I initially described it"
626,1551210342.3706,Lowell,"<@Dann> so i've got to `(ThreadManager/createBackgroundThread (BlobstoreServiceFactory/getBlobstoreService))` after the imports
and had `com.google.appengine.api.blobstore.BlobstoreServiceImpl cannot be cast to java.lang.Runnable`"
626,1551210418.3712,Dann,"so what you do is make that call (and ancillary code if any) inside a function; `(ThreadManager/createBackgroundThread (fn [] (some-other-step) (BlobstoreServiceFactory/getBlobstoreService)))`; where (some-other-step) might not exist, of course; you may also need to explicitly call the Thread's `run` method once it has been created"
626,1551210576.373,Lowell,Might be something like this `(.run (ThreadManager/createBackgroundThread #(BlobstoreServiceFactory/getBlobstoreService)))` ?
626,1551210609.3732,Dann,right; and you probably don't want that at a top level of the ns (otherwise it runs every time the ns is loaded or compiled)
626,1551210647.3743,Lowell,"Sure, it isn't :wink:"
626,1551210669.3749,Dann,"I was taking a literal read of ""after the imports"" :D"
626,1551210674.3751,Lowell,ahahahaha
626,1551210690.3756,Dann,I find assuming common sense in software discussions is dangerous
626,1551210698.3758,Lowell,Awesome ahaha; BUT; `Current thread is not associated with any request and is not a background thread`
626,1551210728.3764,Dann,weird
626,1551210775.3768,Lowell,:smiling_face_with_smiling_eyes_and_hand_covering_mouth:
626,1551210783.3771,Dann,"oh, :facepalm: you want the `.start` method, not `.run` - newb error on my part; it's a weird thing about the API that if you call the run method, the thread's code (if any) runs on your thread instead - I have never seen a design where that was useful; but start actually uses the thread object like you'd expect"
626,1551211146.3789,Jasmine,I've wasted more time than I care to admit accidentally calling .run instead of .start in Java
626,1551211225.3791,Dann,I'm glad I'm not the only one
627,1551211743.3797,Lowell,well.. didn't budge
626,1551211798.3813,Lowell,"To give more context, this is from:
<https://cloud.google.com/appengine/docs/standard/java/images/#using-image>"
626,1551211911.3822,Dann,"is it about other methods that need to be on google owned threads, or still the same method?"
627,1551211959.3827,Myrtle,"Came across this trick to avoid loading files at compile time: <https://stackoverflow.com/a/31333821>

Does that work b/c the `def`s are evaluated at compile time _and_ runtime?"
626,1551211977.3829,Lowell,"Same, the snippet here is the same one you see as the first and second line over the link"
626,1551212077.383,Dann,"yes, that's one work around - the issue is there's no compile time / run time distinction of that sort in clojure - every time your namespace is loaded, whether it's because you are compiling your app or running it, the code inside every def runs (as well as any other top level code); the cleaner fix is to put things that interact with the ""outside world"" or stateful objects inside functions, and arrange to call them via your main or other startup code; OK - I think that all the api calls related to using the blob store need to be inside the function you pass to the google thread manager; if you are doing that and still see that sort of error, you might need help from someone who knows app-engine"
626,1551212300.3846,Myrtle,Interesting...so why evaluate anything at compile time at all?
626,1551212364.3848,Dann,"because clojure allows you to use the full language while compiling - it's a common thing in lisps; there's no ""compile only"" mode other than putting something inside an fn; and yes, another work around is not using AOT, so that your code is only loaded when running the app (but this still causes problems when eg. linting or running tests, depending what sorts of side effects are in your def)"
626,1551218197.3861,Myrtle,"Yes, I see. The interplay b/t :clj: 's dynamism and Java's static nature always gets me :simple_smile: ."
628,1551230392.3864,Mireille,"interesting, do you have an example of this I could refer to?"
629,1551250124.3877,Betty,"Hi everyone! Has anyone encountered the `java.lang.module.FindException: Module java.xml.bind not found` error after adding: `:jvm-opts ...` and the `[javax.xml.bind/jaxb-api ""2.4.0-b180830.0359""]` dependency?; Fixed it! Adding one is fine but not both."
630,1551254472.3895,Mariela,"Anyone heard of a library that points out the slowest members in your system? (Component/Integrant)

Doesn't sound hard to build, but who knows, maybe someone already has such code; was defnitely easy with robert-hooke.

If going for it, do all logging in a ns with `clojure.tools.namespace.repl/disable-reload!` set"
631,1551259271.3943,Darcel,None
632,1551268898.396,Lucio,G’day! I’ve got a question about database connections in a web application: where do I actually keep the connection? Putting it into a namespace is not so great for obvious reasons. Is it a common pattern to put it in a request object of a http framework?; Most of the demo/example applications do keep the connection in a namespace :disappointed:; (specifically speaking of compojure and monger)
632,1551269096.3969,Bo,"Are you aware of tufte? <https://github.com/ptaoussanis/tufte>
I'm using this for profiling (a yada server using component)"
632,1551269301.3972,Mariela,"I'm not sure something like that would have served

I needed an answer to ""of all my [Sierra] components, which one is the slowest""?

I cannot add profiling boilerplate to every single component...; So, I have to ""profile"" `component/start`, which code I cannot modify

did so with robert hook, so args and `time` are logged"
632,1551269441.398,Bo,"Right, that sounds like a good solution"
632,1551269525.3988,Katherina,<@Lucio> <https://github.com/tolitius/mount> and <https://github.com/stuartsierra/component> are precisely for these scenarios
632,1551269526.3989,Lucio,"ah, or one can create the connection in a “create-routes” method passing the connection down to handlers; <@Katherina> using components?; read about stuartsierra/component, but not about mount; thanks"
632,1551269615.4012,Katherina,"mount is an alternative that some people prefer, both have their ways of managing state."
632,1551269760.4016,Lucio,"ah “component” even has an example on web applications; will check that out, thanks!"
633,1551270004.4022,Toccara,which kafka client you are using guys in production ?
632,1551270782.4023,Lucio,"just from contemplating the sources of “mount”: it actually “does” define a variable in the respective namespace but defers the instantiation of the actual value until you call “start” on the framework and from then on it takes care of the lifecycle; …trying to understand the magic behind it; sooo technically, if I don’t need lifecycle, I would just define an atom and “assign” the connection to it from somewhere later in the code. That’s what the component framework actually does under the hood"
632,1551271517.4033,Katherina,yeah both of them make state management nicer than the manual way. Mount however tries a kinda less opinionated approach i think: <https://github.com/tolitius/mount/blob/master/doc/differences-from-component.md#differences-from-component>
633,1551271885.4037,Elizebeth,The Java one
633,1551271909.4042,Mariela,"IIRC Mount has the drawback of failing to create isolated systems that can be run independently

e.g. what if I want to parallelize my test suite? All tests would share the same stuff"
632,1551271918.4045,Elizebeth,With a thin wrapper we wrote around the bits of it we need to make interacting with it more 'Clojureish'
633,1551271988.4046,Min,Integrant is also quite nice.
634,1551272951.4048,Gilberto,"I (and my team) bounced off duct, and by extension integrant, pretty hard. I strongly suspect component would be the same story, but it's been years since I last tried it out.

FWIW we migrated everything duct/integrant to mount in an hour and the productivity boost that we have seen from doing that has been incredible.

I find mount more amenable to just starting a part of the system, which means I can now do REPL-driven development inside the namespace I am writing, as opposed to somewhere else, followed by shipping it out when I'm done.

In short, I just find mount to be a lot closer to rolling plain Clojure without any of this stuff than the other two.; <@Toccara> We use <https://github.com/dvlopt/kafka.clj> which is a thin wrapper around the Java one. It even supports the Kafka Streams stuff, should one desire to use it."
634,1551273155.4061,Toccara,great thanks guys
634,1551273353.4062,Mariela,"Honestly that sounds like a classic simple vs. easy contrast.

I absolutely do repl-driven dev with Component. Everyone else in the team does, and it's a diverse one (vim, emacs, cursive...)

Component/Integrant make things explicit + testable, similarly the Reloaded workflow forces you to keep things pure and non-cyclic :slightly_smiling_face:

It wasn't entirely an easy journey, here are some notes taken <https://github.com/reducecombine/rehardened>"
633,1551273518.4065,Min,"Your mileage may vary. We use component heavily at work and are happy with it. But I like what I read about Integrant, seems better"
634,1551273608.4067,Min,"&gt; Honestly that sounds like a classic simple vs. easy contrast.
exactly"
633,1551274858.407,Gilberto,"I agree, but my conclusion is opposite to yours - I view `mount` as simple, and integrant/component as complex. It just so happens that in this case, it is ""made easy"" as well.

Like you say, your mileage may vary."
635,1551276815.4074,Jenine,"Announcing ClojuTRE 2019, September 26-27th in Helsinki, Finland. Tickets are on sale, get yours now from <https://clojutre.org/2019/>"
635,1551277574.4076,Mariela,"I try to avoid controversy, but it might be helpful to wonder ""I say _x_ is complected, but it complects what with what? Is it a complection or a composition?""

Mount appears to complect namespaces with state. You cannot take a namespace without also taking its state, and vice versa. Other libraries keep those orthogonal: I can create state (e.g. new app instances) without creating namespaces,

That's the magic of Rich's discourse: he pursues an objective definition of simplicity, enabling more fruitful discussions :slightly_smiling_face:"
633,1551277810.4078,Min,"One is pure, the other is not. Sure it's more work to handle when pure, but that's also more powerful (testing/repl etc). Same argument can be made for functional programming and here we are, using clojure, so you might as well embrace (relative) purity. And you're free to use whatever you want, the rest is just subjective arguments (simplicity etc).; On a side note, that would be cool to have first class namespaces but that's another subject"
636,1551279238.4091,Holly,"Is there any library out there with some kind of `let-debug`  that prints a debug statement after each let? :stuck_out_tongue:; ```(let [a (f1)
      b (f2)]```
into
```(let [a (f1)
      _ (println ""a"" a)
      b (f2)
      _ (println ""b"" b)]```"
637,1551280192.41,Jasmine,"there's a dlet explained at <https://cambium.consulting/articles/2018/2/8/the-power-of-clojure-debugging>; I think there are some libs out there with stuff like this, but I'm not sure which ones off the top of my head"
637,1551280382.4108,Holly,"here’s my shot:
```
(defmacro letd [bindings &amp; body]
  (let [pairs (partition 2 bindings)
        dbg   (map (fn [[v value]] `(_# (println ~(str ""&gt;&gt;"" v) ~value))) pairs)
        intv  (interleave pairs dbg)
        bs    (into [] (apply concat intv))]
    (println dbg)
    `(let* ~(destructure bs) ~@body)))
```; my solution does not work with destructuring :cry: tks <@Jasmine>; I guess is one of those things, everybody quietly rolls their own :smile:"
636,1551280584.4125,Alleen,would you have any links to share about first class namespaces <@Min> ?
637,1551280649.4134,Min,"not really, it's not a thing in clojure, racket has something like that and ocaml functors come to mind (somewhat)"
637,1551280748.414,Tressa,"til interleave. i was reducing; ```
(defmacro let-debug
  [bind-vec &amp; body]
  (let [parted (partition 2 bind-vec)
        new-bind (reduce
                   (fn debugger [aggr [name value]]
                     (conj aggr
                           name value
                           '_ `(println ~(str name "" is "") ~value)))
                   []
                   parted)]
    `(let ~new-bind ~@body)))
```"
637,1551281071.4156,Alleen,I'll have to move these languages up from my learning list
637,1551282189.4158,Gilberto,"<@Min> I think you are confusing purity with functional programming.

With mount we still have pure functions. The point of FP is pure functions, not pure namespaces - since namespaces are just groupings of things. Whether said groupings contain state or not is, in my humble opinion, completely beside the point of writing pure, stateless functions.

State needs to live somewhere. I don't think it matters whether it's spread across the place or living in a single namespace if you can easily get hold of it when you need it. Beyond that, it boils down to whether it forces me into a particular way of doing REPL-driven development.

And my point was that mount allows me to do it any way I like, unlike the alternatives."
637,1551283053.416,Min,"I am not :) But as I said it's all quite subjective arguments at this point. ; I like to be able to pass my state around, have multiple versions of it etc, you like to shove it at the namespace level, so be it. "
638,1551283430.42,Chauncey,"There doesn't seem to be a channel for `clojure.java.jdbc`, so a simple question here. I need to write some code that will be generating a ton of very postgresql specific DDL.  Without meaning to slight `clojure.java.jdbc/create-table-ddl`, it is nowhere near prepared to deal with schema entity references, quoted identifiers for table or column ids, and the many _many_ options for `create table`.  Even something as simple as a column default constraint requires special quoting to use `create-table-ddl`, e.g. `[:text-col :text :default ""'the default value'""]`  (note inner single quotes).

I'm just wondering if someone has written an abstraction like `create-table-ddl` that is more capable with regard to supporting the many options of `CREATE TABLE`.  If not I suppose I'll just be concatenating up a lot of strings, no time to write this dreamed-of abstraction now."
637,1551283443.4201,Lucio,"I see, my original question has no clear answer, there’s some controversy about where to keep the state :smile:"
637,1551283719.421,Chauncey,as a reminder of the wide variety of options.
638,1551283759.4214,Tressa,are you dynamically generating tables?
638,1551284115.4215,Gilberto,I think the suggestion would be to try both `mount` and one of `component`/`integrant` and find out which one fits you better.
638,1551284215.4218,Chauncey,yes
638,1551284229.4222,Tressa,i feel your pain
638,1551284237.4224,Chauncey,"Part of a semi-structured to structured data storage project; tables, schemas, partitions, the whole bit"
638,1551284329.4233,Darlene,"<@Chauncey> - There's also <#C1Q164V29|sql>, FYI."
638,1551284367.4241,Chauncey,"On a side note, I was kind of suprised when I couldn't find a nice package that encapsulates queries on the the supposed-SQL-standard ""information schema"" supported by postgresql.; thanks, will cross post there; (as in, return maps of maps that represent schemas/tables/columns etc in a hierarchical view)"
639,1551287691.4255,Celestine,"&gt; There doesn't seem to be a channel for `clojure.java.jdbc`, so a simple question here.
The <#C1Q164V29|sql> channel is for `clojure.java.jdbc` discussions, as well as general SQL questions (and also other SQL libs)."
640,1551297071.4269,Maximina,"I am trying to do some calls to https with http-kit/client , but all I get is "" :message ""HTTPS is not supported"". What http-client lib do you guys use for async-http-requests? I need to use ssl with pkcs12; I am on the latest version of Http-kit. I tested Clj-http before but I did not like the async-connection-manager"
640,1551297600.4273,Dann,aleph has a client iirc; it has its own setup for async (manifold) which is similar to core.async in some ways
640,1551298012.4277,Maximina,"i'll have a look, thanks :slightly_smiling_face:; awh yeah. Aleph looking sweet"
641,1551300363.4285,Antwan,"<@Holly> I cant think of a destructuring form that doesnt just use symbols; so if you wanted that macro to log everything, you would just need to scan the thing on the left for ""all symbols except _"" recursively"
641,1551301968.4299,Holly,I think ur right
642,1551312436.431,Vinnie,i've been seeing obscure errors in my stacktraces like `in unnamed module of loader 'app'` since upgrading to java 11 and clojure 10. others seeing this? example: ```class clojure.lang.PersistentList cannot be cast to class clojure.lang.IFn (clojure.lang.PersistentList and clojure.lang.IFn are in unnamed module of loader 'app')```
642,1551312528.432,Vita,I have seen those - my understanding is that’s just letting you know what jvm module (jigsaw and all) was responsible for the classes listed. but the exception is that you’re using a list as a function somewhere; I believe with jigsaw there’s an implicit top level module if you don’t define your own modules; presumably that’s what ‘app’ is
642,1551312559.4331,Rosaline,"yeah, that looks like a regular error with a little extra java module information appended; ```
user=&gt; (())
Execution error (ClassCastException) at user/eval602 (REPL:1).
class clojure.lang.PersistentList$EmptyList cannot be cast to class clojure.lang.IFn (clojure.lang.PersistentList$EmptyList and clojure.lang.IFn are in unnamed module of loader 'app')
user=&gt; 
```"
642,1551313006.4342,Jasmine,That’s standard for Java ClassCastExceptions now; In Java 9+
643,1551326135.436,Loria,"Is there a common name for this function in Clojure?
```
(defn &lt;*&gt;
  [fs xs]
  (reduce-kv (fn [m k f]
               (assoc m k (f (get xs k))))
    (cond (vector? xs)      []
          (associative? xs) {})
    fs))
```; it applies each `f` in `fs` to each `x` in `xs` while trying to keep the original data structure; ```
&gt; (&lt;*&gt; [dec inc] [10 20])
[9 21]

&gt; (&lt;*&gt; {:a dec :b inc} {:a 10 :b 20})
{:a 9, :b 21}
```"
643,1551326736.4386,Simonne,"so, I’ve seen thinks like `map-vals` that’s basically `(into {} (map (fn [[k v]] [k (f v)])) coll)`; it’s _very_ questionable to me that there’s value in not knowing whether you have a vector or a map; like, I _kinda_ see it, but I mostly don’t :stuck_out_tongue:"
643,1551326914.4402,Loria,"hmm ok, just realised that it's almost equivalent to
```
(defn &lt;*&gt; [fs xs]
  (reduce-kv update xs fs))
```"
643,1551326972.4417,Simonne,ah :derp:; I misinterpreted what you were doing; (a little)
643,1551327004.4428,Loria,"the concept is roughly equivalent to the Applicative typeclass in Haskell, or like `juxt` with multiple arguments; so I was wondering if there was a primitive for it"
643,1551327064.4438,Simonne,not something I’ve seen before :slightly_smiling_face:
643,1551327208.4443,Loria,"looks like `reduce-kv` doesn't work on lazy sequences though; I wonder what would be the expected behaviour for missing keys :thinking_face:; or variadic arguments; real-world example: let's say you have a map of strings, each to be parsed differently; ```
(def data {:date  ""2019-02-28""
           :price ""$20.50""
           :id    ""0a18abb7-dd4f-4aad-a49a-acb46cf23955""})

(&lt;*&gt; {:date  parse-date
      :price parse-currency
      :id    parse-uuid}
  data)
```"
643,1551327961.4479,Celestine,<@Loria> You can use `empty` instead of that condition (from 30 minutes ago). `(empty xs)` will produce `[]` if `xs` is a vector and `{}` if `xs` is a hash map.
643,1551328044.4483,Loria,Thanks for the tip!
644,1551328303.4507,Celestine,"For the above example, I'd probably be tempted to use conforming specs... ```
(s/def ::date parse-date)
(s/def ::price parse-currency)
(s/def ::id parse-uuid)
(s/conform (s/keys :req-un [::date ::price ::id]) data)``` where each of the `parse-*` functions accepted a string and either returned the parsed value or else `s/invalid`.; (but you'll get howls of protest from the folks who say specs should not conform from string to non-string types :slightly_smiling_face: )"
643,1551328521.4532,Loria,"That's interesting, I've only used `spec` for instrumenting functions during development - is it common practice to use it in this way for actual application logic?"
644,1551328544.4537,Celestine,"Also, in the above example, what should have to keys that aren't in the parse hash map? Clojure's principles would suggest that such any additional key/value pairs should be passed through unchanged."
643,1551328597.4548,Celestine,We use spec very heavily in production code. We use it for API parameter validation (and we use heuristics on top of `explain-data` to produce user-facing error messages).
644,1551328661.4561,Celestine,"We also use spec around our persistence model, to strip hash maps down to just the expected keys (which we extract from the `s/keys` in the spec via `s/form`) and that the values conform to what the database expects."
643,1551328717.4572,Celestine,"We have three layers of spec: API parameters (conforming from string to simple values), domain model (this isn't used a huge amount right now), persistence model.; We don't use instrumentation a great deal (we use it around some tests). We use `s/exercise` to produce ""random example"" data for unit tests. We have a few `st/check` tests as well, and some ""occasionally run"" generative tests.; (we started using early releases of spec in production during the early 1.9 alpha cycle)"
643,1551329023.4598,Loria,"Thanks for the explanation :slightly_smiling_face: Sounds like I should start looking into `spec` more deeply; In the above case, missing keys are dealt with by passing values through unchanged if there's no corresponding function; and calling the function with `nil` if there's no corresponding value; ```
(defn &lt;*&gt;
  ""apply functions in `fs` to values in `xs`""
  [fs xs]
  (reduce-kv update xs fs))

&gt; (&lt;*&gt; [dec inc str] [1 2 3 4 5])
[0 3 ""3"" 4 5]

&gt; (&lt;*&gt; [dec inc str] [1 2])
[0 3 """"]
```"
643,1551329374.4621,Celestine,And in the case of hash maps?
643,1551329497.4625,Loria,"```
&gt; (&lt;*&gt; {:a str} {:b 3})
{:b 3, :a """"}
```"
643,1551329521.4628,Celestine,"Ah, OK. Not what I expected.; I wasn't expecting the function to _add_ new keys to the map being processed. But that's a reasonable behavior too."
643,1551329664.465,Loria,"I guess that using spec would return `s/invalid` or throw an exception? Unless using `opt` keys, which I recall were going to be deprecated in the future"
643,1551329740.4654,Celestine,"I don't think a decision has been made on that yet.; Specs should return either a successfully conformed value or `s/invalid`. Throwing an exception is not useful there.; What we do for specs that conform strings, is we wrap their parsing in `try`/`catch` and in the `catch` we return `s/invalid`."
645,1551336612.0018,Loria,"How do I define a custom return value for `s/conform`?
E.g. I have a spec like
```
(s/def ::nested
  (s/tuple (s/tuple #{""s""} int?)))
```
and I'm only interested in the int; so I would like to have `(s/conform ::nested [[""s"" 123]]) =&gt; 123`; (apologies if this is more suited to the beginners channel); Also is there any way to recursively conform specs?
```
&gt; (s/conform ::int-string ""3"")
3

&gt; (s/conform (s/keys :req-un [::int-string])
    {:int-string ""3""})
{:int-string ""3""}
```; Google searches didn't lead me anywhere :confused:"
646,1551343470.0065,Elly,"Hey how do Clojure people run db migrations? In .NET I have my project set to auto-migrate a DB on startup in production if there is things to migrate. So I just have to git push and I'm done deploying a new version of my app.

Anything similar in Clojure?"
646,1551343597.0083,Leah,"does somebody here have experience with integrating single sign via OAuth or SAML 2? Wondering which of the many java libraries to choose. Today I only need Azure Active Directory support, but it would be handy if the library handled more…"
646,1551343730.0084,Katherina,I used <https://github.com/weavejester/ragtime> worked out pretty okay for me; I generally call the migrate function in the main which applies it everytime the server starts in an idempotent manner
646,1551344084.0089,Elly,"<@Katherina> Nice, thanks"
647,1551345760.0124,Diedra,"hi guys! is there a canonical way to get a subspecification from a clojure.spec? something like get-in where you would supply a spec path? The use case is to validate the results of ´update-in´ when you have a spec for the root  without checking the entire datastruct; I guess I could work from spec/form, but maybe there is a better way."
648,1551351751.0144,Alleen,"<https://docs.racket-lang.org/guide/units.html>
is this the feature you had in mind <@Min> ?"
647,1551357055.0148,Mariela,"Out of a binding vector with destructuring:

```
[{::keys [foo bar]
  baz ::else/omg
  {:keys [tomato]} :potato
  :as self}]
```
...how would you get a mapping of the extracted variables to their paths? Like the following

```
{foo [::sth/foo]
 bar [::sth/bar]
 baz [::else/omg]
 tomato [:potato :tomato]
 self []}
```"
649,1551359577.0172,Jasmine,"Destructuring in macros is backed by a function called `destructure` which rewrites the binding vector into a binding vector without destructuring. It won’t give you paths but it’s halfway there; That function is intentionally not doc’ed (as it’s an impl detail) but it takes a binding vector and returns a binding vector so you can invoke it by quoting your vector; The next step of going from that binding vector to paths is probably not fun, but it’s possible"
649,1551359853.021,Alleen,"<https://gist.github.com/leonoel/e933ee2b3f1e627063ab1db90d5396f9>
While reading the manual I've written a clojure implementation of the example, with injure
Feel free to comment"
649,1551359883.0215,Mariela,"thanks Alex :slightly_smiling_face:

I had played a bit down that path... and yes, didn't look very fun!"
649,1551359931.0216,Clarine,"We use <https://github.com/yogthos/migratus>; Hi <@Katherina> - nice to meet you at ClojureD :slightly_smiling_face:; Btw, there’s also a GraalVM version of migratus:
<https://github.com/leafclick/pgmig>
Should be super fast to run, didn’t try it."
649,1551360029.0227,Katherina,Nice to meet you too <@Clarine> :smile:
649,1551360357.0252,Cruz,"what would be the best way to log an exception’s ex-data using logging? Say with logback as the logging backend. E.g when if I did
```
(log/errorf (ex-info ""test"" {:foo 42}))
```
and it produced something like
```
- host date | ""test"" {:foo 42}
```; Does it mean I have to write my own appender or convertor class?"
650,1551362249.0259,Ronald,Can you elaborate a little on these heuristics? We like spec but have found it very troubling to have to wrap any user-facing validation (since the messages are pretty atrocious for those who don't speak Clojure).
651,1551365753.0263,Tressa,what would be your expected output?
651,1551367292.0275,Cruz,"<@Tressa> as I posted above, e.g. `- &lt;host&gt; &lt;date&gt; | ""test"" {:foo 42}`"
652,1551374633.0281,Celestine,"We have a hash map for each API that maps symbols (or occasionally sequences of symbols) to error codes, and we walk the `explain-data`, looking at `:path` and `:pred` and build a `reductions` of partial combinations of those, then walk that list looking for a match in our API hash map.; Missing parameters match to a `contains?` check on the API parameter name. Incorrect types match to a pair of the API parameter name and the spec operator, e.g., `int?`."
653,1551378065.0285,Ronald,"Wow, that seems like a lot of work, but is sort of what I imagined would be required to prettify those. Is that code public? Thinking of building something similar at work in the medium-long term."
652,1551380093.0299,Nigel,I was teaching a bunch of people Clojure. I asked them to implement the game 2048 and one of the constraints I had was to use as few `defn` as possible.  <https://gist.github.com/craftybones/42f180cf753db07b6694de87f4182ece>; I’d appreciate it if people can critique that solution.; Quite a few people landed at roughly the same solution
652,1551380400.0316,Dann,"<@Nigel> many of those partials could be transducer arities instead, using comp to combine them, then using a transducing context at the top level"
652,1551380443.032,Nigel,"<@Dann> thanks. I hadn’t yet taught them transducers at that point, but point taken; Also, I didn’t realise that partition returns a transducer; Darn, so cool :slightly_smiling_face:"
652,1551380510.0329,Dann,"yeah, I think all your partials are valid transducers; your comps would need to reverse order of course"
652,1551380524.0334,Nigel,Of course.; But ok otherwise isn’t it? Its remarkable how a game such as 2048 can be written almost entirely without a single “variable” and letting a managed stack do all the work
652,1551380591.0348,Dann,"for transpose, there are few cases where `list` is better than `vector` and I suspect this isn't one of them; both are eager, you can easily seq on a vector, you can't easily do indexed lookup on a list; and in many cases creating a vector is lower overhead (one contiguous object instead of a linked series of allocations)"
652,1551380710.0368,Nigel,so `(def transpose (partial apply map vector))` instead?
652,1551380716.037,Dann,"and agreed, it's a good demonstration of how elegant and powerful higher order functions can be"
652,1551380773.038,Nigel,"To be clear, a seq is eager, so seq on a vector and a seq on a list should theoretically be the same, so why the vector?"
652,1551380783.0382,Dann,list is eager
652,1551380805.0388,Nigel,But wouldn’t the seq force both?
652,1551380807.0389,Dann,"the difference is that vectors are more efficient to allocate, and they have fast indexed lookup; there's no forcing in question, both are eager"
652,1551380826.0395,Nigel,"Right. That’s what I assumed.; Ok, got it; the allocation is the performance you are talking about"
652,1551380866.0408,Dann,lists have few (no?) features that make them superior to vectors; the allocation and the lookup time
652,1551380907.0416,Nigel,lists make better stacks?
652,1551380922.0419,Dann,"vectors are great stacks, you just pile onto the end"
652,1551380936.0423,Nigel,and peek ?
652,1551380940.0424,Dann,peek / pop work on both vectors and lists; right
652,1551380952.0429,Nigel,I remember reading somewhere about peek performance.; or last. I can’t remember which
652,1551380978.0436,Dann,"peek is faster than last, and happens to find the last element of a vector"
652,1551380990.0439,Nigel,ok. Thanks.
652,1551381003.0442,Dann,"vectors are indexed, so all lookups by index are faster; (of course you lose this advantage by calling seq, but you are still no worse off than you were with a list)"
652,1551381053.0453,Nigel,"I am guessing lists are there primarily for homoiconicity?; and we always need more parentheses, of course"
652,1551381114.0466,Dann,"yeah, you need lists from macros (but only weird macros are built out of *direct* calls to list)"
652,1551381171.0476,Nigel,That’s true. Regular old quoting seems to cover most needs; Is the idea of LightTable dead? There seems to be a brave soul who every now and again revives it from the dead; I am more interested in the idea itself even if the project doesn’t rekindle itself
654,1551381509.0491,Rosaline,what is the idea of lighttable?
652,1551381552.0502,Rosaline,"(like, I am familiar with the project, and have seen chris talk, etc)"
654,1551381559.0504,Rosaline,but what do you think the idea is?
652,1551381570.0507,Nigel,One of the things that the original video from the kickstarter campaign spoke about was a function as a unit of code as opposed to a file and the ability to live debug as you built stuff; I thought both those ideas had a lot of merit and would have liked to see it go some distance
654,1551381599.0518,Rosaline,isn't that just a clojure repl?
652,1551381678.0539,Nigel,"yes and no. The repl by itself is certainly powerful, but the repl that he showcased and seemed to be aiming at was far more powerful and was real time, often highlighting values overlaid on the original code etc"
654,1551381748.0547,Rosaline,have you seen rebl?
652,1551381783.0555,Nigel,I haven’t yet seen/used rebl. Is that what I want? I have the talk bookmarked and am meaning to watch it
652,1551381808.056,Rosaline,it is a kind of gui data explorer
654,1551381819.0567,Rosaline,with repl hooks
652,1551381874.0587,Rosaline,"I dunno, in general gui tools tend to pass me by because I do all my work ssh'ed into a vm specifically setup for work programming"
654,1551381897.0596,Celestine,"The original demo for LightTable was a radically different way to edit/work with functions -- but in testing with actual users it proved too alien/confusing so they scaled back to a much more ""normal"" editor experience. The main ""novel"" features it included were inline result display and auto-evaluation of code as you typed (which, frankly, I found a bit too dangerous/annoying and quickly turned that off)."
654,1551381912.0603,Rosaline,"so lighttable wasn't very compelling, rebl itself isn't super compelling, but it is built on some protocols which are usuable elsewhere which is kind of nice"
652,1551381931.0606,Nigel,Ok. There was this fancy node.js repl that doesn’t seem to be maintained anymore which was quite cool as well; Can’t remember the name now
654,1551381944.0612,Celestine,I think several editors provide the inline results and auto-eval options now and LT is virtually abandoned (I think).
652,1551381981.062,Nigel,<@Celestine> - A lot of tools have this thing where they are born again later and somehow seem to catch on
654,1551382007.063,Clarine,like bash
652,1551382008.0631,Celestine,"REBL is ""different"" because it's in-process and it's very focused on data viewing/visualization/exploration right now. It'll be interesting to see where it goes."
652,1551382016.0635,Nigel,"<@Clarine> - LOL :smile:; <@Clarine> - yeah, unlike fish that die and are never born again; I’ll definitely try out REBL"
652,1551382069.0652,Celestine,"Liquid is also a very interesting project: again, it's an in-process editor, that's fairly vim-like, but written entirely in Clojure and using curses-style terminal UI (so it can run in an ssh session on a remote box, for example)."
654,1551382113.066,Rosaline,ed for clojure running from the repl
654,1551382132.0665,Clarine,"btw, which is also kinda cool if you work in a terminal: <https://github.com/denisidoro/floki>
just spit your edn to some file and then inspect it. I’m not sure if I’ll use it, since I can inspect things with CIDER pretty well, but it’s cool that this kind of thing can be written in CLJS now"
652,1551382205.0679,Nigel,Just hanging out in these channels is a wealth of information. Thank you <@Clarine> and <@Celestine>
652,1551382205.068,Celestine,"<https://github.com/mogenslund/liquid> -- see the demo videos for insight into the workflow. I really like it (and will like it more after it completes its transition to more vim-like key bindings!).; I'm hoping to extract the generic heuristic code into a library and open sourcing it at some point. Right now, it's a bit tangled up with some of our proprietary code."
652,1551382280.0688,Nigel,<@Celestine> - the best of vim and emacs but with Clojure instead of elisp.; Seems cool; This is a ridiculously cool project. <@Celestine>
655,1551386369.0699,Jasmine,lists are much faster than vectors as stacks btw
655,1551386387.0701,Dann,oh! - good to know
655,1551386425.0703,Jasmine,"I mean the data structure modification is a pointer, so that should be the guess (but it's easy to see in a perf test)"
656,1551387400.0705,Dann,"using criterium and a random series of stack operations I was able to confirm that, though the difference was smaller than the smaller standard deviation"
655,1551388269.0707,Jasmine,"you'll get more variability with the vector I suspect as it will depend on how deep in the data structure you are updating; so for an empty vector, would likely be pretty fast, but you might see a different story on one with a few dozen elements"
657,1551401006.0721,Kayce,"from the docstring of <http://clojuredocs.org/clojure.core/case>
&gt; Unlike cond and condp, case does a constant-time dispatch, the clauses are not considered sequentially.

can someone explain in plain English what that means?"
657,1551401096.0726,Dann,"it jumps to the condition, rather than linearly checking the conditions one at a time; it compiles to effectively (or maybe literally) a hash-map lookup on the dispatch value"
655,1551405968.0742,Jasmine,"the jvm has two bytecodes supporting ""switch"" - one is a linear series of checks, the other is effectively a constant time jump table keyed off of hashcode; Clojure's case does a ridiculous amount of work to use the latter"
655,1551418825.0843,Antione,"That got me scrolling through my phone to find the case source, which stirred up a couple of questions/comments:

1.) some?, if-some, when-some— do people use these often? I don’t, personally. Anyone have insight as to why they made it into core? I think I saw an added in 1.6, which makes me guess at it being related to transducers?

2.) `mod`’s docstring has a line “Truncates toward negative infinity.” Could someone explain that to me, and perhaps provide an example of why it’s important to know?"
658,1551423612.0861,Alleen,I prefer `if-some` and `when-some` over `if-let` and `when-let` almost every time; if I remember correctly the reason why they were added was because `core.async` channels impose `nil` as the end-of-stream sentinel
658,1551423826.0894,Mariela,"&gt; I prefer `if-some` and `when-some` over `if-let` and `when-let` almost every time

yes I've met other clj programmers following that style

It might boil down to Java-like vs. Lisp-like boolean semantics (in Java there's no 'truthiness' - just true and false can be used in conditions). Some people prefer Java-like"
658,1551424208.0895,Latonya,"I typically avoid calling modulo/remainder or division operations on negative numbers, to avoid having to know, and because applications I have written didn't need such operations on negative numbers.  But this page on the divide and modulo behavior in various flavors of C/C++ might answer some of your question: <http://www.microhowto.info/howto/round_towards_minus_infinity_when_dividing_integers_in_c_or_c++.html>"
659,1551441937.1015,Jaimee,Hi! Anybody knows of a clojure nlp library with things like RAKE/LDA?
659,1551443467.1018,Clarine,<@Jaimee> I’d take a look at <https://stanfordnlp.github.io/CoreNLP/>
659,1551443947.102,Jaimee,Thank you! I actually know about corenlp but it doesn't have LDA nor RAKE. I know Spark has LDA but I'd like to avoid to massive overhead Spark creates... Worst case I'll go an implement it...
660,1551443998.1022,Clarine,"I saw something about LDA mentioned in the JavaDoc of CoreNLP, that’s why I thought it may be relevant, but maybe not."
661,1551448258.1058,Epifania,"I'm trying to find any previous implementations (or some library I could steal ideas from) for having a pipeline which basically all functions inside this pipeline depends on the previous step and also have side-effects. Goes something like `fetch source -&gt; build -&gt; report status` but with a bit more steps in-between. Any previous art or thoughts on the subject are welcome! I've looked at some implementations using `async/pipeline` but feels like over-engineering for my case, no need for it to be async"
662,1551450921.1062,Tiesha,"If I understand your requirement, I’ve done similar before simply using thread-first, passing a context as I go: ```(-&gt; initial-context fetch-data parse-data categorise send)```"
661,1551450958.1064,Epifania,"Ah, basically build up some context map that contains all the parts that are needed? Actually not a bad idea; thanks!"
661,1551450994.1068,Tiesha,Yep exactly.  You’re welcome :slightly_smiling_face:
663,1551461701.1074,Ronald,I think that would definitely help improve practicality of spec
664,1551463857.1102,Neoma,"I couldn’t find `clojure.java.jdbc` channel, so asking here: At the time of table creation, if I provide `[:age :int :default 18]` then jdbc throws error, but it accepts `""18""`, which is logically incorrect. How to handle this?"
664,1551463908.1104,Dann,the channel for jdbc is <#C1Q164V29|sql>
664,1551463927.1106,Neoma,"oh okay, thanks"
663,1551466843.1111,Celestine,<@Ronald> Have you looked at `expound`?
663,1551467224.1113,Ronald,"I have, and I think it's pretty solid. But for a lot of purposes I want to leak even less Clojure/spec stuff in error messages. So if a user sends JSON to my application and gets back this error message, they aren't confused by seeing the actual keys, maps, predicates etc. that I used internally.; For me that's just meant trying my best to wrap any `spec` checks and give ""Clojure-free"" messages, but it's tedious and failure-prone; Maybe there isn't really a great solution, since failing a spec inherently means getting ""you were missing key `:some-key` in `some-map`"", and you can't really send that out to the world without revealing internals of Clojure code"
663,1551467655.1121,Celestine,"If you need to produce domain-specific error messages, you pretty much have to have domain-specific heuristic code... but if I can reduce it to generic data walking and lookup + a simple hash map, then it would be worth releasing as an OSS lib..."
663,1551468025.1123,Ronald,Yes I think so (on both accounts)
665,1551470255.1152,Delcie,"I'm making myself crazy with this... I'm using clojure.data.json to create a json string. The string I want to create looks like this:
{""query"":
   {""field"":
       {""text"": ""123"",; Sorry, hit the wrong key. Let me try again.; {""query"":
  {""field"":
      {""text"": ""123"",
       ""title"":  ""ABC""}
  }
}; the json/write-str I use looks like this:
(json/write-str {:query {:field {:text ""123"", :title ""ABC}}}); But I keep getting
""No value for key"" error on the generation.; I've tried just about every combination I can think of, with no joy."
665,1551470463.1187,Dann,"is the "" after C missing in your original?"
665,1551470463.1188,Delcie,"Does someone see something I'm missing?; No, it's there. Just a typo."
665,1551470555.1203,Rosaline,"```
user=&gt; ((fn [&amp; {:as m}]) 1)
Execution error (IllegalArgumentException) at user$eval1467$fn__1469/doInvoke (REPL:1).
No value supplied for key: 1
user=&gt; 
```"
665,1551470590.1211,Dann,"```egret.run=&gt; (j/write-str {:query {:text ""123"", :title ""ABC""}})
""{\""query\"":{\""text\"":\""123\"",\""title\"":\""ABC\""}}""
egret.run=&gt; (println *1)
{""query"":{""text"":""123"",""title"":""ABC""}}
nil
egret.run=&gt; (j/write-str {:query {:text ""123"", :title ""ABC""}} :foo)
IllegalArgumentException No value supplied for key: :foo  clojure.lang.PersistentHashMap.create (PersistentHashMap.java:77)

```; extra arg, yeah"
665,1551470616.1219,Delcie,"It seems to me that query is matched by field, field is matched by the object containing text and title. Everything has a key value. The original JSON validates. It just doesn't work with json/write-str. Very odd."
665,1551470629.1223,Dann,you are providing the wrong number of args to write-str
665,1551470644.1227,Rosaline,what does the stacktrace say?
665,1551470655.123,Delcie,Where did the :foo come from in your example?
665,1551470664.1233,Dann,it's how you make that error message happen
665,1551470692.1241,Delcie,Ah. Is there a better way to make sub-objects in a JSON string with json/write-str?
665,1551470699.1242,Rosaline,"you have supplied the error message, which says what the error is, but the stacktrace will tell you where the error is actually happening"
665,1551470737.1245,Dann,what does this mean?
665,1551470796.1258,Delcie,"IllegalArgumentException no value supplied for key:
then: clojure.lang.PersistentArrayMap.createAsIfByAssoc (PersistentArrayMap.java:79)"
665,1551470821.1262,Dann,`*e` will contain the full trace
665,1551470835.1265,Delcie,That's the whole stack trace (this is in the repl)
665,1551470845.1267,Dann,"that's not a stack trace, it's a message; *e contains the trace"
665,1551470854.1272,Delcie,"Never mind, I see it.; Here's the whole thing:
at [clojure.lang.PersistentArrayMap createAsIfByAssoc ""PersistentArrayMap.java"" 79]}]
 :trace
 [[clojure.lang.PersistentArrayMap createAsIfByAssoc ""PersistentArrayMap.java"" 79]
  [clojure.core$array_map invokeStatic ""core.clj"" 4256]
  [clojure.core$array_map doInvoke ""core.clj"" 4249]
  [clojure.lang.RestFn applyTo ""RestFn.java"" 137]
  [clojure.core$apply invokeStatic ""core.clj"" 646]
  [clojure.core$apply invoke ""core.clj"" 641]
  [clojurewerkz.elastisch.arguments$__GT_opts invokeStatic ""arguments.clj"" 9]
  [clojurewerkz.elastisch.arguments$__GT_opts invoke ""arguments.clj"" 3]
  [clojurewerkz.elastisch.rest.percolation$register_query invokeStatic ""percolation.clj"" 30]
  [clojurewerkz.elastisch.rest.percolation$register_query doInvoke ""percolation.clj"" 25]
  [clojure.lang.RestFn invoke ""RestFn.java"" 467]
  [esearch.handler$get_register_search invokeStatic ""handler.clj"" 124]
  [esearch.handler$get_register_search invoke ""handler.clj"" 119]
  [mysql.core$eval11790 invokeStatic ""form-init1224899402989498950.clj"" 1]
  [mysql.core$eval11790 invoke ""form-init1224899402989498950.clj"" 1]
  [clojure.lang.Compiler eval ""Compiler.java"" 6927]
  [clojure.lang.Compiler eval ""Compiler.java"" 6890]
  [clojure.core$eval invokeStatic ""core.clj"" 3105]
  [clojure.core$eval invoke ""core.clj"" 3101]
  [clojure.main$repl$read_eval_print__7408$fn__7411 invoke ""main.clj"" 240]
  [clojure.main$repl$read_eval_print__7408 invoke ""main.clj"" 240]
  [clojure.main$repl$fn__7417 invoke ""main.clj"" 258]
  [clojure.main$repl invokeStatic ""main.clj"" 258]
  [clojure.main$repl doInvoke ""main.clj"" 174]
  [clojure.lang.RestFn invoke ""RestFn.java"" 1523]
  [nrepl.middleware.interruptible_eval$evaluate invokeStatic ""interruptible_eval.clj"" 79]
  [nrepl.middleware.interruptible_eval$evaluate invoke ""interruptible_eval.clj"" 55]
  [nrepl.middleware.interruptible_eval$interruptible_eval$fn__764$fn__768 invoke ""interruptible_eval.clj"" 142]
  [clojure.lang.AFn run ""AFn.java"" 22]
  [nrepl.middleware.session$session_exec$main_loop__865$fn__867 invoke ""session.clj"" 171]
  [nrepl.middleware.session$session_exec$main_loop__865 invoke ""session.clj"" 170]
  [clojure.lang.AFn run ""AFn.java"" 22]
  [java.lang.Thread run ""Thread.java"" 748]]}; esearch.handler is my code."
665,1551471042.1281,Dann,so this problem has nothing to do with data.json
665,1551471082.1285,Delcie,"Probably not, but I presume that people have built JSON like this before with data.json..; I'm just looking for what I'm doing wrong in my write-str."
665,1551471117.1292,Dann,write-str has nothing to do with that error
665,1551471145.1298,Delcie,"write-str triggers it, that's all I know."
665,1551471160.1301,Dann,"if that were true, write-str would be in the stack trace"
665,1551471247.1311,Delcie,I'd think so. It could be when it gets passed to ElasticSearch. Maybe something goes wrong there.
665,1551471284.1323,Dann,what does -&gt;opts do and how is it being called?
665,1551471298.1328,Celestine,You are most likely realizing a lazy sequence that was created somewhere else.
665,1551471301.133,Delcie,"I think one problem might be that the values for title and text aren't simple like ""123"". They are 1024 character strings containing search terms that may or may not have foreign characters in them."
665,1551471319.1335,Celestine,And the error is in what you passed to the code that created that lazy sequence.
665,1551471338.1338,Delcie,That's a reasonable idea.
665,1551471447.1351,Margit,"Is `-Dclojure.compile.warn-on-reflection` property supposed to work? If so, what effect should it have? I supposed it will set the reflection warning dynvar for all namespaces by default, but it doesn't seem to."
665,1551471503.1369,Celestine,<@Delcie> have you shown us exactly what code is on line 124 of `esearch.handler`?; `-Dclojure.compile.warn-on-reflection=true` should work.
665,1551471662.139,Dann,"```$ clj -J-Dclojure.compile.warn-on-reflection=true
Clojure 1.10.0
(cmd)user=&gt; *warn-on-reflection*
false
```"
665,1551471665.1392,Delcie,"this is Elastisch, submitting a query to the ElasticSearch percolator:
(pcl/register-query conn index rowid json)
That's on line 124. 'json' is the output of data.json. index and rowid are strings."
666,1551471722.1393,Madeleine,I think it only sets it when compiling 
665,1551471742.1395,Celestine,"Ah, yes, that's it.; Which version of Elastisch are you using? The stack trace does not match the latest version.; It looks to me like `register-query` expects kw-args style arguments, i.e., named arguments, not a single JSON map."
665,1551472248.1409,Madeleine,"So its not controlling the value of `*warn-on-reflection*`, it is just looked up as well by the compiler when compiling to decide if it should emit or not the warnings."
665,1551472256.1414,Delcie,"Elastisch is 2.2.1; Really, I didn't see that in the docs. That is very helpful to know."
665,1551472281.1424,Celestine,"Yes. Then you're calling it per the 3.x API, instead of the 2.x API.; <https://github.com/clojurewerkz/elastisch/blob/2.2.x-stable/src/clojurewerkz/elastisch/rest/percolation.clj#L27>; `&amp; args` is expected to be unrolled keyword args, not a map.; In Elastisch 3.x, this call changed to accept a single hash map of `opts`; <https://github.com/clojurewerkz/elastisch/blob/3.0.x-stable/src/clojurewerkz/elastisch/rest/percolation.clj#L27>; So you either need to change your call or update to 3.x."
665,1551472389.1445,Delcie,"I'll try both. :slightly_smiling_face:; Well, updating Elastisch to 3.0.0 didn't fix it. Same problem. I'll try keyword args rather than the JSON."
665,1551472497.1455,Celestine,"It should be a hash map not a JSON string.; Here's the commit that changed the kwargs to option hash maps across the whole of Elastisch in May 2016 <https://github.com/clojurewerkz/elastisch/commit/f3ea4289b9a9cb37a491f0a3a2df4ec6388d27ae#diff-62e296465e10f4b062c0484560be3e12>; So `(pcl/register-query conn index rowid {:query {:text ""123"" :title ""ABC""}})` for 3.x or `(pcl/register-query conn index rowid :query {:text ""123"" :title ""ABC""})` for 2.x."
665,1551473048.1478,Delcie,Thanks that's very helpful. OF course our ElasticSearch servers just went down so I'll have to test later. My localhost ES doesn't have enough data for what I'm doing.
667,1551474080.1488,Magdalena,[ANN] Cognitect Labs' aws-api 0.8.273 is now available: <https://groups.google.com/forum/#!topic/clojure/PgnJxiam_qk>
667,1551474169.1498,Dona,"this is pure gush but i just got my first full-time clojure gig and am incredibly excited. thanks for being such a thoughtful, curious community :lambdalove:"
665,1551474223.1505,Delcie,<@Celestine> I have to thank you. That one post about 3.x vs. 2.x was the key. It's fixed now.; <@Dona> Congratulations! That's pretty exciting.
665,1551475455.1545,Celestine,"<@Delcie> This is a good example of why Rich is such a strong advocate of accretion, relaxation, and fixation -- rather than _breakage_. Admittedly, Elastisch did a major version change to signal ""potential breakage"" per so-called Semantic Versioning, but it really does show that you never really know whether updating to a new major version is ""safe"" or not -- and changes like this make it hard to trust the docs, unless they are also fully versioned for every new release.; (That said, my ""flagship"" Clojure project, `clojure.java.jdbc` also went through two rounds of API breakage -- to move to a more idiomatic API -- and, in fact, it was precisely the same changes that Elastisch made, switching from keyword arguments to an options hash map!)"
665,1551475701.1579,Delcie,"That's true. I use your java.jdbc as well. Many times reading code is all that really works. Still, in my job I'm often trying to hack together something needed in a matter of hours, and I rely on docs to get things started probably more often than I should.; (I write mostly back end data moving stuff)"
665,1551475780.1585,Shonda,"Nice, congratulations!"
668,1551475890.1587,Margit,<@Madeleine> So it seems like I can't use it to check all namespaces for warnings. Sad.
665,1551476342.1589,Celestine,"`clojure -J-Dclojure.compile.warn-on-reflection=true -e ""(compile 'entry.point)""` should do it <@Margit>?; (you'll need a `classes` folder for it to compile into -- or else add a `binding` call around the `compile` for `*compile-path*`); I don't think I've broken the `java.jdbc` API in about two and a half years now, but 2016 and 2013 were bumpy years for the API :slightly_smiling_face:; (unfortunately there are still a lot of books and tutorials out there containing 0.2.x examples which haven't worked since 2013 :disappointed: )"
665,1551477349.1671,Donovan,"I saw the following spec in some code and I was wondering what the `or` was supposed to do.
```
(s/def ::my-string string?)
(s/def ::my-int integer?)
(s/def ::my-spec (s/keys :req-un [(or ::my-string ::my-int)]))
```
I generated a few samples using `clojure.spec.gen.alpha/generate` and saw that it does not yield the same results in Clojure 1.9 and 1.10.
In 1.9, it always returns maps with both keys (which looks like a bug :thinking_face:)
In 1.10, it returns maps with either `::my-string` key, `::my-int` or both (which looks like a normal `or`)

What is the expected behavior?"
665,1551477379.1676,Clarine,"<@Celestine> I recently learned about clojure.jdbc. Are you aware of it and its criticisms of java.jdbc?
<https://funcool.github.io/clojure.jdbc/latest/#why-another-jdbc-wrapper>; FWIW I still use java.jdbc but I thought it might be worth sharing"
665,1551477537.1693,Dann,"I find it odd and annoying that the clojure.jdbc docs call clojure.java.jdbc java.jdbc, and that the project picked a name such that many discussions about using jdbc with clojure now look ambiguous; I haven't used it at all though"
665,1551477812.1699,Clarine,"yeah, we can refer to it as funcool jdbc :wink:"
665,1551477840.17,Jasmine,"well first,  the or here is not xor, so the generated examples in 1.9 are still ""correct"". in 1.10, it was updated  to include either or potentially both.; so, expected behavior is its current behavior"
665,1551477928.1707,Donovan,"Great, thanks for your answer ; It seems like the `valid?` function behaves the same way on this spec, though; So in 1.9, it generates only one case (both keys) of the 3 valid ones (first key, second key, both keys)"
665,1551478657.1719,Celestine,Are you aware that it started life by copying code from `clojure.java.jdbc` and ripping out the license and copyright? I had to call the guy out on the main Clojure Google Group for that.; <https://groups.google.com/d/topic/clojure/Louc1PRdb_s/discussion>
669,1551479161.1744,Celestine,"Also, it's criticisms are mostly out of date (and will be completely irrelevant when `next.jdbc` comes out which I've been working on a for a while). And it hasn't had any code updates in three years now (and only minor doc updates that were two years ago) -- so I'd say it's abandoned at this point.; <@Clarine> ^"
669,1551479783.1751,Clarine,"great, thanks. So yes, you were aware, now I know :wink:; didn’t know there was this “drama” associated with it. I just saw someone mentioning it on clojureverse; Somewhere he said:
&gt; Currently I have removed all taken code from the clojure.java.jdbc, license problem should be solved.
I wonder with what he replaced that code then"
669,1551480184.1769,Celestine,I won't comment on that... for legal reasons...
669,1551480228.1772,Clarine,"fine, we can close this topic"
669,1551480301.1781,Celestine,"Where it was mentioned on ClojureVerse, I also pointed out that the original code was ripped off, BTW. <https://clojureverse.org/t/next-jdbc-early-notes/3480/5> Or is there another thread that mentions it?"
669,1551480343.1784,Clarine,I’ll see if I can find this
669,1551480364.1789,Celestine,(that's the only thread that search finds where it seems to be mentioned)
669,1551480403.1791,Jasmine,"yes, we improved it"
669,1551480452.18,Tammera,"thats so uncool, not attributing code. Even disregarding the legal implications"
669,1551480469.1803,Clarine,"or maybe it was on Reddit… or Zulip… or Slack… I forgot, sorry :confused:"
669,1551480517.181,Celestine,I think I saw a mention on Reddit (and also linked to the Google Group thread there about the code being ripped off in the early versions).
669,1551480565.182,Clarine,"yeah, I think it was this one: <https://www.reddit.com/r/Clojure/comments/ao8hlb/using_databases_in_clojure_a_lot_of_options/>; This was the comment: <https://www.reddit.com/r/Clojure/comments/ao8hlb/using_databases_in_clojure_a_lot_of_options/efzpxxj/>
and I see 3 days later you reacted on it. I think I missed that."
669,1551480607.1829,Tammera,"derivation is at the heart of open source, but not by copying others work and posing it as your own"
669,1551480633.1834,Celestine,"I try to catch every mention of it I can. As someone who's been doing OSS development for over twenty five years, I'm very sensitive to the issues of licensing and plagiarization :angry:"
669,1551480706.1841,Clarine,"Rightly so. Sorry man, didn’t want to trigger you into a bad mood."
669,1551480766.185,Celestine,We're good. I'm just listening to Amanda Palmer's new album so not much is going to dampen my enthusiasm today :slightly_smiling_face:
669,1551480828.1858,Dann,"legal issues aside, it's a disrespectful way to engage with a project whose work is leveraged that heavily"
669,1551480878.1862,Clarine,"that’s totally (f)uncool; (sorry, bad joke :wink: )"
669,1551481117.1889,Kirsten,this went from technical to legal issues ( but the technical part was never talked about )
669,1551481155.189,Tammera,or ethical :stuck_out_tongue:
669,1551481231.1898,Celestine,"As technical people, we'd do well to remember there are ethical and legal aspects to our work a lot of the time... for example <http://2018.clojure-conj.org/keynote-speaker-rebecca-parsons/>"
669,1551481279.1901,Tammera,I often cite ‘computer ethics’ as the most influential course in my masters
669,1551481726.1905,Clarine,which uni? my uni also paid quite some attention to it
669,1551481774.1907,Tammera,"University of Twente (Enschede, The Netherlands)"
669,1551481892.191,Clarine,"Yep, that’s where I was too :slightly_smiling_face:"
669,1551482011.1913,Tammera,Also had lectures from Johnny Søraker? Its such a shame that he’s no longer at the uni…
669,1551482040.1916,Clarine,I graduated in 2005; Don’t know the name.
669,1551482180.1921,Tammera,"yeah probably not, I think he started teaching around 2006. Anyhow, cool to hear that this has been a trait of the UT for so long. I still believe that having a good ethics course is great for a computer scientist."
670,1551482437.1925,Celestine,Small world :slightly_smiling_face:
669,1551482680.1927,Tammera,"Quite, moreso because the university we went to is one of the smaller of The Netherlands"
669,1551499434.1929,Madeleine,"You can use `run!` or `doseq` for that.; For example, you can do:

```
(run! #(%) [f1 f2 f3])
```
or
```
(doseq [f [f1 f2 f3]]
  (f))
```; What user was that? Almost makes me want to avoid all funcool lib; It could be a liability to do so"
669,1551504447.1953,Celestine,"<@Madeleine> As far as I'm aware, it was just the one guy, called out in the thread I linked to..."
671,1551522895.1959,Margit,"I still use Boot, but thanks, I will try to do something similar."
672,1551527971.1965,Epifania,"Can I somehow read the args of a function passed into a macro?; Tried to see how `#()` does it with the variadic args but can't find the source for that macro; `(:arglists (meta #'my-symbol))` seems to do the trick, and I don't even need a macro; So, got it to work with vars, but would like it to work with anonymous functions as well, if possible (feels like I need another way of reorganizing the forms in a different macro to solve this)
Current implementation
```
(defmacro read-args [f]
  `(first (:arglists (meta #'~f))))

(defn use-log-func [log] (log true))

(read-args use-log-func) ;; Works
(read-args (fn [] (println ""None""))) ;; Fails
(read-args (fn [one] (println ""One""))) ;; Fails
;; Failure:
;; clojure.lang.PersistentList cannot be cast to clojure.lang.Symbol
```"
673,1551539847.2013,Clarine,"This:
```
(let [in (java.io.PushbackReader. (StringReader. ""#&lt;Namespace user&gt;""))]
    (try (read in) (catch Exception e nil))
    [(read in) (read in)])
```
returns `'[Namespace user&gt;]`
How do I get the reader to skip over this thing entirely?; i.e. I’m not interested in anything `#&lt;foobar&gt;`; use case: I’m parsing REPL sessions that can be interleaved with valid clojure expressions and their output; Another issue. I’m generating code like this:
```
(defn example-104
    ""clojure.core/extend""
    []
    (defprotocol Dateable
      (to-ms [t]))
    (extend java.lang.Number
      Dateable
      {:to-ms identity})
    (extend java.util.Date
      Dateable
      {:to-ms (fn* [p1__19578#] (.getTime p1__19578#))})
    (extend java.util.Calendar
      Dateable
      {:to-ms (fn* [p1__19579#] (to-ms (.getTime p1__19579#)))})
    (in-ns (quote speculative.clojuredocs-parser)))
```
but it seems that defprotocol is not supported well in defns: the symbol `to-ms` cannot be resolved.; A declare helps"
674,1551546869.204,Min,"Weird pattern; Just wondering, why isn't the defprotocol at top level? "
673,1551547002.2053,Clarine,I’m just reading examples from clojuredocs and generating a function for each example; I could just spit out all the code at the top level I guess; but this makes it a bit more manageable; I could also spit each example to their own namespace
673,1551564381.2086,Marlyn,"<@Clarine> in your example `to-ms` cannot be resolved because you're referring to a symbol/var before the protocol is defined; It is the defprotocol that defines it; The protocol is defined at runtime of that function.
The symbol is resolved at compilation time of that function"
673,1551564497.2115,Clarine,"I fixed it now by emitting the defprotocol before the start of the function (same for import, require, etc.)"
673,1551564511.2118,Marlyn,"Yeah. That works; Some people call this the ""Gilardi scenario"" which sounds sort of creepy; It's at least a variant of it"
673,1551564604.2134,Clarine,"oh yeah, sounds familiar"
675,1551566332.2135,Latonya,"Creepy?  Does it remind you of something else with a similar name that is creepy, perhaps?  If it reminds you of ""The Cask of Amantillado"", then agreed, but the only thing I can see common between those is that they contain an Italian name :slightly_smiling_face:"
675,1551566448.2137,Clarine,"what’s the origin of this name for this problem btw. I tried to look it up before, but couldn’t find it"
673,1551568636.2152,Marlyn,"I don't know the origin story, but it's about Stephen Gilardi, one of the OGs "
676,1551575063.2163,Samual,"In Clojure Jira, how do you comment on an issue?"
676,1551576401.2169,Celestine,"<@Samual> You need additional permissions to add comments -- we've had a lot of problems with spam, unfortunately.; If you ask in <#C06E3HYPR|clojure-dev> and give your JIRA username, someone from Cognitect should be able to add your permissions (usually <@Jasmine>)"
676,1551577625.2182,Samual,"<@Celestine>, that means they accept comments only from signatories to the contributors' agreement?"
676,1551578875.2192,Celestine,"No, you just need to ask for comment permission to be added.; But they need to know your JIRA account name for that.; And the folks who control permissions on JIRA are mostly hanging out in <#C06E3HYPR|clojure-dev>"
676,1551578996.2216,Keenan,"Java interop question: If I'm extending a base class using gen-class and all that, from within an overriden method how can I call the parent's method (_super_ .theMethod()) in plain java"
676,1551581019.2229,Celestine,<@Keenan> Looks like you need to expose the super class method and rename it <https://stackoverflow.com/questions/9060127/how-to-invoke-superclass-method-in-a-clojure-gen-class-method>
676,1551581280.2234,Keenan,"Awesome, thanks <@Celestine>"
676,1551581568.224,Celestine,"(I can't vouch for it, I've never tried it -- I just searched on Bing for a suggestion for you)"
676,1551581742.2258,Keenan,"^^^ No problem. In experimenting for a few seconds, it doesn't seem to be taking...but I could be missing something. That, and in this case I'm the author of the base class, so I can just make `parentMethod()` and call that for stuff I'd rather handled in pure java from the overriden one in clojure"
677,1551587115.2261,Latonya,"<@Clarine> I get several hits via a Google search for the term: Gilardi scenario.  Yes, it was named for Steve (Stephen?  not sure of spelling) Gilardi, who was one of the first to describe it."
677,1551591758.2264,Madeleine,"What the macro receives is not a function, but code. So you will need to parse the code yourself and identify the args within it.; It might be possible for you to delegate back to def in this case.; Actually, it seems only defn parses args into arglists; You can try this:
```
(defmacro read-args [f]
  (if (symbol? f)
    `(:arglists (meta (var ~f)))
    `(do (defn ~'_ ~@(rest f))
         (:arglists (meta (var ~'_))))))
```"
678,1551609306.2273,Epifania,"Nice! Thanks a lot, works perfectly for what I wanted it to do!"
678,1551609757.2297,Colette,"I’m having an issue running boot inside my Docker image. Locally it works fine, but when I run the command
`boot --verbose api-uberjar` it gets stuck on:
`Writing api-0.1.0-SNAPSHOT-standalone.jar...`
The last output I see in the docker build (with the --verbose option) is:
`Filesystem: writing META-INF/MANIFEST.MF...`

It’s the first write operations, so it seems like docker does not like to write to disk it for some reason.
I am running the build as root.
Any ideas?; This is the full docker image:
```FROM openjdk:12-jdk-alpine AS build-api
RUN apk add bash curl
RUN bash -c ""cd /usr/local/bin &amp;&amp; curl -fsSLo boot <https://github.com/boot-clj/boot-bin/releases/download/latest/boot.sh> &amp;&amp; chmod 755 boot""

WORKDIR /app
COPY boot.properties build.boot ./
RUN BOOT_AS_ROOT=yes boot api-deps
COPY api /app/api
RUN BOOT_AS_ROOT=yes boot --verbose api-uberjar
```; reboot fixed it…"
679,1551612230.2319,Epifania,"I seem to miss something in my understanding about `let`. In this example, the first function calls works but the second doesn't, as it seems a `let` binding is not a `var`. Only if I use `def/n` it's a `var`? Could I get what the `var` binding is pointing at somehow?

```
  (var one-arg)
  (let [f one-arg]
    (var f))
```

Something that confuses me is that these too function calls gives the same output, but according to ^, are clearly not the same

```
  (println one-arg)
  (let [f one-arg]
    (println f))
```"
679,1551616718.2338,Loria,"The issue with the first example is that `var` is a special form which treats its arguments literally as syntax, so the let bindings don't get substituted inside it; just like `def` is a special form and you don't expect
```
(let [f 42]
  (def f :abc))
```
to be equal to
```
(def 42 :abc)
```"
680,1551619025.2355,Lakeisha,"Hi all!
is there a way i can start my system (i’m using mount) only once before all tests run ?"
680,1551620061.2359,Samual,<@Lakeisha> are you using clojure.test?
680,1551620093.2363,Lakeisha,i’m using eftest runner but my tests are all clojure.test
680,1551620362.2384,Samual,"<@Lakeisha> clojure.test ""fixtures"" do set-up and shut-down for tests. A fixture can set-up once before running all the tests in a ns."
680,1551620395.239,Lakeisha,"yes i’ve been looking at it, but i need something to run before all ns"
680,1551620543.2392,Samual,How do you invoke eftest?
680,1551621938.2399,Lakeisha,"either through the REPL with `(run-tests (find-tests ""test""))` or through the CLI with `lein eftest`; i have a problem with multithread mode and when running with `:multithread? false` its running ok
so i know that if i start mount only once when starting to test it will work ok"
681,1551624404.2412,Epifania,I see. Thanks for explaining! Follow up question: Is it possible to get whatever the binding is pointing at?
682,1551625326.2416,Loria,Can you give an example? What are you trying to achieve?
683,1551629683.2419,Luke,is there a SnowFlake implementation for clojure?
680,1551632159.242,Madeleine,"In Clojure, symbols point to values.; one-arg is a symbol, and so is f; When you eval a symbol, you don't get the symbol back, you get what the symbol points too, or what people sometime say the symbol is bound too; There are lookup contexts to find the value of a symbol, from the inner local scope to the outward local scope and finally to the global scope until a value for the symbol is found.; If you want to get the symbol back on eval, and not the value it points too, you can prefix the symbol with quote: `'one-arg`; Now you have a kind of value in Clojure called a Var; A Var is also a pointer to a value; You can think of it like a collection of one element; So `(def bla 42)` binds the symbol bla to a Var which contains 42 as its value. ; That's how def, defn, defmacro, etc. work. They always wrap the value in a Var and bind the symbol to the Var.; Now for convenience, when you eval a globaly scoped symbol which is bound to a Var, you will not get the Var back, but the value contained within the Var; If you want to get the Var back on eval, you can use the `var` special form or prefix it with `#'`; Now, `let` and other local bindings of symbol to value do not wrap the value in a Var for you.; This: `(let [bla 42] bla)` has no Var in it. Just the symbol bla is bound to 42 directly, so bla points to 42."
684,1551635678.2458,Samual,"<@Luke> (From the snowflake website, I learned that snowflake is a cloud service that you access with SQL.)"
684,1551635703.2462,Shayla,Like this? <https://github.com/snowflakedb/snowflake-jdbc>
680,1551650655.2489,Madeleine,"So in your example: `(let [f one-arg] (println f))` what happens is when you eval it, one-arg is a symbol which points to a var,  and that gets resolved, and then the var points to a value, that gets resolved as well, and the symbol f is bound to point to that value. And for `(println one-arg)` one arg is a symbol that points to a Var, which points to a value, and again, both get resolved until you get the value and it is printed.; So, since you are interested in the var itself, you just need to bind f to the var itself.; ```
(let [f (var one-arg)]
  f)
```; Specifically, in this case, it isn't really because var is given f as a symbol, since var resolve the symbol. The issue is that let binds f at runtime, and var runs at compile time. So f isn't bound yet, and will resolve to nothing."
684,1551680049.2509,Shakita,<@Luke> Mac Address based Base62 String ID <https://github.com/maxcountryman/flake>
684,1551682051.2513,Luke,"thanks <@Shakita>; i just need 8 bytes, it seems is 16 bytes, can not store as a interger in db?"
684,1551684627.2539,Shakita,"you can change it with less bytes. For Example, less length for unix timestamp epoch, or use ip address instead of MAC address, or use less length for seq."
685,1551695017.2556,Elly,"This has turned out to be kind of ungoogleable, why do people write `~` in their clojure code? What is the convention?"
685,1551695498.2557,Stefan,"This is a way to get the scope inside a qouted macro; that is if you quote a macro to create a list of the symbols, ~ will actually expand (eval) the part you use it with; maybe have a look at something like that: <https://learnxinyminutes.com/docs/clojure-macros/>"
685,1551695670.2568,Samual,<@Elly> It's the unquote for syntax-quote: <https://clojure.org/reference/reader#syntax-quote>
685,1551695843.257,Elly,"Thanks, haven't gotten around to reading about macros yet.; Thanks"
686,1551697081.2575,Sixta,<https://clojure.org/guides/weird_characters> this is useful :)
687,1551713617.2595,Ariel,"Where is the best channel to report documentation improvements? Github?
I am under the impression that there is something wrong with <https://clojuredocs.org/clojure.core/reify>"
687,1551713776.2601,Clarine,"clojuredocs is a community driven site; if you want to improve the docstring of a clojure function itself, you can first discuss in <#C06E3HYPR|clojure-dev> and ask if it’s worth posting an issue; and if it is, you can go sign up for the CA and open a JIRA ticket"
687,1551714048.2613,Jasmine,the snark is really unnecessary; what's the question?
687,1551714285.2619,Clarine,"Snark removed, just a joke, didn’t mean anything by it :slightly_smiling_face:"
687,1551714898.2627,Ariel,"I think the docs for reify says a lot about _how_ but misses the point for _what_ ""reify"" does. Under the perspective of somebody who came across that function in a codebase, and looked it up, the expectation was to find some definition like the one in Stu's+Aaron's Book:

```
Reify lets you create an anonymous instance of a datatype that implements either a protocol or an interface.
```"
688,1551715176.2658,Shayla,"I have a design/architecture question: I I have some logic that's repeated in a couple different places, and I want to DRY it a bit. The only way I've figured out how to do so is to build a ""wrapper"" that takes in 5+ functions and then uses those to pivot or pass the necessary data around. I've looked into multi-methods that's not quite what I need (because I'd end up just repeating myself in each method); Does anyone have resources or suggestions as to how to pull abstractions out without turning it into a weird ""mess""?; If this were more OOP, I'd build an interface or base class, write the base logic in a method on it, and then inherit and write the variations in each child, relying on the parent to provide the abstraction, but I'm dealing with generic data structures (maps as my main data object)"
688,1551715401.2694,Clarine,"if you need something like an interface you can write a Protocol; but I’m not sure if that make sense in your situation; what could also work:
`(merge {:fn1 default-fn1 :fn2 default-fn2} {:fn-1 override-fn1})`?"
688,1551715819.2721,Shayla,"With my current proposed changes, it'd look like this:
```
(let [wrapped-damage (prevent-wrapper :runner
                                      (fn [target args] [:damage :damage-prevent (:type args)])  ;prevent-loc-fn
                                      (fn [target args] (:type args))                            ;card-prevent-fn
                                      (fn [target args] ""Runner to prevent damage"")
                                      (fn [target args] ""Prevent damage?"")
                                      resolve-damage
                                      nil
                                      :prevented-damage)]
  (defn damage
    ""Attempts to deal n damage of the given type to the runner. Starts the prevention/boosting process and eventually resolves the damage.""
    ([state side type n] (damage state side (make-eid state) type n nil))
    ([state side type n args] (damage state side (make-eid state) type n args))
    ([state side eid type n {:keys [unpreventable unboostable card] :as args}]
     (swap! state update-in [:damage :damage-bonus] dissoc type)
     (swap! state update-in [:damage :damage-prevent] dissoc type)
     (trigger-event state side :pre-damage type card n)
     (let [n (damage-count state side type n args)]
       (if (pos? n)
         ;; This is where all of the old logic would have gone (very messy)
         (wrapped-damage state side eid n (assoc args :type type))
         (effect-completed state side eid))))))
```; and that doesn't feel quite right to me"
688,1551715874.2733,Lane,"<@Shayla> Could you implement a protocol to define the interface that each child (w/ variations) will implement. The common code can be in functions that take realizations of this protocol as argument?; If possible, I would also try to write most of the logic as pure functions and do the mutations (swap!) ""outside""."
688,1551716004.2745,Becki,also have the two swaps! just update `:damage` once rather than do it twice
688,1551716039.2748,Shayla,"I'd love to do that, but sadly, the engine leans _very heavily_ on that kind of stuff"
688,1551716106.2755,Lane,"Yeah, if the API is already heavily stateful, don't bother :slightly_smiling_face:"
688,1551716511.2761,Shayla,I'm reading the official clojure page on protocols (<https://clojure.org/reference/protocols>) now! any other protocol references I should look into?
689,1551718811.2786,Victorina,"worth noting the most recent development with protocols, in Clojure 1.10: <https://github.com/clojure/clojure/blob/master/changes.md#22-protocol-extension-by-metadata>"
689,1551719765.2797,Brittney,Is there a way to fully realise a data structure (all sub values) for the purpose of performance testing? 
689,1551720177.2808,Sixta,"<@Brittney> doall, generally. Do you have lazy seqs within lazy seqs? ; Postwalk with identity would probably do the trick"
689,1551720622.2823,Brittney,Yeah that was the first thing I thought of but felt a bit gnarly. ; It's a big old data structure of maps and lazy seqs. Wanted a easy solution. Calling str on it atm. Appears to work ; Although I admit inelegant
690,1551734923.2851,Matha,"Is there a way to attach metadata to a map that gets purged whenever the map is modified in any way? (e.g. a new key is assoc’ed, etc)"
689,1551736288.2858,Meagan,not really. you could maybe create your own type that implements the metadata protocols in a specific way
690,1551739043.2872,Matha,"<@Meagan> ah ok, unfortunate. I was wondering if I could use such a feature to make runtime checks of validity against a spec cheap. e.g. I could do a `s/valid?` check, and cache the result on the object (as metadata), so that future checks would be a simple look-up; (if the map doesn’t change)"
690,1551739857.2888,Meagan,<@Matha> why not cache it in an atom or something and look it up in there?
690,1551739937.2898,Matha,yep could do that too; good point
691,1551768008.2928,Tammera,I like how this is called `weird_characters`
692,1551772507.2943,Brigid,"Hey, uh, I can't figure out how to comment on any issue on the Clojure JIRA. I've commented on issues before, so I'm thinking that maybe somehow my commenting permissions have been disabled? I can still create issues, though. Who should I ask about this?"
692,1551772849.2951,Becki,yeah permissions were restricted due to spam. Just reach out to alex miller tomorrow and he can get you settled. It's 2am in his time zone so he's not likely to be up right now
692,1551773254.2954,Brigid,"Ah, okay, thanks"
690,1551779494.2977,Edie,anyone knows the reasoning why `(seq (transient []))` throws an exception?
691,1551782026.2987,Clarine,"because transient does not implement the seq abstraction, probably for good reasons"
691,1551783102.2991,Gia,"Has anyone used `cheshire` to lazy load json content from a particular nested node? For example, I have a json file like `{""package"": ""354"", ""misc-info"": {..}, ""entries"": [{...lots of data...}]}` and I need to lazy-parse precisely the `""entries""` part of json file. I'm not sure cheshire's `parsed-seq` is suitable here. Is there a way to achieve that?"
690,1551784703.2995,Edie,"that's right, I can't see how this could lead to trouble..."
690,1551784802.2997,Clarine,"if you want a seq, why not first call `persistent!` on it?"
690,1551784951.2999,Edie,"I am trying not, so that it can be done outside of the scope I need seq; I guess my idea of transient must be wrong, perhaps it is more local than my goal"
690,1551785014.3003,Clarine,you should never expose transients outside of a public API
693,1551795959.3038,Leif,"This seems a strange behavior with the or

```
(deftest destructuring
  (let [foo1 (fn [{:keys [bar] :or {bar 2} bar {}}]
               bar)
        foo2 (fn [{:keys [] :or {bar 2} bar {}}]
               bar)]
    (is (= (foo1 {{} 1}) (foo2 {{} 1})))))

(destructuring)
FAIL in (destructuring) (form-init5648150256962006264.clj:6)
expected: (= (foo1 {{} 1}) (foo2 {{} 1}))
  actual: (not (= 2 1))
```"
693,1551796161.3042,Jasmine,":or never creates values from thin air; so if you don't put the local in :keys, the :or default isn't used"
693,1551796367.3058,Nguyet,And `:keys` has precedence over “regular” destructuring?
693,1551796393.3061,Jasmine,"no, it's all ""regular"" destructuring; if you've made it ambiguous where a destructured symbol comes from, then you are in the land of undefined behavior; generally, destructuring maps are array maps, thus retain order, thus last one wins; but it's possible to use those maps in contexts (like macros) that go through an extra step that potentially destroys that order; if you want to see how destructuring will expand, use the (intentionally undocumented) `destructure` function:; ```(destructure '[foo1 (fn [{:keys [bar] :or {bar 2} bar {}}]
               bar)
        foo2 (fn [{:keys [] :or {bar 2} bar {}}]
               bar)])
;;=&gt; [foo1 (fn [{:keys [bar], :or {bar 2}, bar {}}] bar) foo2 (fn [{:keys [], :or {bar 2}, bar {}}] bar)]```; I guess that didn't help much"
693,1551796726.3101,Nguyet,"```
(deftest destructuring
  (let [foo1 (fn [{:keys [bar] bar {}}]
               bar)
        foo2 (fn [{bar {} :keys [bar]}]
               bar)]
    (is (= nil (foo1 {{} 1})))
    (is (= nil (foo2 {{} 1})))))
```
Does not seem to be order based; `:keys` wins in both cases"
693,1551796803.3113,Jasmine,"well, I wouldn't rely on that. I suspect it's an artifact of implementation we would not commit to; I will come back to: if you make it ambiguous, it's undefined"
693,1551796967.3142,Nguyet,"Yeah, we stumbled on it with a misplaced `}` : `{:keys [a b c d e] :or {a {} b 44 c d ""Not found!""} e {}}` and wondered how the compiler treats that; A linter to detect the same symbol bound multiple times in the same destructuring is in order"
693,1551797147.3153,Jasmine,<https://github.com/jonase/eastwood> would be a good place for that
694,1551802716.3174,Epifania,Hey! Many thanks for the very elaborate explanation <@Madeleine>! :thumbsup:
693,1551805757.3178,Danna,"I expect there are thread-safety issues with mutable updates; if you _really_ want a mutable data structure, then Java has got plenty of them; use one of those; and makes it a bit more obvious that you are going contrary to Clojure convention"
695,1551807280.3188,Meagan,"are there any libraries for EQL &lt;-&gt; GraphQL parsing?; I'm mainly interested in EQL -&gt; GraphQL; it looks like pathom _might_ be what I want. I specifically would like to avoid having to write a bunch of custom parsing stuff; most of the examples are using fulcro, though, and I have no need for client-side stuff for my use case"
695,1551811776.322,Sixta,"<@Meagan> I think fulcro has some examples of doing this, but I think you're right that you'll be porting things from cljs examples unfortunately.

I only looked into this briefly though."
696,1551813721.3234,Arline,"Is there a way to print components of the merged project from leiningen? I basically want to `(get project :java-cmd)` as lein would see it with all profiles activated and merged on the merged profiles.; Ah duh. `lein pprint` can do it natively. :facepalm:; ```
$ lein pprint :java-cmd
""/var/lib/jdk/openjdk-7-jdk/bin/java""
```"
697,1551819564.325,Ariel,Do you know lacinia?
697,1551819783.3252,Meagan,"we're using Lacinia for our GraphQL service. I need EDN -&gt; GraphQL _query_, not GraphQL SDL"
698,1551834776.329,Tonya,"I'm torn between using plain functions for grabbing users from a database for my website or a protocol. I'm using component to manage dependencies and I saw this: ```At this point you may be thinking, “API functions where the first argument determines a lot of the behavior… that sounds a lot like a protocol.” That’s an excellent point. For many common components, particularly ones that can be swapped out with different implementations like database connections, it can be valuable to define their API as a protocol. This can also enhance testability, since it gives us a flexible way to inject different mock components in our tests.```; I don't understand what a protocol offers vs functions such as get-user : db * username -&gt; user_row"
698,1551834851.3303,Meagan,"you can pass in a ""mock"" db that just returns pure data"
698,1551834920.3324,Tonya,Oh shit.; I've been thinking this whole time about only mocking with a test database but if I use a protocol I can mock everything.; Maybe though not at the user level.
698,1551834987.3351,Alessandra,"<@Tonya> depends on your use case:
if you're building a http service, then the interface of your system is your HTTP api, and not the functions/protocols inside of it
if you're building a library, then you may consider using a protocol

With functions, if I want to mock the database call for testing, we use `with-redefs` to make it explicit that we're monkey patching a particular function for testing"
698,1551835028.3359,Tonya,"I'm building a website, so neither.; Would it be better to mock jdbc/sql commands though?; rather than the individual user calls"
698,1551835062.337,Meagan,"yep. you can just have a
```
(deftype FakeDB
  IUserInfo
  (get-user [this username]
   {:posts [] :name ""Foo Bar""}))
```
and use that in your component system"
698,1551835077.3375,Tonya,I feel like IUserInfo will be really large; eventually
698,1551835079.3378,Meagan,"eh, usually you want to operate at a higher level of abstraction in most of your code"
698,1551835141.3395,Tonya,have defprotocol SqlDB with query do_command etc I feel like that offers a more powerful way to swap in certain behaviours.; If I were to have:
698,1551835148.3399,Meagan,depends on how coupled you want to be to your SQL
698,1551835160.3403,Tonya,But I guess both could work; AS they are not mutually exclusive
698,1551835193.3412,Meagan,IMO you usually want to use abstractions to model your domain
698,1551835207.3417,Tonya,"<@Meagan> I really appreciate your help btw, now I see the value in the defrecord crap."
698,1551835218.3421,Meagan,:+1: :smile:
698,1551835238.3426,Tonya,"I'll take your advice, I can always add the SqlDB later.; If necessary"
699,1551859935.3455,Brigid,Does anyone know if using side-effects in lazy sequences can result in the side-effects being executed twice?
699,1551860053.3472,Mireille,"I'm getting this error getting a docstring for a function (using clojure 1.10.0, nrepl 0.4.0, and monroe), has anyone seen it before? seems to be project specific because I don't get the error for a new project, but I'm not sure how to go about debugging the issue
```
#error {
 :cause ""clojure.repl""
 :via
 [{:type java.lang.ClassNotFoundException
   :message ""clojure.repl""
   :at [java.net.URLClassLoader findClass ""URLClassLoader.java"" 471]}]
 :trace
 [[java.net.URLClassLoader findClass ""URLClassLoader.java"" 471]
  [clojure.lang.DynamicClassLoader findClass ""DynamicClassLoader.java"" 69]
  [java.lang.ClassLoader loadClass ""ClassLoader.java"" 588]
  [clojure.lang.DynamicClassLoader loadClass ""DynamicClassLoader.java"" 77]
  [java.lang.ClassLoader loadClass ""ClassLoader.java"" 521]
  [java.lang.Class forName0 ""Class.java"" -2]
  [java.lang.Class forName ""Class.java"" 398]
  [clojure.lang.RT classForName ""RT.java"" 2207]
  [clojure.lang.RT classForNameNonLoading ""RT.java"" 2220]
  [clojure.lang.Compiler$HostExpr maybeClass ""Compiler.java"" 1041]
  [clojure.lang.Compiler macroexpand1 ""Compiler.java"" 7044]
  [clojure.lang.Compiler macroexpand ""Compiler.java"" 7074]
  [clojure.lang.Compiler eval ""Compiler.java"" 7160]
  [clojure.lang.Compiler eval ""Compiler.java"" 7131]
  [clojure.core$eval invokeStatic ""core.clj"" 3214]
  [clojure.core$eval invoke ""core.clj"" 3210]
  [clojure.main$repl$read_eval_print__9068$fn__9071 invoke ""main.clj"" 414]
  [clojure.main$repl$read_eval_print__9068 invoke ""main.clj"" 414]
  [clojure.main$repl$fn__9077 invoke ""main.clj"" 435]
  [clojure.main$repl invokeStatic ""main.clj"" 435]
  [clojure.main$repl doInvoke ""main.clj"" 345]
  [clojure.lang.RestFn invoke ""RestFn.java"" 1523]
  [nrepl.middleware.interruptible_eval$evaluate$fn__9015 invoke ""interruptible_eval.clj"" 86]
  [clojure.lang.AFn applyToHelper ""AFn.java"" 152]
  [clojure.lang.AFn applyTo ""AFn.java"" 144]
  [clojure.core$apply invokeStatic ""core.clj"" 665]
  [clojure.core$with_bindings_STAR_ invokeStatic ""core.clj"" 1973]
  [clojure.core$with_bindings_STAR_ doInvoke ""core.clj"" 1973]
  [clojure.lang.RestFn invoke ""RestFn.java"" 425]
  [nrepl.middleware.interruptible_eval$evaluate invokeStatic ""interruptible_eval.clj"" 84]
  [nrepl.middleware.interruptible_eval$evaluate invoke ""interruptible_eval.clj"" 54]
  [nrepl.middleware.interruptible_eval$interruptible_eval$fn__9060$fn__9063 invoke ""interruptible_eval.clj"" 220]
  [nrepl.middleware.interruptible_eval$run_next$fn__9055 invoke ""interruptible_eval.clj"" 188]
  [clojure.lang.AFn run ""AFn.java"" 22]
  [java.util.concurrent.ThreadPoolExecutor runWorker ""ThreadPoolExecutor.java"" 1128]
  [java.util.concurrent.ThreadPoolExecutor$Worker run ""ThreadPoolExecutor.java"" 628]
  [java.lang.Thread run ""Thread.java"" 834]]}
```"
699,1551860451.3476,Brigid,"If you run `(require 'clojure.repl)` in the REPL first and then try to get a docstring, does this still happen?; I'm thinking that getting docstrings maybe runs `clojure.repl/doc` (or some other function from that namespace) and it's not loaded in your project for some reason, so that's why you're getting the error.; I'm not really familiar with Monroe, but if the require works, a quick fix could be adding the require to `user.clj`."
699,1551860761.3482,Sixta,"I don't think so, no. They get cached.; If you act on a reducible which has side effects however, that will side effect as many times as you interact with it."
700,1551861342.3486,Sixta,"```
user=&gt; (let [x (eduction (map println) (range 3))]
  #_=&gt;   (when (seq x)
  #_=&gt;     (map identity x)))
0
(0
1
2
nil nil nil)
```"
701,1551862035.3489,Mireille,"oh wow, that works for me!; I think it's because I'm starting the repl server with `nrepl.server`, so clojure.repl namespace doesn't get included.; anyways, I know how to fix the issue now, thanks so much!"
701,1551862786.3526,Amada,"So I came to clojure from c# and node, so was mostly shielded from all the java and jvm things that happen behind the scenes. I would very much like to read about those parts of the echo system, but obviously a **java/jvm for clojure developers** book does not exist :smile:. Any suggestions on where I can find some resources or what parts might be valuable and what can be left out?"
700,1551863104.3527,Sixta,there's a good talk from conj by ghadi I think :slightly_smiling_face:
701,1551863250.3529,Amada,this? <https://www.youtube.com/watch?v=S1mzUi_zbEs>; nice thanks
700,1551863275.3534,Sixta,<https://www.youtube.com/watch?v=-zszF8bbXM0> I think this is the one :slightly_smiling_face:; both are probably good though :smile:
702,1551866130.3542,Brigid,"Thanks, that's what I thought as well"
703,1551867939.3564,Loria,"What's the normal workflow like for making changes to a dependency library? (e.g with the intent of fixing a bug and contributing those changes upstream); from Emacs specifically, I can jump to function or symbol definition, then edit and eval forms in that buffer, but the actual location is in a .jar file somewhere in my ~/.m2/ folder, which I assume isn't meant to be edited directly"
700,1551870707.3596,Amada,nice
704,1551875761.3613,Jaimee,Is there a way to do incremental changes with `enlive`? for example `(at [:p] (add-class nb-of-p))`
704,1551875824.3616,Teodoro,what do you mean by incremental? what is `nb-of-p`?
704,1551875916.3625,Jaimee,"Let's say I have a few p tags in my code, I'd like the first p tag to have the class ""p1"" the second ""p2"" etc"
704,1551876294.3658,Teodoro,"No, nothing standard. Are `pN` unbounded?
Anyway you can cheat by using a mutable counter `(at [:p] #((add-class (str ""p"" (swap! cnt inc))) %))`; I’ll deny having made this suggestion :wink:"
704,1551876342.3664,Jaimee,"haha thank you though !; It's not unbounded though, essentially I load an html file and I do some manipulation of it"
704,1551876425.3674,Leone,"<@Meagan> I'm using this, which may be what you're looking for?
<https://github.com/district0x/graphql-query>"
704,1551876478.3687,Jaimee,"Maybe I could use a random number generator though, I don't care if they are ordered, I just want to make sure that each one of these has a unique class or id"
704,1551876479.3688,Leone,"Although, I'm not sure that it takes EQL exactly. "
704,1551876488.3691,Jaimee,Would that be cleaner?; or maybe the hash of the content
704,1551876625.3695,Jefferey,perhaps this would help too: <https://purelyfunctional.tv/guide/clojure-jvm/>
705,1551879420.3738,Garnett,"Hey everyone

I'm building something that started from the chestnut template (<https://github.com/plexus/chestnut>), using muuntaja for de/encoding (<https://github.com/metosin/muuntaja/>).
Unfortunately, unlike in the toy example of muuntaja (<https://github.com/metosin/muuntaja/blob/master/doc/With-Ring.md#simplest-thing-that-works>) returning hashmap response bodies doesn't work in my app, I have to encode them in my request handler.
I added muuntaja's middleware `muuntaja.middleware/wrap-format` to the default middleware (which looks like this: <https://github.com/plexus/chestnut/blob/master/src/leiningen/new/chestnut/src/clj/chestnut/config.clj>), but something works differently there.

The failure is very weird too:
I get the following exception:
`java.lang.IllegalArgumentException: No implementation of method: :write-body-to-stream of protocol: #'ring.core.protocols/StreamableResponseBody found for class: clojure.lang.PersistentArrayMap`
which seems reasonable, but then the request is repeated (even when I use curl to send the request, so it's not the frontend logic or the browser).
The second request then also fails and I get a 500 response.

The double request happens with only the default middleware in a fresh chestnut project as well, so it's not caused by muuntaja or my changes

Any idea why muuntaja's auto-encoding doesn't seem to work in chestnut and where the request duplication comes from?"
705,1551880010.374,Amada,thank you; I made a repo <https://github.com/SneakyPeet/java-for-clojure-developers>; I’ve made a repo for java/jvm resources specifically for clojure devs. please feel free to add anything you think ads value <https://github.com/SneakyPeet/java-for-clojure-developers>
706,1551884506.3768,Shirleen,"<https://www.youtube.com/watch?v=P76Vbsk_3J0>

and

<https://www.youtube.com/watch?v=hb3rurFxrZ8>; Oh maybe I missed the point, you mean the opposite; sorry"
707,1551886277.3797,Shayna,"<@Garnett> by default, muuntaja will encode only `:body` if it's a collection (a map is) and there is `Content-Type` header set.; maybe something sets the content-type?"
707,1551886410.3802,Garnett,I think I tried to depend on the automatic negotiation because the request sends `application/transit+json` in the accept header
707,1551886569.3804,Shayna,If you have a public repo of the setup I could look at that today
707,1551886641.3806,Garnett,unfortunately not :confused:; i'm gonna try to reproduce it in a public repo; thanks!
708,1551887943.3841,Junko,<@Shirleen> hehe yes. 
707,1551887974.3848,Tonya,"Okay so I have this Database record (a component) that implements a protocol called UserInfo. I want to mock a test database, so to do this I swap out the config (very easy) but I'm having trouble adding startup/cleanup code (such as adding certain users, creating schema, destroying schema, etc.). The trouble is that I don't want to have to re-implement all of my UserInfo methods for this TestDatabase record, I want it to inherit them from the real Database record."
708,1551887985.385,Tonya,"Is there a good way to do this?; For example I have code that looks like the following:; None; I feel as if I shouldn't need to reimplement this for a test database that does some extra setup/finalization.; Oh, it seems like this is a use case for reify."
707,1551889266.3869,Garnett,"ive got it in a repo:
<https://github.com/TimoFreiberg/map-return-test>"
708,1551889855.3884,Garnett,"ok, i added some logging to `muuntaja.middleware/wrap-format`, and I notice that it receives a response that looks like this: `{:status 200, :headers {Content-Type application/octet-stream}, :body {:a x}}`; i noticed here: <https://github.com/TimoFreiberg/map-return-test/blob/master/src/clj/map_return_test/routes.clj#L38>
that when my handler sets a Content-Type header, muuntaja doesn't touch the body anymore (because the Content-Type header should only be set when the body is already in that format, I assume); now I only have to find out where that header is being set... - looks like it's `ring.middleware.defaults/wrap-defaults`; that's it.
keeping `ring.middleware.content-type/wrap-content-type` from being added by `wrap-defaults` fixed it"
709,1551898468.3904,Meagan,"thanks! I'll check it out. it might be what I'm looking for; don't need EQL exactly, but am looking for something that does EDN -&gt; GraphQL. EQL just looked like a good standard"
709,1551898567.3908,Leone,"ok. That ought to do it then.; I don't have much experience with that lib or graphql, but let me know if I can help"
710,1551903562.392,Shayna,Great! The middleware-stack is not the easiest to debug
710,1551903608.3923,Arline,"Does anyone know how to do an `in` query using `clojure.java.jdbc`?
Like `[""select * from foo where id in ?"" a-vector]`?"
710,1551903677.3929,Shayna,... but would be great if the `ring-defaults` and `muuntaja` would work together by default.; <@Garnett>  Could you write issues to both repos about that default mismatch. We could figure out which one should change.
710,1551903986.3933,Garnett,sounds reasonable
710,1551904001.3937,Arline,Oh lord. Is this post still true? <https://stackoverflow.com/questions/15580371/how-do-you-use-where-x-in-y-clauses-with-clojure-java-jdbc>; I need to generate the correct number of question marks? :neutral_face:
711,1551905080.3951,Harold,see also: <#C1Q164V29|sql>
711,1551905515.3975,Ronald,"<@Arline> I don't know for sure what capabilities `java.jdbc` has in that regard, but I know that most people in Clojure use libraries on top of it, to operate at nicer levels of abstraction. For example, I can see the use of a `where .. in` that looks nice in the README of HoneySQL <https://github.com/jkk/honeysql>"
712,1551908153.3978,Melina,"The last I checked (a couple of months ago), yes. I ended up using honeysql."
710,1551909967.3986,Shonda,<@Arline> the <#C1Q164V29|sql> channel may be able to provide more details as well.
710,1551911775.4017,Celestine,"<@Arline> `(str/join "","" (repeat (count v) ""?""))` isn't a terrible hardship since you'll need to use `(into [(str ... SQL fragments here ...)] v)` to ""pour"" the elements of the vector into the sql+params vector anyway :slightly_smiling_face: But, yeah, use `honeysql` if you want to avoid that. `clojure.java.jdbc` is deliberately *not* in the business of building your SQL for you and JDBC requires a placeholder `?` for each parameterized value..."
713,1551911916.4038,Keenan,"Any tips on de/serializing records with edn? Should I just not? I will have probably a hundred or more ""things"" that need polymorphic behavior, but I need to put these things to a file and get them back out. Better to find a way to use plain maps and defmulti, or...?"
713,1551912049.4046,Dann,"the `transit` library is intended for this sort of usage, but defrecord already implements a printer and reader tag that should do the right thing when read back in; I've definitely found transit easier to use and more reliable than the `pr` / `read` combo though; that said, pr / read does work ```(ins)user=&gt; (defrecord Foo [])
user.Foo
(ins)user=&gt; (-&gt;Foo)
#user.Foo{}
(ins)user=&gt; (= (-&gt;Foo) (read-string (pr-str (-&gt;Foo))))
true
```"
713,1551912413.4083,Keenan,"<@Dann> Interesting...I guess two questions:

1. Did this not used to work/be supported out of the box? When I realized I might have an issue I looked around and saw info about reader hints and other stuff that indicated it didn't.
2. If it works as you say with the pr/read combo...what is `transit` providing?"
713,1551912456.409,Dann,"transit allows extension of new type tags without a global reader registry, and it has better performance; what are reader hints?"
713,1551912565.4103,Keenan,"Sorry, using imprecise language. The last example in this ""x in y"" on edn suggests some kind of ""help"" that needed to be given to parse records: <https://learnxinyminutes.com/docs/edn/>; ^^^ <@Dann> The above is the first thing that got me worried I may have issues with deserialization"
713,1551912642.4113,Dann,"~if that document was ever accurate about records, it's definitely wrong now~ see convo below, it's right, I was wrong"
713,1551912692.4121,Keenan,Haha. Good to know...probably not great it's one of the first things you'll see if you're looking for some basic info about it
713,1551913357.4129,Rosaline,the behavior of the functions for reading in clojure.edn differ from those in clojure.core; the clojure.edn functions don't automatically look up records
713,1551913498.4138,Dann,"oh, now I see that"
713,1551913523.4143,Rosaline,the xiny page is about as clear as mud about it
713,1551913582.4149,Dann,"~OK, so another advantage of transit is that it implicitly works with record types without risking code injection via read-eval~
actually it downcasts the record to a hash-map unless you define a custom writer/reader"
714,1551914502.4167,Keenan,"Ah, okay...starting to see what this is about now. Well, darn, I probably do want to go with edn, so I guess I'll have to figure out something there...I will have a lot of record types, and it's going to suck to explicitly declaring each one for reading in edn. Hmmm"
714,1551914641.4174,Jasmine,"You can set a default-data-reader-fn; This is probably not what you want to do, but it might help connect the pieces: <http://insideclojure.org/2018/06/21/tagged-literal/>"
713,1551914771.4189,Jasmine,Also some docs at end of <https://clojure.org/reference/reader>
714,1551915017.4192,Keenan,Thanks <@Jasmine>
715,1551917990.4215,Kerstin,"Hi, how do we check a `spec` across a combination of 2 different keys in a hashmap. eg: `{:user ""string"" :valid :string }` or `{:user nil :valid :nil}`; `:user` can be nilable only when `:valid` is :nil but not when `:valid` is :string"
715,1551918157.4227,Meagan,sounds like it might be a use-case for multispecs?
715,1551918358.4233,Kerstin,How would that work?
715,1551918521.4235,Meagan,<https://clojure.org/guides/spec#_multi_spec>
715,1551918680.4241,Kerstin,"Yeah. I saw that but I don't quite understand how that applies to this case, that seems to apply only to multimethod?"
715,1551918846.4249,Meagan,you use a multimethod to decide which spec to use
715,1551918926.4252,Kerstin,"Okay, I see where you're coming from"
715,1551919039.4265,Meagan,"```
(defmulti user-valid-type :valid)

(defmethod user-valid-type :nil [_]
  ;; return spec to use
  )

(defmethod user-valid-type :string [_]
  ;; return spec to use
  )
```"
715,1551920872.4288,Kerstin,"In this case, I've been ingesting the document the actual `tag` is one level deeper. ie:

```
{:user ""string"" :profile {:valid :string}}
{:user nil :profile {:valid :nil}}
```
So how would that work? The document is a bit hard to parse"
716,1551920916.4292,Dann,a multimethod can use any function for dispatch
715,1551920977.4305,Dann,instead of `(defmulti user-valid-type :valid)` you could use eg. `(defmulti user-valid-type (comp :valid :profile))` or `(defmulti user-valid-type (fn [m] (get-in m [:profile :valid]))`
715,1551921249.4312,Kerstin,What about the last parameter to `(s/multi-spec)` then?
715,1551921354.4315,Dann,"the same thing you pass to defmulti I think; hmm... it seems to be more complicated than that; it is used during generation, and should either be a key (if the dispatch is by a key) or a function that takes a thing and a value and tags the object - so it's like the inverse of the multimethod dispatch function it seems(?)"
715,1551921554.4337,Kerstin,"Yeah, the additional nesting makes it a whole lot complicated it seems."
717,1551928368.4344,Toby,<@Arline> <@Ronald> there's also Walkable which is more expressive <http://walkable.gitlab.io>
718,1551935789.4361,Xiomara,Can somebody briefly tell the difference between (and high level overview of) Socket-REPL and prepl?
718,1551940491.4375,Celestine,"<@Xiomara> prepl is a REPL for other programs -- it offers no prompt and it returns data: a hash map containing the result, the form read, etc. prepl can run locally or over a socket connection.; When folks talk about Socket REPL, they mostly mean a regular REPL (with a prompt, and that prints results) running over a socket connection.; Does that help?"
718,1551940571.4389,Xiomara,"<@Celestine> Thanks, that makes it clear for me. :slightly_smiling_face:"
718,1551940723.4411,Celestine,"Socket REPLs can be started for any process, just by providing JVM options -- that's most how we run REPLs on our processes. You can tell Clojure to start a Socket REPL (added in 1.8) with either a regular REPL (prompts, prints results) or a prepl (new in 1.10, no prompt, returns data). The nice thing is that you can do this for _any_ Clojure process now, external to the code.; I switched to using unravel (based on unrepl) at the command line to connect to process that have a Socket REPL started up, and more recently to Atom + Chlorine for my editor experience that can connect to any Socket REPL -- no need for nREPL etc. Which means I can interact with any of my processes -- locally for dev or remotely on QA/production -- using the same editor or command-line setup, with no server-side deps.; I also use REBL the same way: I start up REBL but also start a Socket REPL via JVM options, and then I can connect to it and `submit` forms and values to REBL for display in the visualization pane.; (I don't know how many people are using REBL in their day-to-day workflow?); I posted an example the other day, showing Atom + Chlorine + REBL running on Windows 10 (via the work-in-progress PowerShell version of `clj`): <https://clojurians.slack.com/files/U04V70XH6/FGKMLGF41/image.png>; (it was on my tiny laptop so it looks a mess -- works great on my 27"" desktop tho' :slightly_smiling_face: )"
718,1551941681.4475,Xiomara,"<@Celestine> Coincidentally, I started thinking about this after reading your Chlorine-Atom blogpost."
718,1551941888.4477,Celestine,That makes me happy :slightly_smiling_face:
719,1551960974.4514,Sonny,"Hey folks, was just doing a little `defprotocol` / `defrecord` / `extend-protocol` / `extend-type` demo to a member of my team here. It's actually been a little while since I really did much of this stuff in anger and at one point I said, ""I'm pretty sure you can just treat Java interfaces as protocols"" and tried to, `extend-protocol` java.lang.Runnable. As it turns out... you _can't_ do this :wink:. Aware of the existence of things like `reify` and `proxy` etc, but I am interested in whether there is a good technical reason why interfaces and protocols can't just be treated as transparently the same."
719,1551961060.4518,Harris,"java interfaces aren't open to extension, clojure protocols are; in java you can't extend a class to an interface _after_ having created that class"
719,1551961272.4541,Sonny,"Ahhh, I see. We actually spoke a little about this. I actually waved my hands and said, ""I guess clojure does some kind of magic to allow for the runtime implementation of interfaces"", instead it separates the concepts entirely. Makes sense. Thanks."
719,1551961288.4543,Harris,"yeah; protocols are backed by an interface for performance; but that's just an implementationd etail; the interface is only used if you extend the protocol inline while defining the type; when you extend an existing type to a protocol, the impl lives in an (open) vtable"
719,1551962562.456,Sonny,Makes sense. Thank you <@Harris>.
720,1551963074.4563,Bernardo,"Just discovered
<https://github.com/dvlopt/clojure-raspberry-pi>

Fascinating"
720,1551963702.4565,Hedy,<@Celestine>  can the Socket REPL be configured for SSL?  Or do you only open the port to certain clients.  thanks by the way for you blog post about Atom + Chlorine.  I am really liking that combination
721,1551966963.458,Eduardo,"In Scala, using a future requires an `ExecutionContext`. Is there anything analogous in Clojure?"
721,1551967018.4591,Celestine,Just a plain socket. We don't open the port on the box -- we use an ssh tunnel over a VPN to connect. 
721,1551967037.4594,Jasmine,no; there is one global pool for futures; it is possible to replace the global executor used for futures with <http://clojure.github.io/clojure/clojure.core-api.html#clojure.core/set-agent-send-off-executor%21> but that's not something most people do (or even know exists)
721,1551967197.4612,Clarine,"<@Eduardo> You can however use libraries that mimick Clojure future but allow passing a threadpool:
<https://github.com/mpenet/knit>
Manifold also allows configurable thread pools"
721,1551967228.4618,Jasmine,or <https://github.com/TheClimateCorporation/claypoole>
721,1551967259.4625,Eduardo,"In the Scala world, it’s a whole other layer of complexity to manage. I’m just curious why we never worry about it in Clojure."
721,1551967329.4631,Jasmine,"well realistically, there are only a finite number of threads :)"
721,1551967361.4641,Clarine,am I right that in Scala you set an implicit somewhere once to a ThreadPool and then never worry about it again? what is the added complexity in Scala?
721,1551967391.4645,Jasmine,"Clojure has an ambient global pool and suggests you use that by default; (well, two global pools - an unbounded cached thread pool for I/O and a bounded thread pool for CPU); futures and agent send-off use the first, send uses the latter"
722,1551968931.4661,Hedy,ahh .  ok makes sense.. thanks
722,1551969535.4667,Arline,<@Celestine> Makes sense. :slightly_smiling_face: <https://clojurians.slack.com/archives/C03S1KBA2/p1551911775401700>
722,1551969678.4674,Min,with pg you could use ANY(?) and pass an array
722,1551969687.4678,Jasmine,friends don't let friends make sql with string concat
722,1551969703.4686,Min,^
723,1551973649.47,Eduardo,"<@Clarine> I just read an article on the three different ways to manage an ExecutionContext in Scala, depending on your goal. So it’s not a set-and-forget, necessarily. But I’m certainly no expert in Scala futures, either."
723,1551973669.4702,Clarine,Me neither; <@Min> I just co-incidentally found an email from 2014 in my inbox and realized it was you I bought a EuroClojure ticket from last-minute
723,1551974298.4714,Min,right!
724,1551975101.474,Ashlie,"Hi all. I'd like to submit a minor change to the <http://clojure.org|clojure.org> website, so I need to sign the contributor agreement. But I can't seem to actually _see_ it, no matter what I do it shows up as ""thumbnail not available"" or a broken image icon. I've tried this in both Safari and Chrome, with/without adblock, I even installed Flash and had someone else check the site, still broken. Any idea what to do so I can sign it?"
724,1551975293.4748,Epifania,"<@Ashlie> seems something is wrong with the image loading, not the image itself. If you visit <https://secure.na1.echosign.com/document/ci/3AAABLblqZhDSsExRd_lWlJxQm5A6RsQuKSIJlSvjgSw_zJ8BPFSdTqI4Xy5JV14UpnUiBQCEbbNtASDjPyMn5hb1a5KjWaQf/z100.png&amp;sns=z100&amp;snp=1> you'll see the actual agreement. You can also not trust my link, and right click, copy image url and visit it manually; that document in general seems broken (<https://secure.echosign.com/public/hostedForm?formid=95YMDL576B336E>)"
724,1551975359.4758,Ashlie,"Didn't think of that. Thanks, good enough for me."
724,1551975490.4764,Jasmine,"there is a CORS error in the echosign site, which seems totally broken; we are aware of it, but are at the mercy of adobe's broken junk afaik; all that stuff is under Rich's account so it's fighting for attention with a lot of other stuff"
724,1551976067.4781,Ashlie,Oh well. I got it submitted still :)
724,1551976644.4787,Jasmine,"it is the url indeed; should be <https://secure.na1.echosign.com/public/hostedForm?formid=95YMDL576B336E>, will fix"
725,1551980576.4815,Nigel,"as a part of an internship programme, I have a setup where I run my tests against the intern’s code. My setup is currently only for Javascript, but I’ve been thinking about a setup like this for Clojure; I guess I’d have to write my own runner for this"
725,1551980675.4823,Clarine,what is your question? if there’s a clojure test runner that works for your needs?
725,1551980788.4836,Nigel,"<@Clarine> - yes. I need two things. One, a way into hook into various stages of execution(before test, after test etc), the other is some way to generate a JSON; if I have the first feature, I can easily obviously build the other; I would like to stick to `clojure.test`"
725,1551980813.4846,Clarine,If you only need the JVM then kaocha can already do this; With CLJS it’s pretty early days for kaocha; you can also use the multimethod that’s in clojure.test maybe
725,1551980837.4856,Nigel,"no, just jvm for now. T hanks <@Clarine> I’ll look into it; This is great. Thanks <@Clarine>; An unrelated question: Have you played with yetibot? I want a project that I can get the interns to hack together on"
725,1551980959.4869,Clarine,<@Nigel> here’s an example of using the hooks in clojure.test: <https://gist.github.com/metametadata/c40a5f099814e591cd627b874f9bb595>; I don’t know yetibot; I usually talk directly to Slack via webhooks
725,1551981065.4878,Nigel,<@Clarine> Thanks. <https://cljdoc.org/d/lambdaisland/kaocha/0.0-389/doc/plugin-hooks> is what I was looking for; so the `test` passed to the hook is a map with test metadata?
725,1551981208.489,Clarine,"If you don’t want to usa kaocha but plain clojure.test, you can use these hooks, is what I tried to say:
<https://github.com/clojure/clojure/blob/master/src/clj/clojure/test.clj#L408>
For questions about <#CCY2V0U6A|kaocha> you better ask in that channel"
725,1551981303.4894,Nigel,thanks.; `clojure.test` is enough for my needs. Thank you
726,1551982632.49,Vinnie,i'm happy to answer any yetibot questions
726,1551983629.4902,Nigel,<@Vinnie> - are you the author?
726,1551983736.4904,Vinnie,yep
726,1551983800.4906,Nigel,"Cool! I’ve a bunch of people that I am planning on teaching Clojure to. I thought it would be a good idea for them to hack on something like Yetibot; Build their own chatbot and at the same time, learn Clojure; those are the goals, broadly"
726,1551983835.4912,Vinnie,cool :slightly_smiling_face: i'm actually doing something similar in a few weeks. teaching a workshop on yetibot to people who are not familiar with Clojure; it's a pretty good project for it because a command is pretty well isolated; don't need to understand the rest to build a command that interacts with an external API
726,1551983926.4918,Nigel,Cool. Let me play with it a bit and see where I go with it
726,1551983943.492,Vinnie,sounds good. just ping me if you need anything
726,1551983953.4922,Bernardo,And ask me anything about... crazy uses for Yetibot: like eval-ing Clojure expressions in Slack; *admin-only feature `:-D`
726,1551983992.4927,Nigel,Lol. :slightly_smiling_face:
726,1551984055.493,Bernardo,"Yep. Stuff like

```
!eval (xml/emit-element (zip/root [{:tag :a, :attrs {:href ""<http://yetibot.com|yetibot.com>""}, :content nil} nil]))
```"
727,1551990757.4948,Scotty,What would be a good interface for a module that provides a wrapper around a serial port (full-duplex)? A pair of `core.async` channels?
727,1551991366.495,Rosaline,You could construct a channel type that wrapped two channels and implemented WritePort using one channel and ReadPort using the other
727,1551991627.4966,Meagan,I think manifold is meant to be a more general interface for async programming: <https://github.com/ztellman/manifold>
727,1551991643.4971,Rosaline,meh
727,1551991684.4982,Scotty,"Hmm, a pair of a source and a sink."
727,1551991691.4984,Rosaline,"manifold provides nice integration with netty, but it is hardly general, and doesn't properly expresses things like choice over streams"
727,1551991791.4995,Meagan,"I haven't used it at all. I just know that in a talk I watched, the reason ztellman gave for creating it was that core.async was more of a app-level abstraction choice; and he wanted a library that didn't force you to warp your application to be core.async-y"
727,1551991850.5011,Rosaline,instead forcing your application to manifoldy; and not having proper choice
727,1551991905.5023,Scotty,Is there really a way to do `alts!` over disparate streams? It's not like Java gives us an analogue of `select(2)` system call.
727,1551991922.5029,Rosaline,java does; you use nio; do it over channels; (nio channels)
727,1551991964.504,Scotty,"I don't see how can I do `nio` on `core.async` channels, or on a `BlockingQueue`, or on a lazy sequence."
727,1551991975.5042,Rosaline,correct
727,1551991991.505,Scotty,So there is no way to implement `alts!` in Manifold.
727,1551991991.5051,Rosaline,core.async's alt only works on core.async channels; You could implement the channel protocols on top of nio channels
727,1551992117.5069,Meagan,manifold doesn't seem to be nearly as infectious as core.async
727,1551992118.5071,Rosaline,I have some concurrent ml kind of experiments that provide concurrent ml events as sync points (instead of sync'ing directly on channels) and extends them to nio operations with a selector; I doubt that; and then has the cml events implement ReadPort
727,1551992196.5079,Meagan,it seems pretty straight forward. functions that return values. without e.g. syntax transforms
727,1551992220.5081,Rosaline,you can do that with core.async too
727,1551992256.5083,Meagan,"anyway, I'm talking out of my ass anyway so I'll assume you've done your due diligence. but I'm curious why it fails to approach its goals given in the rationale: <https://aleph.io/manifold/rationale.html>"
727,1551992266.5085,Rosaline,"if you don't use the go macro, and are on the jvm, you use the thread blocking version of everything, boom same thing; it fails because zach started from netty, a concrete io famework, vs some concurrency formalism; so for example, alts! on some collection of core.async channel ops will succeed for one of them once atomically; where as for manifold, taking from a stream returns a deferred, and then you can us or to make a choice between deferreds, but you cannot untake that deferred from a stram; which is very io like, you cannot un read that stream; but even then, concurrent ml (which builds on the ideas from csp which core.async is built) provides hooks for building transactional io operations"
727,1551992503.5098,Meagan,I don't get the netty connection
727,1551992512.51,Rosaline,"oh; that whole codebase grew out of aleph, which is zach's netty library"
727,1551992547.5104,Meagan,I see
727,1551993199.5143,Rosaline,"the tricky thing with integrating with nio there is naively you assume that similar to core.async having !&gt; and &lt;! on channels, that the integration point is reading and writing to nio channels, which would leave with similar issues to manifold with regard to atomic choice between multiple actions, so the correct integration point is around the selector or the selectionkey (I don't deal directly with nio all that often so the specifics escape me)"
728,1551993208.5147,Clarine,"I have encountered several examples from a clojuredocs dump that use a var called `unchecked-divide`:
```
{:var clojure.core/unchecked-divide,
 :example 582,
 :toplevel nil,
 :sandboxed
 [(def thous 1000)
  (def trill (* thous thous thous thous))
  (unchecked-divide trill 10)
  (/ trill 10)]}
```
but I can’t find this in clojure itself nor on the clojuredocs site. What’s the history behind this?"
727,1551993284.515,Rosaline,old code
727,1551993291.5152,Clarine,<https://dev.clojure.org/jira/browse/CLJ-1545>; it seems like it never made it into clojure (so far)
728,1551993365.5158,Clarine,"the links on this page indeed exist, but point nowhere: <https://clojure.org/reference/java_interop>"
727,1551993369.516,Suzann,<https://github.com/clojure/clojure/blob/8fbafa92faacb92a9bd49fa1e9b7e2c8c0747c07/src/clj/clojure/core.clj#L1015-L1020>; Got removed here <https://github.com/clojure/clojure/commit/6ab3e4cd672092823a04c944210a23c29142785d>
728,1551993422.5172,Suzann,now there is `unchecked-divide-int`
728,1551993447.5175,Clarine,ok — thanks
729,1551998253.5186,Meagan,"this took me way too long to come up with for some reason:
```
(defn deep-merge [x1 x2]
  (cond
    (and (map? x1) (map? x2)) (merge-with deep-merge x1 x2)

    (and (coll? x1) (coll? x2)) (into x1 x2)

    :else x2))
```"
727,1552002638.5191,Kirsten,stackoverflow
727,1552002835.5195,Dann,you'd need a very deep nesting of maps for that to be an issue
729,1552012816.521,Ruthann,Question about datomic ions: is there a way to do a compiler check without pushing to AWS? I am still new to Clojure…
729,1552036144.5236,Clarine,"Funny:
```
 $ clj -Sdeps '{:deps {org.clojure/clojure {:mvn/version ""1.5.0""}}}' -e '(pr-str (quote))'
""nil""
$ clj -Sdeps '{:deps {org.clojure/clojure {:mvn/version ""1.10.0""}}}' -e '(pr-str (quote))'
Wrong number of args (0) passed to quote
```
Seems like a breaking change to `quote`. Not important, just something I found while mining clojuredocs :slightly_smiling_face:.; Same with `clj -Sdeps '{:deps {org.clojure/clojure {:mvn/version ""1.5.0""}}}' -e '(pr-str (quote 1 2 3 4 5))'`, doesn’t seem to work anymore.
I came across that code here: <http://clojuredocs.org/clojure.core/quote#example-542692d0c026201cdc326ea2>"
730,1552036832.5253,Roselle,"Nothing to add here, just noting how trivial it was to test this with `clj`"
731,1552037311.5275,Melynda,Hi! Is there a short form for something like `(update coll #(map (fn [item] (if (condition item) (modify item) item)) %))`? Something like a `:when` for updating a collection?
729,1552037894.528,Clarine,"not really. maybe specter offers something really short here, but that would be a library"
729,1552038217.5282,Melynda,<@Clarine> Thanks!
732,1552041439.5287,Emmy,"hmmm
`wat`
```
user=&gt; (type 1)
;;=&gt; java.lang.Long
user=&gt; (case (type 1)
         java.lang.Long :long
         java.lang.Double :double
         :something-else)
;;=&gt; :something-else
user=&gt; (= (type 1) java.lang.Long)
;;=&gt; true

```; oh because case is a macro?; It doesn't evaluate the test?"
732,1552041565.5312,Clarine,"no sorry, that’s only the case for the values on which it dispatches.
```
(macroexpand ' (case (type 1)
         java.lang.Long :long
         java.lang.Double :double
         :something-else))
(let* [G__141 (type 1)] (case* G__141 1 1 :something-else {0 [java.lang.Long :long], 1 [java.lang.Double :double]} :compact :hash-equiv nil))
```; (else `case` would be pretty useless)"
732,1552041602.5319,Emmy,mm
732,1552041678.5326,Clarine,"```
(case 'java.lang.Long java.lang.Long :long) ;;=&gt; :long 
```
so the symbol is not evaluated; the class is not a compile time constant is what it boils down to"
732,1552041878.5333,Harris,"```user=&gt; (case (type 1) #=java.lang.Long :long :else)
:long```; just beware that if you AOT compile this, it may break between different jvm versions, since it relies on the class hash identity"
732,1552041946.5341,Clarine,"in other words, just go with `cond` here"
732,1552041950.5343,Harris,"yep; or if you need constant~ish time dispatch, use a protocol or a multimethod instead"
732,1552042090.5355,Alleen,"```
(case (symbol (.getName (type 1)))
  java.lang.Long :long
  java.lang.Double :double
  :something-else)
```"
733,1552042430.5356,Roslyn,What is this magic?
732,1552042513.5359,Clarine,clever :slightly_smiling_face:
733,1552042768.5361,Harris,read-eval; don't think it's documented anywhere
734,1552044638.5393,Danna,"multimethod sanitycheck -
If I declare
```(defmulti example-multi (fn [arg] (:type arg)))```
and I want to create a default method that returns a string,  it always feels like I ought to be able to write something like
```(defmethod example-multi :default str)```
but I've never got that to work, and instead I have to invoke it manually
```(defmethod example-multi :default [arg] (str arg))```

Am I missing something here, or is it just not possible?; my driver is that plain old functions are easier to work with than multi-method tentacles
I would like multi methods to be solely about dispatch/invocation and not contain any other functionality"
734,1552044883.541,Emmy,yeah I figured that I was probably doing it wrong with case to do runtime type dispatch when protocols and multimethods exist; but then got more caught up with why it didn't work
735,1552047560.5435,Sina,"I want to write some property tests, and I have done that before with `clojure.test.check`.

However, am I right in thinking that I could just write some spec for my functions and get the property testing for “free”?"
735,1552047646.5445,Clarine,"in a lot of cases yes, unless you use `s/and` + some predicates, these will mostly require writing a generator"
735,1552047648.5447,Gilberto,"You still need to write your properties, you just get generators ""for free""."
735,1552047705.5458,Sina,"Right, I suppose I’m more asking, is there any reason why I would still use `test.check`, rather than using spec and getting a bit more bang for my buck?; &gt; You still need to write your properties
ah wait so I _do_ still need `test.check` to actually do the tests. Thanks <@Clarine> and <@Gilberto>"
735,1552048024.5497,Gilberto,"Yep - you still need to do `for-all`, you can just use your specs to generate the data. You can also use your specs to validate something is conformant to a spec (via `valid?`) in your property so you do get plenty of mileage with spec, but it won't give you properties for free.

Not entirely related to this I also highly recommend using <https://github.com/gfredericks/test.chuck> if you are not doing that already."
735,1552048148.5508,Sina,"Awesome, thanks"
736,1552052357.5514,Danna,<https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/LispReader.java#L115>
737,1552056941.5534,Deb,I'm using deps.edn for my project. Is there a way to list which dependencies have newer versions available?
737,1552056976.5538,Clarine,yes: <https://github.com/Olical/depot>
737,1552058096.5549,Danna,"I was hoping to
```
(extend-type PGobject
  Named
  (getNamespace [^PGobject this] (.getType this))
  (getName[^PGobject this] (.getValue this)))
```
but it gives me
```CompilerException java.lang.IllegalArgumentException: interface clojure.lang.Named is not a protocol, compiling:```"
736,1552058130.5556,Danna,is there a convenient way round this? Do I just have to accept that I cannot do it?
737,1552058190.556,Jasmine,"Named is an interface, not a protocol, so you can't use extend with it"
737,1552058224.5565,Danna,is that an intentional choice?
737,1552058284.5581,Jasmine,"well, intentional in that it's not possible"
737,1552058285.5582,Clarine,"I’m using clojail and need to add a permission to read a Property. I thought this is how I should do it:
```
grant {
  permission java.security.AllPermission;
  permission java.util.PropertyPermission ""line.separator"", ""read"";
};
```
but I’m still getting access denied (“java.util.PropertyPermission” “line.separator” “read”) when using `clojure.pprint` in the sandbox"
737,1552058361.5586,Jasmine,"presuming that PGObject is  a Java class, it can't be retroactively made to implement an interface (Java classes  are closed  for extension). Clojure protocols are open for  extension, which is why they're cool."
737,1552058415.5588,Danna,I guess i'm asking why `Named` is not a protocol
737,1552058449.559,Jasmine,well it's in the guts of Clojure and was created several years before protocols existed
737,1552058455.5592,Danna,"the PGObject is a convenient way of hooking into Postgres enum types; ah okay, so its an accident of history"
737,1552058466.5596,Clarine,"it is in ClojureScript which benefited from being created later:
<https://github.com/clojure/clojurescript/blob/master/src/main/cljs/cljs/core.cljs#L839>"
737,1552058478.5599,Danna,"rather than a deep design decision; ah well
thanks"
737,1552058510.5603,Jasmine,"yeah, most of the core abstractions in Clojure are Java interfaces (CLJS had the benefit of hindsight)"
737,1552058950.561,Clarine,"I fixed it now by customizing the `:context` arg to:
```
:context (-&gt; (permissions (java.util.PropertyPermission. ""line.separator"" ""read""))
                                         domain
                                         context)
```
Apparently this policy file is needed but ignored"
737,1552060470.5666,Danna,"so I can achieve a similiar result using `proxy`
```
(proxy [PGobject clojure.lang.Named] []
  (getNamespace [] (.getType this))
  (getName [] (.getValue this)))
```"
737,1552060498.567,Clarine,Or just a function
737,1552060507.5673,Danna,is that going to reflect?; <@Clarine> not quite clear what you mean
737,1552060542.5681,Clarine,you can check with *warn-on-reflection* and add a type hint; you can make a function which turns a PGObject enum thing into a keyword; this is usually how I do it: when reading from the database turn it into something clojure-y instead of working with those objects directly
737,1552060617.5694,Danna,"well the point of doing this is that I want to call `(comp keyword name)`; because I'm not sure if its a PGObject or just a keyword; computer says ```Reflection warning, /tmp/form-init3318477797552259570.clj:2:20 - reference to field getType can't be resolved.
Reflection warning, /tmp/form-init3318477797552259570.clj:3:15 - reference to field getValue can't be resolved.```"
737,1552060673.5703,Clarine,the point I’m making is that I would get rid of the PGObject as soon as possible and not expose it beyond the database layer
737,1552060716.5707,Danna,"yeah, you are prolly right"
737,1552060747.5714,Jasmine,"if you're proxying you're already switching objects, might as well make it what you want"
737,1552060795.5723,Danna,I wasn't sure if proxy _automatically_ inferred type of *this*; but clearly it doesn't
737,1552060857.573,Rosella,"I'm using clojure.java.jdbc to access a Microsoft SQLServer database. I'm using the following database connection structure: {:subprotocol jtds:sqlserver, :subname //192.168.2.129:1433;database=demo;integratedSecurity=false, :user sa, :password whatever}. I'm connecting as the system admin, so I have access to the demo database, but the JDBC connection is binding to the default database, master, rather than the specified database, demo. Has anyone having experience with MS SQLServer and/or the JDBC driver seen anything like this? Any ideas as to why the driver isn't honoring the database parameter specified in :subname?"
737,1552060975.5735,Danna,might you  have got the syntax of that URL wrong?; sometimes the default database parameter name gets changed or moved; this is a very old memory I'm dredging up; ? intead of ;; that sort of thing
737,1552061406.5799,Rosella,"Oh, I understand now. The sad thing is that that isn't an actual URL. It's just a parameter string to the MS SQL Server JDBC driver, which has about fifty different optional parameters that can be appended to the servername and port (as detailed in the page <https://docs.microsoft.com/en-us/sql/connect/jdbc/setting-the-connection-properties?view=sql-server-2017>). It appears that databaseName is a synonym for database and I'll try that. The odd thing is that this connection structure worked about two years ago when I last ran this program."
737,1552061430.5802,Danna,two years is a long time
737,1552061443.5805,Rosella,Sure seems to be.
737,1552061463.581,Danna,in the days when SQL server 2017 was Young-And-Wild-And-Free
737,1552061946.5821,Scotty,<http://classicprogrammerpaintings.com/post/183312119276/clojure-programmer-at-work-henri-lebasque>; Well done.
738,1552064199.5851,Celestine,"<@Rosella> I'm more likely to see `clojure.java.jdbc` questions in <#C1Q164V29|sql> -- FYI. My first reaction is ""don't use the subprotocol/subname format of DB spec"" -- use dbtype/dbname per the docs. It's much better supported and easier to use. Then you should be able to specify `:integratedSecurity false` directly in the DB spec hash map."
739,1552084705.5871,Holly,"can I make a var `:dynamic`?; ```
(def x 1)

(alter-meta! #'x assoc :dynamic true)

(doseq [i (range 1 10)]
  (with-bindings {#'x i} ;;complains, cant dynamically bind a non-dynamic var
    (println x)))
```; my guess is alter-meta should work"
739,1552084775.5885,Dann,"as I understand it the :dynamic metadata changes how the def is compiled, in order to create a dynamic var; applying the metadata after the var already exists skips the actual thing that makes the var dynamic"
739,1552084833.5893,Holly,"thats my guess, but it's a shame isn't it? :stuck_out_tongue:"
739,1552084866.5896,Dann,"there's a setDynamic method on clojure.lang.Var; <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Var.java#L106>; I assume the code that implements def decides whether to call that method; yeah, that happens in compiler.java <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Compiler.java#L431>"
739,1552084981.5911,Holly,crap
739,1552085004.5914,Dann,why can't you just use setDynamic? it's public
739,1552085225.5921,Holly,"it worked, wow.; tks"
740,1552093109.5925,Catalina,"After reading this great post <http://insideclojure.org/2016/03/16/collections/> I want to kind of extend clojure abstractions to a custom Java type so it can act just like a map and it can be manipulated elsewhere in the code (including libraries) with standard functions like `assoc`, `dissoc`…

The following code doesn’t work, but here is the idea.

```
(extend MyCustomJavaType
  Counted ;;  - countable collections
  (count [this])

  Indexed ;;  - extends Counted, allows index-based lookup
  (nth [i])
  (nth [i not-found])

  Associative ;;  (extends ILookup)
  (containsKey [key])
  (entryAt [key])
  (assoc [key val]))

(assoc (MyCustomJavaType.) :a 1)
;; =&gt; #&lt;something&gt;
```

- How to express it in Clojure? I thought protocols are Java interface, but this previous isn’t valid.
- Where can I find all the interfaces I need to implement to be 100% sure my object will be treated like a map?"
740,1552093197.5935,Dann,"why not use defrecord? that lets you have something that acts like a hash-map but you can implement more interfaces / protocols; there's also a library with functions for making  a map-like thing if defrecord isn't flexible enough <https://github.com/ztellman/potemkin#def-map-type> (with the warning here that the author considers the things in this library ""almost good ideas""); <@Catalina> and regarding ` I thought protocols are Java interface, but this previous isn’t valid.` - protocols use interfaces as an implementation detail, but extend only works on protocols not interfaces; the jvm doesn't let you add methods to a class that already exists at runtime; extend basically implements a dispatch table that protocol methods use if they can't find the method directly on a target"
741,1552108454.5985,Nigel,How does performance differ between `(apply merge list-of-maps)` vs `(reduce merge {} list-of-maps)` ?
742,1552110723.599,Madeleine,Not in a way that matters
741,1552112418.5992,Nigel,That’s what I thought
743,1552116503.5999,Vernia,"The variadic arity of core functions is often optimised, so `apply` is faster in some cases. In this case it doesn’t really matter since `merge` only has a single arity, which uses `reduce`. An example where there is a difference is `apply str` vs. `reduce str` – the former is faster because the variadic arity of `str` uses a single `StringBuilder`; A counterexample is `apply +` vs. `reduce +`. The latter is faster, because the variadic arity of `+` has to use the slower `reduce1` due to `reduce` not yet being defined"
743,1552116621.6003,Sixta,But `(reduce +)` is faster than `(apply +)` :smile: benchmarking is the best way to find out if you care 
743,1552116633.6005,Vernia,":ninja:; Agreed about always benchmarking though, and even better than benchmarking is profiling w/ real use cases"
743,1552116731.6009,Nigel,Thanks a lot
743,1552117020.6013,Vernia,Somewhat-related: there is a ticket looking at the performance of `merge` – <https://dev.clojure.org/jira/browse/CLJ-1458>
744,1552120626.6023,Nigel,"How can I get the source of a test? I have a bunch of tests in a namespace, and I need to randomly yield a test to someone(like koans let’s say). So far I have `(filter (comp nil? :test second) (ns-interns 'some-ns))`; The above gives me a list of all the tests in that namespace; What I want now is to randomly pick a test and get its source. I could use `source` but that’s in `clojure.repl`; But that won’t work really"
744,1552120876.6038,Sixta,What's wrong with that?
744,1552120928.6044,Nigel,"<@Sixta> - I am not sure `source` is able to see it; `(map (comp #(source %1) first) (filter (comp nil? :test second) (ns-interns 'mars-rover.plateau-test)))`; source is not found.; test is defined using `deftest`; Ah darn; Ok, got it; its a symbol and a fully qualified namespace problem; Ok, another foolish question. Is there a simple/canonical way of finding all test based namespaces? Do I just ferret under the `test` dir?"
744,1552121514.6074,Sixta,"Check the orchard codebase, it has a query namespace which can do this; It's designed for building tooling"
744,1552121604.6085,Nigel,Thanks <@Sixta>
744,1552121606.6087,Sixta,"I sometimes write tests inline rather than separately, so searching test folder bothers me. :); I'm an orchard contributor, feel free to bother me if you need help. <#C17JYSA3H|nrepl> is probably the best channel for help with orchard generally, we are all tooling authors."
744,1552121703.6109,Nigel,"<@Sixta> - my use is as follows. I have a bunch of interns and I want to provide them a koan like experience, but with a slightly more gamified environment. They get a random test yielded to them, upon completion of which they get another etc.; So this system has to take their submission, evaluate and provide a test to them; so, an inline test is not a concern at the moment; How do I get a symbol out of a var?; I’ve a bunch of interned vars in a namespace. I am using `(ns-interns 'my-namespace)` to get a map. Now, I want the source of every interned var here.; The map that `ns-interns` returns has a symbol as the key and the value contains a var that the symbol is interned as; `source` accepts a symbol. But the symbol that `ns-interns` returns is not namespace qualified"
744,1552122964.616,Vernia,"Call `meta` on the var to get a map of its metadata; Sorry, I misread – you already have the name to hand if you’re using `ns-interns`"
744,1552123059.6179,Nigel,Yeah; But it is not namespace qualified; So I have to hand it myself I guess
744,1552123130.6199,Vernia,"Yeah, I think just create it yourself (the `symbol` function has a two-argument arity for this)"
744,1552123136.6201,Nigel,"Effectively, I want something as follows: `(map the-source-of (ns-interns 'my-namespace))`"
744,1552123915.6202,Vernia,"Try the following:

```
(defn ns-sources
  ""Returns a mapping from name to source for the namespace's interned vars.""
  [ns]
  (-&gt;&gt; (keys (ns-interns ns))
       (into {} (keep (fn [n]
                        (when-let [s (clojure.repl/source-fn (symbol (str ns) (str n)))]
                          [n s]))))))
```"
744,1552125169.6205,Nigel,Jeez! Thanks a ton <@Vernia>
745,1552131821.6225,Sixta,Has anyone played with pagination and the new Nav protocol? I'm trying to provide a simpler interface to navigate a HTTP api lazily.
745,1552132917.6238,Isa,"deps.edn
`github-kwladyka/form-validator {:git/url ""<https://github.com/kwladyka/form-validator-cljs.git>"" :sha ""5917f9c4fc3c0ea0f22d71bc6a9f1c1257a72319""}`

Do we have any way to use `:tag` instead of `:sha` for `deps.edn`? How do you solve versioning with git deps?"
745,1552133452.6242,Nigel,"Is `clojail` still being maintained? If not, is there an alternative?"
744,1552134066.6248,Clarine,"<@Nigel> I’m using it myself with a minor tweak (added a deps.edn file, forked from someone who upgraded to clojure 1.10)"
744,1552134101.6252,Nigel,"<@Clarine> - ok, because the github page hasn’t had a commit in a while."
744,1552134116.6256,Clarine,"the author is no longer with us, he passed away in 2016"
744,1552134127.6259,Nigel,Oh damn. I’m sorry to hear that.
744,1552134156.6261,Clarine,"<https://www.reddit.com/r/Clojure/comments/5gyyxw/clojure_open_source_contributor_anthony_grimes/>; here’s my fork of a fork. It still works well. I’ve been parsing examples from clojuredocs and executing them in a safe environment:
<https://github.com/borkdude/clojail>"
744,1552134614.6275,Sixta,Clj has a -Sresolve-tags command
744,1552134803.628,Nigel,That’s ridiculously crazy given that so much more has been added in clojure since then.; Sad to hear this
744,1552134903.6289,Clarine,"Yeah, since there’s been stuff added to Clojure, there might be some things that should be added to the “forbidden vars”, like requiring-resolve maybe.; but since that calls resolve, it’s probably already fine"
744,1552134996.6295,Isa,"Oh, I didn’t notice it. How does it work? `github-kwladyka/form-validator {:git/url ""<https://github.com/kwladyka/form-validator-cljs.git>"" :tag ""v1.0.0""}` and after `clj -Sresolve-tags` `:sha` will be added? I can’t find any explanation about it in google.; Anyway I would like too see something what work on the fly, not overwrite deps.edn. But better this, than nothing :slightly_smiling_face:"
744,1552135213.6302,Clarine,but it does attest to Clojure’s and Java’s strength that it still works :slightly_smiling_face:
744,1552135852.6303,Sixta,"it adds the :sha to anything that's missing it, yeah :slightly_smiling_face:; I also wrote a version which preserves comments/formatting/whitespace: <https://github.com/SevereOverfl0w/clj-resolve-tags/>"
744,1552136241.6309,Isa,:+1:
744,1552136513.6317,Clarine,Does someone remember what I refer to here? <https://twitter.com/borkdude/status/1104366075561549824>; already found it in the podcast
746,1552141515.6322,Sixta,"<@Celestine> I suppose this is similar to jdbc ResultSets? I'm now considering reducers, but I seem to recall you having an issue with them?"
744,1552148396.6327,Clarine,"<@Nigel> In case you want to see it, here’s the code I used clojail with:
<https://github.com/borkdude/speculative/blob/master/test/speculative/clojuredocs.clj>"
744,1552149474.6333,Nigel,Thanks <@Clarine> - I’ll take a look
746,1552149598.6336,Nigel,This is so neat! So a basic blacklist
744,1552150218.6344,Clarine,"yeah, that is also how 4clojure works where it forbids certain functions"
746,1552151200.6348,Nigel,I am guessing I can also timeout potential infinite loops; seems like I can. the api has a timeout
746,1552151244.6354,Clarine,"yep, it has a timeout by default turned on as well"
746,1552151835.6365,Celestine,Not sure what you're thinking of <@Sixta>? Reducible queries maybe? 
747,1552153945.6368,Ruthann,Hi. I have a noob question. I am using tools.dep with Datomic Ions. I want to be able to compile locally instead of having to push to see error messages. Anyone know how to do this?
747,1552154524.639,Celestine,"<@Ruthann> You'll need to create a `classes` directory and either add it to `:paths` or use an alias and add it it `:extra-paths` and then use a `:main-opts` to invoke the compiler for the namespace `-e ""(compile 'your.namespace)""`; (if I'm understanding your question correctly); But I think I'd really recommend adjusting your editing workflow to rely more on a REPL running in the context of your project and make sure you eval the code into the REPL regularly as you're working -- since that will also _compile_ the code locally (in the REPL).; As a general rule of thumb, in my opinion, you should evaluate all the code you write into the REPL, as you're writing it. That way you don't even leave your editor and you have the fastest possible feedback loop."
747,1552155087.6431,Ruthann,"Thanks <@Celestine>. I tried using a REPL for this as you suggested, but the Datomic Ions has dependencies in AWS that are not downloaded to my computer. This is causing difficulties for me."
747,1552155330.6442,Celestine,"For _compiling_ code, you should only need the library deps specified locally -- it wouldn't need to _run_ the code (but I would run as much code as you can before pushing it up to AWS).; You may find more specific assistance in the <#C03RZMDSH|datomic> channel around workflows for Ions (I haven't used them, but I have worked with code that depends on AWS services and libraries, from my local REPL)."
747,1552156101.6453,Sixta,"<@Celestine> I found a thread about you implementing IReduce or something?

And I seem to remember you planning to change something about that?; For jdbc ""2"""
747,1552156194.6463,Ruthann,Thanks so much for your help <@Celestine>. I did not know there was a <#C03RZMDSH|datomic> channel.
747,1552156382.6464,Celestine,"`clojure.java.jdbc` introduced `reducible-query` ages ago that implements `IReduce`.; `next.jdbc` will only implement `IReduceInit` (which greatly simplifies things). Neither of those have anything to do with `datafy`/`nav` tho'...; An example (from `next.jdbc`): ```  ;; raw java
  (defn select* [^Connection con]
    (let [ps (doto (.prepareStatement con ""SELECT * FROM fruit WHERE appearance = ?"")
               (.setObject 1 ""red""))
          rs (.executeQuery ps)
          _ (.next rs)
          value (.getObject rs ""name"")]
      (.close ps)
      value))
  (quick-bench (select* con))

  ;; almost same as the Java example above
  (quick-bench
   (reduce (fn [rs m] (reduced (:name m)))
           nil
           (execute! con [""select * from fruit where appearance = ?"" ""red""])))
```; (there's syntactic sugar wrapping available but that's the raw, under-the-hood call); And that currently looks a bit like this ```(defn- reduce-stmt
  """"
  [^PreparedStatement stmt f init]
  (if (.execute stmt)
    (let [rs     (.getResultSet stmt)
          rs-map (mapify-result-set rs)]
      (loop [init' init]
        (if (.next rs)
          (let [result (f init' rs-map)]
            (if (reduced? result)
              @result
              (recur result)))
          init')))
    (f init (.getUpdateCount stmt))))

(extend-protocol Executable
  Connection
  (-execute [this [sql &amp; params] opts]
            (let [factory (pre-prepare* opts)]
              (reify clojure.lang.IReduceInit
                (reduce [_ f init]
                        (with-open [stmt (prepare-fn* this sql params factory)]
                          (reduce-stmt stmt f init))))))
...```; (I'm still figuring out how best to handle statements that produce update counts instead of result sets)"
748,1552159125.6476,Sixta,I must be misremembering. I thought someone had done some experimenting in another repo with performance maybe
749,1552172201.6487,Malik,"what's the difference between `(Integer. ""1"")` and `(Integer/parseInt ""1"")`"
749,1552172283.6489,Clarine,"seems to be the same thing:
<http://hg.openjdk.java.net/jdk8/jdk8/jdk/file/687fd7c7986d/src/share/classes/java/lang/Integer.java#l867>"
749,1552172294.6491,Malik,ahhh ok; thanks
750,1552174132.6497,Jasmine,Use the latter; It will cache integer values around 0. The former always constructs a new object
750,1552174196.6508,Malik,ahhh ok
749,1552177902.6515,Malik,is there a way to do `(map Integer/parseInt coll)`? it barfs on using a java function like that
749,1552178063.6518,Meagan,you have to wrap it in a function; `(map #(Integer/parseInt %) coll)`
749,1552178107.6529,Malik,ok; that's what I was doing but I figured there might be a trick
749,1552178126.6534,Meagan,"or,
```
(defn parse-int [n]
  (Integer/parseInt n))

(map parse-int coll)
```"
749,1552178131.6536,Malik,"right; I'm doing ```(defn parse-int [string-to-parse]
  (Integer/parseInt string-to-parse))

(defn split-to-digits [num]
  (as-&gt; num n
    (str n)              ;; convert to string
    (string/split n #"""") ;; split to digits
    (map parse-int n))   ;; parse digits back into integers
)
```; which seems reasonable; I love threading macros so much"
749,1552178345.6559,Meagan,yeah :smile: I miss it in every other language
749,1552178371.6563,Malik,elixir's pipe operator is good too but it only does first arg; but you can do anonymous functions to trick it out and pass the arg in another position; but it's just ugly; <https://exercism.io/tracks/clojure/exercises/armstrong-numbers/solutions/c91ba2cff80645c6a28e671a73668e4e>
749,1552178423.6578,Meagan,yeah. I remember being unsatisfied with the pipe operation both in Elixir and ReasonML
751,1552186844.658,Celestine,"`next.jdbc` is a lot about performance, building on the performance of `reducible-query` compared to `query`, and also by using protocols more heavily."
752,1552188840.6587,Elly,Any cool open source DSLs?; Honestly I'm not sure what the difference between a DSL and a library of utility functions is.
752,1552189724.6598,Nigel,<@Elly> DSL for?
752,1552189750.6602,Elly,<@Nigel> anything popular and/or considered good code.; Just want to see what constitutes a DSL.
752,1552189849.6608,Nigel,"Instaparse; at some level, isn’t Leiningen a DSL of sorts?"
752,1552190032.6617,Elly,So what makes Instaparse a DSL vs a library?
752,1552190037.6619,Nigel,hiccup; Because you can use most if not all functionality of both hiccup and instaparse without having to muck about too much with Clojure itself; But the definition is sketchy
752,1552190131.6637,Elfriede,I think it's a library for implementing DSLs
752,1552190149.6639,Elly,hiccup looks much more DSLish; to me
752,1552190260.6644,Nigel,<@Elly> - agreed
752,1552210311.6689,Elly,"If I'm writing a monolithic app in Clojure but I want to go with a container like Kubernetes or Docker to simplify deployment, which one should I choose? Is there one I haven't mentioned?; Nvm I'm retarded. I knew that Kubernetes had something to do with containers, thought it's a container.; Turns out it's not really a competitor to Docker whoops.; Oh shit I remember why I gave up on Docker before.; Requires Windows 10 Pro or Enterprise.; Now isn't that some bullshit."
753,1552214887.6715,Epifania,Pretty sure I run docker without either Windows 10 Pro or Enterprise :slightly_smiling_face: You can always give virtualization a try (running Ubuntu in VirtualBox)
754,1552217899.6731,Scotty,"Could someone recommend a library for parsing binary data in Clojure? The format is not very complicated, but it has variable-length fields with a length specified in the packet body, and a moderate amount of branching."
755,1552224609.6733,Ferne,ztellman might have a library for that
755,1552230497.6752,Guy,"I was looking at the guestbook application from Luminus, it was using nrepl.server, I am trying to understanding what is the need for nrepl.server? does it open a port in production which I can connect cider to?"
752,1552235563.677,Clarine,"I have some weirdness when executing examples in a sandbox (clojails). In the REPL (works) vs running with tools/deps -main function from the command line (fails). In the REPL it works, but from the command line I get:
```
""executing"" (send counter inc)
Exception in thread ""clojure-agent-send-pool-0"" ""executing"" (clojure.core/deref counter)
java.lang.IllegalMonitorStateException
	at java.util.concurrent.locks.ReentrantLock$Sync.tryRelease(ReentrantLock.java:151)
	at java.util.concurrent.locks.AbstractQueuedSynchronizer.release(AbstractQueuedSynchronizer.java:1261)
	at java.util.concurrent.locks.ReentrantLock.unlock(ReentrantLock.java:457)
	at java.util.concurrent.LinkedBlockingQueue.take(LinkedBlockingQueue.java:449)
	at java.util.concurrent.ThreadPoolExecutor.getTask(ThreadPoolExecutor.java:1074)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1134)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
	at java.lang.Thread.run(Thread.java:748)
```
and
```
""executing"" (send pulp-fiction assoc :act-two ""VINCENT VEGA &amp; MARSELLUS WALLACE'S WIFE"")
Caused by: java.lang.RuntimeException: Agent is failed, needs restart
	at clojure.lang.Util.runtimeException(Util.java:225)
	at clojure.lang.Agent.dispatch(Agent.java:238)
	at clojure.core$send_via.invokeStatic(core.clj:2109)
	at clojure.core$send_via.doInvoke(core.clj:2101)
	at clojure.lang.RestFn.applyTo(RestFn.java:146)
	at clojure.core$apply.invokeStatic(core.clj:671)
	at clojure.core$send.invokeStatic(core.clj:2120)
	at clojure.core$send.doInvoke(core.clj:2111)
	at clojure.lang.RestFn.invoke(RestFn.java:464)
	at sandbox4362$eval4454.invokeStatic(NO_SOURCE_FILE:0)
	at sandbox4362$eval4454.invoke(NO_SOURCE_FILE)
```
It’s this example from clojuredocs:
<https://clojuredocs.org/clojure.core/agent>; I think I’ll just exclude this example, but it’d be nice to know what’s causing this"
755,1552240431.6793,Jasmine,"Code looks ok to me; If you want to make a jira, go for it"
752,1552252369.6821,Clarine,"With leiningen + clojails I get the same thing. For now I find it too time consuming to find out why this particular example doesn’t work outside the REPL, so I’ll leave it for now."
756,1552253531.6835,Tonya,I'm trying to setup my website to use clojurescript and I want to have two directories src/clj and src/cljs for the different source files. I'm using Lein and am unsure how to specify this new directory structure. Anyone have solutions?
752,1552253964.6838,Clarine,<@Tonya> Here I’ve got a project like that: <https://github.com/borkdude/lein2boot>
752,1552254607.6845,Tonya,<@Clarine> Thank you that is perfect.; <@Clarine> what if I don't want to use figwheels static server function. I desire figwheel to automatically recompile my code as I use a ring handler to serve the static content.
752,1552255847.6864,Clarine,I believe that’s what the project in the link does too; I just ignore the figwheel server
752,1552255861.6868,Tonya,Where does it specify that?; Oh so its running you just ignore it.
752,1552256012.688,Clarine,"I think lein figwheel reads the cljsbuild config, at least that’s my vague memory about it. I’m pretty sure it worked back then, since it was a requirement that I wanted to replicate in boot"
752,1552256021.6882,Tonya,Okay thank you.; <@Clarine> thank you for your time and help.
752,1552256065.6889,Clarine,"yeah, maybe you can pass an option to not start a static file server but it wasn’t important to me"
757,1552261065.6896,Tonya,Can I connect cider to clojurescript and clojure simultaneously?
757,1552261107.6902,Meagan,"typically I have two REPLs open: one for the Clojure process, and one for the ClojureScript process"
757,1552261122.6905,Tonya,"Yes, then how do you connect to both?"
757,1552261166.6912,Meagan,"mm, I just `cider-jack-in` inside of a .clj file, and then `cider-jack-in-clojurescript` inside of a .cljs file"
757,1552261193.6918,Tonya,"Okay, makes sense.; I use cider-connect; instead of cider-jack-in but I'm sure it's easy"
757,1552261216.6927,Meagan,"if you already have e.g. a clojure REPL and a figwheel process running, you can connect to the Clojure REPL and then connect again to the figwheel REPL"
758,1552267869.6934,Tonya,Is it possible to pass data from clojure -&gt; reagent as in my fake example?
757,1552273389.6956,Connie,None; None
759,1552273988.6969,Gemma,Hi. How can I print to repl? Unfortunately putting println in functions the backend uses doesn't work
757,1552274610.697,Meagan,yes. what I typically do is print the data to a string and put it inside of a `&lt;script&gt;` tag; e.g. `__QUERY_PARAMS__ = ...stringified params...`
759,1552275145.7001,Lana,"Is anyone familiar enough with pomegranate and dynapath to help me figure out how to integrate them into my project? I provide an environment where people can add code in the field, and I compile and run it. I wanted to be able to let them pull in their own dependencies, and pomegranate seemed like the answer, but it is blowing up saying it can’t find a suitable class loader to modify, even though in my startup code I tried setting my context class loader to a `clojure.lang.DynamicClassLoader`. Unfortunately, the readme for pomegranate just says “you will need to explicitly enable the java.net.URLClassLoader support in dynapath (upon which pomegranate relies for such things)” and does not say *how*. Nor can I find anything that seems helpful in the dynapath read-me."
760,1552282366.7015,Marcie,"hi who used expo on cljsrn?; lein new expo myapp +reagent  then  exec ‘(start-figwheel!)’ in repl   but it’s error ,it’s con’t found evn.dev/ip; None; None"
759,1552296946.7041,Clarine,"Using tools.cli I want to parse a repeat number of the same argument and collect into a vector:
```
(parse-opts [""-n"" ""1"" ""-n"" ""2""]
              [[""-n"" ""--num NUMBER"" ""Run example number""
                :parse-fn #(Integer/parseInt %)
                :default []
                :update-fn conj]])
```
Why is `num` still the empty vector here?"
760,1552297307.7043,Clarine,"oh I see, I have to use `assoc-fn`"
761,1552298930.708,Isa,"I am thinking today about databases and tools around Clojure. What is your stack of dream for FE+BE? Datomic is cool, but it is too expensive for me. So I am talking about free DB, tools. I like idea of EQL, but I didn’t use it. I like idea of using `:user/id` instead of `:id` in query and insert / update. I am trying to find tools in Clojure / ClojureScript which will let me use databases in this new way. It needs to be stable and popular, it is too critical to choose something on early stage. Do you have your thoughts in this topic?"
760,1552298990.7087,Isa,I back to this topic from time to time and each time I don’t feel satisfied.
761,1552299033.7097,Chanelle,there is free datomic version?
761,1552299058.7098,Isa,"<https://www.datomic.com/get-datomic.html>; there is starter, but you have only 1 year update; there is also `datomic free` but it is limited AFAIK; Anyway it sounds like a trap :slightly_smiling_face:"
761,1552299090.711,Clarine,"Stable and popular, but free for commercial use? There are other triplestores like <https://jena.apache.org/documentation/tdb/> or Neo4J ?"
761,1552299110.7112,Chanelle,<https://github.com/walkable-server/walkable>; but feels a bit like orm to me…
761,1552299128.7118,Isa,"neo4j probably wouldn’t be the best choice for warehouse, bookkeeping systems etc."
761,1552299159.7124,Clarine,For such a system I would just go with Postgres if you want free and popular
761,1552299169.7128,Chanelle,also if I am not mistaken `jdbc.next` will add support for namespaces keywords; but better ask here <#C1Q164V29|sql>
761,1552299196.7132,Clarine,"I don’t know how stable <https://github.com/replikativ/datahike> is nowadays, but they do offer support for it"
761,1552299231.7135,Isa,"What is walkable vs pathom? I am not sure I catch what job it really do; also in walkable doc I can red:
```
Currently Walkable only takes care of reading from the database, NOT

making mutations to it. I think it varies from applications to

applications. If you can think of any pattern of doing it, please

open an issue.
```

So it sounds like it is read only solution"
761,1552299284.7139,Chanelle,you can insert with plain old sql; in datomic it is also separated
761,1552299330.7145,Isa,"&gt; in datomic it is also separated
Can you expand what you mean?"
761,1552299353.7148,Chanelle,"for read - datalog
for update - transaction; walkable tries to first read part; but you can still insert with plain old sql; Why you think datomic free wont work for you?; what limitations concern you?"
761,1552299419.7159,Isa,"So… pathom (FE-&gt;BE) -&gt; walkable (BE-&gt;DB) -&gt; PostgreSQL
Am I understand it?"
761,1552299430.7161,Chanelle,"yes, i think so; (didnt use it at all, just read)"
761,1552299464.7165,Isa,"&gt; Why you think datomic free wont work for you?
I will have to start to pay sooner or later. I don’t want to care about licence."
761,1552299491.7167,Chanelle,the free version is free forever (with updates supported); it is just limited to only 2 peers
761,1552299501.7171,Isa,<https://jena.apache.org/documentation/tdb/> What is it? I am not very familiar with it.
761,1552299507.7173,Chanelle,there is also datomic cloud; solo costs only 1 dollar per day; if i am not mistaken
761,1552299581.7179,Isa,Maybe I “over fear” of this Datomic licence things. I don’t know. I just make me fear of this choice.; My purpose is to not make code more complex because of choice of DB
761,1552299619.7183,Chanelle,"I fully understand you :slightly_smiling_face:

I did think about datomic (free) + datascript"
761,1552299628.7185,Isa,"So for example if I will choose to use Datomic in AWS, then I can’t use google cloud. I have to use other solution for developing"
761,1552299631.7187,Epifania,"you probably shouldn't chose a DB that is not open source. Not sure what the commitment from Datomic is when in the future the product gets deprecated/unsupported, but the move of data would be a hassle anyways"
761,1552299635.7189,Clarine,RDF is a format to store facts. SPARQL is the query language that is often used with it.
761,1552299656.7191,Chanelle,indeed; thats a vector lock
761,1552299690.7196,Clarine,TDB is an implementation that supports these standards
761,1552299712.7198,Chanelle,"datomic peer can use other stores (like sql or cassandra); so not that much vendor specific; datomic seems sexy
but sql works most of the time :wink:"
761,1552299748.7204,Clarine,This might also help you understand it: <https://github.com/arachne-framework/aristotle>
761,1552299792.7213,Isa,"Clojure tools don’t support it yet, right?"
761,1552299829.7221,Chanelle,"not aware of any sql with namespaced keywords…; also, it is still sql, not a datalog"
761,1552299846.723,Sixta,"<@Isa> JUXTs (of which I'm an employee) may be what you are after, except it is very new. It will be announced at clojure north.

It has support for namespaced keywords though :)"
761,1552299856.7231,Chanelle,You may go <#C1Q164V29|sql> and ask there
761,1552299871.7236,Clarine,"<@Sixta> what is it, a triplestore?"
761,1552299877.7237,Chanelle,Sean Cornfield is the author; keep us posted!
761,1552299958.7246,Clarine,"I’ve never tried to build a business-y type app with <https://github.com/arachne-framework/aristotle>
It might be fun to try."
761,1552300024.7247,Isa,"What is the status of the project?

For example `yada` is super cool idea, but IMO it is not ready to use yet, because of to up to date documentation and few issues. But it will be cool product soon probably.

I would like to avoid something similar with DB tool.; Is it for graph DB?"
761,1552300185.7252,Clarine,"it’s for Apacha Jena:
<https://jena.apache.org/>"
761,1552300196.7254,Isa,"exactly, I don’t know this tool :slightly_smiling_face:; not sure what it really is"
761,1552300231.7258,Clarine,"This is a nice tutorial by my colleague:
<https://joelkuiper.eu/semantic-web>"
761,1552300256.7261,Sixta,"Yada is something we use on all our projects, we consider it production ready. It's just hard to find time to document things :)"
761,1552300262.7263,Isa,it looks like graph DB
761,1552300295.7265,Sixta,"I'm not sure how much information is public, so I'm going to hold off answering."
761,1552300306.7267,Clarine,We have been running yada in production for years now. It’s mature.; Fair :slightly_smiling_face:
761,1552300330.7271,Isa,"Exactly. Without good documentation it is good for you, but not for me, because I don’t know to use the tool and frustrate to find out how :slightly_smiling_face:"
761,1552300380.7273,Clarine,"It’s more important to understand the yada model of execution than the documentation, there’s not much to it really; But I found pedestal even harder in that respect because of missing docs. I believe we have had this conversation before :slightly_smiling_face:"
761,1552300432.7278,Isa,I didn’t try pedestal. It doesn’t seem like tool for me.; So I have no opinion about that :slightly_smiling_face:; Yes we had
761,1552300466.7284,Clarine,"Maybe luminus is more for you then, it’s got nice docs"
761,1552300487.7286,Isa,I wanted only to say if this new tool for DB haven’t good documentation I can’t consider it to use for my purpose. At least it is how I see it.
761,1552300502.7288,Clarine,yeah
761,1552300600.729,Isa,"But I appreciate the idea and I hope your tools will grow up soon and things around will be cleared. I understand how hard it is to make open source and maintenance docs etc.; :+1:; you are doing very good job, just need more time; <https://github.com/replikativ/datahike> hmm do you know something more about it? It looks like beta
&gt; We provide a small stable API for the JVM at the moment, but the on-disk schema is not fixed yet. We will provide a migration guide until we have reached a stable on-disk schema"
761,1552300938.7298,Clarine,ask in <#CB7GJAN0L|datahike>
761,1552301210.7318,Isa,So the conclusion: nothing really changed. Still we can use <https://github.com/clojure/java.jdbc> and potentially pathom / walkable on top of SQL. But it is worth to consider if use pahtom. As far as I understand it in this way we close the system for only Clojure / ClojureScript vs GraphQL solution which let developers use other languages for API.
762,1552305010.7327,Clarine,if you want GraphQL you can use lacinia. it’s about trade offs I guess. GraphQL comes with its limits too.
762,1552305191.7328,Ali,"Don't fall in to the false economics of trying to be provider independent, though.

An alternative economical analysis is to observe that the more abstracted you are, the less you can leverage the particulars of the platform of your choice. Possibly to the point where you are paying up front for what it would cost to do a migration later (if you should need it).

My advice would be to not worry too much about large scale problems until you've done the initial work, and proven your model.; The teaser says ""Unveiling of JUXT's new bitemporal database""; Very exciting"
762,1552306206.7337,Isa,"<@Ali>

&gt; An alternative economical analysis is to observe that the more abstracted you are, the less you can leverage the particulars of the platform of your choice. Possibly to the point where you are paying up front for what it would cost to do a migration later (if you should need it).

Do you mean better is to use JDBS directly instead of extra layers on SQL like Datomic? Not sure what you really mean in this sentence."
763,1552306561.7341,Sixta,I'm looking forward to talking about it 
763,1552306597.7343,Clarine,Is it a commercial or free/OSS product?
763,1552306675.7345,Isa,"&gt; My advice would be to not worry too much about large scale problems until you’ve done the initial work, and proven your model.

I care more about make data and state management simpler. For example I want to use everywhere `:user/id` vs `:id` etc."
763,1552307178.7351,Ali,"At the extreme, it would be like choosing tools built for Google-scale problems when starting out with a hobby project, because one day you might have a company the size of Google.

If you feel like Datomic can get you off the ground quickly, then pick Datomic and don't worry too much about maybe, perhaps, potential, but current non-problems like the license until you have reason to do so. It's a bad tradeoff to worry about long-term scalability problems before you have a workable proof of concept for what you intend to do.

That being said, you should still pick a solution that fits the problem of course."
763,1552307404.7354,Isa,"&gt; tools built for Google-scale problems
Which exactly?"
763,1552307433.7356,Chanelle,i think details doesnt matter; the point was - overoptimization is not good
763,1552307458.736,Isa,I need this info to understand what we are talking about :slightly_smiling_face:
763,1552307473.7362,Chanelle,it was abstract point :slightly_smiling_face:
763,1552307475.7364,Isa,like cloud postgresql or other kind of tools
763,1552307483.7366,Chanelle,"<https://blog.bradfieldcs.com/you-are-not-google-84912cf44afb>; no-no, I think it was like you should not think about your map-reduce cluster with 1000 machines; just start with one instance"
763,1552307556.7375,Isa,"oh I think I interpreted this sentence exactly opposite. Now I see what he wanted to say.; But I don’t care about infrastructure scaling, I care about simple code :slightly_smiling_face:; And managing state"
763,1552307614.7381,Chanelle,does it mater which db you will take? :slightly_smiling_face:
763,1552307666.7383,Isa,"I think yes. For example I saw project which use NoSQL, but data were relational. It was so messy after years."
763,1552307736.7386,Chanelle,do you think if they will pick relational - they would do it right? :slightly_smiling_face:
763,1552307751.7388,Isa,yes
763,1552307755.739,Chanelle,kk )
763,1552307769.7392,Isa,DB wouldn’t let them to make this mistakes
763,1552307777.7394,Chanelle,hehe; with sql you can much a lot of mistakes; even not noticible :slightly_smiling_face:
763,1552307824.74,Ali,"Do you _really_ think that what you write right now is going to be run years from now? Pick the best thing for now, then refactor it in a year when it has matured, and you know more about the constraints you need."
763,1552307828.7402,Chanelle,"i think it is not about the tool
it is how you use the tool :slightly_smiling_face:; they say only third rewrite makes things kinda optimal; go for datomic :slightly_smiling_face:; anyway,  need to work :slightly_smiling_face:"
763,1552307903.741,Ali,"Datomic is great because it's very flexible, you can adapt it as you go along. Postgres is also great as a default unless you know that you need something specialized, just because of the tons of support and documentation.; Make it work -&gt; Make it right -&gt; Make it fast :slightly_smiling_face:"
763,1552308025.7414,Isa,"Sure I agree. I need to make feel comfortable with whatever choice I will do :slightly_smiling_face: So this is why I am thinking about it today, because I am at this step where I should make a decision."
763,1552308158.7416,Ali,"I used Datomic Solo to make a proof of concept. I demoed the proof of concept and got resources to start an initial project.

98% of the code I wrote is unused from the PoC, and ElasticSearch is the main workhorse, because it is the solution to the kind of problem we're dealing with _right now_. We'll bring back Datomic to do some of the more clever things, but for all intents and purposes, almost nothing of I did is in production right now. But it achieved the goal it set out to achieve: prove a workable model. And Datomic + Clojure was hands down the correct choice to make a working PoC as fast as I did.; And boy, let me tell you that ElasticSearch is expensive to run, compared to Datomic.; It gobbles up resources like there's no tomorrow.; Nevertheless, Datomic is not built for fulltext indexing and search, so here we are."
763,1552308501.7425,Isa,Probably my issue is I don’t have too much Datomic experience to understand what I lose / get when using it. I understand only 5000$ :wink:
763,1552308541.7427,Ali,Ah! Now we're getting to the core of the problem :slightly_smiling_face:
763,1552308556.7429,Isa,":wink:; I have plan to build tools around  bookkeeping, warehouse, label printing etc. as SaaS. E-commerce things.; So PostgreSQL sounds reasonable"
763,1552309346.7436,Ali,"Datomic can behave like a relational, or graph-like database. If you're modelling something that's sparse—that is, lot's of relatively small pieces of data, not necessarily of the same shape, with tons of relations between them in all directions—a graphlike database is nice.

If you know for a fact that you're storing something that could almost be a spreadsheet, where you stack lot's of data together side by side, and nearly always fill out all the columns, then a document store or relational store might be suitable.

For example, I know that one of the major postal services in Europe has modelled their package delivery system in a graph database, because a package delivery is traversal of nodes through out a huge system of interconnected nodes (delivery centers). Using this, rather than a relational database, made it easy for them to keep track of where a package was, where it is going, and customers can even cancel a package mid-delivery, and it will be routed back to the origin, based on a calculation of where trucks are and how much space they have available, etc. etc. etc.; Your stuff sounds spontaneously more spreadsheet-like, which you could model in Datomic or Postgres.; But eventually, most systems that solve a complex enough problem will be using different stores for different purposes. We're currently using ElasticSearch, a small piece of Datomic, DynamoDB and S3 (and Postgres, for midpoint-storage related to some ingestion of data)."
763,1552310188.7444,Isa,Thanks for input :+1:
764,1552310197.7447,Tonya,<@Meagan> thanks.
763,1552310577.745,Isa,"I am curious how system for warehouse, bookkeeping, orders etc. will look in graphql. Because one of the main issue is to keep sync order -&gt; bookkeeping / warehouse and all documents around and check if they are ok with law in country and don’t break other rules."
763,1552310643.7452,Bambi,It is OSS
764,1552310653.7454,Clarine,:heart:
763,1552310655.7456,Isa,"When add products to it, which have to be in sync with all orders / warehouse / bookkeeping there are a lot of relations; This history about delivery packages sounds inspiring :slightly_smiling_face:; But on the end I want to keep this system independent but cooperate by integrations.; Well, at that moment just sharing my thoughts :slightly_smiling_face:"
763,1552311280.7468,Yen,"I recently made a intro to protocols blog post (<https://alcamech.com/an-introduction-to-clojure-protocols/>) , would love some feedback !"
763,1552311854.7471,Sixta,<https://juxt.pro/technology.html> public info here :slightly_smiling_face:
763,1552311980.7479,Min,<@Yen> s/methods/functions. They sometime compile down to methods but not always; in the clojure sense they are just functions
765,1552313236.7486,Ali,More excite; Is the call for testers still relevant?
766,1552315166.7497,Clarine,"methods is the term that’s often used though, for example here:
<https://clojure.org/reference/protocols>"
765,1552315337.7498,Hung,<@Ali> yep :slightly_smiling_face: will PM you
767,1552315929.7513,Danna,"what's the easiest way to remove Chunking from a sequence?
I can write something like
```
(defn unchunk
  ""convert a Chunked Seq into something else""
  [[head &amp; tail]]
  (if (nil? tail)
    (list head)
    (cons head (lazy-seq (unchunk tail)))))
```
but seems a bit of a palaver.
Is there a more concise way?"
767,1552315981.7522,Clarine,"<@Danna> Usually when you need this, it’s a bad sign"
767,1552315990.7527,Jasmine,agree
767,1552315993.7528,Danna,yeah you are prolly right; ok
767,1552316022.7534,Jasmine,back up to the prior step and use loop/recur or transducers instead
767,1552316089.7537,Clarine,"when Alex told me the same, I went with transducers :stuck_out_tongue:"
767,1552316116.7541,Danna,"so I'm leaning towards something like
```
(defn first-filtered
  ""similiar to (comp first filter) but without chunking""
  [pred coll]
  (reduce (fn [_ v] (when (pred v) (reduced v)))
          nil
          coll))
```"
767,1552316148.7545,Clarine,"(first filter) is also an anti-pattern, mostly :wink:"
767,1552316179.7551,Danna,you think so? `(some` leaves a semantic hole in my life; because I don't always want the _result_
767,1552316208.756,Clarine,"well, this was discussed a while ago. you should organize your data such that you don’t need to walk over it like this at all, if possible; there are cases where it’s appropriate"
767,1552316255.7567,Danna,haha there always are
767,1552316444.7578,Lemuel,<@Danna> medley has find-first
767,1552316530.7583,Danna,"Ah yes! of course it does
good old James"
767,1552316625.7596,Lemuel,"And it's exactly what you wrote, but usable as a transducer, too.  I didn't know about the transducer case, and I've wanted that!"
767,1552316777.7602,Danna,haha. the side effect I'm trying to avoid is just a log statement
768,1552317219.7603,Roselle,"And here's our daily ""Thank you!"",  <@Angila>"
769,1552320191.7606,Nannette,"If I need to extend a Java base class to use a specific Java library that requires that and I don't want to use genclass &amp; AOT, what options do I have?"
769,1552320276.7608,Roslyn,`proxy`?; or `reify` if that's an interface
769,1552320581.7623,Nannette,I need to extend an abstract base class. I was reading about proxy myself. I think I need to read about proxy a bit and try it.
769,1552321150.7624,Stephen,"It's a common misconception that GraphQL has anything to do with Graph Databases. It's almost like Java and Javascript. The one is a query language, the other a database, it might be a little easier to use GraphQL with a graph database, but you can also perfectly use GraphQL with a relational database."
769,1552321219.7632,Clarine,I wasn’t the one bringing GraphQL to this conversation.; but you’re right
769,1552321587.7652,Nannette,"I was reading Programming Clojure, 3rd ed, page 172 by <@Jasmine> , <@Berta> and Aaron Bedra. If I understood the example I can create a defprotocol and then extend some Java class with the defprotocol?"
769,1552321722.7656,Harris,there's nothing other than `gen-class` for extending abstract classes ATM
769,1552322486.7665,Nannette,"Sorry, my mistake. It's not an abstract class, it is an ordinary Java class that I need to extend somehow in Clojure (just checked the library source code)."
769,1552322585.7668,Harris,"doesn't matter, you just can't extend classes at all other than with `gen-class`"
769,1552322695.7674,Evonne,<@Nannette> <@Harris> it occurs to me that you may be using “extend” in different senses?
769,1552322728.7677,Harris,I'm talking about `class A extends B` :)
769,1552322831.7685,Kirsten,its true that is less hassle to extend the class from java and then call it from clojure?
769,1552322935.7701,Evonne,"I’m guessing <@Nannette> was thinking in terms of ```
(extend SomeJavaClass 
  SomeProtocol
  {:foo some-custom-fn
     ...})```; But perhaps not — an in any case it’s important to understand what Java `extends` gives you that protocol `extend` does not."
769,1552323047.7714,Harris,"for interop clojure's `extend` is useless; protocols are a concept that exists just in clojure, java doesn't know about them"
769,1552323819.7749,Nannette,Ok. Thanks for clarifying that for me. What I need is to somehow extend a Java base class to use a specific Java library in Clojure and I thought that there could be other ways to do it in Clojure than genclass which requires AOT.
770,1552323878.7754,Dann,"there's also proxy, which can extend a java class to new interfaces; (or just extend a class by overriding some/all methods) - see also proxy-super"
770,1552324695.7782,Nannette,If genclass is the only option I have what's the best practice in a use case like I have (I need to extend a Java base class provided by a Java library to use that library in Clojure). Should I create the extended Java classes using Java instead and put the class files in the Clojure class path or something like that? That way I would avoid AOT.
770,1552324755.779,Dann,"you don't need aot for proxy, the only problem with proxy is you get an auto-generated name; extending a base class in java makes a new subclass, it doesn't alter the parent"
770,1552325000.7827,Nannette,"Ok. I'm a bit confused. One Clojure expert says that genclass is the only option in my use case, and another Clojure expert says that I can use proxy as well. Well, I think I follow this roadmap: 1. I try proxy first. If it works I'm good. If not, then 2. I implement the extended classes in Java, put the Java classes somehow available for my Clojure app and use Java interop in Clojure to use those Java classes with the Java library."
770,1552325051.7836,Dann,~is there some gotcha for abstract classes and proxy that I should know about?~ n/m it was clarified that this isn't about abstract classes anyway
770,1552325086.7843,Harris,"<@Nannette>, you can use `proxy` to create an instance of an (abstract or not) class, you just can't create a named class, that's what I meant, I wasn't very clear"
770,1552325098.7848,Dann,"ahh, so we agree"
770,1552325291.787,Nannette,"Ok. So, I can try to use proxy to create an ""extended class"" for that Java base class and then to use that proxy to interop with that Java library within Clojure. Good, I'll give it a try. Thanks everyone! I'll tell you later if I managed to use proxy like this."
770,1552325354.7877,Dann,"the class is only implicitly created, proxy gives you an instance of that class, but yeah, this should work with most libs that require a class be extended; where it doesn't work is if it needs the string name of a class that extends its base class (eg. quartz)"
771,1552327001.7905,Nannette,"I didn't do that well :slightly_smiling_face: : java.lang.ClassCastException: class simpleserver.util.azuregenclass.productgroup.proxy$com.microsoft.azure.storage.table.TableServiceEntity$ff19274a cannot be cast to class java.lang.Class...   I.e. I managed to create the proxy but when I tried to use the proxy with the Java library it blew.
Maybe I'm trying my second option: create the extended classes using Java and use the java classes in Clojure to interact with the Java library. I found a document which suggests how to mix Java with a Clojure project using Leiningen: <https://github.com/technomancy/leiningen/blob/master/doc/MIXED_PROJECTS.md>"
770,1552327282.7911,Dann,"as mentioned above, proxy gives you an instance, not a class"
770,1552327699.7951,Nannette,"Yep. Now I understand. So, basically, my options are: genclass (with AOT - already tried this - works but causes issues with my repl workflow) or extend the classes with Java and use those Java classes in Clojure to interact with the Java library.
I try the second way as instructed in that Leiningen document.
Anyway, I'm really grateful for you helping me. Thanks!"
770,1552327807.7957,Dann,"you can get the class of a proxy object ```(cmd)user=&gt; (def c (proxy [clojure.lang.IFn] [] (invoke [] ""hi"")))
#'user/c
(cmd)user=&gt; (.newInstance (class c))
#object[user.proxy$java.lang.Object$IFn$e81cd1ee 0x5b40ceb ""user.proxy$java.lang.Object$IFn$e81cd1ee@5b40ceb""]```"
772,1552328460.796,Miles,Is it possible to `binding` a `with-local-var`?
770,1552328494.7963,Dann,the setDynamic method should work on the var
772,1552328573.7969,Miles,I’m having trouble getting the macros to compose. Maybe I just need to push-thread-bindings explicitly?
770,1552328581.7971,Dann,"oh but binding wants symbols...; ```user=&gt; (with-local-vars [^:dynamic a 0] (push-thread-bindings {a 1}) @a)
1```"
772,1552328674.7975,Miles,thanks
770,1552328731.7981,Dann,what's missing here is the finally clause that cleans up the push with (pop-thread-bindings)
772,1552328757.7983,Miles,right
772,1552329492.7984,Nannette,"noisesmith: you are the man. :slightly_smiling_face:  It worked:

(def productgroup-proxy
  (class (proxy [com.microsoft.azure.storage.table.TableServiceEntity]
                               [])))
... and using it:
          table-query (TableQuery/from simpleserver.util.azuregenclass.productgroup/productgroup-proxy)
=&gt; Worked.
Let's see if I can create another proxy class, but this time I need to add some extra getters/setters."
770,1552329559.7986,Dann,cool
770,1552329598.7988,Nannette,"Thanks, I really appreciate how you helped me."
773,1552330621.7997,Ali,"I never actually tried this before, but you're not allowed to do,

```(defn hello [x &amp; y z] (println x y z))```

As it turns out"
770,1552330688.8006,Ali,"I went back over the special forms and noticed that the specification says that one parameter can be variadic, but it doesn't specify that it must be the last one: <https://clojure.org/reference/special_forms#fn>; It would have been an interesting way to capture first and last, I guess, with any number of arguments between.; Not that `(last z)` is particularly hard."
770,1552331030.8021,Celestine,`(defn hello [x &amp; [y z]] (println x y z))`
770,1552331167.8027,Dann,"I think in the version <@Ali> imagined, y would suck up a variable number of items, and z would always be the last one"
770,1552331218.8032,Ali,"Yeah, exactly."
770,1552331306.8044,Dann,"destructuring is implemented by the function `clojure.core/destructure`, and nothing stops you from implementing `fn+` that uses a modified destructure function; but destructure is a very tough nut of code"
770,1552331341.8051,Becki,Transduce could benefit from this. I think it has to modify it's docstring 
774,1552332509.8055,Julienne,"Is there a way to catch an error in a macro, and return the error I want rather than the error from the body?

Example:
```(defmacro describes [msg &amp; body]
  `(try (do (println :start ~msg)
          (let [ret# (do ~@body)]
            (println :end ~msg)
            ret#))
     (catch Exception e# 
       (throw (Exception. (str ""The Error I want""))))))```"
770,1552332541.806,Julienne,"_Wasn't sure if this was beginner or not so put it in both, will remove once I get an answer on one ^^^_"
774,1552342042.8079,Alison,"I’m unexpectedly having to deal with Java 9 modules, and I feel like my grandma trying to use a mobile phone."
775,1552344563.8086,Jasmine,ain't no fun
775,1552344715.8087,Lana,"Did I just post this at a bad time, late Sunday night, or is this simply not a good place to ask?"
776,1552345249.8096,Marlyn,<@Alison> curious about your experiences with modules
776,1552345696.8097,Meagan,"I think that pomegranate is not a very widely use lib, so it might be hard to find someone else who has run into this same issue"
776,1552345901.8115,Alison,"<@Marlyn> Mostly I am hoping to ignore them, since Cursive will need to support Java 8 and Java 11 for the moment. I was trying to figure out how to get Gradle to co-operate but my problem is looking like a bug in the Gradle plugin I’m using: <https://github.com/JetBrains/gradle-intellij-plugin/issues/374>; So with a bit of luck I can just continue in blissful ignorance for now. I previously worked with OSGi, and I have no desire to go back there."
775,1552348787.8132,Lana,"That’s probably true, if I don’t see anything for a while I guess I will open an issue against the read-me asking for an example."
777,1552378964.8149,Tanesha,"hey clojurians: quick: What's the best acronym for NON-REPL development?

CECR - Compile Execute Crash Repeat?
Any fun acronyms you guys are using?"
778,1552381383.8153,Clarine,"if you have a decent compiler, your program never crashes, it all just works the first time around :stuck_out_tongue:"
779,1552382341.8163,Roslyn,I wonder when we will see a decent compiler...
777,1552383493.8167,Samual,"<@Tanesha> ""FOD"" file-oriented development; Mitigated by having a 'main' in each file.  That's multi-main file oriented development, MMFOD"
777,1552387694.8183,Kerstin,"Trying to connect to a nrepl server with `lein repl :connect`. But facing an error
```
Connecting to nREPL at 127.0.0.1:50724
       java.lang.ClassNotFoundException: nrepl.core
clojure.lang.Compiler$CompilerException: java.lang.ClassNotFoundException: nrepl.core, compiling:(null:1:82)

Error loading namespace; falling back to user
#object[clojure.lang.Namespace 0x6bee017d ""user""]nil
```"
779,1552388663.8184,Cherise,Also see <https://github.com/weavejester/medley/blob/master/src/medley/core.cljc#L174>
777,1552405818.8203,Nigel,"My favourite is FDD. Faith driven development. Hit enter with one hand, cross fingers in the other, and let entropy determine your ourse"
780,1552405820.8205,Nigel,*course
781,1552408650.8213,Latrice,"I’m stealing FDD forever, sorry, it’s too good."
781,1552408826.8224,Melina,"GDD, Guardrail Driven Development, an alias for TDD. (From Simple Made Easy of course)"
782,1552409482.823,Loria,"Just curious, does anyone know why `lazy-seq` takes a variable number of ""body"" arguments?"
781,1552409538.8238,Loria,for accommodating side effects? It only seems to return the last argument
781,1552409936.8242,Clarine,"that’s funny yes:
```
cljs.user=&gt; (def x (lazy-seq (println ""dude"") [1 2 3]))
#'cljs.user/x
cljs.user=&gt; x
dude
(1 2 3)
```"
781,1552409982.8247,Fredda,I like it
781,1552410039.8252,Loria,"yeah, all the examples I found only use it as single arity"
781,1552410101.8257,Clarine,well observed. you can add an example to clojuredocs if you want :wink:
781,1552410169.8261,Loria,"and isn't the above equivalent to
```
(def x (lazy-seq (do (println ""dude"") [1 2 3])))
```"
781,1552410203.8268,Clarine,"yes, it is. basically lazy-seq takes the same as fn, which is always implicitly wrapped in a do"
781,1552410225.8273,Harris,"yeah, but so is `(fn [] (println ""foo"") 1)` equivalent to `(fn [] (do (println ""foo"") 1))`, clojure implicitly wraps `do` in places where it's convenient"
781,1552410313.8287,Loria,"hmm, that just seemed to me like a strange design decision for `lazy-seq`, for example the `for` macro doesn't have a implicit `do` block; seems highly non-idiomatic to have side-effects inside lazy sequences"
781,1552410361.8297,Harris,agreed :)
781,1552410709.8307,Dann,does lazy-seq have a guarantee that the side effects in the implicit do won't run twice?
781,1552410787.8315,Marlyn,Yes
781,1552410792.8316,Clarine,"it guarantees that the next time the seq will be called, the cached result is returned, so I’d say yes"
781,1552410804.8319,Dann,I was thinking of race-type conditions; eg. memoized functions can be called twice for the same arg in some situations
781,1552410840.8325,Clarine,oh right
781,1552410878.8327,Harris,lazy-seq has a synchronization barrier
781,1552410894.833,Clarine,"yeah, just found it: <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/LazySeq.java#L39>"
781,1552410928.8342,Becki,i assume it can still be chunked though?
781,1552410948.8344,Harris,not lazy-seq; you can build chunked seqs over a lazy-seq; but lazy seqs aren't chunked per se
781,1552411005.8359,Becki,so if you `(take n ..` you can guarantee that n and only n side effects would be triggered?
781,1552411047.8365,Harris,"if `..` is a lazy seq that yield _only_ lazy seqs in its tail, yes"
781,1552411109.8371,Clarine,n depends on how many args you used to create the lazy seq with of course
781,1552411114.8374,Harris,"but you have no guarantee that'll happen; ```user=&gt; (first (lazy-seq (map println (range 3))))
0
1
2
nil```; as opposed to e.g. ```user=&gt; (defn f [n] (lazy-seq (if (= 0 n) () (cons 1 (f (dec n))))))
#'user/f
user=&gt; (first (lazy-seq (map println (f 3))))
1
nil```; where each ""tail"" of the lazy-seq is a lazy-seq itself"
781,1552411470.8402,Jasmine,"Clojure does not make guarantees about how lazy lazy seqs are. If that is of critical importance to you (due to side effects or resource consumption), don't use lazy seqs."
783,1552412549.8405,Sixta,"Just wondering, what should I use?"
783,1552412673.8407,Clarine,loop/recur or transducers
783,1552413066.8414,Sixta,"But my transducer is just going to consume a lazy sequence, no?"
783,1552413089.8422,Rosaline,<https://dev.clojure.org/jira/browse/CLJ-1906>
783,1552413094.8425,Sixta,loop/recur requires users to implement map/filter/reduce/etc themselves 
783,1552413109.843,Dann,"a transducer can be used in multiple contexts, the input need not be lazy; or even a ~sequence~ data structure"
783,1552413164.8448,Sixta,"<@Rosaline> I've been playing with that recently. I wasn't sure how collections played into this conservation. I did have to make modifications to the proposed functions there, so I should make a comment :)"
783,1552413214.8455,Rosaline,I haven't used anything on the ticket in anger other then the original unfold
784,1552416464.8468,Tonya,I'm really struggling to setup emacs CIDER with clojurescript + clojure together.
784,1552416483.8476,Becki,Happy to help in <#C0617A8PQ|cider>
784,1552416485.8477,Tonya,"It's a breeze with just clojure, but adding clojurescript seems to be difficult."
785,1552417248.8511,Joette,"what would the idiomatic approach be to the following problem. You have `n` threads and a single set. You require a function `(insert! coll val)` such that `insert` returns `true` if `val` was inserted into the collection by the calling thread and `false` if `val` is already contained in `coll`?; while swap! can update the value, it seems that you need another atom to capture the success/failure state of the operation"
785,1552417323.8525,Dann,sounds like a good use for an atom and `compare-and-set!`
785,1552417340.8531,Becki,There's a swap-vals that returns the old value and you can check for the presence of what you added; More what you want then check and set which is overly strict it would seem; Although I guess atoms are check and set either way under the hood
785,1552417400.8552,Dann,"compare-and-set! is a building block for swap! and swap-vals!, but yeah, I forgot swap-vals! was there and it does precisely what you want; the atom isn't check-and-set, the compare-and-set! operation is (which every op that alters an atom other than reset! uses in some form)"
785,1552417617.8569,Joette,"perfect, so just ```(defn foo [xs x]
  (let [[old new] (swap-vals! xs conj x)]
    (not= old new)))
```"
785,1552417641.8573,Dann,they all use the underlying compareAndSet method on AtomicReference <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Atom.java>; <@Joette> yeah that should be it
785,1552417678.8584,Alleen,"a manual `compare-and-set!` would avoid a write if the value is present, so it should perform better"
785,1552417681.8586,Dann,where xs must be an atom containing a set
785,1552417690.8588,Joette,"exactly, or at least something conjable"
785,1552417766.8598,Dann,the return value is much less interesting for anything but a set (or a map if the arg is another map or a map-entry I guess...)
785,1552418080.8628,Joette,was considering if multiple clients wanted to register a topic (anonymously) in the context of pub/sub. How do you you indicate that a publisher has successfully registered that topic? This approach relies on the publishers being well behaved. An alternative would be to call `(insert! m topic publisher)` and return  true if `topic` is a new key in the map…
785,1552418125.8633,Dann,"then you would also want to stop short if the topic key is already present instead of overwriting...; so you'd likely want compare-and-set! for that; (or a function that replicates compare-and-set! by not altering the input if the value has changed); I guess that custom function could have better key granularity and thus do fewer retries -- abort if any alteration has occured, vs. abort if this key exists"
785,1552418375.8655,Tonya,"Has anyone seen this error: ""java.lang.ExceptionInInitializerError
        at clojure.main.&lt;clinit&gt;(main.java:20)
Caused by: Syntax error compiling . at (ring/adapter/jetty.clj:28:9).""; I'm getting it when I run lein repl"
785,1552418457.8665,Dann,"I'm surprised - that indicates that ring.adaptor.jetty has a syntax error, are you using an up to date version of ring and the ring jetty adapter?"
785,1552418473.8668,Tonya,"Yes, it is a problem with figwheel-main; If I leave it out the error doesn't occur."
785,1552418531.8676,Dann,the error is in the ring jetty adapter which figwheel uses because it wants its own webserver
785,1552418582.8679,Tonya,So what is the issue?; Why can't it have its own webserver
785,1552418624.8687,Dann,"it can, the problem is this version of the ring jetty adapter has a syntax error, which makes me assume it's an old version"
785,1552418665.869,Tonya,"ring jetty adapter is included in ring.; I'll update though and see.; No I'm using ring ""1.7.1"""
785,1552418775.8703,Dann,"in that case clojure is claiming this is a syntax error, which is weird <https://github.com/ring-clojure/ring/blob/master/ring-jetty-adapter/src/ring/adapter/jetty.clj#L28>"
785,1552418822.8706,Tonya,"Yes, it does seem strange.; Why does setting up my dev environment have to be so hard !!!!!"
785,1552418855.8716,Jasmine,"anything happening in the compiler will report as a ""syntax error"" so that may be misleading you in this case"
785,1552418934.8731,Tonya,"It's weird, all I added was figwheel and I staarted getting these erros."
785,1552418935.8732,Jasmine,"""Syntax error compiling ."" just means it's an error being thrown out of one of the host expressions (field, method, etc)  calls"
785,1552418969.8737,Tonya,None; There's the full stacktrace.
785,1552418979.8745,Jasmine,"and that's probably happening while compiling, while loading the system via user.clj (which happens under the RT static initializer), which is the ExceptionInInitializer part"
785,1552419011.8749,Dann,```java.lang.ClassNotFoundException: org.eclipse.jetty.http.BadMessageException``` this is the real problem
785,1552419035.8755,Jasmine,`Caused by: java.lang.ClassNotFoundException: org.eclipse.jetty.http.BadMessageException` is the real cause
785,1552419036.8757,Dann,looks like ring jetty adapter wants a version of jetty different from the one you are pulling in; you could check `lein deps :plugin-tree` for jetty version conflicts
785,1552419188.8766,Tonya,"Nothing there but does this mean anything?; [refactor-nrepl ""2.4.0""] -&gt; [nrepl ""0.4.4""]
 overrides
[cider/cider-nrepl ""0.19.0-SNAPSHOT""] -&gt; [nrepl ""0.5.3"" :exclusions [org.clojure/clojure]]"
785,1552419215.8773,Dann,"you likely need `with-profile` to ensure it checks the profile that figwheel uses; I forget how that's typically set up, but it will be evident in project.clj, something like `lein with-profile +figwheel deps :plugin-tree`"
785,1552419400.8785,Tonya,"So removing: ""[com.bhauman/figwheel-main ""0.1.5""]"" from my :dev dependencies fixes the error; But I see no conflicts even with my dev profile"
785,1552419424.8791,Dann,if you have the figwheel plugin it would likely be pulling that in already
785,1552419445.8795,Tonya,No figwheel plugin
785,1552419453.8799,Dann,but figwheel probably changed significantly since I last used it :/
785,1552419474.8803,Tonya,I was trying to figure out figwheel + cider when everything broke
785,1552419507.8813,Dann,"anyway, if it's not a dep conflict, and figwheel is just pulling in a bad jetty version, that's just a bug, but you can work around it by explicitly asking for the version that has the class you need before the figwheel dep"
785,1552419508.8814,Becki,be aware lein-figwheel and figwheel main are different and incompatible
785,1552419543.8817,Tonya,I should use figwheel main correct?; I'm not using lein-figwheel
785,1552419582.8824,Dann,"I wrongly assumed that you were using `lein figwheel`, I haven't used cljs in about a year, sorry"
785,1552419638.8826,Tonya,no problem; does figwheel-main look at :cljs-build?
786,1552489964.8869,Janean,is there a cljc library like plumatic’s graph (<https://github.com/plumatic/plumbing>) ? Plumbing doesn’t work with deps.edn because of cljx.
785,1552491738.89,Tonya,"So I have clj source files in src-clj and cljs source files in src-cljs. I want run both a figwheel repl and a clojure repl and connect to both with CIDER. I'm trying to use figwheel-main but I'm running into a bunch of issues.; I keep getting this error: [WARNING] No nREPL middleware descriptor in metadata of #'cider.piggieback/wrap-cljs-repl, see clojure.tools.middleware/set-descriptor!"
785,1552492233.8906,Clarine,maybe also ask in <#C0617A8PQ|cider> or <#C17JYSA3H|nrepl>
785,1552493206.8907,Sixta,It works as a maven dependency
786,1552493246.8909,Sixta,"Even if there wasn't cljx, it doesn't work as a git dependency because it doesn't have a deps.edn"
786,1552493286.8911,Janean,good to know thanks. Are you aware of other libs that are easier to fork/change?
785,1552493361.8914,Sixta,I vaguely recall someone releasing something like the graph recently
787,1552495410.8916,Danna,"are you running cursive?; when you start up the repl you have give it a startup option that instruments it for cljs; that error (usually) means that you have tried to use a cljs repl on something that has not been instrumented for it; Cursive does not yet natively support this instrumentation for cljs; but if you are running from command line then its much easier ...; ultimately you need to stick something like ```-m nrepl.cmdline --middleware [cider.piggieback/wrap-cljs-repl] --interactive```
into your Clojure Java process; its the details of what technology you use to get it there that might vary"
788,1552498980.8948,Corine,"hello... need an advice for which clojure server lib to use? ring, http-kit ....???? tks"
788,1552499108.8964,Rosaline,"ring usually means jetty, but ring is a spec that defines an interface between clojure code and a webserver, so there there are implementations of that spec (usually called an adapter) for a number of jvm webservers; http-kit to some degree implements the ring spec even; jetty just happens to be kind of the default choice for ring because I believe it is the only adapter that is part of the ring project; I like jetty too, and it supports all the cool stuff these days (http2, websockets), but a lot of that post-dates the ring spec, so the jetty ring adapter doesn't expose it in an easy to use way"
788,1552499675.9046,Corine,"you know if http-kit is abandonware?? i mean that because my background is in common-lisp and i really dont want to get all the jvm stuff for now... i started to use http-kit but i heard that it is now abandoned by the author... i know i can just ""plugin"" another server... but i really want to focus on the app and not the server per se"
788,1552499696.905,Rosaline,"because the http-kit implements the ring spec, you can actually switch between it and jetty pretty seamlessly, which if I recall we've done at work a few times (I mostly don't notice the switch), and I think we are using http-kit now; something that I can't really put my finger on about http-kit makes me nervous, but we are using it at work and don't have problems with it; I do have a (unreasonable?) soft spot for jetty"
788,1552499837.9068,Augusta,<@Corine> Aleph is also a nice alternative to ring
788,1552499862.9071,Rosaline,"aleph infact also implements the ring spec to some degree; aleph is a webserver and ring is an interface for connecting clojure code to webservers, they are not directly comparable things (apples and oranges); <https://github.com/ring-clojure/ring/blob/master/SPEC>"
788,1552500201.9109,Corine,tks <@Augusta> and <@Rosaline>; i will stick with http-kit ....after knowing <@Rosaline> employer is using it!!!; tks!!! :sunglasses:
789,1552500809.9165,Kirsten,"It also depends in if you need  to do async stuff, the official ring/jetty combo has some async apis but it can't really do non-blocking IO."
790,1552503443.9172,Fredda,"this seems normal; but this surprised me; If the values in an `update` application are fns, it seems only the first one applies"
790,1552503521.9193,Melina,huh
790,1552503521.9194,Sixta,"<@Fredda> `update` only works on 1 key at a time, always; but the second thing is weird; oh, no it isn't"
790,1552503549.9202,Rosaline,"it is weird, and it is not what I get locally"
790,1552503561.9207,Sixta,"```
user=&gt; {:b inc}
{:b #object[clojure.core$inc 0x18fdb6cf ""clojure.core$inc@18fdb6cf""]}
```"
790,1552503564.9209,Rosaline,"for update-in and update, it works on a single thing, the rest args are for arguments"
790,1552503586.9215,Sixta,Why is it weird?
790,1552503591.9217,Fredda,also; What I wanted to do
790,1552503611.9224,Sixta,"<@Rosaline> it is what I get locally, so I am confused :slightly_smiling_face:"
790,1552503626.9231,Rosaline,I copied and pasted the wrong thing out of the two examples
790,1552503632.9234,Sixta,haha :smile:
790,1552503646.924,Dorla,The function `constantly` returns a function which takes any number of args
790,1552503663.9244,Rosaline,"anyway, ` (constantly 2)` is passed the arguments `inc`, `:b`, and `(constantly 1)`; and the result is assoc'ed in under `:a` in the result; which is why you get the wrong arity exception"
790,1552503720.9258,Fredda,"Sorry, maybe my intentions got mixed up there. I wasn't actually trying to `inc` 2; ah okay"
790,1552503736.9263,Melina,"`((:a (update {:a inc, :b inc} :a comp inc inc inc)) 38)`; I get it now; returns 42"
790,1552503766.9272,Fredda,ooooh
790,1552503782.9279,Melina,`:b` remains associated to `inc`
790,1552503832.9296,Fredda,I thought update expected key value pairs
790,1552503833.9297,Melina,the rest of the args are used as in `apply`
790,1552503841.93,Marlyn,"update doesn't take multiple keys to update; just one key, a function, and trailing args to the function"
790,1552503849.9306,Fredda,right
790,1552503880.9315,Jasmine,if only someone had documented the arguments somehow :)
790,1552503882.9316,Sixta,"I've been banging my head against this one for over an hour now. I've tried using various libs for Reader/Writer to Input/OutputStream so that I can run an interactive process in the REPL against `*in*` and `*out*`, but I'm having mixed results. I don't see anything until I hit Ctrl-D.

I want to be able to run this in any repl (socket or terminal, or maybe even nrepl)."
790,1552503888.9318,Fredda,okay okay; ma' bad
790,1552503898.9323,Sixta,Am I hitting a fundamental limit that I don't understand?
790,1552503922.9327,Rosaline,nrepl has a whole other thing going on
790,1552503935.9333,Fredda,Somehow I had the wrong contract for update in my head
790,1552503952.9338,Rosaline,"basically for reading *in* to work in the nrepl the client has to have special support for it, and many clients implement it as a weird different thing"
790,1552503977.9344,Sixta,"nrepl does some stuff with in &amp; out, so may not apply. Going to circle round to that one. That's a bad thing to mention at this stage perhaps :smile: I'm more interested in terminal &amp; socket at this stage.; here's some things I tried: <https://gist.github.com/SevereOverfl0w/c4c8876f20d6ce1772a77e2cc216d814>"
790,1552504048.935,Jasmine,doesn't make sense to me
790,1552504050.9352,Fredda,"oh, 'cause of `assoc`, that's why"
790,1552504061.9356,Jasmine,"you do have to be careful to flush when dealing with `*out*`; note that `*in*` is not  exactly  stdin; stdin in Java  is typically an inputstream.  The REPL wraps a reader around that.; inputstream being byte-oriented, reader being char-oriented"
790,1552504250.938,Sixta,"ah, WriterOutputStream requires a flag to flush immediately!"
790,1552504259.9384,Jasmine,or just call flush
790,1552504275.9389,Sixta,"I don't know when writing has happened, that's down to the process."
790,1552504284.9391,Jasmine,"gotcha; autoflush is probably a lot slower but interactively, prob don't care"
790,1552504431.9399,Sixta,"that didn't solve it anyway :disappointed:; ah, removing the piping of `*in*` fixed it. I guess I'm blocking _some_ thread.; No idea what one.; I wonder if it is because .available always returns 0, so you can't do the equivalent of a select on the input/output to decide what to do; That would be a blocking limitation for this idea"
791,1552523058.946,Elaine,"I'm trying to remove some reflection from my code
there is a `(.set foo inst)` that works via reflection but I can't find WHY it works (inst is java.util.Date, there is no mention to java.util.Date in this lib)
There is some way to debug this? some way to ""print the reflection result"""
792,1552524029.9469,Jasmine,What is the type of foo?
792,1552524654.948,Guy,"After I did cider jack in, I installed more deps. Looks like cider doesn’t know the new packages installed, is there some way to refresh cider?"
792,1552525940.9486,Meagan,you can do `cider-restart`. it will shutdown the REPL process and start it again; so you will lose the state of your application
792,1552527017.9495,Guy,<@Meagan> is that the only way?
793,1552527025.9498,Guy,there isn’t a way to reload?
792,1552527070.9505,Meagan,"there are libraries out there to help with this, but in general yes"
793,1552527134.9517,Guy,I am trying to find some lib which can do this
792,1552527136.9519,Meagan,"adding new dependencies means you need to add new things to the class path. in general, class path are determined before you start the JVM process clojure lives in; I’ve heard of people using pomegranate: <https://github.com/cemerick/pomegranate>; but I’ve never used it; if you’re using `clj` + deps.edn, I’ve heard of some branch that has an `add-lib` function but I don’t know how well it works right now"
792,1552527750.9537,Guy,<@Meagan> nice. Thanks
793,1552528161.9545,Celestine,"<@Guy> If you're using `deps.edn`, see <https://github.com/seancorfield/dot-clojure/blob/master/deps.edn#L103-L116> which shows how to use the `add-lib` branch."
794,1552528473.9576,Tressa,"i've got an api endpoint for listing entities. entities are many, so they are returned paginated, sorted by a given attribute. this is backed by datomic. how do i achieve in datomic what in sql would be a order by + limit + offset?"
793,1552528495.9577,Guy,<@Celestine> I was looking up what deps is.
793,1552528497.9578,Celestine,Maybe ask in <#C03RZMDSH|datomic> ?
792,1552528546.9582,Celestine,<https://clojure.org/guides/deps_and_cli>
793,1552528605.9589,Tressa,gonna do that
793,1552528663.9601,Celestine,"If you're using Leiningen, there's no simple way to add deps once you're up and running (you'd have to use Pomegranate I think). Boot lets you add deps to a running REPL easily. CLI/`deps.edn` lets you add deps if you depend on that branch of `tools.deps`."
793,1552528696.9603,Guy,Nice.; <@Celestine> Is there some way to install packages from emacs? I have seen clj refactor but it doesn’t work with cider 21(which is the default now)
793,1552529146.9618,Celestine,"No idea. I stopped using Emacs years ago, sorry.; And by ""install packages"" I assume you mean ""add Clojure dependencies""?; Or do you mean ""install Emacs packages""?"
795,1552550039.9632,Alleen,"<@Janean> you may consider <https://github.com/leonoel/injure/>
same goals as plumatic graph, slightly different approach"
796,1552554772.9634,Sixta,That's the library I was thinking of!
796,1552566153.9636,Darlene,You might ask in <#C099W16KZ|emacs> or <#C0617A8PQ|cider>.
797,1552571441.9639,Toccara,Hi guys; is there something like lisp trace in clojure?
797,1552571507.9645,Fritz,"like, <https://clojure.github.io/tools.trace/#clojure.tools.trace/trace>"
797,1552575130.9655,Toccara,"what is best performant approach for iterating over a list by two elements what i have in mind is:
(map vector l (rest l))"
797,1552575274.9659,Clarine,<@Toccara> `(partition 2 1 [1 2 3 4])`
797,1552575540.9662,Toccara,should be faster than map solution for big l ?
797,1552575627.9665,Clarine,"don’t know, run a benchmark :slightly_smiling_face:"
797,1552575743.9675,Toccara,okay thanks
798,1552578817.9684,Corine,hi all... anyone knows if hiccup can indent the generate html????
798,1552581059.9687,Marlyn,<@Corine> nope.  <https://github.com/weavejester/hiccup/issues/27>
799,1552581081.9693,Marlyn,you can always re-parse it with something else if you really want indentation
798,1552581465.9699,Corine,<@Marlyn> tks! gonna see that!
798,1552582541.9713,Mariela,"I'm a big fan of `clojure.test/are`. Occasionally for each ""iteration"" I'd need the `:each` fixtures to be re-run.

Wondering if anyone has solved that problem, maybe with a custom `are`"
800,1552583651.9717,Janean,is there cljs/cljc map-like datastructure that allows lookups by key OR value?
800,1552584013.9723,Dann,"makes me wonder if anyone has implemented bimap on top of map (not precisely this, but very close); cgrand has a version of bimap in this mailing list thread <https://groups.google.com/forum/#!topic/clojure/L1GiqSyQVVg>"
800,1552584148.973,Janean,"yes, unfortunately CLJ only"
800,1552584215.9737,Dann,"ahh, I missed that detail - seems like you could do something similar portably, at the cost of performance of course"
800,1552584271.9739,Clarine,you could also use two maps
800,1552584319.9743,Dann,"cgrand's version is ""just"" a deftype which uses two maps internally; the tricky part is concisely implementing the N interfaces / methods for a map"
800,1552584429.9752,Clarine,"I mean, if you know you’re searching with the key or the val, that would make the most sense probably"
801,1552584753.976,Janean,"<https://clojurians.slack.com/archives/C03S1KBA2/p1552584346974800>
yup that’s a bit of work. I might start with a few function wrappers to get it to work initially"
801,1552584818.9772,Marlyn,What would it return when you lookup avalue?
801,1552584820.9773,Janean,"quite surprised that among the numerous datastructures in the eco-system, bi-map isn’t one of them; <@Marlyn> the key; the idea to be able to do lookups in either direction, from k to v or v to k"
800,1552584861.9787,Becki,what about `{:a :duplicate :b :duplicate}`. what would bimap lookup return for `:duplicate`?
801,1552584872.9791,Marlyn,Just assoc both directions
801,1552584908.9807,Becki,"also, if you need this only once and not in the datastructure there's set/invert-keys"
801,1552584910.9808,Janean,<@Becki> depends when the entries were added. one would overwrite the key for the other
800,1552584920.9812,Dann,<@Becki> I'm pretty sure a bimap should remove :a :duplicate if :b :duplicate is inserted
801,1552584942.9819,Becki,i see
801,1552584950.9822,Dann,I could be wrong though...
801,1552584953.9823,Janean,my use case is to keep it around / mutate / do many lookups
801,1552585012.9836,Dann,"&gt; A bimap (or ""bidirectional map"") is a map that preserves the uniqueness of its values as well as that of its keys.
<https://google.github.io/guava/releases/21.0/api/docs/com/google/common/collect/BiMap.html>"
801,1552585100.9841,Becki,"ah, and you can ask for the inverse."
801,1552585140.9845,Tammera,"ohhh cool datastructure, what would be a usecase for a bimap"
801,1552585263.9854,Dann,things that link two unique entities - eg. customer / assigned seat; as long as it's guaranteed 1:1
801,1552585315.9863,Clarine,what am I overlooking when I say that in that case you can just use two maps?
801,1552585334.9867,Dann,"you need to keep them in sync, and it would be nice to be able to use assoc / get etc.; but yeah, easy to implement with two maps and some clever dissoc logic to keep in sync"
801,1552585368.9886,Tammera,"(I just found a bimap in rust, it uses two hash/tree maps apparantly)"
801,1552585370.9887,Clarine,"{:a 1 :c 1} would be invalid, because chair 1 would be allocated twice right"
801,1552585375.9888,Becki,"its tough without mutation. since the mutable one lets you ask for the inverse, but if you're immutable only one ""direction"" can use assoc,"
801,1552585399.9898,Dann,"<@Clarine> exactly, your assoc implementation would need to guarantee that wouldn't occur"
801,1552585409.99,Becki,`{:a :b :b :c}`. how do you lookup `:b` in vals or in keys
801,1552585429.9904,Dann,that's another invalid state you'd need to avoid
801,1552585435.9907,Becki,but that is valid; or at least in the mutable one
801,1552585450.9912,Dann,"oh, I might misunderstand"
801,1552585456.9915,Becki,since you can specify which direction you are using and use the same underlying data
801,1552585628.9922,Dann,"so it appears the guava version has a method to access the ""reversed"" view; so you can get on the canonical or reversed view (backed by each of the two underlying maps of course); <@Becki> for real world your case is eg. secret santa or spouse, defined as 1:1 but the same item can appear on both sides"
801,1552585733.9942,Becki,anytime K and V intersect
801,1552586042.9949,Vinnie,"any tips on cleaning up these warnings on repl startup?
```
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by mranderson049.orchard.v0v4v0.dynapath.v0v2v5.dynapat
h.defaults$eval39549$fn__39550 to method java.net.URLClassLoader.addURL(java.net.URL)
WARNING: Please consider reporting this to the maintainers of mranderson049.orchard.v0v4v0
.dynapath.v0v2v5.dynapath.defaults$eval39549$fn__39550
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access
 operations
WARNING: All illegal access operations will be denied in a future release
```

i've been searching my deps. not sure what `mranderson049.orchard.v0v4v0.dynapath` is but seems related to <https://github.com/clojure-emacs/orchard/issues/2>"
800,1552586083.9951,Vinnie,"```java 11
clojure 1.10
lein 2.9.1
nrepl 0.6.0```"
801,1552586173.9953,Dann,"there's a jvm arg for the newer jvm versions that overrides the new module protection rules, and if I understand correctly that's what makes this reflection illegal now"
801,1552586211.9958,Janean,bingo <@Dann> <@Becki> <https://github.com/CharlesHD/chulper/blob/99c35dffb5e725a5dba08da5a70e053f9fb4bde4/src/chulper/bimap.cljc>
801,1552586213.9959,Vinnie,ic. i wonder if the reflection is a necessary part of whatever lib that's causing it or if there is a better alternative
801,1552586268.9964,Becki,so it seems this one cannot express the secret sant problem
801,1552586514.9968,Janean,it’s missing a protocol and impl for reverse lookup
801,1552586733.9977,Sixta,"the problem is that the jvm lies, it says these things are accessible, but they aren't. There's parts of clojure that can trigger this too."
800,1552586759.998,Vinnie,is the solution to set a jvm flag to ignore it?
801,1552586820.9988,Dann,"it's written such that one of the maps contains all keys and vals as keys, which is why it can't express secret-santa, unlike guava's version of bimap; but that also means that there's no distinct ""reverse lookup"" - lookup is just lookup"
801,1552587222.9996,Guy,is there some way to figure out what are the exported fns from a package?
801,1552587240.9997,Dann,I'd need to know a lot more about mranderson (the lib that is causing this problem) to offer any other suggestion; and it would mean fixing mranderson
801,1552587308.0001,Vinnie,yeah i can't figure out what it is or where it's coming from. maybe `cider-nrepl`; it doesn't show up in `lein deps :tree` (at least by anything with `anderson`); confirmed: it goes away if i remove `cider-nrepl` from my profiles.clj
801,1552587903.0011,Dann,"by package do you mean namespace, dependency, ...; (jvm has a concept of packages but most don't contain anything implementing clojure.lang.IFn)"
802,1552590124.002,Becki,"```
user&gt; (bimap :a :b :b :c)
{:a :b, :b :c}
user&gt; (get *1 :b)
:c
user&gt; (get (inverse *2) :b)
:a
```
looks good actually"
801,1552590879.0026,Guy,<@Dann> external lib/dependency  like compojure
802,1552591212.0035,Rosaline,"libraries are just namespaces that are distributed together, there is no language level feature that distinguishes them as a group; everything def'ed in a namespace is available when you load the namespace (there is a way to flag a def as private, but meh)"
802,1552591316.0053,Isa,"```
#:foo{:bar 1}
=&gt; #:foo{:bar 1}
(def foo {:bar 1})
=&gt; #'user/foo
#:bar foo ;; how can I achieve it in the simplest way for first level keywords in the map? Something native in Clojure?
```"
802,1552591359.0058,Rosaline,you have to traverse the map and re-create the keys with the namespace
802,1552591387.0063,Isa,"ok, so there is no simple way with native solution. Thank you for confirmation."
802,1552591448.0073,Rosaline,"#:foo{:bar 1} is syntax that works at read time, you are looking for something to happen at runtime; at read time, the symbol foo is the symbol foo"
802,1552591466.008,Isa,"sure, just wanted to be sure if I didn’t miss something; Clojure sometimes come with crazy simple solutions with blow up my mind :slightly_smiling_face:"
802,1552591528.0092,Clarine,"probably not recommended, but when hiredman said his last sentence, I though of this:
```
cljs.user=&gt; (cljs.reader/read-string (str ""#:foo{:bar 1}""))
#:foo{:bar 1}
```"
802,1552591566.0096,Rosaline,"or, you know, use clojure.walk"
802,1552591570.0099,Isa,too dirty
802,1552591580.0101,Clarine,"```
cljs.user=&gt; (defn foo-ize [m] (cljs.reader/read-string (str ""#:foo"" m)))
#'cljs.user/foo-ize
cljs.user=&gt; (foo-ize {:bar 1})
#:foo{:bar 1}
```; yes, dirty, agree :slightly_smiling_face:"
802,1552591734.0111,Guy,"<@Rosaline> so, I do ```(require '[selmer :as s])``` how do i iterate on `s`?; ho you are saying there isn’t a way"
802,1552591915.0118,Fredda,<@Isa> something like `explicate` might work <https://github.com/clojure/spec-alpha2/blob/master/src/main/clojure/clojure/spec_alpha2.clj#L334>
802,1552591925.0121,Clarine,"<@Guy> do you mean something like:
```
cljs.user=&gt; (require '[planck.http :as p])
cljs.user=&gt; (ns-publics 'planck.http)
{put #'planck.http/put, get #'planck.http/get, patch #'planck.http/patch, delete #'planck.http/delete, head #'planck.http/head, post #'planck.http/post}
```"
802,1552592021.0123,Isa,Thanks. In the meantime I got an idea how to solve my issue on form level in UI :slightly_smiling_face:
802,1552592098.0147,Dann,"I could imagine something more general that lists definitions in all files in some dep, I don't know if there's a tool that does that though"
802,1552592210.016,Isa,<@Guy> I don’t know the answer but you can see how clojure editors make hints for functions in namespace when you are writing `alias/my-fuction`; at least it should be accessible in REPL
802,1552592254.0166,Clarine,hi <@Maren> :slightly_smiling_face:
802,1552592350.017,Guy,<@Clarine> ah yes nice
802,1552592528.0174,Isa,`(keyword (name :foo/bar))` no 1 function to get `:bar`?
803,1552592558.0177,Becki,`(comp name keyword)`; 1 function :slightly_smiling_face:; or backwards. `(comp keyword name)`
804,1552596871.0188,Sixta,"it is coming from cider-nrepl. mr.anderson isn't causing the issue, it's just a tool for inlining other deps, dynapath in this case."
805,1552603454.0207,Guy,"I am playing with sierras-component. My system component starts web server, db etc. how does compojure handler gets access to db connection instance?"
805,1552603574.0215,Tiffanie,Anyone have luck getting Log4j2 JsonLayout working that actually outputs JSON in the `message` field?
805,1552603714.0217,Celestine,"<@Guy> What I typically do is to have middleware that accepts the system component and puts it into the Ring `req`uest as `:app/system` for example, then each handler function can access it as `(-&gt; req :app/system :database)` or something similar.; (and then I wrap that middleware around my routes as part of the Ring setup in the web server startup)"
805,1552603872.0221,Guy,"ok, so, you are creating a higher order fn"
805,1552603894.0223,Celestine,"That's what middleware is.; `(defn add-system [handler system] (fn [req] (handler (assoc req :app/system system))))`; Then `(-&gt; routes (add-system system) (other-middleware))` is how you build the app that you pass to the web server.; So I typically have an ""application"" component and a separate ""webserver"" component that has ""application"" as a dependency, so that when it `start`s, it can pass in the (already started) application component.; Does that make sense?"
805,1552604090.0233,Guy,got it.
805,1552604142.0235,Celestine,"I tend to have a component for each ""subsystem"" that needs to be ""started"". So I'll have a DB component that builds a pooled datasource from the db-spec, and that DB component would be a dependency of the app component and so on.; That's where the real power of Component comes in."
805,1552604182.0239,Guy,"I was looking at the example here: <http://www.luminusweb.net/docs/migrations.html>

search for `*db*`; what they are doing there is, they are pinning the instance to a dynamic var and importing that everywhere."
805,1552604254.0243,Dann,one of the main points of component is not doing that
805,1552604339.0245,Guy,right.
805,1552604417.0247,Clarine,I second <@Celestine>’s approach by adding it via a middleware. We do something like this in yada too.
806,1552611078.0262,Antione,"<@Tiffanie> got any more info?; What does the config look like, what is it named, does it not work locally, when jarred up, what is in the message field if anything, etc. etc."
806,1552611285.0287,Liliana,"is there any way to reify dynamically?
```
(defn my-reifier [classname]
(fn [f]
  (reify classname
        (invoke [args] (apply f args))))
```
There's a code that I'm trying to get running with AOT, and there's some series of eval that's preventing it from happening."
806,1552611888.029,Dann,you could do that in a macro; ```(defmacro my-reifier [classname f] `(reify ...))```; you likely need eval to retain the same functional abstraction
806,1552612130.0318,Liliana,"yes the args as args# gensym doesn't seem to work well. I think all in all I'll abandon this idea. This is the clj-native library I'm trying to hack, and there are already much better ways to interact with jna than with this eval soup.; like loading library into a gen-interface, seems to make the symbols predictable, rather that converting the name of the classname from string to a variable."
807,1552654235.0356,Chester,"is this supposed to be happening?
```
(ns myns
  (:require
    [clojure.core.match :as m]
    [clojure.core.match.regex])

(let [a {:a :b}]
  (m/match [a]
    [{:a #""arst.*""}] 1
    :else 2))
Execution error (ClassCastException) at myns/eval13037 (form-init1389493813015240111.clj:2).
clojure.lang.Keyword cannot be cast to java.lang.CharSequence
```
shouldn't this, like, just not match?"
807,1552660110.0367,Britta,<@Chester> you didn’t close your `ns` form
808,1552662727.0373,Bart,anybody got a nice way of listing all files in a given classpath directory?
806,1552662749.0376,Bart,perhaps even all files of a given extension while we're at it
809,1552664256.0377,Tiffanie,"My base code is all here:
<https://github.com/defndaines/argo>
But I’ve been having trouble finding examples of people actually using this feature, even in Java. When I look at the original PR, it only tests passing a simple value (integer) and not a more complex map-structure or anything."
809,1552665096.0382,Leeann,<https://clojuredocs.org/clojure.core/file-seq>
809,1552665329.0385,Jasmine,"classpath implies resources, not files; and I don't think there is any such support for resources; in the most general sense; but if you can detect the resource is really a dir, then you can fall back to files"
810,1552672047.0424,Dann,"<@Bart> if you search for ""list resources java"" there's examples of listing every resource visible inside a given classpath entry - for a folder on disk that corresponds to files in a directory; of course for physical directories there's also file-seq (and now I see that was already suggested)"
810,1552672089.0434,Bart,"yeah, if i can just get the directory i can use file-seq; but how to easily get the (context independent) root of your classpath?"
810,1552672141.0451,Dann,"there's no such thing; a class path is a list of roots; ```user=&gt; (System/getProperty ""java.class.path"")
""src:/Users/justin.smith/.m2/repository/org/clojure/clojure/1.10.0/clojure-1.10.0.jar:/Users/justin.smith/.m2/repository/org/clojure/spec.alpha/0.2.176/spec.alpha-0.2.176.jar:/Users/justin.smith/.m2/repository/org/clojure/core.specs.alpha/0.2.44/core.specs.alpha-0.2.44.jar""```"
810,1552672269.0468,Bart,"i mean, the problem i'm trying to solve is letting people stuff some resources in a given directory that gets built into the JAR; and the app should just read the contents of that directory"
810,1552672304.0479,Dann,"OK, than you want to list all resources under that directory, which should be a child of a classpath entry (your root jar for example)"
810,1552672329.0488,Bart,and i'd prefer to avoid having hardcoded references to the files in the code as well (though that would fix the problem since you would then know the full path)
810,1552672334.049,Dann,"then if you have them put it in ""foo/"", ask the classpath resource finders for all resources under ""foo/""; I think I have a clojure translation of that java code that lists resources under a path, one moment..."
810,1552672393.0501,Bart,and i'd have to implement this resource finder myself? it doesn't seem to exist in the standard libraries
810,1552672419.0507,Dann,"right, strangely enough it isn't in any lib I know of, but it's only four lines of code or so"
810,1552672481.051,Bart,"None; that's the code i have right now, which obviously works just fine locally; what i need next is a context agnostic path for the server environment"
810,1552672542.0526,Dann,"yeah, the code for listing things inside resources is trickier"
810,1552672584.0532,Bart,"i'm looking at this now <https://stackoverflow.com/questions/3923129/get-a-list-of-resources-from-classpath-directory>, which was maybe what you referred to initially"
810,1552672626.0535,Dann,"<https://stackoverflow.com/a/22363700> - clojure solution; looks like you can hand it a jar file and list things inside, from there you could filter, and given that classpath will have all your visible jars, you can iterate and check them all..."
810,1552672768.0563,Rosaline,using mapv like that is real gross
810,1552672782.0566,Bart,hm. feels weird that this would be such an ... intractable problem
810,1552672793.0569,Rosaline,you can't list resources on the classpath
810,1552672811.0577,Jasmine,classpath is not even the starting point to this story
810,1552672814.0578,Rosaline,"you can only access resource via classloaders, classloaders provide a key/value like interface"
810,1552672842.0584,Jasmine,"the JVM has a hierarchy of classloaders, each of which can find resources based on arbitrary means; the classpath is just a list of roots for the system classloader to use; and can be made up of dirs, jars, etc by  default; but the provided URLClassloader can handle anything  you can make a URL for, which is itself a protocol open for extension"
810,1552672972.0616,Rosaline,the general solution is to build some kind of manifest file with a well known name that contains a list of the resources
810,1552673067.0629,Bart,"yes, that was the ""fallback"" solution I was thinking of. listing the resources so i can just map them as `(io/resource)`"
810,1552673108.0644,Jasmine,"the whole class loading / resource loading mechanism is intentionally built to not require enumerability -  it's like a map (keyed by resource name), not a seq."
810,1552673121.0647,Bart,otherwise i'd have to iterate through the entire classpath until I hit the directory i'm looking for; which leads to stuff like this
810,1552673135.0652,Jasmine,there are various classpath scanning libraries out there
810,1552673140.0653,Bart,None
810,1552673191.0664,Jasmine,stuff like <https://github.com/classgraph/classgraph>; ^^ that has functions to do what you're asking for example (all  resources that match a path); good list of alternatives in the readme too
810,1552673299.0679,Rosaline,"but it isn't a general solution, because not all classloaders can be scanned"
810,1552673353.0682,Jasmine,"yep; but if it's stuff ""on the classpath"", that's a pretty good answer"
810,1552673468.0703,Rosaline,"yeah, like, if you are backed in to a corner by something else, I would look at that, but if you are building something from scratch as a library, code that other people might consume, it is far better not to rely on something like that, because at some point it will break for someone (maybe you)"
810,1552673795.0736,Jonelle,"```(defprotocol XMLParsable
  (parse-xml [this]))


(extend-protocol XMLParsable
  (Class/forName ""[B"")
  (xml-parse [xml-bytes] (with-open [r (io/reader xml-bytes)] (xml/parse r)))

  File
  (xml-parse [xml-file] (with-open [r (io/reader xml-file)] (xml/parse r)))

  String
  (xml-parse [xml-str] (xml/parse-str xml-str)))```

why doesn’t this work?  `Don't know how to create ISeq from: java.lang.Character`
I know i’ve used `Class/forName` to extend a protocol before"
810,1552673843.0747,Rosaline,"you have to def it, if I recall"
811,1552673863.0751,Jonelle,"like so? `(def Bytes (Class/forName ""[B""))`"
810,1552673868.0753,Rosaline,sure; it has been a while
810,1552673890.0759,Jonelle,"I tried that and I get `Unable to resolve classname: Bytes`; I just came across  this SO answer that says it has to be the first class <https://stackoverflow.com/questions/13924842/extend-clojure-protocol-to-a-primitive-array>; which seems to work, but i’m assuming that’s a bug? or at least I don’t understand why it would have to be first"
810,1552674292.0791,Rosaline,"I don't think classes for array types were considered when the extend-protocol macro was written, and it just happens to work in certain ways, and people have just limped along on that"
810,1552674406.0794,Jasmine,there's a ticket for t his; we've come back to it  a few times but never gotten it over the  line; <https://dev.clojure.org/jira/browse/CLJ-1381>
812,1552685774.0814,Onita,"hey everyone, i’m interested in creating a data structure that is identical to a map, except behaves well with keys that are raw bytes.; is this feasible in clojure? what would it entail?"
812,1552685799.082,Dann,why would a map misbehave if a key were a byte?
812,1552685829.0826,Onita,"based on my last experiment, equality doesn’t seem to work as i would expect; so merging two maps containing a key `(.getBytes ""foo"")` results in two keys"
812,1552685864.0835,Dann,oh you mean arrays of bytes
812,1552685867.0838,Onita,so i’ve written a function called `bytes=`; yeah
812,1552685871.0842,Dann,"yeah, those use pointer equality by default"
812,1552685885.0847,Onita,right. so all i really need to do is change how equality is handled. “all”
812,1552685903.0854,Dann,the easy option is to use vec on the keys (it's cheap on an array and safe if you don't mutate)
812,1552685922.0858,Jasmine,"for Clojure maps,  you can't change that; but there are various Java map implementations that can use identity or custom equality for  maps; guava has lots of options for this"
812,1552685963.0865,Onita,"sorry, could you elaborate?; cool, so then in theory i could wrap it as an associative collection to use with `merge`, for example"
812,1552685991.0873,Dann,"(vec b) makes a vector, it's cheap as it reuses the array, it has value rather than pointer equality"
812,1552686020.0875,Onita,"oh, that’s super cool, did not know that; thanks"
812,1552686040.0879,Dann,and there's a method to get the backing array back out - also should be safe if you don't touch the vector other than comparison / reading
812,1552686060.0883,Jasmine,"or  rather, you can just use IdentityHashMap  in the  jdk <https://docs.oracle.com/javase/8/docs/api/java/util/IdentityHashMap.html>; I think if you made two IdentityHashMaps and called `merge` on them in Clojure, it would do what you want"
812,1552686109.0897,Dann,"with any of the options mentioned, using value semantics plus any change to the array would have bad and wrong results"
812,1552686125.09,Jasmine,who would do such a monstrous thing :)
812,1552686147.0905,Onita,"why, me of course"
812,1552686151.0908,Jasmine,"well, I guess you really want custom equality, not identity"
812,1552686160.0912,Onita,right
812,1552686161.0913,Jasmine,"so  IdentityHashMap isn't what you want; but same principle - if you can  find  a Java map impl with custom equality, then that's good  enough; you will need to be careful not t o mix those  with Clojure maps  though  or you're likely to have surprising things happen (like using Clojure equality semantics)"
812,1552686247.0934,Dann,"I think value equality and treating the keys as immutable is called for here, so why not just call vec on each byte-array before insertion / lookup?"
812,1552686285.094,Onita,"yeah, i think that’s looking like my best option; although all this leads me to think i’ve made a wrong turn in my design choices to this point. so maybe i’ll have another look at that; all the same, appreciate the help"
812,1552686349.096,Rosaline,"bytebuffer has slightly better behavior has a key; <https://docs.oracle.com/javase/7/docs/api/java/nio/ByteBuffer.html#equals(java.lang.Object)>; depend on what you want raw bytes for, you might look at `(vector-of :byte)`"
812,1552686549.0979,Guy,is there a replacement for clj-refactor? It is painful to keep typing the namespace. I couldn’t get clj-refactor to work with cider 21 and clojure 1.10
812,1552686552.0981,Onita,"hm, interesting"
812,1552686610.0992,Rosaline,"I haven't used gvec much, I kind of find the ease of interop as a regular clojure vector alarming, I might accidentally lose my precious specialized vector of bytes; <https://github.com/hiredman/vbuffer> is a thing that I kind of doubt is very useful in its self, but it might be some interesting wreckage to pick through"
812,1552687006.1011,Jasmine,vector-of might be interesting thing to try here.  note that getting values from the vector will incur boxing
813,1552700550.1036,Marylin,"can i require a namespace from a string, outside of the `ns` form? like, a message queue says “handle this task with function `f` in namespace `a.b.c`” - my mq handler says `(require '[""a.b.c"" :as executor])` or somesuch?"
813,1552700787.1043,Celestine,"<@Marylin> Yes, you can turn the string into a symbol and call the `require` function.; ```user=&gt; (require [(symbol ""clojure.set"") :as 'q])
nil
user=&gt; (q/union #{1} #{2})
#{1 2}```"
813,1552700981.1051,Marylin,"awesome, thanks <@Celestine> - my personal clojurians slack guardian angel"
813,1552700996.1053,Celestine,I just have no life :slightly_smiling_face:
813,1552701002.1055,Marylin,"ha; while i’m here, does anyone know of a task queue implementation any higher level than carmine message queue?; like, priorities on the tasks, etc"
813,1552701637.1067,Celestine,"Carmine is just a wrapper for Redis, isn't it?"
813,1552701668.1075,Marylin,"yep, a little on top"
813,1552701705.1081,Celestine,Maybe you'd want RabbitMQ and priority queues? Not sure if Langohr supports that aspect of RMQ?
813,1552701707.1083,Marylin,"i mean, it has a message queue support"
813,1552701784.1088,Celestine,"Yeah, Redis is pretty basic tho', right?"
813,1552701821.1093,Marylin,"it is - there’s also this: <https://github.com/b-ryan/farmhand> , but it looks moderately abandoned (the webpage doesn’t work anymore…)"
813,1552701857.1096,Celestine,<https://github.com/gabfl/redis-priority-queue>; Seems to implement priority queues on Redis via the Lua scripting support...?
813,1552702082.1107,Marylin,ah! maybe i could use that - good idea
814,1552721527.1122,Sheron,"any good links for maintained and working   larger-than-memory collections library for clojure ? (something that would keep maps or vectors efficiently on disk (as a temporary storage, not a full blown database))  i found spicerack   (and an apparently abandoned clj-mapdb)"
815,1552727320.1123,Tressa,"that description reminds me of datascript, might worth checking out?"
815,1552727970.1125,Stephen,"If you just need key/value rocksdb might be a good fit, <https://github.com/kotyo/clj-rocksdb> is recent, haven't used it myself."
816,1552729657.1128,Stephen,If performance it not (so) important you could also just write/read files. That's what I did for my current project. Also because With those files it's easy to generate the html files statically.
816,1552729752.113,Sheron,rocksdb sort of falls into the same category as spicerack ... if you look under the hood your uberjar jumps by over 10 megabytes in size and you get native extensions ontop :disappointed:; datascript is also not in the direction i'm looking at
816,1552729941.1134,Stephen,"If the size of the application  is important writing/reading files might not be bad, you don't need any dependencies. It's to bad for the JVM we don't have something like Closure, removing/stripping unused stuff. Using a native image kind of does it, but kan be hard to get it to work."
816,1552730017.1136,Sheron,"handling files on their own is not a problem for me, but i was hoping to skip a set of excess code :slightly_smiling_face:; it would feel nice to just say something
`(let [persistent-map (make-a-file-backed-transient-map ""datafile.dat"")] ... )`  for writing things and in a similar way just say that hey, that file there contains a vector of data that i want to process, let's fly through it (obviously with lazy or iterator style functions only) :slightly_smiling_face:"
816,1552730369.1144,Epifania,is there a way of getting the test results from `run-tests` as data rather than it's printing a report to stdout?
816,1552730400.1149,Sixta,"<@Epifania> yes! this is what cider does, there's a multi-method you can rebind. I think it's clojure.test/report; You could do this:

```
(let [events (atom [])]
  (binding [clojure.test/report (fn [evt] (swap! events conj evt))
    (run-tests …)
    @events)))
```"
816,1552730603.1166,Stephen,"I just store/get them as .edn but keeping them all in memory maks it real simple, cause I just need to read on start up, and then I only need a file-sync to keep the files in sync.; ```(defn- keys-&gt;path
  [k key]
  (str (k file-map) (name key) "".edn""))

(defn- keys-&gt;map
  ""fetches the vector from a part, and turns is into a map""
  [k key]
  (let [full-path (keys-&gt;path k key)
        [spec vec-values] (edn/read-string (slurp full-path))]
    [spec (de-ser-vector spec vec-values)]))

(defn- add-reference
  [k map reference]
  (let [reference-map (keys-&gt;map k reference)]
    (assoc map reference reference-map)))

(defn- init-data
  ""get the initial data from the file system""
  [k]
  (let [[spec-summary map-summary] (keys-&gt;map k :summary)
        data {:summary [spec-summary map-summary]}]
    (reduce (partial add-reference k) data (keys (second (first map-summary))))))```; I also so some stuff with spec to make the data more compact; Another trick that's in there is that all the names/keys of the map are in the summary file.; You could for example keep the keys in memory, so you now before trying to read if a file exists. And keep a weak reference to it, so when it's required soon after it's still in memory."
817,1552731259.1179,Epifania,"oh, sweet. Thanks a lot <@Sixta>"
816,1552731318.1181,Epifania,works perfectly! :thumbsup:
816,1552731384.1182,Stephen,This might clearify how it's working. Each folder is 'linked' to an atom to keep the content of the folder in sync. The names of the files are the keys in the map of the atom.
816,1552731736.1189,Sixta,I didn't even test it :see_no_evil: 
817,1552734028.1196,Epifania,"<@Sixta> well, to be honest, you missed a `]` in the binding :wink: But in general, the idea works well! :slightly_smiling_face:"
817,1552734042.1199,Sixta,phew! at least the world is right again :slightly_smiling_face:
818,1552738504.1226,Jaimee,"Hi, I have a pipeline that batch processes files (using threadpool for concurrence) and I would like to make an interface that shows the progress for each file individually using <https://github.com/ptaoussanis/sente>
However given that the different files are processed in parallel, is it ok to share the socket across threads and have them all send stuff separately?"
817,1552740015.1228,Sheron,"my usage pattern will be indexing through a few gigabytes of data at time, storing the results into about 1 million subbuckets before i store it back to the real storage in batched form from the subbuckets ... it's a long story :smile:; at first i thought i could open the million files around in the local filesystem but giving it some thought this is probably a terrible idea :slightly_smiling_face: from both the fopen&amp;close overhead and also the local filesystem may not agree"
817,1552747942.1258,Tona,"<@Sheron> you might take a look at <http://immutant.org/documentation/current/apidoc/guide-caching.html#h3205>

I have used it outside of a container for larger than memory storage."
819,1552757783.1271,Jeanne,Can I have something like `dir` but for function internals or let macro ? E.g. is it possible to extract symbols from inside fn?
817,1552762106.1273,Sheron,o_O but that depends on some fancy jboss infinispan that claims to need 55mb in it's smaller form :smile:
820,1552767985.1289,Jasmine,You can if you use an analyzer like tools.analyzer on the source
821,1552778078.1294,Jenni,what is a simple clojure rest server?
821,1552784085.1305,Celestine,<@Jenni> You might want to look at Ring + Compojure API.
821,1552784902.1308,Jenni,thanks!
822,1552789997.1317,Guy,"```(reduce (fn [x [k v]]
                               (str (name k) "":"" v)) ""foo"" {:id 1 :name ""foo""})``` =&gt; “name:foo”; I was expecting this to return “fooid:1name:foo”; ```(reduce (fn [x y]
                               (str x y)) ""foo"" '(:id 1 :name ""foo""))``` =&gt; “foo:id1:namefoo” as expected; could someone explain me what is the difference here?; one is a seq and another is a hashmap but both can be iterated"
822,1552790569.1345,Meagan,"in the first one, you never add on to your accumulator `x`; so it is just returning the value of the last iteration `(str (name k) "":"" v)`"
822,1552790695.1365,Guy,"the reducing fn doesn’t get the accumulator as argument, how do I concat?; how is that different for the second one?"
822,1552790736.1373,Meagan,"your reducing function does get the accumulator; `(fn [x [k v]] ...`; x is the accumulator, `[k v]` is the map entry"
822,1552790872.1382,Guy,"ah, I though I was destructing"
822,1552790945.1387,Meagan,"you are destructuring the map entry; it helps to give your variables more explicit names; ```
(fn [accumulator [key value]]
  (str (name key) : value))
```; when reduce is used on a hashmap, it passes the MapEntry value as the second argument which can be destructured as `[key value]`"
823,1552799226.1412,Tressa,then there's reduce-kv
824,1552819612.1422,Leatha,"Hi
i am using re-natal readme to generate new app (all deps install, and verified that they work)

after doing init i got
```Creating Leiningen project
Updating Leiningen project
Creating React Native skeleton.
Creating Re-Natal config
Compiling ClojureScript
Command failed: lein prod-build
```

so i read <https://github.com/drapanjanas/re-natal/issues/108>
and ran it manually but got this

```Could not transfer artifact re-frame:re-frame:jar:0.10.6 from/to central (<https://repo1.maven.org/maven2/>): Connect to  [localhost/127.0.0.1] failed: Connection refused (Connection refused)
Could not transfer artifact re-frame:re-frame:jar:0.10.6 from/to clojars (<https://repo.clojars.org/>): Connect to  [localhost/127.0.0.1] failed: Connection refused (Connection refused)
Could not transfer artifact re-frame:re-frame:pom:0.10.6 from/to central (<https://repo1.maven.org/maven2/>): Connect to  [localhost/127.0.0.1] failed: Connection refused (Connection refused)
This could be due to a typo in :dependencies, file system permissions, or network issues.
If you are behind a proxy, try setting the 'http_proxy' environment variable```

i am not behind proxy i asked in <#C0E1SN0NM|cljsrn> but they said to look for help here

edit: SOLVED <https://github.com/technomancy/leiningen/issues/2368#issuecomment-451581572>"
825,1552825766.1431,Epifania,"for the various `rand` functions like `rand-int`, is it possible to set the seed value somehow?; looking through the source of clojure, I find no relevant mentions of `seed`"
826,1552830386.1441,Jasmine,<https://dev.clojure.org/jira/browse/CLJ-1452>; Vote!
826,1552830869.1447,Rudolph,None
826,1552831155.1451,Laurice,"probably what really happened =&gt;; ```&gt; (defrecord ConversionError [key val exception])
&gt; (def -q- (-&gt;ConversionError 1 2 3))

&gt; (defrecord ConversionError [key val exception])
&gt; (def -w- (-&gt;ConversionError 1 2 3))

&gt; (type -q-)
ConversionError

&gt; (type -w-)
ConversionError

&gt; (instance? ConversionError -q-)
false

&gt; (instance? ConversionError -w-)
true```"
826,1552831274.1463,Rudolph,as in the defrecords end up making different types with the same name?; if they get eval'ed twice
826,1552831357.1481,Laurice,"yep, you have 2 types with the same name ..   and 2 instances; the 1st from the 1st type and the 2nd from the 2nd type   .. the type name being equal is throwing you off      `(= (class -q-) (class -w-)) =&gt; false`"
826,1552831470.1484,Rudolph,guess I'll rethink what I'm doing there; that is also the case
827,1552833734.1518,Derick,"Hello, all!
When using <#CEA3C7UG0|jackdaw> `peek` to process the messages in a `KStream`,  is there any way to get message's offset?"
828,1552848622.1522,Mohamed,how am I supposed to concat two transient vectors?
828,1552848660.1527,Laurice,IIRC reduce using conj! with 1st vector as `val` arg to reduce  ....actually you might be right; it's not clear how one reduce with a transient as `coll` arg .. hmmm x)
828,1552848730.1529,Mohamed,"ah i see, thanks!"
828,1552848839.1539,Laurice,"`(persistent! (reduce conj! (transient [0 1]) (persistent! (transient [2 3]))))`    works of course, if you're ok with the early call to persistent! there (for the 2nd vector)"
829,1552861168.1589,Isa,"Any better method to select keys only in `spec`, than macro?
```
(s/def ::person (s/keys :req [::first-name ::last-name ::email]
                        :opt [::phone]))
```

So I want to validate it, but also I want to remove all other keys, which are not specified like `::phone2`, but pass `::phone`, `::first-name` …

I see developers did solutions like here <https://stackoverflow.com/questions/47781002/reuse-structure-definition-code-from-clojure-spec-keys>

Do we have common solution (function, library) which can I use? I can write my own macro to use also namespaced keys, but maybe we already have solution, which I can use :slightly_smiling_face:"
830,1552862935.1594,Meagan,the general wisdom is that this is an antipattern
830,1552865107.1601,Jasmine,"I wouldn’t say that, just that it’s not well supported yet"
831,1552870010.1612,Josue,"anyone know why `(bit-test 1 32)` returns false on the JVM and true in CLJS? estoy confundido…; off by one… 31 is the highest bit, not 32. good to know that still happens to me"
832,1552891300.1681,Phylicia,"Q: when using fn indirection for development I can use #‘get-person and this allows me to reload get-person from the repl - awesome!
But what if get-person is the result of a higher-order fn call and I still want that indirection? i.e. I want #’(get-person-factory); Is this possible?"
832,1552892306.1686,Laurice,"you can call a var as is; i.e.    `(let [my-fn #'+] (my-fn 3 2))` =&gt; 5      ...maybe answers your Q ..          or maybe you want to go from + to #'+     ?   ..i don't think that's something people generally do, tho i might be wrong"
832,1552893812.1704,Phylicia,"I want to return an anonymous fn that behaves as if it was not anonymous and referenced via #'; the more I describe this, the more it seems impossible.; I had an idea. maybe I can have the anon fn call a #' ref. I’ll try that"
832,1552894818.1732,Isa,"<@Phylicia> not sure if I understand your issue, but maybe this help
```
(with-redefs [email/send-email! #(-&gt;&gt; (:body %2)
                                            (re-seq #""(?s)https://.*(/authentication/confirm-email/[a-z0-9-]+)"")
                                            (first)
                                            (second)
                                            (reset! email-confirm-url))]
        (is (= 204 (-&gt; (request-auth {:action ""sign-up""
                                      :user/email ""<mailto:foo@example.com|foo@example.com>""
                                      :user/password ""qwaszx""})
                       (get-status)))
            ""pass""))
```
`with-redefs` can change `fn` to different one under the hood"
833,1552904505.1754,Danna,"If I want to create a size-bounded list of size 50 I could just
```(take 50 (cons new-value size-bounded-list))```
every time I need to add an element
but I am wondering if there is a tidier/more idiomatic way; <https://github.com/clj-commons/ring-buffer>
is the thing"
832,1552914620.1761,Shanelle,Hi there
834,1552917285.1777,Tamisha,"hello, using pedestal, I'm having a problem because I have to deal with big auth tokens, they are causing trouble because the header goes over the size limit (431 (Request Header Fields Too Large)), does someone know how can I increase the max header size for local running pedestal server?"
832,1552919977.1782,Marlyn,"I don't think there is a straightforward way to do it; But here is a not straightforward way:; When you configure the server, pass a configurator to server/start `{:io.pedestal.http/container-options {:context-configurator f}`

In the function, grab the Server, map over .getConnectors, mapcat over .getConnectionFactories, filter the instances of HttpConnectorFactory, get their HttpConfiguration, and setRequestHeaderSize() on it

<https://github.com/pedestal/pedestal/blob/master/jetty/src/io/pedestal/http/jetty.clj#L113-L125>
ideally pedestal could add an option here to expose that config; You must be using JWTs :slightly_smiling_face:"
832,1552920172.1791,Tamisha,"yes, with ACL included, doesn't scale well... we moved away from it, but still supporting the old cases; thanks, I'll try this out; <@Marlyn> it worked, thank you so much!; and for anyone looking to do it, this is the fn to configure the context:; ```(defn set-request-header-size [x max-size]
  (-&gt;&gt; x
       (.getServer)
       (.getConnectors)
       (mapcat #(.getConnectionFactories %))
       (filter #(instance? org.eclipse.jetty.server.HttpConnectionFactory %))
       (run! (fn [factory]
               (-&gt; factory
                   (.getHttpConfiguration)
                   (.setRequestHeaderSize max-size))))))```"
832,1552921420.1807,Marlyn,cool
835,1552925366.1813,Emmie,Did the URL for the Slack archives change? I'm not able to browse the archives via <https://clojurians-log.clojureverse.org/>
835,1552925714.1818,Clarine,I guess it was taken offline due to some privacy concerns
835,1552926614.1828,Emmie,Thanks <@Clarine> I hope something like it comes up again :disappointed: that was a good resource for documentation :slightly_smiling_face:
835,1552926665.1835,Clarine,"The current suggestion is to move the community to Zulip because there all history is preserved. In fact, they are also saving these Slack chats there via some bot."
835,1552927372.1845,Emmie,"Oh cool, I've heard about Zulip, are the messages here being replicated there currently?"
836,1552927460.1858,Fairy,"Not that I would actually do this, but if one were to leave an NREPL port open on a public instance, has anyone heard of hackers scanning for that port and if so, would they know to use a Clojure interpreter and would it be possible to pull in all the namespaces, functions, etc ?"
836,1552927822.1868,Jasmine,"with regard to the last, yes all state in the Clojure runtime is globally accessible. repl access should be controlled."
836,1552928976.1876,Marlyn,"<@Fairy> make sure the port isn't listening on all interfaces, and make people use SSH forwarding to reach it"
835,1552930161.1892,Ciara,<@Emmie> the slack-archive can be found at <https://clojurians.zulipchat.com/#narrow/stream/180378-slack-archive>
835,1552930180.1895,Emmie,Thank you!
837,1552939133.1932,Muriel,"Is anyone attending Clojure North in Toronto? If so, you can meet the author of <https://www.metosin.fi/blog/faster-and-friendlier-routing-with-reitit030>. He's in a group that created Tilakone Finite State Machine, too."
837,1552939302.1941,Clarine,"I’m also looking forward to the Juxt talk, introducing a new DB. Lots of exciting stuff in April I guess. Have fun over there!"
837,1552939415.1954,Cira,"I have a set of scored pairs as below and would like to identify the set of pairs that produce the highest score in total:
```
{#{0 1} 0.98,
 #{0 3} 0.62,
 #{1 3} 0.71,
 #{1 2} 0.01,
 #{0 2} 0.89,
 #{3 2} 0.16}
```
I assume this is a solved problem but am not sure what I should be searching for. If anyone could point me in the right direction that would be very appreciated :slightly_smiling_face: (guess maybe I should have gone to uni after all :smile:)"
837,1552939519.196,Danyell,cant you just sort the map and get the first two?
837,1552939608.1964,Clarine,"I might be understanding the problem wrong, but this returns:
```
(apply max-key val sp)
[#{0 1} 0.98]
```"
837,1552939687.1978,Cira,<@Danyell> <@Clarine> probably doing a bad job at explaining :smile: The list above contains all permutations(?) of 4 items. I want to find the two pairs that produce the highest total value. N might be higher than 4 :slightly_smiling_face:
837,1552939746.1988,Clarine,"or is this like x0 + x1 = 0.98, x0 + x3 = 0.62, … find max(xi + xj)?; from the above it’s not entirely clear what the equation is, it could also be x0*x1, etc.?; <https://www.wolframalpha.com/input/?i=solve+x0+%2B+x1+%3D+0.98,+x0+%2B+x3+%3D+0.62,+x1+%2B+x3+%3D+0.71>"
837,1552940316.201,Danyell,Yea I am not quite getting it then
837,1552940453.2017,Cira,the score is `score(pair)`. In the example above the optimal solution would be `[#{1 3} #{0 2}]` because the sum for the score of these pairs is the maximum that can be achieved
837,1552940501.2023,Clarine,"ah, so that fact that these are sets of numbers is irrelevant?; then yes, you can simply sort and take the first two"
837,1552940588.2042,Dann,"but there has to be more to it, as #{0 1} had a high score and was ruled out"
837,1552940590.2043,Cira,<@Clarine> sorting won't work because it might return an invalid result like `[#{1 3} #{0 1}]`
837,1552940608.2049,Clarine,ah so the sets have to be distinct
837,1552940612.2052,Dann,OK so you can only use a number once in the key sets?
837,1552940616.2054,Cira,yes
837,1552940699.2062,Clarine,and there is no way to calculate the individual contribution of each id?
837,1552940720.2065,Cira,"no, they are always in relation to another"
837,1552940735.2069,Clarine,nice Advent of Code puzzle :wink:
837,1552940762.2078,Cira,Glad to hear this is half-entertaining :smile:
837,1552940817.2087,Isa,"```
(s/def ::address (s/keys :req-un [::recipient ::country ::postal-code ::city ::street]
                         :opt-un [::house-nr ::flat-nr ::phone]))
```
I want to write macro. How can I get by `::address` all keys from it?; Is it possible to read this from macro definition?"
837,1552940885.2097,Cira,<@Isa> does it need to be a macro? this might be easier to extract from the spec registry
837,1552940907.2102,Clarine,<@Cira> I think you must enumerate all partitions of #{1 2 3 4} in subsets of two and then calculate the score of the partition and then take the max
837,1552940926.2103,Isa,"whatever, If I can to id in fn, I can do it in macro. But how to get this data from `s/def`?"
837,1552940959.2105,Cira,take a look at `get-spec` (I think that's what it's called)
837,1552941023.2107,Isa,"```
(s/get-spec ::address)
=&gt;
#object[clojure.spec.alpha$map_spec_impl$reify__1997 0x29848e69 ""clojure.spec.alpha$map_spec_impl$reify__1997@29848e69""]
```"
837,1552941077.2117,Hae,"is there any way to call getBasis() on a record without knowing the type of the record? I’m trying this, but it’s giving me an exception:
```(defrecord TestComposite [a b])
(let [x (TestComposite. ""HI"" 1)]
  (.getBasis ^clojure.lang.IRecord x))
```"
837,1552941078.2118,Isa,hmm how to get keys from it?
837,1552941101.2121,Hae,"```IllegalArgumentException No matching method found: getBasis for class user.TestComposite  clojure.lang.Reflector.invokeMatchingMethod (Reflector.java:53)
```; is the error"
837,1552941124.2127,Dann,"is getBasis something you call on the instance, or the class?"
837,1552941133.2129,Hae,it’s on the class
837,1552941143.2134,Dann,than call it on the class of x
837,1552941144.2136,Hae,but i get a different exception when I try to call it on (class x)
837,1552941217.2139,Cira,"I think `(meta (get-spec ,,,))` or something like that"
837,1552941219.2142,Isa,`(s/form (s/get-spec ::address))`
837,1552941219.2144,Dann,"it's static ```(cmd)user=&gt; (defrecord Foo [a b])
user.Foo
(cmd)user=&gt; (Foo/getBasis)
[a b]
(ins)user=&gt; (. Foo getBasis)
[a b]
```"
837,1552941223.2147,Isa,I found it; :beers:
837,1552941228.2154,Cira,sounds good
837,1552941231.2156,Dann,use (. (class x) getBasis)
837,1552941274.2158,Isa,"Do you know if this registry I can read only during run app or I can do it during compilation?; Well, probably I have to try :slightly_smiling_face:"
837,1552941294.2163,Hae,"```(let [x (TestComposite. ""HI"" 1)]
  (. (class x) getBasis))```; that fails with `IllegalArgumentException No matching field found: getBasis for class java.lang.Class  clojure.lang.Reflector.getInstanceField (Reflector.java:271)`; also fails if I put getBasis in parens, as a method call"
837,1552941349.2173,Dann,"I wonder why it works with the class as a literal arg but not as the result of an expression; it's a method call as is, adding parens doesn't change that"
837,1552941377.218,Cira,It's available at runtime
837,1552941403.2185,Hae,"yeah, i’m a bit confused about this aspect of java interop. Normally these things work just fine"
837,1552941501.2189,Dann,"oh, getBasis isn't on IRecord <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/IRecord.java>; we need the interface that actually has that method"
837,1552941725.22,Danyell,I can only think of the brute force solution here
837,1552941987.221,Cira,<@Clarine> the issue with generating all possible 2-pair combinations of `#{1 2 3 4}` is that with just 10 items the combinations explode
837,1552942090.2223,Danyell,You want to two points that do not intersect in neither the x or y direction
837,1552942090.2224,Cira,I mean maybe this is just the wrong approach to the problem :smile:
837,1552942219.224,Dann,"if the inputs lead to a combinatorial explosion, you either need to consume them lazily and hold the two highest found so far, or you need some other property of the index / scoring function that helps you narrow the space; <@Hae> I found where getBasis is added to the class: it's done while emitting bytecode, separately for each record / type rather than using an interface <https://github.com/clojure/clojure/blob/2cc37bb56a9125a1829c73c505e32995e663059a/src/jvm/clojure/lang/Compiler.java#L8210>"
838,1552942726.2264,Clarine,"<@Cira> quick REPL session:
```
$ clj -Sdeps '{:deps {org.clojure/math.combinatorics {:mvn/version ""RELEASE""}}}'
Clojure 1.10.0
user=&gt; (require '[clojure.math.combinatorics :as mc])
nil
user=&gt; (mc/permutations (range 4))
([0 1 2 3] [0 1 3 2] [0 2 1 3] [0 2 3 1] [0 3 1 2] [0 3 2 1] [1 0 2 3] [1 0 3 2] [1 2 0 3] [1 2 3 0] [1 3 0 2] [1 3 2 0] [2 0 1 3] [2 0 3 1] [2 1 0 3] [2 1 3 0] [2 3 0 1] [2 3 1 0] [3 0 1 2] [3 0 2 1] [3 1 0 2] [3 1 2 0] [3 2 0 1] [3 2 1 0])
(def scores {#{0 1} 0.98,
 #{0 3} 0.62,
 #{1 3} 0.71,
 #{1 2} 0.01,
 #{0 2} 0.89,
 #{3 2} 0.16})
#'user/scores
user=&gt; (def perms (mc/permutations (range 4)))
#'user/perms
(user=&gt; (defn score [perm] (-&gt;&gt; perm (partition 2) (map set) (map scores)))
#'user/score
user=&gt; (score [0 1 2 3])
(0.98 0.16)
user=&gt; (defn score [perm] (-&gt;&gt; perm (partition 2) (map set) (map scores) (reduce +)))
#'user/score
user=&gt; (score [0 1 2 3])
1.14
user=&gt; (apply max-key score perms)
[3 1 2 0]
user=&gt;
```; you might leverage the fact that `[0 1 2 3]` and `[1 0 2 3]` is the same score so you can filter those out first.; but with n = 10 you might still have a problem, I could test …; if you have some test input for n = 10 :slightly_smiling_face:"
838,1552942930.2283,Cira,<@Clarine> 1s; None
839,1552943018.2295,Hae,"<@Dann> I see, thanks for the help."
838,1552943097.2301,Cira,"<@Clarine> 6s for 10 items, I'll need to do this for maybe 50-hundreds; so I guess a new approach might be needed :smile:"
838,1552943122.2306,Dann,if you search the clojure repo for `getBasis` I think one of the things that pops up is how to find that method - it requires explicit reflection rather than clojure's implicit reflection (?)
838,1552943134.231,Clarine,what does this data represent?
838,1552943405.2312,Cira,I'll tell you over a beer some time :smile:
838,1552943470.2317,Clarine,"fun :slightly_smiling_face: I mean, is this the real data or just some mock data?"
838,1552943518.2324,Cira,it's a real problem and real data in that the numbers represent some kind of IDs
838,1552943576.233,Clarine,the above code is the real data?
838,1552943582.2332,Fredda,I guess you don't need all permutations; Just distinct ones
838,1552943614.2336,Clarine,"<@Fredda> this?
&gt; you might leverage the fact that `[0 1 2 3]` and `[1 0 2 3]` is the same score so you can filter those out first."
838,1552943628.2338,Fredda,"right, just don't produce them"
838,1552943647.2342,Clarine,that’s even better. I couldn’t find the right function for that yet; subsets-of-2… or something
838,1552943690.235,Cira,`(combinations (range 4) 2)`
838,1552943770.236,Clarine,I mean `(partition-into-subsets-of-2 #{1 2 3 4}) =&gt; [[#{1 2} #{3 4}] [#{1 3} #{2 4}] ...]` etc.
838,1552944199.2363,Hae,"yeah, I see that. I’m assuming that’s why my reflection calls are all failing, but I don’t quite understand 100% why. I’m going to try a slightly modified approach to my problem, since I want to avoid reflection anyway.  I appreciate the help though, thank you."
838,1552947464.2371,Cira,"<@Clarine> <@Dann> <@Danyell> I think this might be the ""proper solution"": <https://en.wikipedia.org/wiki/Blossom_algorithm>"
840,1552952827.2378,Vinnie,how are people using rebl? using something like this? <https://github.com/DaveWM/nrepl-rebl>; (i haven't used it yet. just starting to figure out how)
841,1552956222.2383,Marcia,<https://github.com/RickMoynihan/nrebl.middleware>
840,1552958448.2386,Vinnie,thanks i'll try that next. `nrepl-rebl` was erroring out; i did manage to get a rebl launched but when i eval from vim-fireplace it doesn't auto show up in REBL. guessing that's what the middleware will help with :slightly_smiling_face:
842,1552959146.239,Celestine,"I use REBL all the time but I start a Socket REPL (via JVM options) and I connect my editor to that (Atom/Chlorine) so I avoid nREPL. Chlorine has support for ""inspect"" as well as ""eval"" -- the latter is just regular eval-in-REPL but the former additionally sends the form and the result to REBL (via `cognitect.rebl/submit`) so values show up in the browse/view panes."
840,1552959176.2392,Vinnie,interesting
840,1552959182.2394,Celestine,"But, yes, the nrebl middleware should help you with automatically sending values to REBL as they are evaluated in nREPL."
840,1552959193.2399,Vinnie,will find out soon :slightly_smiling_face:; funny you popped up i was just reading your post <@Celestine> <http://corfield.org/blog/2018/12/03/datafy-nav/> :slightly_smiling_face:
840,1552959235.2412,Celestine,"(I don't ""inspect"" every value but for anything complex that I want to be able to drill into and explore, REBL is great)"
840,1552959254.2417,Vinnie,i'm guessing if i have as nrepl middleware i won't have the choice - everything will show up; which might be fine. not sure yet
840,1552959268.2424,Celestine,"That's my understanding, yes.; There's a <#CEFN9UP8R|rebl> channel here if you have more detailed questions..."
840,1552959301.2432,Vinnie,"oh, thanks. i missed that"
840,1552959302.2434,Celestine,...especially about using the middleware.
840,1552959728.2459,Vinnie,works great. eval results show up in vim like usual and *also* shows up in REBL!; now to learn how to use this thing :slightly_smiling_face:; yetibot weather response
843,1552963688.247,Jaimee,Is it possible to use sente with the hot reload of compojure?
844,1552964244.2493,Diamond,"<@Clarine> Another option is k-combinations. I use k-combinations in meander to generate the search space used find to all possible pattern matches for set and map patterns containing variable keys: <https://gist.github.com/noprompt/6a4624a81908baf60263dcd4efeda4d8>; Note, this solution requires realizing the input collection (it counts). In practice that hasn’t bit me because the collections I’m counting are cheap to count e.g. sets and maps."
844,1552972156.2531,Cira,<@Diamond> I think your `k-combinations` is the same as math combinatorics‘ `combinations` when you supply a second arg?
844,1552975614.2651,Diamond,"<@Cira> no because my version has a different interpretation of the word “unique”. That version will give you unique selections via a `distinct` view of the input collection, my version doesn’t do that. It yields all the selections even if they produce duplicates. In my case, doing it that way ensures a full survey of the search space. Apart from that, I think they will also have different space and performance profiles depending on the context.; I also notice now that the combinatorics solution also realizes the input up front.; And here I was berating myself. :smile:"
845,1552980535.2677,Belia,Does Clojure support Java 11 now? like reflection? I want to use JavaFX through library `cljfx` which has minimum Java 11 requirement.
845,1552981075.2684,Chanelle,"if there is a clojure wrapper for a library which requires Java 11
I would assume support is there"
844,1552981227.2687,Belia,I see.
844,1552981534.2698,Roslyn,"<@Belia> clojure definitely supports java 11, I wrote cljfx in it :slightly_smiling_face: Join <#CGHHJNENB|cljfx>!"
845,1552981679.2719,Belia,"<@Roslyn> Thanks for your work!! I like it very much. After I switched Java version to 11, then I just runned `re-find.fx` which rely on `cljfx`. It works. BTW, I got an error in output: `Reflection warning, cljfx/fx/table_cell.clj:33:11 - call to method updateItem on javafx.scene.control.TableCell can't be resolved (no such method).` I think it should be cljfx issue. Do I need to post an issue on GitHub?; I use command
```
clj -Sdeps ""{:deps                   {MageMasher/re-find.fx                      {:git/url \""<https://github.com/MageMasher/re-find.fx\>""                       :sha \""b29bde3519f7632b63eb71415943bf8a7cfa1462\""}}}"" \    -m re-find.fx
```; I tested some of my usually used libraries, some libraries still have problem on Java 11. But I decide to switch to Java 11 now. I will report issue on library repo."
845,1552982587.2754,Roslyn,"Yeah, it's a cljfx problem, I put reflection warnings to not lose on performance, but using proxies with proxy-super generates them. I should disable these warning in proxy-super calls. Please open an issue!"
846,1552984214.2804,Isidro,"a clojure design question. Assume I have a server side function which, when called, will make a (potentially large) number of async http requests, process the responses and return a value based on the responses. Requests form a tree in that a returned request, depending on the returned data, might lead to more requests. Let’s further assume both the time for request completion and the time to process a completed request is non-negligible. Clojure has a lot of async primitives, promise, future, channels, async pipelines, pmap, etc etc. What primitives would you choose for a scenario like this?"
845,1552984521.2808,Belia,<@Roslyn> Ok. I will add a new issue on GitHub :slightly_smiling_face:
847,1552984884.2821,Bart,"how is performance of `map` compared to `mapv`, especially on larger data?; i've heard claims that `mapv` is much faster than map, at least in the ""core"" case of `mapv f coll`"
848,1552985816.2835,Madeleine,"I'd benchmark it.; But, the major difference is mapv is eager, and map is lazy; You said the response processing is non negligible? That means it is CPU heavy? Or just doing a bunch of IO?; Basically, you need to see. Is there any.two things you could do concurrently?"
847,1552986575.2853,Clarine,<@Diamond> Nice! Still k-combinations doesn’t yield all ways to partition a collection into 2-sized subsets. If you call `(k-combinations [1 2 3 4] 2)` you still have to figure that part out yourself
848,1552986584.2856,Clarine,and for n = 50 this will still explode :slightly_smiling_face:; also it yields `[1 2] [2 1] ...` which are duplicates in <@Cira>’s problem
848,1552986752.2865,Roslyn,"Thanks, I'll have a look at it today later when I'll be home"
848,1552986810.2867,Isidro,"yeah I certainly want to do both querying and processing in parallel; I think I’m opting for just using promises, makes things simple. Less control than say async pipelines, but I think the clarity is worth it in this case"
848,1552986924.2871,Madeleine,"I mean, can you? Like is there a case where the next thing to do needs the answer to multiple prior requests?"
849,1552988030.2874,Isidro,"no; each response will result in one answer, the function returns a collection of answers; but each response can in addition to an answer also result in further requests, so it’s a “draining” kind of process…but I think promises will be good enough here"
848,1552989263.288,Madeleine,"Hum, alright. I'm not tottally following, but promises are just a way to deliver a value between two places, threads normally. So they could work if your async http requests can deliver them on result. Otherwise you will probably need future instead."
848,1552989602.2885,Clarine,"can I use <https://github.com/clojure/tools.analyzer.jvm> to analyze just one file from a project without loading an entire project on the classpath?; it seems like tools.analyzer.jvm is meant to be run in process and isn’t that suitable to build a static linter with maybe?; is there a way to make something like this work?
```
(-&gt;&gt; (ana.jvm/analyze '(ns foo (:require [bar :as b])))
       (ana.jvm/analyze '(b/func 1)))
```; I guess it really needs a runtime for macro-expansion"
850,1552993422.2905,Epifania,is there any visual tools to aid reading clojure/tools.trace output?; some visualizer or similar
848,1552996116.2915,Harris,"<@Clarine> there's `analyze-ns` but yes, that needs runtime evaluation; we could do without evaluation if clojure had clearly defined evaluation stages (a la CL or racket) , but alas, it's not the situation we are in"
848,1552996189.293,Clarine,I was thinking of making a simple linter that gives a warning when you use def inside def. But I think I can do this just on the literal s-expressions maybe
848,1552996207.2932,Harris,makes sense
848,1552996392.2956,Sixta,"I never know what to think of those kinds of approach because of `(def def let)` kinds of thing (okay, less likely for this specific kind). It would be useful to have a way to know what a symbol resolves to in a file. If it's a local, that's fine too."
848,1552996481.2965,Harris,well for `def` in particular that's a bit easier since the only valid value of `x` in `(x new-var init)` is a _literal_ `def` (modulo macros)
848,1552996493.2968,Clarine,use case: personally I use def inside defn for debugging and my linter gives me an overview of where to remove these before committing.
848,1552996530.2973,Harris,but linters don't have to be 100% accurate so it's fine
848,1552996971.2983,Sixta,"It's also useful for doing analysis of function calls. Who calls what &amp; where. Using analyzer for that causes macro-expansion, so it would appear that you never once refer to clojure.core/ns"
848,1552996990.2986,Harris,the analyzer keeps track of macroexpansions
848,1552997075.2991,Sixta,"oh, I didn't see that in the output. How can I perform mappings to the original?; That's a little ambiguous. How can I list things in the original only?; I guess that's impossible without macro-expansion to some level :thinking_face: Because macros can make symbols special, so you have to track where they end up, and what they end up being used for?"
848,1552997589.301,Harris,"you can't really perform mappings; ```user=&gt; (defmacro m1 [] `(m2))
#'user/m1
user=&gt; (defmacro m2 [] 1)
#'user/m2
user=&gt; (select-keys (analyze `(m1)) [:val :raw-forms])
{:val 1, :raw-forms ((user/m1) (user/m2))}```"
848,1552997664.302,Sixta,"oh, that's cool. How did I miss that :thinking_face:"
851,1552999425.3044,Tabitha,"Can someone help me understand the behavior of `sequence` when passed an xform and multiple collections?
I really don't understand what the documentation is getting at.
&gt;returns a lazy sequence of applications of
&gt;the transform to the items in coll(s), i.e. to the set of first
&gt;items of each coll, followed by the set of second
&gt;items in each coll, until any one of the colls is exhausted.  Any
&gt;remaining items in other colls are ignored. The transform should accept
&gt;number-of-colls arguments

example behavior that I dont understand at all
```
  (sequence (comp (map inc) (map inc) (map inc)) [1 2] [-1 -2] [0.1 0.2])
=&gt; (4 5)
  (sequence (comp (map inc) (map inc) (map inc)) [1 2] [-1 -2] [0.1 0.2 0.3])
=&gt; (4 5)
  (sequence (comp (map inc) (map inc) (map inc)) [1 2 3] [-1 -2 -3] [0.1 0.2 0.3])
=&gt; (4 5 6)
```"
851,1552999506.3053,Harris,which part of the doc are you not understanding?
851,1552999532.3059,Clarine,"I think it’s analogous to `map` with multiple seqs:
```
(sequence (comp (map vector)) [1 2] [-1 -2] [0.1 0.2])
;; =&gt; ([1 -1 0.1] [2 -2 0.2])
```"
851,1552999616.3071,Harris,"those examples you pasted make no sense and are not valid, I have no idea how you got those results; ```user=&gt; (sequence (comp (map inc) (map inc) (map inc)) [1 2] [-1 -2] [0.1 0.2])
Execution error (ArityException) at user/eval9 (REPL:1).
Wrong number of args (3) passed to: clojure.core/inc```"
851,1552999643.3083,Tabitha,"uh, well, I ran them in clojurescript, so thats probably how."
851,1552999649.3087,Harris,"this is what should be happening, because you're trying to `(inc 1 -1 0.1)`"
851,1552999654.309,Tabitha,"lol, clojurescript will chew on anything"
851,1552999661.3093,Harris,"ah right, clojurescript doesn't have strong arity checks"
851,1552999669.3097,Clarine,that’s because JavaScript…
851,1552999674.31,Harris,so in cljs `(inc 1 -1 0.1)` is 2 instead of an arityexception; which is what was confusing you I guess
851,1552999684.3107,Tabitha,"right, yeah, thats exactly it; I see, I see.  okay, this is awesome, I get it now.  Thank you guys SO much."
852,1553009215.3124,Tabitha,"Is this another clojurescript specific thing?
<https://clojure.org/reference/transducers#_sequence>
&gt; The resulting sequence elements are incrementally computed. These sequences will consume input incrementally as needed and fully realize intermediate operations. This behavior *differs from the equivalent operations on lazy sequences*.

```
(type (sequence (comp (map inc) (map inc) (map inc)) [1]))
=&gt; cljs.core/LazySeq
```"
851,1553009345.3129,Tabitha,maybe I should ask that in the cljs channel...
851,1553009422.3131,Harris,"no, it's a transducer specific thing (the part in the docs)"
851,1553009614.3153,Tabitha,"I'm referring to the fact that, despite what the documentation seems to imply, the sequence appears to be of type LazySeq.   So, I guess I'm asking if that LazySeq is special and works incrementally behind the scenes, or is it really just a LazySeq in clojurescript"
851,1553009696.3162,Esteban,"i've got this java method
```public int put(int row, int col, double... data) {```
how do i call it from clojure?
i tried `(.put a 1 1 (into-array Double [2.0]))` but it says `No matching method put found taking 3 args`"
851,1553009749.3163,Tabitha,seems to also be of type LazySeq in clojure.  guess its just fancy under the hood
851,1553010020.3165,Madeleine,You might <http://need.to|need.to> type hint; The ints
851,1553010175.3174,Jasmine,"`double...` is a varargs argument, which in the jvm is an array of &lt;type&gt;"
851,1553010180.3175,Madeleine,Also I would try using `double-array` instead of into-array. In case it matters that it is a primitive double array
851,1553010192.3179,Jasmine,"here, double is the primitive double, not the boxed Double; so you need to use `double-array`"
851,1553010221.3185,Esteban,"oh, `(.put a 1 1 (double-array [2.0]))` works"
851,1553010225.3187,Jasmine,yep
851,1553010230.3189,Esteban,"thank you, sir"
851,1553010236.3192,Jasmine,np
851,1553010252.3193,Esteban,thank you
851,1553010293.3201,Jasmine,<https://clojure.org/guides/faq#varargs> is missing the primitive aspect so I'll update that
851,1553010639.3205,Madeleine,"&gt; sequence
function
Usage: (sequence coll)
       (sequence xform coll)
       (sequence xform coll &amp; colls)
Coerces coll to a (possibly empty) sequence, if it is not already
one. Will not force a lazy seq. (sequence nil) yields (), When a
transducer is supplied, returns a lazy sequence of applications of
the transform to the items in coll(s), i.e. to the set of first
items of each coll, followed by the set of second
items in each coll, until any one of the colls is exhausted.  Any
remaining items in other colls are ignored. The transform should accept
number-of-colls arguments; The doc mentions lazy-seq it seems"
851,1553010737.3209,Tabitha,"I think those docs are just saying that, e.g,  `(sequence (map inc [1 2 3]))` will not force realize the map operation like a `doall` would"
851,1553010814.3212,Madeleine,"Ya, I admit that part you highlighted in bold is confusing.; But sequence will not force realize a lazySeq as well; So I fail to see what is different about the transducer usage"
851,1553010882.3218,Tabitha,"yeah ¯\_(ツ)_/¯; the docs seem to suggest that the actual process of realizing a sequence is incremental, meaning it only computes one element at a time (which would be different from lazyseqs which realize in chunks)"
851,1553010988.3222,Madeleine,"Ya, but, somehow I doubt that :yum:"
851,1553011002.3224,Tabitha,hahaha; <@Jasmine> any thoughts?
851,1553011030.3228,Madeleine,If its just a lazySeq of applying xf to each element. That lazySeq would behave like any other I'd guess
851,1553011156.323,Jasmine,"sorry, what's the question?"
851,1553011185.3232,Madeleine,"Is this another clojurescript specific thing?
<https://clojure.org/reference/transducers#_sequence>
&gt; The resulting sequence elements are incrementally computed. These sequences will consume input incrementally as needed and fully realize intermediate operations. This behavior *differs from the equivalent operations on lazy sequences*.

```
(type (sequence (comp (map inc) (map inc) (map inc)) [1]))
=&gt; cljs.core/LazySeq
```"
851,1553011203.3234,Jasmine,"no, same in Clojure"
851,1553011216.3236,Tabitha,"no, that part we know now; the question is:"
851,1553011225.324,Madeleine,"Sorry, shouldn't have included the first bit ; What.differs about the transducer sequence over the normal one? What's that part in bold referring too?"
851,1553011270.3244,Tabitha,"`sequence` returns a value of type `LazySeq`, the docs say that the behavior of sequence differs from equivelant operations on lazy sequences.   Is the LazySeq returned by sequence actually realizing values differently (i.e. incrementally rather than in chunks)"
851,1553011298.3246,Jasmine,"it's what it says - ""These sequences will consume input incrementally as needed and fully realize intermediate operations. ""; lazy seqs are fully lazy in their intermediate operations too; so  you  could  have a nested operation that creates an infinite sequence for example and just take some of i t; the transducer equivalent will never return"
851,1553011360.3254,Tabitha,"right, but the question is the difference between lazy seqs and sequence; not sequence and transduce"
851,1553011424.3258,Jasmine,are you talking about concepts or specific function names?
851,1553011428.326,Madeleine,"I think an example would help me. Or, what do we mean here by intermediate operations ?; `(sequence (comp (map inc) (remove even?)) (range 10000))`"
851,1553011612.3265,Jasmine,"it's  easier to get with an expanding op; `(-&gt;&gt; (range 5) (mapcat #(range (+ 100 %))))`; will  create an output lazy sequence of 510 values; 100 +  101 + 102 + 103 + 104 vals; `(take 5 (-&gt;&gt; (range 5) (mapcat #(range (+ 100 %)))))` can make and return just 5 values; (ignoring chunking  for the moment); `(take 5 (sequence (mapcat #(range (+ 100 %)) (range 5))))` will return the same result; but must fully realize the first intermediate chunk of 100 values; lazy seqs are ok with an arbitrarily (infinitely) long intermediate sequence, the transducer equivalent is not"
851,1553011879.3283,Tabitha,"...wait, wouldn't taking 5 just realize the lazyseq value, which would then emit 5 values lazily?"
851,1553011880.3285,Jasmine,"the result production model is different -  lazy  seqs are a fully ""pull"" driven  model where values are produced when needed (again, ignoring the wrinkle of chunking)"
851,1553011906.3287,Tabitha,"because range is lazy, right?"
851,1553011911.3289,Jasmine,"`sequence` with a  transducer is pull  on the  outside level, but the transducer ""push"" model  inside; yes, range is lazy; consider `(take 5 (-&gt;&gt; (range 5) (mapcat (constantly (range)))))`"
851,1553011991.3295,Tabitha,"so, sequence is a lazyseq of lazyseqs, so if I take 5, wouldnt it only realize 5, because it would realize the first value, which is a lazyseq value, and then would consume 5 values from that?"
851,1553011993.3297,Jasmine,"that concatenates five infinite sequences; ignoring chunking, yes it only realizes what it is being asked to produce; `(take 5 (sequence (mapcat (constantly (range))) (range 5)))` will never return because it will attempt to fully  realize the  first intermediate result (which is  infinite)"
851,1553012196.3303,Tabitha,well how about that.  Thank you!  thats extremely helpful!
851,1553012207.3305,Jasmine,"and that's  what the docstring is trying  to say: ""The resulting sequence elements are incrementally computed. These sequences will consume input incrementally as needed and fully realize intermediate operations. This behavior differs from the equivalent operations on lazy sequences.""; ""incrementally computed"" because still lazy, but avoiding the word ""lazy""  b/c it's different than lazy sequences; still implemented by LazySeq but backed by transducer iteration instead"
851,1553012318.3312,Tabitha,"yeah, that distinction is crucial.  thank you so much.  that probably would have gotten me good"
851,1553012393.3316,Jasmine,"it's rare to actually need the `sequence` function at all. most things that are being used to produce  the initial collection are seqable and the consumers are calling `seq` on it automatically, so things  plumb together  automatically without needing this"
851,1553012506.3318,Tabitha,"when you bring chunking back into the discussion, does `sequence` have the performance benefit of fewer intermediate values for long chains of operations?; im working in lambda so I'm trying to optimize on memory efficiency"
851,1553012960.3362,Madeleine,"Hum, I get it. But I need to take some time to internalize it :rolling_on_the_floor_laughing:"
851,1553012963.3364,Jasmine,"there are two levels here - the top level is lazy seq, unchunked, will be computed as needed"
853,1553012984.3366,Clint,"Hey, question with Lacinia, if I have a field such that
```:xs {:type (list :x)
     :resolve :my-resolver/get-xs}```
when I try to change the resolver to use an Async following the example here: <https://lacinia.readthedocs.io/en/latest/resolve/async.html>, it ends complaining because it was expecting a collection, not a single item. Using `resolve-as` works correctly

Is it not possible ?  or is the case that I am missing something?"
851,1553012993.3367,Jasmine,"the  lower level is a transducer stack and will depend on what you're doing; generally yes, but depends a bit; depends what the source collection is, whether it's a seq, whether it's chunked, etc. and also what you do with the output"
851,1553013185.3374,Tabitha,"right, yeah.  If the sequence being realized is an infinite sequence, its obviously not going to be more memory efficient"
851,1553013244.3376,Jasmine,"no :); whether or not you plan to use the full result is important.; and some tension between ""memory efficient over time"" vs ""minimizing overall work"""
851,1553013355.3382,Tabitha,I take it lazyseqs supply the latter in most cases?
851,1553013357.3384,Jasmine,lazy seqs  generally being better at the former and transducers on the latter
851,1553013362.3386,Tabitha,"oh, how about that"
851,1553013392.3388,Jasmine,transducers avoid all intermediate seq caching so do less overall work (and consume less overall memory); but they do it at one time
851,1553013422.3392,Tabitha,ahhhhh
851,1553013432.3394,Jasmine,rather than  smeared over consumption
851,1553013433.3396,Madeleine,"Ok, I think it clicked. Each element is processed eagerly. Because the pipeline is a transducer. And sequence lazily applies the xf to each element. But the application of xf is eager. It's just that sequence will wait till you need the next element before applying xf to it. So its only lazy at the first level. And that level is unchunked as well."
851,1553013448.3398,Jasmine,right; seqs and transducers are both useful models  in different circumstances. `sequence` with transducers is  kind  of a mix; you could `map identity` over the top  to get chunking at that level
851,1553013578.3409,Clint,"As it happens, three minutes later I discover that I was missing something. Oh well :slightly_smiling_face:"
851,1553013580.341,Tabitha,haha! thats interesting
851,1553013598.3412,Jasmine,chunking is its own set of tradeoffs from amortization; less memory and faster than unchunked  at the expense of less laziness; and less control
851,1553013826.3418,Madeleine,"I think I had never really thought about nested lazy seq before. It seems like the nested lazynes only makes sense in a cat scenario no?; Otherwise, taking the next element requires full realization of the sequence in it as well ; Hum... or I guess that might be due to me printing the result. It would juat take a lazySeq I'm guessing."
851,1553013970.3424,Jasmine,"only  really matters in an  expanding  intermediate op, `mapcat` being  the canonical example; but even things that collect and  report can be  affected, like `group-by`; `partition`, `dedupe`, etc"
851,1553014044.343,Madeleine,"Right I see. Anytime where in theory, taking the next doesn't need everything in the next element to realize."
851,1553014063.3432,Jasmine,yeah
851,1553014067.3434,Madeleine,Its kind of mind boggling a bit hehe
851,1553014109.3437,Jasmine,"fortunately, the majority of time it doesn't  matter :)"
851,1553014195.3447,Madeleine,"`(first (last (take 3 (-&gt;&gt; (range 5) (map #(map (fn[a] (println a) (inc a)) (range %)))))))`; Haha, its amazing to see."
854,1553015655.3466,Clarine,I’m now looking at rewrite-clj as an alternative for tools.analyzer to do some static analysis. It was perfect until I discovered that it doesn’t support ClojureScript and you don’t get line numbers with your tokens…
855,1553016396.3486,Isidro,"another “opinion based” question as s.o. would phrase it - does anybody have any guidance/feelings/grudges/info between clj-http, http-kit, and aleph for production level async http client requests?"
854,1553016568.3491,Clarine,"one argument could be: if you’re already running a server with aleph or http-kit, you have the dependency anyway"
854,1553016840.3509,Lesa,"I'm using clj-http atm. One annoyance was a lack of mocking support for async requests but it otherwise has been quite painless to use, currently using client certs with it which was quite easy to setup"
854,1553016953.3526,Isidro,"read a reddit thread claiming that http-kit randomly stopped working in prod, and it seems that clj-http only does async via callbacks…guess I’m going with aleph until somebody tells me otherwise; <@Lesa> async via callbacks or something like futures/promises?"
854,1553017131.3554,Lesa,"Using callbacks. We have a small wrapper that takes as arguments the specific clj-http function, the url, and any options, the wrapper creates a `promise-chan` which the callbacks push their return value onto, and we return that promise-chan to the caller; which we can then consume using the usual core.async stuff; ```(defn- req! [func url options]
  (let [prom-chan (a/promise-chan)
        callback (fn [v] (a/&gt;!! prom-chan v))]
    (func url options callback callback)
    prom-chan))```"
854,1553017194.3563,Isidro,ok
854,1553017260.3572,Lesa,"the calling code is then responsible for handling any exceptions that come out, but you could return separate result-chan / exception-chan promises as well"
856,1553019757.3586,Gina,"Hello! I'm writting a POC web app to learn clojure, and I was thinking on how to handle users. Since I'm going the easy way for now I thought about having a dynamic variable `*user*`, which would be set for every request in a middleware. Something like this (untested):

```
(ns a.vars)
(def ^:dynamic *user* nil)

(ns a.middlewares
  (:require [a.vars :refer [*user*]]))

(defn middleware-add-user [handler]
  (fn [request]
    (binding [*user* (get-user-from-request request)]
      (handler request))))

[...]
```

I'm using `luminus` lein template, which uses `ring` and `immutant/undertow` if I understood the config correctly. My question is: is the `with-bindings` safe to be used in a situation where multiple requests are arriving? In other words, will the binding be unique for each request context? Something like a thread-safe biding?

Thanks for the help :slightly_smiling_face:"
856,1553020080.3597,Dann,<@Gina> it's normal to assoc data onto the `request` object itself - it's a hash map; also I think `with-bindings` there would just be `binding` (but passing the data is cleaner IMHO)
856,1553020144.3611,Gina,"Yes, I imagined, it just feels that I'm gonna have to pass the `user` to virtually every function I call from the routes, so I was trying to be lazy :stuck_out_tongue:.; Regardless of whether it is a poor design (I agree with you), would it work? Is the binding request-specific?"
856,1553020337.3633,Dann,"yes, but certain scenarios can make you lose your dynamic binding where an explicit arg would be preserved; clojure's good about propagating bindings, but eg. if you interop with a lib from java that uses threads you can easily lose bindings"
856,1553020408.3647,Gina,I see. Cool. I really appreciate the help <@Dann> :slightly_smiling_face:. Thanks
857,1553023217.3648,Candis,We (Amperity) use Aleph heavily in production and it’s been great to us so far.
858,1553033227.3661,Valrie,"hey folks, Is there any protocol to implement in a type that makes it print friendly ?"
858,1553033362.3663,Clarine,you mean like implementing the toString method of Object?
858,1553033424.3668,Celestine,<@Valrie> maybe you're thinking of <https://clojuredocs.org/clojure.core/print-method>
858,1553033430.367,Valrie,maybe; thanks <@Celestine> that's what i'm looking for
858,1553033493.3679,Dann,there's also print-dup for things that should explicitly be readable from the printed output
858,1553033575.3682,Clarine,what does `dup` stand for?
858,1553033759.3684,Dann,"duplicate; as in, print, read, get the duplicate back"
858,1553033821.3689,Clarine,right…
859,1553035589.369,Sixta,<@Clarine> it does have a mode which includes line numbers
858,1553035605.3692,Sixta,But it's separate because it isn't compatible with clojure.zip
859,1553035641.3694,Sixta,Also see rewrite-cljs in clj commons
860,1553066709.3745,Ahmad," zipmap or rename keys does not maintain order same as input keys or map , seems it is due to assoc function which is used by them . Please Can someone suggest an way to rename keys with map key order maintained "
860,1553066888.3749,Tammera,"I don’t think there is a guarantee that a maps keys remain ordered; As in — as a datastructure; I wonder what your usecase is, there are sorted-maps in core, and there are ordered-maps in libraries, I just wonder how you wish your map to remain ordered"
860,1553067419.3828,Ahmad,"I get an dictionary of [excel-number-date, values] from Java api . Convert result into sorted-map , similar to here let  [result ( into (sorted-map) java-dict-result)] , now  trying to rename the keys from number into ‘yyyy-mm-dd’ format ; When I rename the keys the order of keys gets changed ; Basically I believe it is due to assoc function used internally "
860,1553067779.3861,Tammera,"I wonder whether the map you get from renaming keys is still a sorted map. Nevertheless, you could again convert it to a sorted map, can’t you?"
860,1553068122.3902,Ahmad,Yes I can since new keys are of ‘yyyy-mm-dd’  sorting works fine here. But was checking if there are some way which maintains orders . 
860,1553068602.3931,Zita,"<@Ahmad> Did you want to preserve the order of insertion, or ensure that they are sorted in key order when iterating?; for the latter, there's sorted-map:```
user=&gt; (sorted-map :b 2 :d 4 :a 1 :c 3)
{:a 1, :b 2, :c 3, :d 4}```"
860,1553068792.397,Ahmad,"I want to preserve order  while rename keys , Was trying zipmap and set/renames-keys "
860,1553068814.3974,Zita,"for the former, I'm not aware anything native to clojure. you could try using java.util.LinkedHashMap; alternately, you could build your own using a list or vector of pairs; you'd lose the map syntax shortcuts and the sub-linear access time, but insertion order would be preserved; or: store insertion order in a list/vector and pairs in a map; you'd just need to keep the two structures synchronized"
860,1553069409.4026,Ahmad,"Ok I sort my result again after rename , which works for my current scenario ; I would try you suggestions later and add them to my util , thx for your suggestion "
860,1553069545.4048,Zita,note that LinkedHashMap is a mutable map
861,1553071667.4063,Clarine,<@Sixta> How do I turn the line numbers on? I can’t find any docs on this; I found it. Like tools.reader it uses meta for this.
861,1553071920.4067,Sixta,Yep!
861,1553071944.4069,Clarine,Thanks! :slightly_smiling_face:
861,1553072128.4071,Sixta,"No problem, I'm excited to see what you come up with :)"
862,1553075976.4092,Karren,"<@Ahmad> I'm not sure I understand your issue - if you use `sorted-map` then the order is preserved after `assoc`, `rename-keys` et al.
If sorting after `rename-keys` would lead to a different order from what you want then I don't understand the ""I sort my result again after rename"" bit. However, in that case you could use <https://github.com/flatland/ordered/blob/develop/src/flatland/ordered/map.clj#L140>"
863,1553092388.4107,Sherril,does anyone know if there is a java equivalent for this datastructure?; <https://github.com/michalmarczyk/psq.clj>
863,1553094185.4117,Holly,<@Sherril> you could try adapting <https://github.com/michalmarczyk/psq.clj/blob/master/src/main/java/psq/PersistentPrioritySearchQueue.java> to pure java
864,1553099982.4141,Clarine,"Graal native complains about:
```
Discovered unresolved type during parsing: rewrite_clj.node.protocols.Node
```
because I’m using that protocol somewhere. How can I resolve this?; somehow moving the predicate in which I use this protocol to another namespace helps…
```
(ns ild.pred
  (:require [rewrite-clj.node.protocols :as node]))

(defn uneval? [node]
  (= :uneval (node/tag node)))
```; it’s black magic to me"
864,1553100996.42,Danna,"I am trying to make handling of Postgres enumtypes feel more idomatic.
I have writtten an `intern` function to help with this
```
(defn intern-enumobj
  [_ enum-obj]
  (println enum-obj)
  (let [start-ns *ns*
        the-ns (in-ns (symbol (str start-ns ""."" (namespace enum-obj))))
        objref (intern the-ns (symbol (name enum-obj)) enum-obj)]
    (in-ns (symbol (str start-ns)))
    objref))
```
this is called directly within a namespace

My problem is that I cannot refer to one of these dynamically created namespaces from a `(:require` clause; I get a the error ```CompilerException java.io.FileNotFoundException: Could not locate notifications/enumset/channel_type__init.class or notifications/enumset/channel_type.clj on classpath. Please check that namespaces with dashes use underscores in the Clojure file name., compiling:```

I can work around this by _instead_ making a call to `clojure.core/alias`
This feels a bit hacky though; is there a better way of doing this?"
864,1553101092.4205,Rosaline,that function is just broken; using in-ns in code like that is never a great idea; I'd suggest starting with a `(def postgres-enum-objects (create-a-map-from-name-to-enum-object))`
864,1553101242.4224,Danna,yeah i did.
864,1553101277.4229,Rosaline,"which will give you want you want, without creating namespaces"
864,1553101375.424,Danna,"so it marginally nicer to refer code to the var
`enumset.comms_status/sent`
rather than to
`(:sent enumset/comms_status)`; but I accept that it is unimportant in the big scheme of things
and perhaps I should just get over it; it seemed worth investigating though;
In practice I will always need the map representation as well in order to process keywords; is this not the sort of this a self modifying LISP is supposed to be good at?"
864,1553101712.4281,Evonne,"What if you create the namespace the regular way, and just write a macro to automatically `def` the names you want based on the enum?"
864,1553101724.4284,Danna,"actually if I'm using plain old `alias` I can use `create-ns` instead of `in-ns` which is a little simpler but doens't address your fundamental point
```
(defn intern-enumobj
  [_ enum-obj]
  (let [the-ns (create-ns (symbol (str *ns* ""."" (namespace enum-obj))))]
    (intern the-ns (symbol (name enum-obj)) enum-obj)))```; so I have a single `enumset` namespace where I define the  enumtype/enumvals; I'd rather keep the 'enum type' definitions in one place; rather than have a ```(def comms_status (postgres-enumset ""comms_status""
                                    #{""abandoned""
                                      ""failed""
                                      ""sent""
                                      ""unsent""}))```
map in `enumset` and then seperate-and-distinct `enumset/comms_status.clj` file; but yeah perhaps
I'm just looking for raindows in a star filled sky"
864,1553101960.4301,Bee,So what happens to the parts of your program that rely on `&lt;ns&gt;.&lt;enum-obj&gt;` when they try to load when the database connection isn't available yet?
864,1553101985.4308,Danna,well I've hard coded it as strings; so it does not rely on a database connection; tempting although that was
864,1553102019.432,Bee,Oh so you just are aliasing data in some ns to vars in another ns?
864,1553102023.4321,Danna,"hardcoded like ````(def comms_status (postgres-enumset ""comms_status""
                                    #{""abandoned""
                                      ""failed""
                                      ""sent""
                                      ""unsent""}))```; yeah"
864,1553102057.4331,Bee,"So 99 times out of 100 I'd never advise someone out of the blue to ""use a macro instead"""
864,1553102064.4333,Evonne,"Right, I’m thinking you’d create the `enumset/comms_status.clj` file manually, give it a regular `(ns ...)` declaration, and then have a macro  that could do something like `(defenums comms_status)`; just to save yourself the trouble of hooking everything up to keep the compiler happy."
864,1553102133.435,Bee,"But you've managed to work your way into the 1%. I really encourage you to write a macro that iterates over `comms_status` and defs the appropriate vars, and to invoke the macro in the namespace where you want the aliases to show up, because I predict it'll be more evident and less error prone than programmatically interacting with the ns api."
864,1553102218.436,Danna,"well. sticking just a
```(alias 'comms_status 'notifications.enumset.comms_status)
``` directly underneath the namespace declaration seems to solve the problem; and is simpler than a macro"
864,1553102454.4365,Evonne,Interesting.
864,1553103379.4367,Danna,"okay so I have a numpty macro question then: how do I return multiple S expressions from a macro?; ```(defmacro generate-postgresenum
  [enum-type valset]
  (let [ns-name (symbol (str *ns* ""."" enum-type))
        enum-map (postgres-enummap enum-type valset)
        syms (into '() (map (fn [v] (list 'def (name v) v))) (vals enum-map))]
    (list* `(ns ~ns-name)
           `(def enum-map ~enum-map)
           syms)))```; ```(macroexpand '(enumset/generate-postgresenum ""comms_status""
                                             #{""abandoned""
                                               ""failed""
                                               ""sent""
                                               ""unsent""}))```; then gives me a *list* of s-expressions
which I need to eviscerate; Hmm this might be one rabbithole too far
at this point; so a namespace is a sequence of s-expressions, starting with `(ns `
and I don't know you would get a macro to return a sequence of s-expressions; `unquote-splicing` looks it wants a single container to be run inside
which isn't compatible with the format of a `(ns`
Is it possible to do?"
865,1553104636.4409,Dann,"you can't return N items, but you can use one collection as if it were N items, and that's what unquote-splicing is for; so you don't write a magic macro that inserts multiple things into the parent (ns), you write a new top level form that expands to an ns call, and also expands some collection"
864,1553104742.4428,Jasmine,And sometimes it’s useful to emit multiple things in a `do`
865,1553104884.4441,Jasmine,Although emitting an ns form + stuff in it is a classic issue aka “the Gilardi scenario”
864,1553104963.4449,Jasmine,"Which, reading again is probably irrelevant for what you’re seeking to do"
864,1553105222.4458,Danna,"i'm starting to think that `(create-ns` and a few `alias` statements is comparatively quite simple; &gt; Although emitting an ns form + stuff in it is a classic issue aka “the Gilardi scenario”
can you point me any discussions/blog posts on this?"
864,1553105316.4466,Jasmine,Google is prob best
864,1553105323.4469,Danna,ok thanks; `Gilardi` is quite a Googleable phrase
864,1553105356.4485,Jasmine,But really it’s having a block of code that need to be broken up into multiple top level expressions to be properly evaluated 
864,1553105397.449,Dann,<@Danna> how is using create-ns etc. better than using ns inside a macro? I don't fully understand your use case
864,1553105739.4491,Danna,"so I would want write a macro that emitted a sequence of s-expressions like
```
(ns notifications.enumset.comms_status
  (:require [notifications.enumset :as enumset]))

(def enum-map (enumset/generate-postgresenum* ""comms_status"" #{""abandoned"" ""failed"" ""sent"" ""unsent""}))
(def abandoned (:abandoned enum-map))
(def failed (:failed enum-map))
(def sent (:sent enum-map))
(def unsent (:unsent enum-map))
```
and I don't know how I could get a single macro to do that"
864,1553105767.4493,Dann,"the normal thing is to put them all in a `do` block, as <@Jasmine> said; putting the forms at the top level is good style, but clojure doesn't require it"
864,1553105841.4506,Jasmine,"Yeah, this is the kind of thing that typically doesn’t work well in a single top level do; Specifically the ns part (the rest is fine)"
864,1553106055.4514,Danna,can I nest the forms _inside_ the `ns` part; would be the other obvious thing to try; (I just tried wrapping that wole thing in a `do` in a .clj file; its weird); this is a fairly frivolous piece of syntactic sugar for me; and I've probably spent enough time on it; thanks for your input
866,1553112446.455,Marlen,"Is it possible to read and transform EDN without evaluating the reader literals? I’m playing with programatically transforming a `duct` `config.edn`, and I need to be able to `read-&gt;transform-&gt;write` without evaluating some of the literals—since the output would contain, for example, expanded absolute file paths for resources, etc; I supposed I could override the readers?"
866,1553112696.4558,Jasmine,"yes, for sure. it's all up to what your data readers do; they are passed read but unevaluated values; you can use the built-in `tagged-literal` function to read your data literals and  print back to the same data literal (without doing any eval)"
866,1553112802.457,Marlen,"ah perfect, thanks Alex!"
866,1553112869.4573,Jasmine,"```user=&gt; (def x (tagged-literal 'hi '[a b c]))
#'user/x
user=&gt; x
#hi [a b c]
user=&gt; (:tag x)
hi
user=&gt; (:form x)
[a b c]```; tagged literals were designed specifically to support this case (flowing data through intermediaries without necessarily ""understanding"" it)"
866,1553112940.4587,Marlyn,if the tag is `#inst` or `#uuid` -- you have to explicitly pass those in to override them
866,1553112974.4591,Jasmine,"yes,  otherwise  you can  fall back to setting the `*default-data-reader-fn*`; `(binding [*default-data-reader-fn*  tagged-literal]   ...read-transform-write...  )`"
866,1553113078.4599,Marlyn,"```
user=&gt; (edn/read-string {:readers {'inst #(tagged-literal 'inst %)} } ""#inst \""what?\"""")
#inst ""what?""
```; inst and uuid are edge cases"
866,1553113228.4606,Marlen,"You guys are awesome, that was exactly what I needed. Thanks!"
866,1553113464.4613,Shayla,"i have a quick question about macros in tests. I want to get nice `expected: X actual: Y` output from calling `is` on a `re-find`; I don't think I need to write a new reporter, I just need to compare the output of `re-find` with whatever I want to pass in; however, i can't seem to write a macro (or function, if necessary) to take in the expected string and the actual string and compare them in such a way as the reporter will put them into the right places"
867,1553113605.4635,Shayla,has anyone tried their hand at something like this?
866,1553113857.4641,Shayla,"The best I've gotten is to double-print the error by embedding `do-report`:
```
(defmacro last-log-contains
  [state content]
  `(let [log# (-&gt; @~state :log last :text)
         found# (re-find (re-pattern ~content) log#)]
     (do-report
       {:type (if found# :pass :fail)
        :actual log#
        :expected ~content})))
```; after some more experimentation, i've found that returning `true` at the end works to suppress the secondary error but it then hides the comment at the end of the `is`"
867,1553114489.4664,Becki,`is` is a macro so that you can tell it how to execute and compare the results of the test right?
867,1553114519.4667,Jasmine,are you aware that `is` takes assertions with an open multimethod `assert-expr`? you could probably define your own assertion type more easily than this
866,1553114562.4672,Shayla,I am not! that's super interesting
867,1553114633.4686,Jasmine,so you'd define `(defmethod clojure.test/assert-expr #'log-contains [state content] (...))` and use it like `(is (log-contains ...))`
866,1553114647.4691,Shayla,"yeah, i see what you're saying, that's cool as heck"
866,1553114656.4693,Jasmine,look at the definitions in clojure.test for more info
866,1553114681.47,Becki,and the docstring for clojure.test namespace is excellent and a nice little novel of how to use it
866,1553114690.4702,Shayla,"awesome, thank you so much"
866,1553114693.4704,Jasmine,<https://github.com/clojure/clojure/blob/master/src/clj/clojure/test.clj#L492>; around there - there's also a big inline comment  higher up in  the source that  explains some of this
867,1553114771.4712,Jasmine,"oh yeah, like dpsutton says :)"
866,1553115208.4716,Shayla,"ooooooo yeah, that's awesome; Thank you so much, <@Becki> and <@Jasmine>, y'all are great; For those following along at home, here's my solution, thanks to some generous help:
```
(defmethod assert-expr 'last-log-contains
  [msg form]
  `(let [state# ~(nth form 1)
         content# ~(nth form 2)
         log# (-&gt; @state# :log last :text)
         found# ~form]
     (do-report
       {:type (if found# :pass :fail)
        :actual log#
        :expected content#
        :message ~msg})
     found#))
```"
868,1553122163.4747,Guy,"My understanding of cider is that it starts the nrepl and sends the code I write in emacs to the nrepl; if that is correct, when I say `(doc doc)` in the `lein repl` that works but not in my cider repl."
868,1553122285.4752,Dann,"doc is `clojure.repl/doc` and clojure.repl is only in scope in your initial ns (whichever that is) usually; so if you run it in a namespace other than the init, it usually won't find doc (but cider has its own tooling for pulling up docs)"
868,1553122481.4766,Guy,<@Dann> thanks. Any pointers on why the cider’s tooling for pulling up the docs are not working?
868,1553122500.4769,Dann,<#C0617A8PQ|cider> is likely your best bet
868,1553122527.4771,Guy,thanks
868,1553122990.4772,Clarine,Made this today :slightly_smiling_face: <https://github.com/borkdude/clj-kondo>
869,1553165677.479,See,Any ideas on where to find the fault? Slightly stumped by this stack trace; I get this when running lein midje; and after the tests have run
869,1553165971.4804,Leeann,"have you forgotten to explicitly require `io` in one of your namespaces?; Your code might be working because `io` might be loaded by another ns when running the code, but when running the tests, `io` might not be indirectly loaded.; A recent version of Eastwood has a linter for this.; <https://github.com/jonase/eastwood/blob/master/src/eastwood/linters/implicit_dependencies.clj>"
869,1553166088.4823,See,Will give it a spin; Found it. Thanks <@Leeann>; He… big midje tests crashed eastwood when analalyzing the test code
869,1553167536.4834,Leeann,:sadpanda:
870,1553170517.4864,Debi,"Question regarding cemerick.friend: the typical approach seems to be that you perform your authentication (including starting sessions) in middleware. However, I would like to start a session in handler body. Reason: in that handler body the user is created in the database, and I would like to associate that user with the session. Is there a way to do this?"
871,1553175418.4875,Sonny,Does tools.alpha / deps.edn have capability of starting a repl in a given namespace like the :init-ns thing in lein?
871,1553175720.4881,Jasmine,"not really, that's hardcoded in the default repl code; you could (instead of using the default repl start),  run a script that started the repl yourself with that part customized; clojure.main/repl is (annoyingly) customizable; I assume that's  more  trouble than it's worth though"
871,1553176051.4928,Sonny,"Yeah, most likely though I will take a look. I think this is a case of me trying to map my previous lein style onto tools.alpha. One thing I used to do quite a bit is create a repl namespace with all my fun little tools and have lein start the repl there. I can either switch every time I start (first world problems), or create the `user` namespace. The latter triggers my OCD a bit though since I like to have everything sit nicely in the project NS.

Not the end of the world by any means. Thanks Alex."
871,1553176154.4942,Jasmine,"ultimately,  it's all  a matter of calling  clojure.main/repl  with the right stuff. so  just follow what clojure.main does  and  deviate where it's useful to you. you can bake that into an  alias with :main-opts  in your deps.edn."
871,1553176504.4956,Sonny,"Ok, that doesn't sound too tricky on the surface of things. I will take a look. As I think about it though, i'd probably want it all to work smoothly with cursive and the REPL integration there too. It's probably easier to just get used to switching it."
872,1553180197.4965,Holly,is it possible to memoize a `deftype`'s proto impls?
872,1553180799.4972,Harris,"no, but you can `(deftype T [] P (f [this arg] (memo-f this arg)))`; where `memo-f` is your concrete memozied impl"
872,1553180930.4983,Holly,"tks, thats what im doing. ideally the memoization would not be observable outside the deftype, but this works too"
872,1553180939.4985,Bart,"bah, why is my brain stuck on this ...; i have this long list of `true/false` conditions that should each be checked and if `true`, add a specific key to a vector; and the only way i came up with was stuffing `conditions` and `keys` into each their vector, `zipmap`-ing those, and filtering the resulting `map`. there must be something nice; *nicer"
873,1553182114.503,Danna,"```(into {} (comp (filter (fn [{:keys [condition] ...)) (mapcat (fn [{:keys [keys vals]}] (map vector keys vals))) &lt;&lt;list of things...&gt;&gt;```
kinda thing?; it sounds like it _IS_ a filter and a map, fundamentally"
872,1553182429.5041,Bart,None
873,1553182456.5048,Bart,maybe it is. this was my solution that I thought smelled a little funny.
873,1553183917.5061,Danna,well that call to `zipmap` does seem like wasted electricity
873,1553184020.5065,Bart,yup. i wanted a solution that avoided that and just worked on the original lists
873,1553184613.5069,Danna,"something like ```(sequence (comp (map (fn [k c] (when (true? c) k)))
                (filter some?))
          (range 10) 
          (cycle [nil true nil]))``` maybe"
874,1553195262.5094,Coreen,"hello, is it possible that with large lists `rand-nth` can go in `stackoverflow`?"
874,1553195334.5099,Dann,"it uses nth, and nth doesn't consume more stack to get larger indexes"
874,1553195355.5108,Becki,did you build up your large list with `concat`?
874,1553195357.5109,Dann,"but if coll is defined pathologically, `(count coll)` can stack overflow; yeah, what <@Becki> said, that would be the s/o risk"
874,1553195371.5114,Coreen,yep
874,1553195395.5119,Becki,anyone have the link?
874,1553195400.512,Clarine,ah
874,1553195408.5125,Dann,<https://stuartsierra.com/2015/04/26/clojure-donts-concat>; it's not just about concat - it's also the more general problem of mixing strict execution and lazy functions in a way that matches up badly; but recursively calling concat is the common source of the problem
874,1553195477.5141,Becki,"(common pitfall by the way, <@Coreen>) its the best dicussion of what's going on"
875,1553203382.521,Adelia,"Earlier, I submitted <https://dev.clojure.org/jira/browse/CLJ-2493>, a fix for clojure.java.browse/browse-url hanging on systems that use xdg-open. If there's agreement that my diagnosis makes sense, I would be willing to also submit some code, but I'm unfamiliar with the process for Clojure. I know there's the CA &amp; some sort of patch format. Maybe it's GitHub-like (Fork, branch, make changes, git diff), but I'd appreciate some guidance."
875,1553203447.522,Latonya,"You can also ask on the clojure-dev channel here, but the process for developing and creating patches is documented.  Finding link ..."
875,1553203451.5221,Dann,"there's a git command that creates a patch, I think there's a clojure doc that outlines the steps; the git command is `git format-patch`"
875,1553203539.5224,Latonya,"<https://clojure.org/community/developing_patches>; Not sure of your expectations, but just realize that code review and patch submission proceed at a pace comfortable for the maintainers, not necessarily the submitters."
875,1553203674.5244,Jasmine,ticket and approach seem reasonable
875,1553203716.5249,Adelia,Thanks to all. New to this Slack thing also (just signed up). I don't see a clojure-dev channel
875,1553203723.5251,Jasmine,CA: <https://secure.na1.echosign.com/public/hostedForm?formid=95YMDL576B336E>; <#C06E3HYPR|clojure-dev>
875,1553204148.526,Adelia,CA signed. Now to see about the patch :slightly_smiling_face:
876,1553204933.5264,Clarine,"Maybe multiple `:as` should be prohibited by the ns/require spec?
```
(ns foo (:require [clojure.set :as s :as set]))
```
It seems the last `:as` wins"
875,1553205236.5268,Dann,"I think it comes down to this ```user=&gt; ((fn [&amp; {as :as}] as) :as 'a :as 'b)
b```"
876,1553208828.5292,Adelia,Proposed patch for CLJ-2493 attached. Apologies for anything non-standard. It _is_ my first patch. (Hopefully not my last)
876,1553213891.5296,Latonya,Tried it out and added comments with results on the ticket.
877,1553214163.5299,Jasmine,"Thanks!; btw, <#C06E3HYPR|clojure-dev> is prob better channel for this stuff, but no biggie"
878,1553228487.531,Faustino,where can I find the COC for this channel?
878,1553230316.5318,Celestine,"<@Faustino> Look at the Channel Details for this channel (click the `(i)` button top right to get the sidebar, then expand Channel Details)"
879,1553237066.5325,Guy,"I am using postgres, Is there some lib that does type conversion like hashmap to json?"
879,1553237164.5332,Tammera,"ehm, what do you mean. Do you want to store a hashmap in clojure as a JSON(B) column in postgres?"
879,1553237189.5335,Guy,yes; and vice versa.; array to vector
879,1553237305.5346,Tammera,"yeah ofcourse, would be stupid if you could store something in postgres but not get it out right x); but sadly, this is where my knowledge ends, I did find this: <https://github.com/jeffpsherman/postgres-jsonb-clojure>, but I can’t say that I tried"
880,1553238635.5357,Guy,"nice, that was helpful. Thank you"
881,1553239060.5369,Tressa,"i got this bit from luminus
```
(extend-protocol jdbc/IResultSetReadColumn
  org.postgresql.jdbc.PgArray
  (result-set-read-column [value metadata index]
    (vec (.getArray value))))
```; it works with array/vector"
881,1553244815.5386,Mariela,"any reason why macroexpand-1 would not work in a the context of a `clojure.core/deftest`?

My test is in the form

```
(testing ""The macro expands to a known-good form""
    (is (= '(foo ...)
           (macroexpand-1 '(foobarize ...)))))
```; if run it from the repl, the test passes. But as I run the test suite, `macroexpand-1` expands nothing, so the equality fails; (...I have written such tests in the past so this issue surprises me); ahhh. got it. inside the macroexpand I was using an alias:

`(macroexpand-1 (sut/foobarize ...))`

I replaced `sut/` with the FQN and voila"
882,1553258366.545,Laveta,"Hi! I write a compiler for a query language in Clojure. The idea is not to interpret the expressions from the query language. Instead the compiler generates Clojure code at runtime and uses `eval` to compile it to byte code. So far it works very well. But now I have the problem that every compilation step creates new classes which go into the metaspace of the JVM. If I restrict the metaspace to a certain size, the GC stops my app for more than 10 seconds. Does someone use `eval` in production and has an idea to improve the GC behaviour?"
883,1553258430.5454,Jasmine,Why are you restricting the metaspace size?
883,1553258459.5459,Laveta,"Because if I don’t, it grows unlimited."
883,1553258698.5486,Jasmine,"when and how classes get unloaded depends on the garbage collector you're using. I noticed that Java 12, which just came out, has support in the ZGC for concurrent class unloading, not sure about the others; you may need to do some research on how to choose and configure the best garbage collector for this application given its unique constraints."
883,1553258913.5518,Laveta,thanks! you wouldn’t recommend against using `eval` in production? I see compilation vs. interpretation as a big plus for my use-case.
883,1553259277.5528,Jasmine,"No, I wouldn't recommend against it out of hand."
884,1553260318.5543,Sixta,"I have a list of net changes, e.g. `[1 -3 5 -10]`, and I'd like to get the totals at each point, so `[1 -2 3 -7]`. My immediate thought for this is `reduce`, but that doesn't feel particularly natural even here.

Any other ideas?"
884,1553260371.5545,Becki,reductions jumps out at me; `(reductions + 0 [1 -3 5 -10])`
884,1553260436.5553,Sixta,"I hadn't made the link for how good that was, perfect"
884,1553260490.5557,Becki,:+1:
885,1553265312.5564,Tonya,how would I specify a relation between keys in spec?; That is something like (s/and (s/keys :req [::k1 ::k2]) #(= ::k1 ::k2))?; saying that the value of two keys must be equal
885,1553265480.5579,Jasmine,"well you're almost there,  just fix the last pred; `(s/and (s/keys :req [::k1 ::k2]) #(= (::k1 %) (::k2  %)))`"
886,1553268785.5589,Deb,"How do you do OOP with inheritance hierarchies and overriding in Clojure? It looks like `deftype` does not allow you to specify a superclass. I know OOP is not popular in Clojure, but there is one situation where I like it: when defining UI components. I want to define behavior for a base class/type, and inherit and override that behavior in specific component subclasses. (I'm using ClojureScript so I want to use pure Clojure, not some JVM interop thing.)  The only way I see to do this is with `defmulti/defmethod`, and my `objects` would be some map or record with a type field."
886,1553269023.5598,Meagan,<@Deb> inheritance just isn’t something that is well supported outside of multimethods and the ability to `derive` keywords; even that isn’t popular. composition is usually favored over inheritance
886,1553269511.5619,Deb,"<@Meagan> Okay, thanks. That may work fine; I'm just not used to it."
886,1553269626.563,Meagan,"I would highly suggest using composition. reagent, Rum and other frameworks are well set up to support complex composition of UI components in ClojureScript"
887,1553271329.5648,Rico,"Hi, we are planning on migrating from RabbitMQ to Kafka to increase the throughput of our services. I'm working on a proof of concept, would anyone recommend any particular library?"
887,1553271478.565,Gilberto,<https://github.com/dvlopt/kafka.clj>
887,1553271790.5653,Rico,"Thanks! how does it compare with ""jackdaw"" and ""kinsky""?"
887,1553272007.5655,Gilberto,"I prefer it to `jackdaw`, having seen/worked with that library before, and I haven't used `kinsky`. This is just a thin wrapper around the standard Java SDK which is why I like it so much."
887,1553272677.5657,Rico,"I'll give it a go, thanks"
888,1553273019.567,Ashlea,I vaguely recall that there were some blog posts about the major differences between Clojure 1.9 and Clojure 1.10. Specifically one that mentioned a change in reflection
888,1553273691.5673,Jasmine,You can find a detailed change log at <https://github.com/clojure/clojure/blob/master/changes.md>; and this is probably the thing you're thinking about: <https://clojure.org/guides/faq#illegal_access>
888,1553273958.5688,Lemuel,"What's the most efficient way to get a sequence with *one copy* of an element removed?  I'm using `sequence` with a custom xf, but it's rather verbose."
888,1553274235.569,Jasmine,is `dedupe` useful?
889,1553276678.5697,Ana,"hi, has anyone invoke a lambda function yet? (with clojure)"
889,1553276754.5699,Tammera,assuming aws lambda instead of mathematical lambda :stuck_out_tongue:?
889,1553277099.5701,Ana,"so, i need call a function lambda on aws. Today i called through of API Gateway, but my service stay in amazon ECR, so is better use the invoke than API GATEWAY. The call is made internal and not external"
889,1553278146.5709,Ashlea,"Ugh, looks like I’m hitting <https://groups.google.com/d/msg/clojure/pxLN9tYti4c/zbhLCOrTBgAJ>; Are there plans backport the fix for the JDK regression to Clojure 1.9 or 1.8? Or will that be a 1.10-only fix"
889,1553278503.5727,Marlyn,<@Ashlea> I think only 1.10
889,1553279116.5735,Dann,"<@Ashlea> it shouldn't be hard to update your project to use 1.10, clojure upgrades cleaner than any other compiler I've used"
889,1553279124.5739,Ashlea,"nope; it’s not usually hard, but we’re having trouble with a particular bug"
889,1553279296.577,Becki,Ran into an issue where a lib has an invalid ns import under 1.10 and not 1.9 :(
890,1553279375.5777,Becki,So couldn't test the beta at work
889,1553279908.5784,Marlyn,<@Ashlea> can you remove the meta from the symbol?
891,1553280204.5787,Marlyn,Or it is within a dependency
889,1553280476.5791,Ashlea,"It’s an internal dependency, I think we can remove the meta; Trying it out now, will report back"
889,1553280504.5797,Jasmine,I'm not sure anyone ever filed the jira for that mailing list message
889,1553280539.5798,Candis,I would :-1: kinsky - in our experience it didn’t provide enough functionality and it’s full of reflection issues
889,1553280678.5804,Ashlea,I don’t think they did. I will as soon as I can
889,1553280682.5806,Jasmine,"so wasn't on my radar, but certainly seems like a candidate for 1.10.1; I'll take care of it"
889,1553280694.5811,Ashlea,:heart_eyes:; Thanks!
889,1553280774.5818,Jasmine,first I will try to decide if it is actually a bug :)
892,1553282873.5834,Melynda,"Hi!  Does Clojure have a short form for the following?
```
(if-let [a ...]
  (if-let [b ...]
    (if-let [c ...]
      (f a b c)
      default)
    default)
 default)
```"
892,1553282922.5838,Marlyn,"nope; `some-&gt;` is in the ballpark, but it doesn't do binding"
892,1553283175.5858,Melynda,"In my case I would have to wildly mix `some-&gt;` and `some-&gt;&gt;`, so that would not be better. Even though conceptually it would be the right tool (`c` depends on `b` depends on `a`).; <@Marlyn> Thanks!"
892,1553284101.5869,Ashlea,<@Jasmine> I put together a minimal reproduction of the issue here: <https://github.com/nwjsmith/meta-regression>
892,1553284162.5872,Marlyn,"very minimal :slightly_smiling_face:; thanks <@Ashlea>.  Would that happen in practice, or would the result of reflect get shredded for the juicy bits?"
892,1553284309.5896,Ashlea,It’s happening in practice for us. We have a macro that reflects on some Java Protobuf objects to generate functions to translate from Clojure maps into said objects.
892,1553284416.5907,Jasmine,"thx, the stuff that was in the google groups message was sufficient so didn't really need that"
892,1553284515.5922,Ashlea,:+1: please let me know if I can provide any more context or other help
892,1553284516.5923,Jasmine,a more minimal repro: ```(eval `~(clojure.reflect/reflect String))```
892,1553284528.5927,Ashlea,repro golf!
892,1553284568.5937,Marlyn,you can invoke the lambda directly through the API; I'll post an example in <#C09N0H1RB|aws>
892,1553284636.5943,Britteny,<@Melynda> Was thinking maybe better-cond could help: <https://github.com/Engelberg/better-cond>
893,1553284714.5946,Melynda,<@Britteny> Thanks!
892,1553284803.5948,Britteny,"Slightly odd, but golfed around this:
```
user=&gt; (or (b/cond
  #_=&gt;       :when-let [a 1
  #_=&gt;                  b 2
  #_=&gt;                  c 3]
  #_=&gt;       (+ a b c))
  #_=&gt;     :default)
6
user=&gt; (or (b/cond
  #_=&gt;       :when-let [a 1
  #_=&gt;                  b nil
  #_=&gt;                  c 3]
  #_=&gt;       (+ a b c))
  #_=&gt;     :default)
:default
```"
892,1553284904.5954,Ashlea,We have a workaround for now: strip the datafy metadata
894,1553287711.5964,Jasmine,"logged at <https://dev.clojure.org/jira/browse/CLJ-2494>, may not make much headway on it  for the next week. Need to think about this one a bit."
895,1553294364.597,Clarine,"I wanted to copy some metadata to all objects in a tree:
```
(defn copy-meta [tree m]
  (clojure.walk/postwalk
   #(if (instance? clojure.lang.IObj %)
      (with-meta % m) m) tree))
```
Why do I get a stackoverflow when using prewalk?"
895,1553294632.5979,Jasmine,sounds like it's walking into the object you replaced recursively
895,1553294864.5983,Clarine,what was the setting again to not load core specs?
895,1553294921.5986,Jasmine,<https://clojure.org/guides/faq#skip_macros>
895,1553294947.5988,Clarine,"ah thanks; I hoped to avoid running into this error with GraalVM (native) with it:
```
Call path from entry point to clojure.spec.gen.alpha$dynaload$fn__2628.invoke():
	at clojure.spec.gen.alpha$dynaload$fn__2628.invoke(alpha.clj:21)
```
but it doesn’t help"
895,1553295771.5997,Candis,I just ran into that with edn-tool and had to drop back to 1.9.0 :disappointed:; <https://dev.clojure.org/jira/browse/CLJ-1472>
895,1553296524.6007,Clarine,"Either `(read-string ""(-&gt; 1 inc inc)"")` or `(macroexpand '(-&gt; 1 inc inc))` don’t work for me in GraalVM native, I end up with the above error. Maybe too dynamic."
896,1553297358.6012,Nguyet,Cleanest way to log an exception stack trace in a single line? (for line-based log consumers)
895,1553297447.6023,Dann,maybe `(clojure.string/join separator (.getStackTrace e))` - but you want the `getMessage` in there too
896,1553297480.6029,Dann,or just some variation of `(pr-str e)` which has all that stuff and escaped newlines
895,1553297649.6031,Dann,"```user=&gt; (try (throw (ex-info ""foo"" {:a 0 :b 1})) (catch Exception e (pr-str e)))
""#error {\n :cause \""foo\""\n :data {:a 0, :b 1}\n :via\n [{:type clojure.lang.ExceptionInfo\n   :message \""foo\""\n   :data {:a 0, :b 1}\n   :at [user$eval149 invokeStatic \""NO_SOURCE_FILE\"" 1]}]\n :trace\n [[user$eval149 invokeStatic \""NO_SOURCE_FILE\"" 1]\n  [user$eval149 invoke \""NO_SOURCE_FILE\"" 1]\n  [clojure.lang.Compiler eval \""Compiler.java\"" 7176]\n  [clojure.lang.Compiler eval \""Compiler.java\"" 7131]\n  [clojure.core$eval invokeStatic \""core.clj\"" 3214]\n  [clojure.core$eval invoke \""core.clj\"" 3210]\n  [clojure.main$repl$read_eval_print__9068$fn__9071 invoke \""main.clj\"" 414]\n  [clojure.main$repl$read_eval_print__9068 invoke \""main.clj\"" 414]\n  [clojure.main$repl$fn__9077 invoke \""main.clj\"" 435]\n  [clojure.main$repl invokeStatic \""main.clj\"" 435]\n  [clojure.main$repl_opt invokeStatic \""main.clj\"" 499]\n  [clojure.main$main invokeStatic \""main.clj\"" 598]\n  [clojure.main$main doInvoke \""main.clj\"" 561]\n  [clojure.lang.RestFn invoke \""RestFn.java\"" 397]\n  [clojure.lang.AFn applyToHelper \""AFn.java\"" 152]\n  [clojure.lang.RestFn applyTo \""RestFn.java\"" 132]\n  [clojure.lang.Var applyTo \""Var.java\"" 705]\n  [clojure.main main \""main.java\"" 37]]}""```"
896,1553297666.6035,Dann,"it's ugly, but it's one line, and knows what to do with ex-info"
896,1553297734.6044,Nguyet,<@Dann> That seems to be exactly the cost/benefit ratio I’m looking for tonight :slightly_smiling_face: thanks!
897,1553301225.6057,Fernande,"<@Jasmine> regarding 1.10.1-beta1, the documentation for prepl mentions :clojure.error/phase but didn't this change to :exception?"
897,1553302232.6064,Jasmine,What documentation for prepl?
897,1553304296.6069,Fernande,<@Jasmine> the docstring for prepl mentions the 4 types of maps that prepl can return
897,1553307485.6072,Jasmine,"yep,  possible that drifted, will   check it; oh, actually these are separate things; :exception is a boolean flag indicating that a :ret map is  from an exception; ah, yeah the docstring is wrong, probably my bad; <https://dev.clojure.org/jira/browse/CLJ-2495>"
898,1553309493.609,Fernande,thanks!
899,1553342621.6132,Isa,"```
;; ::s-common
(s/def ::email (s/with-gen (s/and string? (partial re-matches #""^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,63}$""))
                           (partial gen/fmap #(str % ""@example.com"") (s/gen string?))))

;; ns where I define user

(s/def :user/email ::s-common/email)
(s/def ::create-user (s/keys :req [:user/email :user/password]))
```

`(s/explain-data ::create-user {:user/email ""foo""})` return
```
({:path [:user/email],
  :pred (clojure.core/partial clojure.core/re-matches #""^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,63}$""),
  :val ""foo"",
  :via [:api.auth.db/create-user :spec.common/email],
  :in [:user/email]})
```

here is an issue `[:api.auth.db/create-user :spec.common/email]`. Why there is no `:user/email` here from `(s/def :user/email ::s-common/email)`?
It makes issue to translate it into human understandable message. Normally I would find `:user/email` in `:via` and could return proper message.

Why is it done in this way? Can I consider it as a bug?"
897,1553346379.6138,Isa,"I can trick it doing `(s/def :user/email (s/and ::s-common/email))` but it is dirty; Any better way?; Personally I would say it is a bug, not a feature :wink: Unless I miss something big about it."
900,1553356003.6151,Latrina,Check out this blog post <https://blog.skyliner.io/fourteen-months-with-clojure-beb8b3e4bf00>
897,1553356028.6161,Latrina,Their solution was to use the cats lib either monad
901,1553379654.6175,Jasmine,"some of this has to do with when resolution via the registry occurs in spec, would be fine to jira it"
902,1553394834.6219,Mariela,"```
(defn example []
  """")

(defn uses-example [] ;; reflection warning!
  (-&gt; (example) (.endsWith ""omg"")))
```

Wondering, how come the Clojure compiler doesn't try to attach a `:tag String` to var metas (at least in easy cases)?

Might result in automatically performant code"
903,1553397402.6226,Rosaline,what happens in the repl if change the definition of example to return a boolean in your hypothetical?
902,1553399260.6227,Mariela,"I think I get what you mean.

But under a good Reloaded workflow, dependent vars are also recompiled..."
903,1553414308.6276,Leeann,"<@Milford> has done quite a bit of work on this in Clojurescript, and as <@Rosaline> points out, it has implications as to what needs to be re-evaluated on, well, re-evaluation. I think <@Milford> discussed that on a defn podcast. "
902,1553414460.6277,Mariela,interesting! this one I assume? <https://soundcloud.com/defn-771544745/defn3-repls>
904,1553418596.6295,Isa,"Is it time to move to <https://github.com/clojure/spec-alpha2> vs <https://github.com/clojure/spec.alpha> ? Is it stable and ready to switch in clj and cljs? Or should I wait?; <@Jasmine>

I am not super familiar with JIRA. I did typo when reporting in bug explanation and I don’t see any way to edit it. I can’t also add comment about it. Am I right there is no edit option and comment?

“So `(s/def :foo/email (s/and ::common-email))` is totally omit here.”

But should be “So `(s/def :foo/email ::common-email)` is totally omit here.”

<https://dev.clojure.org/jira/browse/CLJ-2496?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#issue-tabs>

I made it so ugly. I used to github issues. Sorry :slightly_smiling_face:; What should I do to correct my issue?"
903,1553429568.6316,Milford,I think Erik may have been referring to <https://www.therepl.net/episodes/3/>
904,1553431695.6328,Jasmine,I just needed to bump up your permissions - should be able to now ; No. You should wait.
904,1553432062.6344,Leeann,"That might just be. It’s hard to keep track, you’re all over the place these days :)"
905,1553434268.6361,Isa,"```
(s/def :user/password (s/and string? #(&lt;= 6 (count %) 32)))
(s/def :db/user (s/keys :req [:user/uuid :user/email :user/updated_at :user/created_at]))
; there is no :user/password in :db/user !
```
```
(s/assert :db/user {:user/uuid (uuid/v0)
                      :user/password ""0""
                      :user/email ""<mailto:foo@example.com|foo@example.com>""
                      :user/updated_at #inst""2019-03-24T13:19:45.150875000-00:00""
                      :user/created_at #inst""2019-03-24T13:19:45.150875000-00:00""})
```
```
Spec assertion failed
""0"" - failed: (&lt;= 6 (count %) 32) in: [:user/password] at: [:user/password] spec: :user/password
```

Hmm again I think I found a bug in spec and it is not a future. Am I right?; Situation when it start to be issue: plain password has another rules vs encrypted password. Assert check all data expect :user/password by :db/user but it fail because of encrypted :user/password anyway :disappointed:; Jira it <@Jasmine>?"
905,1553434464.6387,Elyse,Pretty sure that's not a bug. `s/keys` checks all namespaced keywords in the map against their specs. (Check out the docstring.)
905,1553434505.6392,Isa,So what is the point of `(s/def :db/user (s/keys :req [:user/uuid :user/email :user/updated_at :user/created_at]))` then?; if it check `:user/password` even if I don’t want; assert function get spec definition to validate. If it doesn’t care about definition what is the point of it. It should be just `(assert data)` then.
905,1553434714.642,Elyse,"If I understand correctly, the purpose of `s/keys` is to express that a certain set of keys are required. So if you were to check a map missing one of the required keys which had all of its keyword conforming to their specs, it would fail due to that missing required key."
905,1553434760.6428,Isa,So what the purpose of `:opt` then for `s/keys`?
905,1553434777.6433,Elyse,It's for documentation only (and for spec generation).
905,1553434862.6441,Isa,"Sounds like a hell. Somebody will add in his library `:user/password` and will affect whole app.; All spec will start to validate even if I have never say it in code of the app; Maybe it is an intention, but it sounds so evil :wink:"
905,1553434953.6457,Elyse,"Good motivation to use keys namespaced by your app's namespaces, which dependent libraries shouldn't be touching."
905,1553434999.6461,Isa,"yeah, but even in my app I would like to have control on it; There is no simple way to use namespace with keywords for database purpose when think about FE+BE and separate services which should use consistent structure.; I mean I can simple use `:user/password` but `::ns-for-user/password` is not a thing to do simple"
905,1553435196.6485,Elyse,At work we have a separate library of specs defined in cljc files consumed by our backend and frontend so they're speaking the same language; that is one solution.
905,1553435253.6492,Isa,"yeah, but even then people use mobile app etc. Using spec on BE shouldn’t force me to use Clojure / ClojureScript in all services and app in BE / FE.; At least it is my opinion. Bug, not a future :wink:"
905,1553435499.6506,Elyse,Not sure I understand how spec is forcing you to use clojure/clojurescript in all services.
905,1553435528.6511,Isa,"How will I use `::ns-for-user/password` in PHP? :wink:; Sure I can use full form, but then instead of `:user/password` developers will have to use `:cool-name-of-the-app.users.spec/password` or something like that for all values; Looks terrible :slightly_smiling_face:; Because by API using JSON I send namespaced data; there is no `email`, everything belongs to namespaces and I know if it is `:user/email` or `:company/email` etc. It has connection to database, validation etc."
905,1553435846.6556,Tressa,"it's the ""if it's present, it has to be this shape"" thing"
905,1553435882.6559,Elyse,"If namespaced keywords are painful for your use case, you don't have to use them. You could either use un-namespaced keywords or add/remove the namespaces at system boundaries."
905,1553435960.657,Isa,"namespaced keywords are solution for me, not an issue. But validation on keywrods which are not in definition of `s/keys` is unexpected thing.; but who knows, maybe I miss big picture of it"
905,1553436268.6592,Jasmine,That namespaced attributes carry global semantics is a core tenet of spec and is laced throughout the design
905,1553436309.6602,Isa,"Yeah I see, but why design in the way to validate keywords, which are not in definition of `s/keys`?"
905,1553436352.661,Jasmine,"Because we want to verify the global semantics throughout the system; s/keys is being replaced in spec 2 with schema and select so some of the details you mention above are changing, but this aspect is not"
905,1553436537.6636,Isa,hmm then I have to think about spec validation architecture once again. I totally miss info about `s/keys` and validation values outside definition.; Thank you all for explanation.
905,1553442780.6664,Mariela,"<@Isa>, if you use `:req-un [::ns-for-user/password]`, PHP consumers will simply pass `password`, while your spec will be checked against your namespace's spec, unmistakably"
905,1553442977.6665,Isa,"I want to use namespaces; The main point of discussion was about validate keywords, which are not in definition of `s/keys`; namespaces is connected to this topic, but not issue itself"
905,1553444378.6671,Mariela,"Understood, here a minimal reproduction of the bug-feature

```
(spec/def ::password string?)

(spec/def ::user (spec/keys))

(spec/valid? ::user {::password 1}) ;; false!
```

I wasn't aware of it to be honest.

One possible approach is to strip extra keys at the system boundaries... It's what reitit does, see the bottom <https://github.com/metosin/reitit/blob/master/doc/coercion/clojure_spec_coercion.md>; Another approach, obviously would be to stop using qualifed keywords if you don't want them to be always checked. The bug-feature doesn't happen for unqualifed `:password`."
906,1553444828.6679,Mariela,"Awesome stuff, ty both! :cljs:"
905,1553447057.6685,Isa,"At that moment I changed it to `select-keys` before validate. It works, but it change architecture and made me confuse how should I change the app.; Also I started to use `(confrom (s/keys) data)` and `(assert (s/keys) data)`; I mean after learned about this it makes spec different tool for me"
907,1553526768.6734,Dulcie,"I have some code:
`(HashMap. {""edgePackage"" (::common/list-item-tid notification)})`
... which warns me with:
`Reflection warning, av_connector/util/notifications.clj:73:60 - call to java.util.HashMap ctor can't be resolved.`
How can this be? And why do I still get warnings if I do this:
`(HashMap. ^Map {""edgePackage"" (::common/list-item-tid notification)})`; Perusing the list of HashMap constructors, I can't see how this would fail the reflection check"
907,1553526956.6745,Harris,<@Dulcie> `(let [^Map m {..}] (HashMap. m))`; the reason why your version doesn't work is a bug
907,1553527020.6751,Dulcie,"OK, well at least I know I'm not going crazy :slightly_smiling_face:"
907,1553527096.6753,Harris,<https://dev.clojure.org/jira/browse/CLJ-1929>; vote or leave a comment on it
907,1553527194.6758,Dulcie,Done
908,1553543410.6777,Kenda,"Kind of a newbie question here, but if I have `[:cat :bird :dog]`, what's the easiest way to get the infinite lazy sequence `(:cat bird :dog :cat :bird :dog :cat ...)`?"
908,1553543458.678,Rachele,Looks like you want <https://clojuredocs.org/clojure.core/cycle>
908,1553543482.6783,Kenda,"Aha! I knew I wasn't remembering something; Thanks, that's it"
909,1553554980.6824,Alejandro,"anybody know of a library I can use to convert `""100MB""` -&gt; `100000000` … i.e from a string representation to its equivalent in bytes as a long ?"
909,1553555039.6827,Meagan,sounds like something you might not need a library to do
909,1553555260.6848,Jasmine,"cl-format does everything, maybe it does this too :)"
909,1553555580.6853,Meagan,"```
(require '[clojure.string :as s])

(def unit-table {""MB"" 1000000})

(let [[_ amount units] (re-matches #""(\d+)(.+)"" ""100MB"")]
   (-&gt; (Long/parseLong amount)
     (* (unit-table units))))
```"
909,1553556297.6869,Alejandro,"<@Meagan> that code looks like the beginning of a library :slightly_smiling_face: … yeah, it is simple enough for one case, but as the units add up a library would make sense"
909,1553556365.6877,Meagan,"Just saying, some code that handles 20+ different units would probably only be ~30 lines of code. not worth adding a lib to my dependency tree IMO"
910,1553562064.688,Roselia,"Can somebody explain assignment of the null reference to *this* in a closure?
What effects does it have?
I assume it's part of `closed-over local clearing` feature, but not sure how it looks from JVM stand point."
910,1553562202.6897,Simonne,<@Roselia> Is there some other context here? Is this decompiled clojure bytecode?
910,1553562206.6898,Dann,"if `this` is your only reference to `coll`'s head, then the vm can free it for garbage collection"
910,1553562222.6904,Roselia,"<@Simonne> not really, just educating myself"
910,1553562243.6908,Dann,"which means you can do `(let [coll (range)] (run! frob coll))` without running out of heap; I mean I assumed this is decompiled clojure bytecode, that's what it typically looks like :D"
910,1553562337.6923,Simonne,"same, was curious what the source code looks like"
910,1553562354.6929,Roselia,so nullifying *this* invalidates any other references to that instance?
910,1553562370.6936,Simonne,<@Roselia> I was just thinking through that. That can’t be the case….; I don’t think.
910,1553562389.6944,Dann,something like `(fn [coll pred step] (step pred coll))`
910,1553562390.6945,Roselia,"yeah that's kinda bothers me, how nullifying this related to other references to target instance"
910,1553562437.6956,Dann,<@Roselia> it frees the resources visible only to this object in this context
910,1553562453.6959,Roselia,interesting
910,1553562465.6962,Dann,"or more technically, marks them as reclaimable"
910,1553562486.6965,Roselia,is it documented somewhere?
910,1553562507.6969,Dann,I'm really not sure - `locals clearing` is definitely the thing to search for here
910,1553562527.6978,Marlyn,It’s tail clearing and I implemented it :)
910,1553562540.6985,Dann,oh! thanks
910,1553562541.6986,Marlyn,Here is a link for reference
910,1553562542.6987,Alix,"How do I specify this type in clojure: `Map&lt;String, Object&gt;`?"
910,1553562561.6991,Marlyn,<https://dev.clojure.org/jira/browse/CLJ-1250>
910,1553562571.6996,Dann,<@Alix> `Map` -the rest is fictional
910,1553562588.7001,Roselia,<@Marlyn> <@Dann> thanks guys
910,1553562618.7009,Marlyn,<https://dev.clojure.org/jira/browse/CLJ-1793> another follow up
910,1553562737.7012,Roselia,really appreciate it
910,1553562763.7021,Marlyn,"tail clearing is needed because closures store their closed over values in instance variables; And if the reference to this isn’t nullified, it remains reachable in a local variable slot ; Which keeps the closed over values alive"
910,1553562821.704,Roselia,"yeah i understood the reason, missing part was the jvm &amp; gc behavior for this == null; :+1:"
910,1553562896.7047,Simonne,<@Marlyn> is there some part of the JVM spec you know of that defines the behavior for `this` assignment?; `javac` will not allow it
910,1553562941.7058,Marlyn,"It’s in there somewhere, maybe search for method calls or local variables ; 2.6.1 last para <@Simonne> ; <https://docs.oracle.com/javase/specs/jvms/se12/html/jvms-2.html#jvms-2.6.1>"
910,1553563130.7068,Simonne,"so the implication being that, because `this` is passed as a local variable, it’s assignable like a local variable?"
910,1553563287.707,Dann,"it seems like since it's of type `reference`, assigning it to null means you no longer consider the referenced object visible in this scope"
910,1553563510.7072,Marlyn,"Yeah, only in instance methods; And like you said javac won't let you"
910,1553563733.7076,Simonne,<@Roselia> Is this an inner class? I’m really curious the code that generated this.
910,1553563802.7078,Marlyn,Any fn that closes over something will generate it
911,1553563829.708,Simonne,"cool, ty"
910,1553563880.7082,Roselia,<@Simonne> you can use this lib to play with it yourself <https://github.com/clojure-goes-fast/clj-java-decompiler>
911,1553563925.7085,Simonne,cool :slightly_smiling_face:
910,1553565862.7087,Simonne,:whoa: <https://stackoverflow.com/a/22175621>
911,1553565926.709,Simonne,I’m actually a little surprised that the JVM allows that.; Well. Surprised and not surprised. Bunch of lisp weenies.
911,1553565999.7094,Roselia,:rolling_on_the_floor_laughing:
912,1553569051.7102,Arnoldo,"why am i getting “no matching ctor” for the following snippet? `(String. somebytes ""UTF-8"")`"
912,1553569579.711,Shavonda,<@Arnoldo> probably because there are multiple 2 arity constructors for string and clojure isn't sure which to pick
912,1553570070.7114,Arnoldo,i don’t typically do much java interop … is the way to handle that type hinting?
912,1553570491.7123,Celestine,"<@Arnoldo> what is `somebytes` in the above? I'm trying to repro your situation but the ""obvious"" things I've tried all just work :neutral_face:"
912,1553570680.7127,Arnoldo,"the result of .readPassword; which i’m also having bizarre issues with; calling it without the third argument, e.g. just `(String. (.readPassword (System/console)))` works fine; err second arg"
912,1553570874.7148,Celestine,"Ah, OK, let me try that....; So `.readPassword` returns an array of `char` from the look of it?; String does not have a constructor that takes an array of char and an encoding. That's why it fails.; `char[]` is already encoded (UTF-8 by default) I believe. So the 1-arg constructor is what you want."
912,1553571330.717,Arnoldo,ahhh i see - thanks!
913,1553595856.7207,Clarice,"What would you prefer in Clojure library *documentation*, to see the usage demonstrated when the namespaces were pulled in via:
- `use`
- `require ... :all`
- `require some.namespace.foo :as foo` … foo/bar
Thanks"
913,1553595903.7209,Harris,the last
913,1553600699.7265,Clarice,"Thanks for that <@Harris> and all the others who reacted with an emoji.
I’m collecting this for a pull request (which I don’t want to share here) but I’m sharing the link to this response.

The reason that I even asked this is because I remember stumbling upon a comment somewhere that went something like:
“Why do we discourage the use of `use` and yet in a lot of the documentation examples for libraries, it’s still prevalent?”"
914,1553601567.7272,Roslyn,I think actual arguments would be better then slack polls :smile:; see <https://stackoverflow.com/questions/22982303/why-should-you-prefer-require-refer-all-over-use-in-clojure>
914,1553602980.7277,Magdalena,[ANN] Cognitect Labs' aws-api 0.8.280 is now available! <https://groups.google.com/forum/#!topic/clojure/644yYo_qgwM>
914,1553606570.7308,Clarice,"<@Roslyn> that SO post talks about the use in the actual code. Whereas I’m talking about how to show the library usage in documentation.
My argument is to show it with the good practices, as per the style guide, so that there isn’t a discrepancy between what is shown in a README and how you’d really use the library in production code. Part of the reason is less of a gap between real usage and part of the reason is not to use deprecated practice. Hope that makes sense…"
915,1553611729.7317,Meagan,does anyone know what I’m supposed to pass into the `env` arg when using tools.analyzer.jvm?
914,1553611769.7322,Meagan,"I was hoping I could do something like:
```
(defmacro asdf [f]
  (prn &amp;env)
  (prn (ana/analyze f &amp;env)))

(let [[ a b c ] [ 1 2 3 ]]
  (asdf (a b c)))
```"
915,1553612295.7324,Becki,"does this help?
```
user&gt; (-&gt; '(let [a a] a)
        (ana.jvm/analyze (assoc (ana.jvm/empty-env)
                           :locals '{a {:op    :binding
                                        :name  a
                                        :form  a
                                        :local :let}}))
        e/emit-hygienic-form)
(let* [a__#0 a] a__#0)
```"
915,1553612571.733,Marlyn,"you need to pass in an environment <@Meagan>, see the README; `empty-env` is one way of constructing one"
915,1553612617.7337,Meagan,it’s not clear to me at all how to construct one
915,1553612625.734,Marlyn,call `empty-env`
915,1553612649.7346,Meagan,"I see that now. how would I populate it with the context of &amp;env in a macro?; I think so! I might be able to work forward from that; what I ultimately want to do (which might be foolhardy) is try and discover all of the symbols that are used in a form; e.g. I want to be able to output something like:
```
(my-macro (do (+ 1 1) (send-message ""foo"") (fn [] ""callback"")))
;; =&gt; [do + send-message fn]
```"
915,1553613368.7375,Raelene,"<@Meagan> Have a look at <https://github.com/ztellman/potemkin/blob/e8c64802b8772a90110434d1b515ce35b78b961b/src/potemkin/macros.clj#L29>; <@Meagan> Simply walk over the body form and collect symbols. But of course, it does not utilize tools.analyzer.jvm"
915,1553613579.7393,Meagan,I thought of that but I was worried about handling things like maps etc.; I forget how powerful clojure.walk is sometimes :stuck_out_tongue:; I also want to make sure that the symbol is in fact a binding/var and not an _actual_ symbol the user might be using in their code; I guess what I could do is walk over the body and then do an intersection with the keys of &amp;env
915,1553613663.7411,Becki,there's also a t.a version of walk
915,1553613878.7423,Raelene,"<@Meagan> I am not sure what you actually are about to do, e.g. what is an ""actual symbol""? But postwalk works with maps as well, yes."
915,1553613951.7429,Meagan,what I’m trying to do is get a list of all of the bindings/vars a form depends on; I’m then going to write them out in the returning form
915,1553614030.7443,Becki,<https://github.com/clojure/tools.analyzer/blob/master/src/main/clojure/clojure/tools/analyzer/ast.clj#L84>
915,1553614163.7467,Meagan,"for example:
```
;; use macro here
(do-effect-only-when-deps-change
  (send-message message-to-be-sent)
  (prn ""sent message""))

;; will write out the following:
(do-effect
  (fn effect []
    (send-message message-to-be-sent)
    (prn ""sent message""))
  ;; list the bindings/vars that should trigger the effect again if they change
  [send-message message-to-be-sent])
```; the `do-effect` works fine it’s just annoying to have to enumerate all of the things that might change by hand; so I want a macro to do it for me :stuck_out_tongue:"
915,1553614330.7485,Raelene,"OK, got it. :slightly_smiling_face:"
915,1553614337.7488,Meagan,"it seems like using regular walk should work; oh, and what I meant by an “actual symbol” was if I did something like:
`(do-effect-only-when-deps-change (send-data ['foo 'bar]))`; I wouldn’t want `'foo 'bar` to show up in the list of bindings/vars because they don’t exist"
915,1553614617.7522,Raelene,"Yea, then you should ignore any calls to `quote`. Still wondering why you would need this, just for convenience during development?"
915,1553614686.7528,Meagan,why I would need the macro? or the part where the function fires if its dependent bindings/vars change?
915,1553614733.7531,Raelene,the latter.
915,1553614845.7542,Meagan,"it’s firstly going to be a wrapper around useEffect in ClojureScript: <https://reactjs.org/docs/hooks-reference.html#useeffect>; useEffect already has that behavior. when you update state, and trigger a re-render, it will check it’s dependencies array to see if they have changed since last render and if so, fire the effect; but also I intend to use this to enable more reloadable workflows in Clojure too yes :stuck_out_tongue:; hmm. It looks like I don’t get global vars in `&amp;env`"
915,1553615099.7569,Raelene,"Ah, interesting. :slightly_smiling_face: Nonetheless, I feel one should not do that during ""runtime"" :slightly_smiling_face:"
915,1553615232.7571,Meagan,“runtime”? :thinking_face:
915,1553615651.7606,Raelene,"What I meant was production, maybe I still haven't got you but I cannot imagine a good case for using var/binding-watching for something else than development. :slightly_smiling_face:"
915,1553615722.7615,Meagan,yeah it would probably be inert when deployed. purely a mechanism for reloaded workflow
915,1553615763.7617,Raelene,"If react does this, I might miss something :thinking_face:  Have to investigate :slightly_smiling_face:"
916,1553627587.7625,Isidro,"saw this thread a tad late. Very good to know, thank you! Aleph looks really promising, will stick on top of the pile and see where things land."
917,1553636251.764,Becki,drawing a blank. ` (into [] distinct [:a :b :c])` is not working. what am i missing
917,1553636357.7645,Sixta,"Is it a stateful transducer?; Yep, you need to do (distinct)"
917,1553636385.7651,Becki,ah thanks
917,1553636493.7654,Isidro,"found another solution which removes the recursion (which could potentially blow the stack):
```
(defn nest-by
  [ks coll]
  (reduce
   (fn [m x]
     (update-in m ((apply juxt ks) x) (fnil conj []) x))
   {}
   coll))
```
I personally find both solutions quite attractive. This one uses the fact that update-in already does most of what we want"
918,1553645186.7678,Lesa,I'm tearing my hair out trying to figure out why `com.stuartsierra.component` isn't shutting down one of my components. I have other components that shut down just fine. I can't spot any material difference in this one. I'm about to start trying to expose some details from within component itself but thought I would ask here if there are any common tripping hazards I might not be thinking of
918,1553645316.7682,Dann,you need to return a valid component map from both startup and teardown of each component; that's the most common reason that teardowns get short-circuited
918,1553645615.7691,Lesa,"yeah that looks fine. everything starts up properly and inspecting the component in the system it's all well and good; i've got a log statement (and heck, a println, to rule out a logging issue) on the first line of the `(stop)` function and that never gets called"
918,1553645847.7709,Rosaline,"most likely you do some operation on the record that turns it in to a normal map; in which case the nop stop function that component defines for Object is called; (some operation in your start function); a common thing that does that is dissoc'ing a field a record is defined as having, but here are other things that do it too"
918,1553645980.7725,Lesa,I was just about to ask...does `dissoc` do it?; :facepalm:
918,1553646022.7729,Rosaline,"```
user=&gt; (defrecord Foo [a])
user.Foo
user=&gt; (assoc (-&gt;Foo {}) :a 1 :b 2)
#user.Foo{:a 1, :b 2}
user=&gt; (dissoc (assoc (-&gt;Foo {}) :a 1 :b 2) :b)
#user.Foo{:a 1}
user=&gt; (dissoc (assoc (-&gt;Foo {}) :a 1 :b 2) :a)
{:b 2}
user=&gt; 
```"
918,1553646092.7733,Lesa,"well, you saved my considerable head of hair from losing (any more) hairs; have been tearing them out for the past hour; thanks"
919,1553647073.7748,Loria,"Why does `group-by` return a map of vectors instead of respecting the original collection type?; eg. I would expect `(group-by even? #{1 2 3 4 5})` to return a map of hash sets; it's easy enough to roll my own version which does that:
```
(defn group-by*
  ""Like `group-by` but preserves the original collection type""
  [f coll]
  (let [emp (empty coll)]
    (persistent!
      (reduce
        (fn [ret x]
          (let [k (f x)]
            (assoc! ret k (conj (get ret k emp) x))))
        (transient {}) coll))))
```; but I'm wondering why the default implementation does it that way"
920,1553690890.7821,Laveta,Is there a way to control the name of a `reify` class? I like to have that for profiling to be able to see which implementation I have in the profiler.
919,1553691197.7823,Jasmine,no
919,1553691274.7832,Laveta,ok but it would be helpful.; By the way: Using ZGC in Java 12 was not suchessful for my compiled code. I still had 5 sec pauses. So I droped the idea to evaluate code during runtime. Now I just use good old protocol dispatch for my expressions. The protocol dispatch is so fast that it’s not slower than directly compiled code.
919,1553691536.7869,Patrice,what do you prefer for the name of a <http://micrometer.io|micrometer.io> wrapper: clj-micrometer or micrometer-clj?
919,1553691539.787,Jasmine,"reify needs to gen a unique classes every time so you wouldn't want to force a particular name; protocol dispatch is designed for speed, for sure"
919,1553691652.7883,Laveta,but a named prefix like in `(fn my-fn [x])` would be possible?
919,1553691687.7886,Jasmine,you could just use a deftype?
919,1553691754.7897,Laveta,yes I could. I also could use defrecord. But for me the code is more readable using reify.
921,1553692856.7901,Harris,then you can implement your own `named-reify` macro on top of `deftype` and `new`
919,1553693239.7914,Laveta,it’s ok. I’m not totally lost in the profiler. I only liked to ask if I was missing something. But thanks.
922,1553697137.7935,Malika,"<https://medium.com/dartlang/making-dart-a-better-language-for-ui-f1ccaf9f546c> is there a way to do something like this in clojure?
tldr: interpolate values into a list like so:
```
[:item-1
 (add-when condition?
   :optional-item-1
   :optional-item-2)
 :item-2]
```; assuming its impossible as macros can't expand to multiple expressions as far as I know?"
922,1553697194.7942,Laveta,`cond-&gt;`
922,1553697248.7957,Merna,I use `(concat [:item-1] (when condition? [:item-3 :item-4]) [:item5])`; you can do stuff with macros and splicing but its unidiomatic imo
922,1553697291.7972,Harris,less performant but I also like ````[:item-1 ~@(when cond? [:item-3 :item-4]) :item-5]```
922,1553697300.7977,Merna,^ like this guy :stuck_out_tongue:
922,1553697315.798,Laveta,"```(cond-&gt; [:item-1] 
  condition? 
  (conj :optional-item-1 :optional-item-2)
  :always
  (conj :item-2))```"
922,1553697315.7981,Harris,s/macros/syntax-quote/
922,1553697335.7985,Merna,okokok
922,1553697486.7992,Malika,"thanks; going to give the concat a go for now, seems reasonably nice"
923,1553698349.8001,Patrice,I still don’t understand why `clojure.datafy.nav` needs both `k` and `v`
923,1553699153.8004,Marlyn,"to transform v; rather, to return a transformed v; see this <@Patrice> <https://github.com/stuarthalloway/reflector/blob/master/src/com/stuarthalloway/reflector.clj>"
923,1553699214.8013,Patrice,<@Marlyn> thanks!
924,1553707345.8024,Nguyet,`java-time/interval` is in the doc but somehow it looks like it can’t be found (I’m on clojure 1.10); `java-time/minus` can be found without problem
924,1553707689.8034,Dann,"<@Nguyet> surely this would be a question of your java-time version, and not your clojure version?"
924,1553707762.8035,Lesa,I feel like I see many more `clj-*` names than `*-clj`
924,1553707866.8039,Tammera,"is that `clojure.java-time`-the-library?; In that case, you will need to add <https://www.threeten.org/threeten-extra/> before you get interval’s; (they didn’t make it into `java.time.*` but were included in an “extra” library made available by the original proposers of the java.time rework)"
924,1553708571.806,Nguyet,Thanks for that! Somehow I missed it in the doc; cheers!
924,1553709051.8066,Tammera,"Yeah, I missed it the first few times too; Also, I like that clojure.java-time is correct and such, but it doesn’t feel very idiomatic to use from clojure. I looked at juxt/tick, but thats just not complete and/or mature…; are there other libraries I should be looking at? That are both correct and have nice clojure APIs?"
924,1553709561.8086,Marlyn,My 2c: learn the java time api; All the clojure wrapper libraries get some things fundamentally wrong
924,1553710139.8097,Sixta,Have you evaluated tick at all? I think it has a novel twist
924,1553710522.8099,Marlyn,nope; what's the twist <@Sixta>?
924,1553710545.8104,Sixta,"It works in clojurescript; I can't speak too much about the design, as I've just been peripheral to it."
924,1553710618.811,Tammera,"(btw, not trying to offend, tick just doesn’t feel “done” to me just yet)"
924,1553710639.8112,Marlyn,java.time fits all my needs
924,1553710696.8114,Sixta,"Tick is trying to stick to the java.time api. ; <@Tammera> we're using it in production with several clients, but you're right that there's still some gaps. "
924,1553710931.8122,Tammera,"Right, I like its way of doing things tho, feels less like a direct wrapper around a java api. Thats why I was asking, I was hoping that I completely missed something as elaborate as clojure.java-time, but with a more clojure-esque API; And thats in the little things right, for example, clojure.java-time does a lot of “java-style” overloading"
924,1553711153.8126,Sixta,<@Tammera> are there any particular gaps that are a problem for you?
924,1553712416.8178,Tammera,"It’s been a while, can’t come up with specifics sadly"
924,1553712470.818,Sixta,"If you check it out again, please feel free to open issues for anything you're missing."
924,1553712507.8186,Tammera,Will do!
925,1553716515.8217,Rosia,"I'm generating the following code using reflection on a javaclass to generate a reify that will implement all methods on the class. The end result looks like this:
<https://gist.github.com/jjttjj/95ff42fedd49893d51a4333da3abe436>
The type hints on return values and arguments are needed to avoid ambiguity.
Currently I'm generating the code as a quoted list of symbols, spitting it to a source file, and reading it. Is there a better way to do this? Is it possible to generate an elaborate reify like this with a macro?"
925,1553716647.8224,Dann,"most macros return a list of symbols (the quoting is done so they remain symbols); the gotcha is that for metadata like type hints you can't just use the metadata reader macro, you need to return a call to `with-meta`; so instead of `^void foo` you'd have `(with-meta foo {:tag void})`"
925,1553716927.8243,Rosia,"ok so ```
(^void currentTime [this ^long time]
          (cb {:time time, :type :currentTime}))
```

would become
```
((with-meta current-time {'void true}
            [this (with-meta {'long true} time)]
                    (cb {:time time, :type :currentTime}))
                    ```
and that should work fine?"
925,1553716974.8253,Dann,I edited the metadata after checking in my repl
925,1553716982.8255,Rosia,ok cool; got it thanks
925,1553717019.8264,Dann,"the with-meta call should only wrap the symbol, and the macro quoting would mean it needs to look different from that; but that's the basic idea - you need to return a list that has the right metadata on the symbols in it"
925,1553717056.8272,Rosia,ok thanks
925,1553724008.8282,Shanell,"I think people have forgotten or don't know, but, Insomnia, the REST client ( <https://insomnia.rest/>) has been supporting EDN without any add-on since some months ago; just thought it was worth a mention. I know about this because I added the feature :stuck_out_tongue:"
926,1553756414.0036,Mariela,"Trying an 'official' reducers example, but adding a println:

```
    (-&gt;&gt; (range 100000)
         (r/map (fn [x]
                  (println (Thread/currentThread))
                  x))
         (r/filter even?)
         r/foldcat)
```

...how come it always prints the same thread? I'd expect things to use all available cores; Should have googled :slightly_smiling_face: <https://stackoverflow.com/a/26291136/569050>"
926,1553757395.0047,Sixta,Range is reducible though :thinking_face: 
926,1553765698.0076,Mariela,"how do I get reducers to process each member of the coll in a separate thread?

I tried with `(fold 1 ...)` but no luck. The forkjoin pool _is_ used, but each member is processed in the same thread, which proves sequentiality

(I might be better off with pmap. But reducers might give some flexibility); Maybe this is my answer:

&gt; . Similarly, reducers is elegant, but we can't control its level of parallelism.

<https://github.com/TheClimateCorporation/claypoole>"
927,1553769113.0088,Eufemia,"Hi, Im new to docker and have to add a clojurescript project to an existing Dockerfile. It uses the ubuntu:latest. Adding `leiningen` to apt-get install fails. Does anyone have a basic configuration to show how to do this in ubuntu image?"
927,1553769179.0103,Clarine,"I need something like this: <http://jsondb.io/> with a focus on performance.

But with the ability to query JSON/EDN without parsing the whole database up front (performance).
And the ability to write objects very fast, without re-indexing the whole database.

Right now I’m doing the naive thing: read a giant EDN file, query it and write a giant EDN file.; One way of optimizing this is to split the EDN file into multiple partitions and only read/write the necessary partitions, but there might already be a tool which does this.
Another requirement: it must run with GraalVM. I already tried nippy/codox which currently doesn’t run with that.; More info: <https://github.com/borkdude/clj-kondo/issues/22>"
928,1553771158.0129,Epifania,"here is a dockerfile that has leiningen + nodejs <https://github.com/ipfs-shipyard/cube/blob/master/Dockerfile>; based on the official clojure image rather than ubuntu though; if you're planning to use in production, you probably want to lock down the dependency versions, as they are not in the example linked above"
928,1553771219.0143,Roslyn,"smartest function composition I ever wrote:
```
(defn- wrap-dedupe-args [f]
  (let [dedupe-fn ((dedupe) (fn [_ args] (apply f args)))]
    (fn [&amp; args]
      (dedupe-fn nil args))))

(let [f (wrap-dedupe-args prn)]
  (f 2)
  (f 2)
  (f 2)
  (f 3)
  (f 3))
2
3
=&gt; nil
```; [ab]using transducers to deduplicate side-effecting calls by their args"
929,1553775566.0193,Joette,"Does anyone know of a library that normalises local variables? `clojure.tools.analyzer.passes.jvm.emit-form/emit-hygienic-form` seems to be the closet, but just appends a `__#&lt;int&gt;` to the var labels. I would like to rewrite variables into the form `x__#&lt;int&gt;` where `x` is an arbitrary constant. This would mean that `(defn f [a b] (let [a (+ a b)] a))` would become `(def f (fn* [x__#0 x__#1] (let* [x__#2 (+ x__#0 x__#1)] x__#2)))`"
929,1553776502.0205,Becki,you could walk the ast and rename them probably? take inspiration from tools.analyzer.passes.uniquify
929,1553776685.022,Joette,"yeah, that’s exactly what I have been doing, was having some problems with dynamic bindings so I just thought I would see if someone had already written this…"
930,1553783292.0251,Darci,"The key to this is to get the 'right' chunk size for fork/join packets. If it is too small you will just context switch. Too large (for your collection size) won't make enough packets to cover the available cores. Have a look at this <https://github.com/jsa-aerial/aerial.utils/blob/d451f81fc308a7fbae2ca1de22890c2e4f726880/src/aerial/utils/coll.clj#L468>, it has worked very well for me."
930,1553783589.0254,Mariela,Super interesting! Will study it
930,1553783721.0256,Eufemia,"i needed to use the ubuntu image, finally i've solved that putting this; RUN wget <https://raw.githubusercontent.com/technomancy/leiningen/stable/bin/lein>
RUN chmod +x lein
RUN mv lein /usr/local/bin"
931,1553785762.0261,Faustino,Is dynamic binding the same as calling a function by variable name?; It is formatted very nicely... but I don't understand what it does; What does prn mean?
931,1553786112.0288,Onita,"hey everyone, i was wondering if there a consensus on the best pattern for a fn defn that can: either perform an operation on one thing or an operation on a collection of those things; i guess the front runner in my mind is `defn operation [ &amp; args ] ` and then either `(operation thing)` or `(apply operation things)`"
931,1553786190.03,Mariela,"Worth pointing out, `apply` isn't efficient"
931,1553786200.0302,Onita,"oh yeah? how so?; i’m not super concerned with that at the moment, but it’d be good to know in the periphery"
931,1553786356.0314,Mariela,"IIRC it boils down to the fact that you are creating short-lived lists in runtime, adding pressure to the GC; Maybe relevant: <https://stuartsierra.com/2015/06/10/clojure-donts-heisenparameter>"
931,1553786372.0318,Onita,"hmm, cool"
931,1553786447.0322,Faustino,"I like your way better... but someone made a ppa...; sudo apt-add-repository ppa:/mikegedelman/leiningen-git-stable
sudo apt-get update
sudo apt-get install leiningen"
931,1553786483.0329,Jasmine,my advice would be not to do that
931,1553786485.033,Faustino,It just tracks the stable lein repo on github
931,1553786498.0334,Jasmine,"in that, every time I've ever done that, I regretted it later; either pick ""one thing"" and use it with seq ops like  map/filter  etc or  make it take a coll"
931,1553786563.0343,Faustino,"<@Epifania> is 100% correct. Lock the clojure version, lein version and dependencies versions... or you could be in dependency hell if just 1 library version changes"
931,1553786641.0348,Onita,"interesting. that’s what i have now, but it feels kind of gross; could be lack of experience, though; thanks!"
932,1553787048.0361,Faustino,"Does '''apply''' operate 1 by 1, on each thing?"
931,1553787074.0368,Faustino,Or just apply the new list of arguments to the function?; Reading the docs... it looks like it applies new args to the function
932,1553787208.0379,Becki,Hard to parse what you are getting at
932,1553787254.0382,Faustino,Function overloading? Argument overloading; (apply + 1 2 3)
931,1553787435.0395,Gillian,that wouldn't work
932,1553787445.0399,Gillian,you need to do `(apply + [1 2 3])`; which is the same thing as `(+ 1 2 3)`
931,1553787531.0407,Faustino,"ahhhh ok, so it does apply the arguments as a whole"
932,1553787533.0409,Faustino,not 1 by 1
931,1553787597.0418,Faustino,"I was thinking that apply operated on each argument, 1 at a time"
932,1553787610.0423,Faustino,e.g. apply the function to each argument
932,1553787636.0427,Onita,sorry i think i made a mistake
931,1553787636.0428,Gillian,yeah you will also see sometimes `(reduce + [1 2 3])` which is something like `(+ (+ 1 2) 3)`
932,1553787656.0435,Onita,generally i’m looking for the optimal way to write one or more functions that do the same thing but either operate on one item or several; [idiomatic|optimal]; sounds like two functions has worked well
932,1553787720.0447,Gillian,you can use multi arity functions for that
932,1553787725.0449,Faustino,you need a map
932,1553787759.0456,Onita,i don’t think multi arity functions would work; i should have specified the ‘several’ is a collection
932,1553787763.0459,Faustino,<https://clojuredocs.org/clojure.core/map>; map is used to work on collections
931,1553787794.0474,Meagan,"<@Onita> I think the idiomatic thing to do is to define a function that operates on one, and then compose that with the various seq operations like `map` `reduce` `transduce` etc."
932,1553787800.0478,Faustino,<@Jasmine> suggested map
932,1553787820.0485,Onita,"right, i guess normally that would be the answer. i guess my question is too abstract. i’m specifically looking at database inserts."
932,1553787823.0486,Gillian,gotcha not sure what you're trying to do maybe i missed an earlier convo
932,1553787853.0494,Onita,"nope, i deliberately asked the question a little too abstractly. my bad"
932,1553787877.0503,Meagan,so you have a fn like `insert-item!` that you might call like `(insert-item! item1)` or `(insert-item! [item1 item2])`?
932,1553787878.0504,Onita,"so, in particular, either way i’d be calling `jdbc/insert-multi!`; right"
932,1553787897.0511,Faustino,"personally, I thought you were just trying to apply a new set of arguments to the same function… method overloading; but you mean a collection"
932,1553787911.0515,Onita,"yeah, not quite; in the case of the single item, i’d be looking at `insert multi! [item]`, in the other `insert-multi! items`; and was trying to avoid `seq? item`"
932,1553787971.0531,Meagan,personally I think that “overloading” your function signature like that is usually a bad idea; and I would consider it un-idiomatic
932,1553787995.0539,Faustino,"I agree… be careful with overloading, especially multi arity; in my opinion, multi arity is really object orienated style"
932,1553788027.0553,Onita,"“overloading,” meaning have it accept either a collection or a single item"
932,1553788031.0555,Meagan,right
932,1553788044.0563,Onita,"ok, makes sense. sounds like that is the consensus"
932,1553788065.0572,Meagan,"I would prefer it to always operate on colls. I agree with Alex, I’ve done stuff like that before and usually come to regret it :grimacing:"
932,1553788091.0576,Onita,"yeah that’s interesting. could you elaborate a bit on how, if any details come to mind?"
932,1553788096.0578,Roslyn,"<@Faustino> `prn` is similar to `println` which prints it's arguments, and the difference is `prn` prints objects so they can be read back. In practice it usually means that `prn` prints some additional data that helps to understand what exactly is being printed. For example, `(prn false ""false"")` will print `false ""false""`, making it easy to understand what exactly these printed values are (compare to `(println false ""false"")` that will print `false false`)."
932,1553788103.0581,Faustino,could you just put the single item into a collection?; so that the function always takes the same type
932,1553788115.0587,Onita,"i could, yes. just call it as `do-thing [item]`; but i’d rather not have to remember to do that; or, rather force others to remember to do that"
932,1553788170.0594,Faustino,"could just convert it, inside the function? no?"
932,1553788202.0604,Onita,"yup. but i would also like to avoid `seq? item`. which, again, is kind of a personal aesthetic preference, i guess."
932,1553788212.0608,Jasmine,"`run!` is like `map`, but for applying the same side-effecting function"
932,1553788215.061,Faustino,"ahhh ,gotcha, avoid type checking"
932,1553788260.0618,Gillian,are you trying to do a bulk insert operation?
932,1553788264.0621,Onita,"<@Jasmine>, that’s cool, didn’t know that. i would have reached for `doseq`."
932,1553788266.0623,Gillian,instead of inserting 1 by 1
932,1553788266.0624,Onita,"yeah.; so, anything map-like is not particularly desirable"
932,1553788440.0638,Faustino,"ahh, it makes it more readable"
932,1553788552.0647,Gillian,if it's a bulk insert i think it should only work on a collection; well that's the assumption i would make if i saw something called insert-multi
932,1553788809.0662,Faustino,"what about looking for a batch insert? are you just trying to make the map for efficient?; in ruby, we would batch insert with map; since ruby is very slow"
932,1553788898.067,Onita,there’s definitely a batch insert. my concern was more around how to wrap it.; i’ll just go with two functions
932,1553788917.0674,Faustino,<https://clojuredocs.org/clojure.core/partition>; there is partition if you want to break the collection into smaller chunks
932,1553788943.0681,Onita,thanks!
932,1553788968.0687,Faustino,"just in case you have millions of items in the collection, and don’t want to suck up all your JVM’s memory… since JVM can use a ton of memory; can I ask a question though? why would a type check be bad in this case?"
932,1553789057.0696,Onita,"i can’t say i have a super rigorous backing for that preference; one thing is i just find that, if i can completely avoid it, it reduces the number of code paths i could be looking at; which is definitely an argument for more than one function"
932,1553789278.0722,Faustino,"ya, the type check is also coupling… still thinking; my thought, comparing this to OOP, is to use dependency injection; but only use that pattern if you find that you need lots of duplicate functions; build yourself a to_collection function, that can turn any other single data into collection type; but that’s only going to be good, if it’s readable, and 1 to_collection function can save you from writing dozens of duplicate code; so it’s a little premmature to use the pattern"
932,1553789645.0749,Onita,"yeah, also a great idea; seeing how this one plays out may be a good indication"
933,1553790286.0763,Jasmine,"in general, Clojure rewards ""thinking in collections"". you have a huge library of seqable-&gt;seqable functions for doing so, threading macros like -&gt;&gt; built to create pipelines, etc; many functions tend to be a predicate (takes a single element and returns logical result) or a transformation (element -&gt; element); generally I find you should mostly  do those, and use sequence functions to transform from collections of elements to collections of elements"
932,1553790464.0798,Jasmine,"when I've created functions that take 1 or N, it's usually because I haven't thought enough about how the function is going to be used.  and when I  have created it, I have ultimately had it break down because my single element actually turns out to be a collection itself and I can no longer distinguish; if the function you're writing is ""insert-multi"", I can't imagine it makes sense to take anything but a coll"
933,1553790546.0817,Sixta,The other place I see it used us as an attempt at aesthetics.
933,1553790555.0821,Jasmine,"which, imo, is false; much better aesthetically to have a single calling convention than 1 or N"
933,1553790594.0836,Latonya,"Not being able to later distinguish between 1 vs. N case, because the 1 case is itself a collection, is certainly a bad place to end up."
933,1553790601.084,Jasmine,"I always end up there; one place that makes this stuff visible is creating specs; if writing the spec for the function args is hard, then that's a good sign that you have possibly introduced unnecessary complexity"
933,1553790666.087,Latonya,"On the comment earlier of ""could be called as (do-join [thing]), but would prefer not to remember that"", I don't want to sound too forceful, but if the doc of the function says that it _always_ takes a sequence of 'thing', then in Clojure the syntactic overhead of putting thing into a sequence like a vector is very very light, and common in Clojure code."
933,1553790676.0873,Celestine,"I'll +1 Alex here. Early on in our Clojure development (2011), we wrote quite a few functions that could either take a collection or a single element -- and that code has been an albatross ever since, until we rewrote it to either always take a collection (and pass `[item]` in calls that had a single item) or to always take a single item (and call `map` on it for places that wanted a collection processed). In other words, Stuart Sierra's ""heisenparameter"" recommendation is what you should be doing :slightly_smiling_face: (or rather ""don't"")."
933,1553790803.0881,Jasmine,"I still have angst about stest/instrument for  example <https://clojure.github.io/spec.alpha/clojure.spec.test.alpha-api.html#clojure.spec.test.alpha/instrument>; arguably done in the sake of aesthetics, but it makes me deeply  uncomfortable"
933,1553791016.0895,Ronald,Is `instrument` + `instrument-multiple` bad for aesthetics? It sounds good to me
933,1553791167.0904,Jasmine,"arguably multi is more primary here, so I'd probably argue just doing `instrument` that takes a coll"
934,1553793239.0915,Faustino,I am new. So it’s better to just convert the single item into a collection type? then pass it to the function. So the function always expects the same type (collection)?; and rely on function doc comments to know what to pass to it?
934,1553793302.0922,Jasmine,"imo, yes"
934,1553793424.0931,Faustino,"I definately in favor of functions taking only 1 type and returning 1 type; Because functions calling other functions... if just 1 function in the chained calls, stack, messes up, you have to trace it, then possibly refactor code all over the place; Func1.func2.func3.fun4 oops... func4 wanted a collection, not a string; In ruby... they say... just don't use more than 3 chained calls :rolling_on_the_floor_laughing:; I started writing the return type into my function names, to make code readable...; func_coll.func_str.func_int"
934,1553793926.0993,Celestine,"In general, yes, but if you have a function that just calls `map` on its argument, it's probably better to name the function that is being applied, and to have callers use `map` on that instead."
934,1553793985.0997,Jasmine,well I can't endorse that :)
934,1553794043.1002,Becki,that notion is called Hungarian notation i think.; and the only popular vestiges that I know of are in interface names
934,1553794108.1017,Faustino,So its ok for Clojure functions to handle multiple types? Please correct me
934,1553794142.1022,Jasmine,"it's possible. whether it's ""ok"" is entirely contextual; certainly there are many polymorphic functions in the core lib"
934,1553794237.1035,Dann,"for comparison, OCaml has different math functions for floating point vs. fixed point (calling `+` on a float is an error, calling `+.` on an int is an error); clojure is pretty deeply polymorphic, it's one of my favorite things about the language"
934,1553794288.1042,Meagan,probably one of the most annoying things about OCaml IMO; not specifically the +/+. thing but the general lack of modular implicits
934,1553794315.1054,Faustino,OCaml is pretty strict on types?
934,1553794322.1057,Dann,they also have different fold (aka reduce) for different sequential collection types - very annoying; extremely so - ML set the paradigm for modern type-safe languages
934,1553794383.1066,Becki,F# was annoying like that as well
934,1553794388.1068,Faustino,Everyone keeps praising Haskell strict types.; But then people say opposite. That inferred types is bad
934,1553794422.1077,Dann,"but back to Clojure - polymorphism is normal, and it works well - especially the way of writing code to interfaces / protocols"
934,1553794430.1078,Faustino,I have no idea. I do think a lack of polymorphic duct typing is annoying. With the + operator
934,1553794445.108,Dann,"yeah, F# was explicitly an attempt to copy OCaml for the CLR"
934,1553794461.1082,Jasmine,wasn't it even a strict superset originally?
934,1553794517.1085,Dann,"type inference is just a convenience for strict typing - if your system is strict enough the compiler can know which type has to be used; OCaml has an object system that is 100% duck typed, but the percentage of people writing OO code in OCaml is small"
934,1553794580.1105,Faustino,Regarding earlier... I think he just needs an implicit type... e.g. single string converts into collection with 1 string element.
934,1553794595.1109,Dann,I think interface dispatch / polymorphism is the good part of OO and I'm glad Clojure embraces it while avoiding concrete inheritance and enterprise design patterns
934,1553794612.1118,Faustino,Can clojure do implicit conversions? Or is that bad idea?; Hmmm. Scala and C++ seem to be against implicit type conversions. Not sure about Clojure.
934,1553794998.1139,Clarine,it’s basically a lack of type classes what makes this annoying (if I’m not mistaking?); implicit type conversions is something different from polymorphism
934,1553795038.1145,Joette,exactly - or just a value ie using `binding` form
934,1553795056.115,Clarine,Clojure doesn’t convert a string to an integer automatically
934,1553795222.1166,Latonya,"nor a string into a list of strings, nor vice versa.  I certainly wouldn't want it to automatically do so."
934,1553795228.1168,Faustino,"Ya... (+ ""a"" ""b"") gives me a cast error"
934,1553795282.1176,Clarine,I kinda don’t like functions who deal with either 1 thing or a list of things. It begets a lot of checks like: am I dealing with a collection here?
934,1553795839.1179,Dann,that sounds right but I'm not sure
935,1553798443.1185,Faustino,<http://xahlee.info/clojure/clojure_binding_forms.html>; How does it know what nth is?
935,1553799880.119,Dillon,I like to work with a single unit and find a way to arrange that function in a way that can process more volume if necessary. Sometimes just map of course :slightly_smiling_face:
936,1553801802.1205,Joette,"```
(defn f [])
(def g #())
```
Is there any reason why calling `g` returns a `clojure.lang.PersistentList$EmptyList` where as calling `f` returns `nil`?"
936,1553801878.1211,Marlyn,I think you mean the opposite <@Joette>
936,1553801884.1213,Joette,:smile:
936,1553801891.1216,Marlyn,"oops you edited :slightly_smiling_face:; ```user=&gt; (macroexpand '#())
(fn* [] ())```"
936,1553801940.1223,Joette,Was this a conscious design decision?
936,1553801991.1229,Rosaline,"`#` means ""a function that has the following form as its body"""
936,1553802006.1233,Joette,ah a meant <https://clojuredocs.org/clojure.core/binding>
936,1553802009.1235,Rosaline,so for `#()` the following form is `()` the empty list
936,1553802042.1243,Joette,"ah, ok"
936,1553802047.1245,Rosaline,for `#(+ 1 2)` the following form is `(+ 1 2)` which is invoking the function + with the args 1 and 2
936,1553802076.1249,Joette,but then again `()` is an invalid form unless it is a macro; sorry - quoted `'()`
936,1553802095.1256,Rosaline,"nope; ```
user=&gt; ()
()
user=&gt; 
```"
936,1553802118.1262,Joette,where did I get that from?; I was certain :sweat_smile:
936,1553802127.1267,Rosaline,some other lisps are like that
936,1553802310.1279,Becki,coworker had a question about `reduce-kv`: is this purely convenience? Seems like a strange function for core (despite us using it a bunch)
936,1553802422.1286,Marlyn,`reduce-kv` allows consuming a map without boxing the entries `[k v]`
936,1553802462.1293,Becki,"```
 clojure.lang.IPersistentMap
 (kv-reduce 
  [amap f init]
  (reduce (fn [ret [k v]] (f ret k v)) init amap))
```
is in core. isn't this the naive thing?"
936,1553802534.1298,Marlyn,<https://dev.clojure.org/jira/browse/CLJ-1879>
936,1553802545.13,Shanell,sorry for breaking the discussion but Stuart talked about the `(if (coll? arg) arg [arg])` antipattern here <https://stuartsierra.com/2015/06/10/clojure-donts-heisenparameter>
936,1553802577.1304,Becki,thanks <@Marlyn>. gonna read over and mull this.
936,1553803506.1317,Faustino,It is basically a more robust way to encapsulate lexical scope of vars; And then return control back to the original scope
937,1553803541.1321,Faustino,Or no?
938,1553805043.1333,Adolph,"so, I can start a rebel-readline like this:
```
  clojure -Sdeps '{:deps {com.bhauman/rebel-readline {:mvn/version ""0.1.4""}}}' \
  -m rebel-readline.main
```
and an nrepl like this:
```
  clj -Sdeps '{:deps {nrepl {:mvn/version ""0.6.0""}}}' -m nrepl.cmdline --interactive
```
but, how do I do an nrepl + rebel-readline?"
938,1553806467.1336,Dillon,<@Adolph> perhaps aliases? <https://clojure.org/reference/deps_and_cli#_aliases>; sorry if not related :slightly_smiling_face:
938,1553806511.134,Adolph,is there an inline way to express it without needing to make changes to `deps.edn`?
938,1553806554.1346,Meagan,there's probably something fancy you can do with `-e` but it's not going to be fun to type
938,1553806682.136,Reiko,"What is the idiomatic way of generating a list or map from a starting value that has some function applied to it iteratively? This would be the equivalent of an imperative for loop where the end condition is that the initial value has reached or dropped below 0.; For example, a credit card payment calculator"
938,1553806731.1365,Ashlea,"`iterate`; ```; ```
user=&gt; (doc iterate)
-------------------------
clojure.core/iterate
([f x])
  Returns a lazy sequence of x, (f x), (f (f x)) etc. f must be free of side-effects
```"
938,1553806764.137,Dillon,"do you mean like `clj -A:1.7:bench:test...` where 1.7, bench, and test are three separate aliases you have set up?

you just use the -A flag"
938,1553806810.1375,Rosaline,<https://dev.clojure.org/jira/browse/CLJ-1906> is also a thing
938,1553806811.1376,Dillon,"that's all I have, might need to ask again if that isn't what you need :slightly_smiling_face:"
938,1553807010.1391,Shawanda,"&gt; Is there a way to control the name of a `reify` class? I like to have that for profiling to be able to see which implementation I have in the profiler.

<@Laveta> have you found any workaround?"
938,1553807049.1396,Dann,"I think at that point you can just use `deftype` right? or does it lack some advantage reify has?; (it doesn't capture scope like reify, but you can translate that into field(s))"
938,1553807249.1425,Reiko,"Ok, so I looked over the docs and they aren't very clear in how exactly it works. Specifically I have an issue where the examples use `partial`, but that seems to only work when the unknown argument is not the first argument. In a simple function where one number is subtracted from the other this won't work because it's the first number that is unknown, not the second.; For example, let's create a simple function for paying off a 0 interest balance so the function would be `(- balance payment)`. It's `balance` that needs to be replaced; not `payment`."
938,1553807385.1442,Adolph,"in my case, I have a docker container with clojure/clj binaries in it and no access to the filesystem and can't mound things in ... if I want to string together multiple deps and two main entrypoints (e.g.: rebel-readline and nrepl mains), how would I do that?"
938,1553807418.1449,Shawanda,"I've never thought about it, but longish classnames generated by `reify` are indeed inconvenient. Yeah, no scope capturing would be a downside. Maybe one could also try overriding `toString` inside `reify`, but then it's probably impossible to `defmethod print-method` for such instance.."
938,1553807518.1457,Dann,"you could probably `defmethod` print-method for `(class my-reify)`; and yeah, overriding toString does also work iirc"
938,1553807600.1465,Reiko,Is there a way to use `partial` when the first argument is the one you want to replace?
938,1553807617.1467,Dann,"```user=&gt; (reify java.io.Closeable (close [this]) (toString [this] ""my closable""))
#object[user$eval138$reify__139 0x37ddb69a ""my closable""]
```; <@Reiko> you can define it, the hard part is a good name"
938,1553807638.1472,Reiko,?
938,1553807640.1473,Marlyn,post a full example of what you're looking for
938,1553807656.1478,Reiko,I just gave a specific example
938,1553807674.1485,Marlyn,"what is the input, and what is the full sequence that you want to get out?"
938,1553807687.1491,Becki,also `(partial #(func % second-arg))` if you don't want to think of a good name
938,1553807724.1498,Dann,fair enough - a cute name for it that I've seen is qartial (since q is a backward p)
938,1553807764.1505,Becki,that's fantastic
938,1553807826.1512,Dann,"I can't take credit, and in practice I came back and found it used and forgot what it meant and expected it to be some kind of polynomial function; so ¯\_(ツ)_/¯"
938,1553808071.1517,Dillon,"I see what you mean now, you are referring to the command line argument for the entrypoint for each dep.

what is your reason for trying to use two entrypoints at the same time?"
938,1553808213.1519,Shawanda,"yeah, cool! not ideal, but better than the default"
938,1553808307.1521,Dillon,Could you specify your own entry point and call into your dependencies' entry points from there?
939,1553810245.1526,Clarine,"What’s the difference between fressian and nippy?; are they conceptually the same but different implementations, or cover entirely different use cases?"
939,1553810440.1541,Dann,<@Clarine> maybe this helps - seems like nippy is trying to be faster <https://github.com/ptaoussanis/nippy/blob/master/src/taoensso/nippy/benchmarks.clj>; it tests and records speed of both
939,1553810475.1551,Rosaline,nippy is like: what if we made bytes out of things instead of printing them and gzipped those bytes
939,1553810544.1565,Clarine,so fressian is better for reading/writing EDN to disk and nippy may be a bit faster than that?
939,1553810544.1566,Adolph,"well, I want the readline capabilities of rebel-readline and I want the nrepl port listening at the same time"
939,1553810548.1568,Rosaline,"fressian is like: lets take a survey of serialization formats, find one that matches what we want for clojure, and include some features like caching to improve performance"
939,1553810568.1572,Adolph,"so, I guess maybe that's where that fancy `-e` work would need to come in"
939,1553810599.1583,Clarine,"if I have a command line app that needs to read and write EDN data from disk and there is no long-running process, does fressian still make sense?"
939,1553810614.1587,Rosaline,"I have only used nippy in the context of using libraries that brought nippy along for the ride, and in ever case formed an unfavorable opinion of those libraries, which has rubbed off on nippy; how much data?"
939,1553810680.1598,Clarine,"the max edn file I’ve seen right now is about 2MB. but I’m going to split it into multiple EDN files anyway, so probably smaller"
939,1553810697.1601,Rosaline,I would go down a list something like pr &gt; transit &gt; fressian; but very likely somewhere between pr and transit I would switch to using apache derby
939,1553810799.1618,Clarine,I’ve tried Derby but that doesn’t compile with GraalVM :disappointed:
939,1553810804.162,Jasmine,"I think Stu's fressian talk  from years ago did a pretty good job at highlighting the goals and tradeoffs of fressian (pre-dated transit, which has different tradeoffs); <https://www.youtube.com/watch?v=JArZqMqsaB0>; plus, that's like peak mullet Stu"
939,1553810853.1629,Clarine,haha. thanks
939,1553811527.1632,Ashlea,"<@Reiko> how about:
```
user=&gt; (let [payment 2] (take-while pos? (iterate #(- % payment) 11)))
(11 9 7 5 3 1)
```
?"
939,1553811599.1634,Reiko,"Ended up with something very similar, but instead of `pos?` I'm using `(&gt;= 0 %)`; Though it actually makes more sense to use `pos?` thinking about it more as depending on the last balance and payment amount it may be less than the usual monthly payment"
939,1553811713.1638,Joette,"`binding` is used when you want to redefine the value of a variable within a code block. The variable needs to have been the `^:dynamic` meta - so lets say you have a variable that is defined in some other namespace. I think this example should make sense: ```analysis.core&gt; (def ^:dynamic hello ""hello"")
#'analysis.core/hello
analysis.core&gt; (defn print-hello []
                 (println hello))
#'analysis.core/print-hello
analysis.core&gt; 
analysis.analysis&gt; (binding [analysis.core/hello ""bye""]
                     (analysis.core/print-hello))
bye
nil
analysis.analysis&gt; ```; It is thread local - the macro expansion makes this clearer: ```analysis.analysis&gt; (macroexpand '(binding [analysis.core/hello ""bye""]
                                   (analysis.core/print-hello)))
(let*
 []
 (clojure.core/push-thread-bindings
  (clojure.core/hash-map #'analysis.core/hello ""bye""))
 (try (analysis.core/print-hello) (finally (clojure.core/pop-thread-bindings))))```"
939,1553811847.1647,Celestine,Can I just say how much I love `tap&gt;`? :heart:; (and REBL :slightly_smiling_face: )
939,1553811904.1651,Jasmine,sure :)
940,1553813531.1667,Dillon,"It's probably a subjective question, when and where to start nrepl/rebl - so you may just want to ask again in the main chat :slightly_smiling_face:"
940,1553813576.1677,Clarine,"I did a quick comparison between pr-str, fressian and transit.
Reading: EDN 100ms, Fressian 20ms, Transit 20ms
Writing: EDN 74ms, Fressian 50ms, Transit between 1000 and 2000 ms.
So it seems that Fressian is the clear winner here, and I don’t know why Transit writing takes that long…; The map has 799 keys and is about 1.8MB in raw EDN."
941,1553814269.1693,Marlyn,Kinda hard to say without code
940,1553814330.1695,Clarine,"<@Marlyn> <https://github.com/borkdude/clj-kondo/blob/fressian/src/clj_kondo/main.clj#L14>; if you want, I can provide you with the data"
940,1553814532.1708,Marlyn,"Offhand, it is benchmarking file io"
940,1553814603.1711,Rosaline,"/tmp maybe a fast in memory filesystem, etc"
940,1553814620.1713,Clarine,"this is my home folder; oh hmm, I’ll try to write fressian not to /tmp"
940,1553814663.1724,Marlyn,It is also not accounting for JIT warmup
940,1553814703.1735,Rosaline,"also, not related to performance, doing defs like that is super gross; clojure is not scheme, def always creates a global name, no matter where it is nested"
940,1553814745.1751,Clarine,"it is, that’s the point of this tool: <https://github.com/borkdude/clj-kondo/#rationale> :slightly_smiling_face:"
940,1553814768.1759,Rosaline,don't do that though
940,1553814773.1764,Clarine,"I know that it’s doing that, I wanted to inspect the value after the run, this is throwaway code"
940,1553814774.1765,Shawanda,I'd suggest also trying Jsonista
940,1553814806.1777,Marlyn,"Anyway, we use transit at work all the time, it's fast.; Something is wrong with the benchmark"
940,1553814830.1788,Rosaline,"like, it is entirely possible to build and operate large complex clojure code bases without inline defs to debug things"
940,1553814845.1793,Marlyn,I would try to eliminate file IO and account for JIT and then recompare; My assumption is that transit is faster than edn and slower than fressian
940,1553814871.1804,Rosaline,"the idea that you do it so often that you need a tool to make it easier is just, I dunno, what are we doing here"
940,1553814946.1815,Clarine,"I don’t make it easier, I just don’t want to commit it if I’ve done it. I find it easy to capture e.g. requests and then inspect them. Works for me. You can also use an atom for this, or scope-capture, I don’t care.; I’ll re-benchmark tomorrow, it’s getting late here."
942,1553816266.1831,Clarine,"I updated the benchmark so I can run it with either edn, fressian or transit from a cold JVM as a cmd line invocation.
These are the numbers (code is above it): <https://github.com/borkdude/clj-kondo/blob/fressian/src/clj_kondo/main.clj#L59>
This is the test file: <https://www.dropbox.com/s/qkhcm5x9fkhvw1f/test.edn?dl=0>
I’m seeing the same thing with transit."
940,1553816607.1841,Clarine,I’d be curious to hear if any one of you can reproduce this. I’m afk now. Goodnight.
943,1553821388.1852,Loria,what's a simple way of testing if a given object is a clojure function? (as defined by `defn`/`fn`)
943,1553821933.1855,Simonne,<@Loria> `fn?`
943,1553822493.1858,Loria,"oops, how did I ever miss that :sweat_smile:; ah, so it's testing for `instance?` of `clojure.lang.Fn` instead of `clojure.lang.IFn`"
944,1553825068.1875,Simonne,Yeah the docstring explains the diff. Also available: `ifn?`
945,1553826500.1879,Jasmine,"`ifn?` is almost always preferable; <@Clarine> it would be worth double-checking that all these paths are buffered.  your edn code goes through io/reader and spit which are both buffered, but I'm not sure about the others. certainly the transit perf seems higher than I'd expect, if it's not buffering, then might be worth a check to make sure there's not a bug that's crept in. I doubt this has been profiled in a long while.; also, for a big file like this you could probably use larger buffers than the default"
946,1553836872.1933,Felix,What is the data structure behind Clojure persistent maps? (I need to port them to another language.)
946,1553838159.1954,Sebrina,<https://github.com/clojure/clojure/blob/master/src/clj/clojure/core.clj#L379> `hash-map` -&gt; `clojure.lang.PersistentHashMap` -&gt; `clojure.lang.APersistentMap` -&gt; `Map` if I’m following your question and inheritance chain correctly.
946,1553838641.1973,Faustino,I just watched Rich's video... vectors are based on tries (trees). Hash maps are probably similar. They also use shared data.; <https://clojure.org/reference/data_structures>; There is hashed and sorted maps. I am not 100% certain they use tries. But probably some kind of branching data structure similar to what underlies vectors.; Which language?
947,1553843638.2003,Clarine,"<@Jasmine> when I write to a `(java.io.ByteArrayOutputStream.)` it’s already much faster; I tried to use fressian with GraalVM native. This code works:
```
(fressian/create-reader (io/input-stream (io/file clj-cache-file)))
```
but this didn’t:
```
(fressian/read-object (fressian/create-reader (io/input-stream (io/file clj-cache-file))))
```
This is the output: <https://gist.github.com/borkdude/5f19d6bb0c3f180273786ae34f63f60f>; I see spec being mentioned in the error message, I see it often with Clojure libs compiled with GraalVM, but it’s weird how this can be triggered by only adding `fressian/read-object`"
947,1553847427.2028,Alyce,"I believe this is a problem with Clojure 1.10.0 and Spec 0.2.176+; It's referenced, indirectly here: <https://dev.clojure.org/jira/browse/CLJ-1472> (ignore the bit about android, the juicy bit is at the end); I hit the same issue yesterday, doing some experimentation with Graal and Clojure. I had to go back to Clojure 1.9.0 to compile a native image."
947,1553849094.2043,Clarine,"thank you, I’ll try 1.9.0; At least Transit JSON works with Graal and 1.10. I couldn’t get MessagePack working:
```
Mar 29, 2019 9:41:43 AM org.msgpack.template.builder.TemplateBuilderChain createForceTemplateBuilder
WARNING: Failed to create a TemplateBuilder reflectively
```; Confirmed, I can get fressian working when dropping back to Clojure 1.9.0 and adding some type hints about FressianWriter + running with `--report-unsupported-elements-at-runtime`. But since Fressian and Transit are pretty close in performance, I’m going with 1.10 and without the flag."
948,1553850276.2088,Marvin,"hey clojurians, how you guys usually do the follow
I have one business rule function ( create-invoice ) which could create an invoice or based on some business rule fail.
should my function return two different shapes ( on success the invoice and on error a map with ::error key  ) ?
should my function throw an exception and my handler dispatch properly to handle that ?

how you guys normally do that ?"
947,1553851367.2094,Clarine,<@Alyce> did you try a fork of Clojure with that patch applied btw? With tools.deps that should be possible I think?
948,1553851524.21,Toby,<@Marvin> use pure data and avoid Exceptions whenever you can
948,1553851872.2107,Marvin,"<@Toby> yeah, so you mean create a wrapper result ?"
947,1553851903.2113,Clarine,"re: <https://clojurians.slack.com/archives/C03S1KBA2/p1553827570192000>
what should I do to buffer the writing to a file?
I currently have something like:
```
(let [writer (transit/writer (java.io.BufferedOutputStream. (io/output-stream (io/file ""/Users/Borkdude/temp/transit.json"")) (* 1024 1024)) :json)]
                      (time (transit/write writer edn)))
````
But I still get very slow writes; I’m not seeing any difference with older transit versions, so it must be something on my side; If I need a `BufferedWriter` I’m not sure how to do this with transit"
947,1553852786.2123,Alyce,"Hi, no. Didn't get round to it sorry."
947,1553852966.2125,Nicki,"I think it would be fine to always return a map.; either ```{:invoice {}}```; or ```{:error ""I am broken""}```"
947,1553853025.2133,Clarine,As a workaround I can first write to a bytearrayoutputstream.
947,1553853028.2134,Nicki,And then surrounding code can easily check for the presence of an error.; But like most things it comes down to style and possibly what else is happening nearby in the code.
947,1553854938.2138,Marvin,"Yeah, I see <@Nicki> . I’m wrapping inside my Result map format"
949,1553857175.2187,Sophie,"Hello clojurians, I’m looking for a tutorial project implementing simple CRUD API powered by Datomic (ideally with front end in cljs) to use for training purposes with some newcomers. I went through some awesome-clojure lists, with no luck. My next best option would be to write something on top of mbrainz."
949,1553858166.2195,Stasia,"This is the only one that I can think of , off hand: <https://github.com/robert-stuttaford/bridge> cc <@Korey>"
950,1553858547.2199,Simonne,&gt; A persistent rendition of Phil Bagwell’s Hash Array Mapped Trie; <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/PersistentHashMap.java>
950,1553858599.2204,Sophie,"thanks, that looks promising"
951,1553859688.2222,Jeannette,"what is the equivalent of the following in core.async?
foobar :: (a -&gt; b) -&gt; (Chan a) -&gt; (Chan b)"
951,1553860696.2232,Danna,"<http://clojure.github.io/core.async/#clojure.core.async/chan>
lets you pass a transform transducer into the channel itself, if you are in control of constructing the channel; if you have been given a pre-existing channel then I think you would have to use
<http://clojure.github.io/core.async/#clojure.core.async/pipe>"
951,1553861166.2256,Jeannette,None; correct?
951,1553861259.2265,Danna,that sort of thing
952,1553864108.2301,Aubrey,"Depends on the context — if you can’t really do anything about it, you might throw an exception and let your top-level error handle deal with that (wrap it in a nice HTTP status, for example). Don’t forget `ex-info` which allows you to put arbitrary data in the exception so you can do further dispatching there as well."
952,1553871873.2323,Marvin,"so <@Aubrey> , Yeah, I tend to not control my flow using exceptions . business case rules I’m returing a Result Wrapper map which the caller should if the   ::error key exists or not …
can you enumerate some cases of ` if you can't really do anything about it` ?"
952,1553872095.2344,Faustino,"In ruby we use {  } for a code block. It has a local scope but also has access to outside scope (closure). But I don't think Ruby can access different namespace scopes like Clojure bind appears to be doing.; So instead of passing parameters to a function, you just bind new variable values to the namespace before running code block or functions. It's almost like a global var but probably immutable?"
952,1553877890.2384,Candis,"<@Clarine> I’ll throw CBOR’s hat into the ring if you’re looking for binary serialization formats: <https://github.com/greglook/clj-cbor>; haven’t specifically tried it with Graal yet, but it has no dependencies outside Clojure itself, so it ought to work.; Also it’s an open standard, so there are other tools out there for working with the data. :slightly_smiling_face:"
952,1553878092.2404,Meagan,"how much of an anti-pattern is it to run `clojure.test/is` in a seq? like:
```
(doseq [ex examples]
  (t/is (f ex))
```"
952,1553878137.2408,Candis,"`is` is side-effecting, so that is not unusual from what I’ve seen"
952,1553878182.241,Becki,maybe use `are`?
952,1553878401.2412,Meagan,hm yeah that might be better
952,1553879047.2421,Clarine,"<@Candis> Cool, thank you."
953,1553880095.243,Clarine,"I’m still a bit unsatisfied with this:
<https://clojurians.slack.com/archives/C03S1KBA2/p1553851903211300>
Anyone got a better alternative?"
954,1553881398.2436,Candis,Don’t the `<http://clojure.java.io|clojure.java.io>` functions already return buffered streams?; you’re going to have a small buffer in front of your big buffer
954,1553881762.2454,Clarine,"<@Candis> I’m now taking a workaround by first writing to a ByteArrayOutputBuffer and then copy that to a file, which is a bit insane. But that only took 45ms whereas directly writing to a file took 1s (EDN read from a 2MB .edn file)"
954,1553882009.2459,Candis,"have you tried making a `FileOutputStream` directly?; (then wrapping in a large buffer as above); FWIW:
```
% ls -lh bench/reddit.edn
-rw-r--r--  1 greg  staff   123K Jan  9 09:31 bench/reddit.edn
```
```
=&gt; (def reddit-data (clojure.edn/read-string (slurp ""bench/reddit.edn"")))
=&gt; (time (cbor/spit-all ""reddit.cbor"" (repeat 17 reddit-data)))
""Elapsed time: 158.625145 msecs""
1683493
```"
954,1553882578.2479,Clarine,"I was preparing a full repro. Here it is:
```
$ wget <https://www.dropbox.com/s/qkhcm5x9fkhvw1f/test.edn\?dl\=0> -O test.edn 
$ clj -Sdeps '{:deps {com.cognitect/transit-clj {:mvn/version ""0.8.313""}}}'
Clojure 1.10.0
user=&gt;  (require '[clojure.edn :as edn])
nil
user=&gt; (def edn (edn/read-string (slurp ""test.edn"")))
#'user/edn
user=&gt;  (count (keys edn))
799
user=&gt; (require '[cognitect.transit :as transit])
nil
user=&gt; (require '[<http://clojure.java.io|clojure.java.io> :as io])
nil
user=&gt; (def writer (transit/writer (io/output-stream (io/file ""transit.json"")) :json))
#'user/writer
user=&gt; (time (transit/write writer edn))
""Elapsed time: 1151.116438 msecs""
nil
```; Now I can look at your suggestion…"
954,1553882730.2489,Candis,"now I’m pretty curious how cbor would do - I tried to copy enough of the sample dataset I had to make ~2 MB, but maybe there’s something gnarly in your data :man-shrugging:"
954,1553882758.2491,Clarine,"2MB is right :slightly_smiling_face:; <@Candis> worse:
```
user=&gt; (def writer (transit/writer (java.io.FileOutputStream. ""transit.json"") :json))
#'user/writer
user=&gt; (time (transit/write writer edn))
""Elapsed time: 2039.522802 msecs""
```"
954,1553882829.2497,Candis,I meant to also wrap your own buffered stream around that
954,1553882838.2501,Clarine,"ok, I’ll try now"
954,1553882861.2506,Candis,"because `io/output-stream` is going to return you a `FileOutputStream` wrapped in a `BufferedOutputStream` with the default buffer size, so wrapping a larger buffer _around_ that isn’t going to help you"
954,1553882886.251,Clarine,"something like this?
```
user=&gt; (def writer (transit/writer (java.io.BufferedOutputStream. (java.io.FileOutputStream. ""transit.json"") 1024) :json))
#'user/writer
user=&gt; (time (transit/write writer edn))
""Elapsed time: 1078.45894 msecs""
```"
954,1553882901.2512,Candis,"yeah, but with a larger buffer size"
954,1553882925.2514,Clarine,"```
user=&gt; (def writer (transit/writer (java.io.BufferedOutputStream. (java.io.FileOutputStream. ""transit.json"") (* 1024 1024)) :json))
#'user/writer
user=&gt; (time (transit/write writer edn))
""Elapsed time: 1016.702847 msecs""
```"
954,1553883054.2518,Candis,well that’s surprising
954,1553883063.252,Clarine,"Note:
```
user=&gt; (def bos (java.io.ByteArrayOutputStream. (* 1024 1024)))
#'user/bos
user=&gt; (def writer (transit/writer bos :json))
#'user/writer
user=&gt; (time (transit/write writer edn))
""Elapsed time: 31.144918 msecs""
nil
user=&gt; (time (io/copy (.toByteArray bos) (io/file ""transit.json"")))
""Elapsed time: 16.471751 msecs""
nil
```; btw, the size for the `bos` buffer didn’t matter very much here; If desired, I can make an issue for this, but first I’d like to know if I’m not overseeing something"
954,1553885560.254,Marlyn,I don't understand what the problem is <@Clarine>
955,1553885608.2544,Marlyn,the file writing being slow?
954,1553885736.2552,Clarine,"when I write directly to a file it’s slow (1s). when I write via a bytearrayoutputstream and then to a file it’s 47ms.; so yeah, the file writing"
954,1553886169.2566,Marlyn,<@Clarine> try to add a call to `.flush()` on the File outputstream on your _other_ (non-Transit) benchmarks and see if it makes them 1sec
954,1553886589.257,Clarine,"<@Marlyn> Like this?
```
user=&gt; (time (let [fos (java.io.FileOutputStream. ""/tmp/foo.edn"") w (io/writer fos)] (.write w (str edn)) (.flush fos)))
""Elapsed time: 77.273308 msecs""
```"
954,1553886631.2573,Marlyn,"yeah, need close the stream too; `with-open`; There's a flush() in transit I'm trying to understand"
954,1553886673.2584,Clarine,"```
user=&gt; (time (with-open [fos (java.io.FileOutputStream. ""/tmp/foo.edn"")] (let [w (io/writer fos)] (.write w (str edn)) (.flush fos))))
""Elapsed time: 73.316135 msecs""
```"
954,1553886821.2587,Marlyn,ok... I can't explain this yet.
954,1553886944.2589,Jasmine,"sorry, no time to look atm"
954,1553887068.259,Roslyn,<@Clarine> have you tried profiling it with clj-async-profiler?
954,1553887112.2593,Clarine,"I just used that tool an hour ago, but not for this problem. I could try it now :slightly_smiling_face:; Here’s the flamegraph: <https://www.dropbox.com/s/4wv7bnvdrnhd5u9/Screenshot%202019-03-29%2020.23.16.png?dl=0>"
954,1553887491.2603,Marlyn,"neat tool, how does it contrast with the other code?"
954,1553887734.261,Tammera,"(what are you profiling, cpu samples?)"
956,1553887751.2614,Tammera,(you can change what is profiled ^^)
954,1553887753.2616,Clarine,"This is the EDN code from above:
<https://www.dropbox.com/s/e0viq6lnquavi0i/Screenshot%202019-03-29%2020.28.25.png?dl=0>; yes, this is CPU"
956,1553887807.2621,Aubrey,"If the caller can recover from that error, and is expected to be able to, then perhaps an exception is not a good fit. If the caller can’t really handle the error, but have to deal with it anyway to avoid things like nils or errors maps propagating throughout the system, then an exception is perhaps better suited?"
956,1553887820.2626,Holly,do you have the file graph?
954,1553887844.2631,Clarine,"The purple here is `flush`: <https://www.dropbox.com/s/2x8ovkcbjfszmgl/Screenshot%202019-03-29%2020.30.34.png?dl=0>; Here’s the EDN flamegraph (as data): <https://www.dropbox.com/s/2kd67lbhycw2gj9/edn-flamegraph.svg?dl=0>
Here transit: <https://www.dropbox.com/s/3dfh77wnvbqkkgv/transit-flamegraph.svg?dl=0>; it seems indeed that transit spends most of its time flushing…"
954,1553888013.2651,Marlyn,clearly FileOutputStream.flush() is slow (the red is a native method).  What I don't understand is why we can't make the EDN writing incur the same cost; by explicitly flushing. (Mind opening a ticket to cognitect/transit-java <@Clarine>?)
954,1553888122.2668,Clarine,is that in JIRA?
954,1553888159.267,Marlyn,no github
954,1553888176.2673,Clarine,ok
954,1553888180.2675,Marlyn,maybe transit-clj might be better
954,1553888187.2678,Clarine,ok
954,1553888193.2681,Marlyn,until we know more about what the source of the problem is; I suspect flush
954,1553888644.2689,Clarine,a’ight: <https://github.com/cognitect/transit-clj/issues/43>
954,1553888726.2693,Magdalena,[ANN] Cognitect Labs' aws-api 0.8.283 is now available! <https://groups.google.com/forum/#!topic/clojure/cOIF5cjAecI>
954,1553889348.2704,Candis,flame graphs are pretty nifty - I was using the same tool while profiling clj-cbor :male-scientist: :bar_chart:
957,1553889441.271,Tammera,"I am so amazed in what you can put in a svg; also, terrified, why does it support scripts :’)"
954,1553889722.2717,Clarine,and why does my computer open .svg files as text in Atom; this is absolutely great for deciding what to optimize. fuzzing about details that only contribute to a small gain is a risk; does this also exist for cljs?
954,1553890165.273,Tammera,its built on a java library iirc
954,1553890325.2737,Meagan,I would imagine in CLJS it would be more useful to use e.g. the Chrome profiler; or the React DevTools profiler if you're doing React
954,1553892228.2745,Dann,there are definitely graphs in that style available with chrome/react
958,1553893848.2749,Clarine,just opened youtube and I saw this: <https://www.youtube.com/watch?v=yqNLDpooFjw>
959,1553923109.278,Gene,I think I remember seeing that someone put together a searchable list of companies using Clojure. Is that still live?
959,1553925333.2782,Becki,<https://clojure.org/community/companies>
959,1553930091.2784,Gene,Cheers <@Becki> ; I did find that. But I thought there was a seperate site. I think it was just the google sheets that the community created to collect more
959,1553930442.2804,Becki,Oh yeah I remember that now; <@Gene> <https://clojureverse.org/t/crowdsourcing-list-of-clojure-companies/2825>
960,1553934107.2812,Jeannette,how do I find the interfaces/protocols a certain value implements?
961,1553935942.2824,Min,You can use (ancestors (class x)) and extenders maybe?
960,1553949817.2857,Jeannette,how do I consume a channel? should i just go-loop over it or is there a more idiomatic pattern?
960,1553951625.2871,Lane,"<@Jeannette> go-loop is good, you will just need a mechanism to stop the loop by having another channel to signal stop or a special value posted on the same channel."
962,1553952121.2875,Lane,Or just detect when the input channel closes.
961,1553954089.2876,Grace,n
963,1553964876.2886,Roslyn,"I wrote a post about question mark suffixes, not sure it's worth <#C06MAR553|announcements> , so I'll post it here: <https://vlaaad.github.io/2019-03-30/question-marks-in-clojure>"
964,1553986799.2901,Clarine,"is there a reliable way to lock an entire directory (for reading and writing) over multiple processes in Java?
a simple but maybe not reliable way would be to write a “pid” or “lock” file and wait for the process which created that file to remove it"
964,1553989065.2905,Simonne,<@Clarine> Is there a way to do that in _any_ lang?; Seems like something that would have to be OS enforced. I’ve not heard of anything like that.
961,1553997014.292,Latrina,A pid file should be reliable
965,1554000929.2935,Latonya,Many Linux/Unix variants have `mktemp` commands with guarantees of safety if many processes are trying to do so at once.  I wouldn't be surprised if there are other related system calls and/or even utility commands that apply for creating and removing lock files.; This may have some pointers to such commands that are on at least some Linux systems: <https://stackoverflow.com/questions/185451/quick-and-dirty-way-to-ensure-only-one-instance-of-a-shell-script-is-running-at>
964,1554020779.296,Clarine,Thanks!
961,1554021438.2962,Karren,"There's FileLock class which you can use on top of ""lock file"" (""exclusive lock"" I guess): <https://docs.oracle.com/javase/7/docs/api/java/nio/channels/FileLock.html>"
964,1554022979.2964,Clarine,awesome!
966,1554061528.3009,Suanne,"Why doesn’t this Java interop work?

```
(String/format ""Hello, %s!"" ""Larry"")
```

I get this error message:

```
Execution error (ClassCastException) at bg-clj.core/eval2010 (form-init14869047494885852816.clj:1).
class java.lang.String cannot be cast to class [Ljava.lang.Object; (java.lang.String and [Ljava.lang.Object; are in module java.base of loader 'bootstrap')
```"
966,1554061612.3011,Simonne,"<https://docs.oracle.com/javase/7/docs/api/java/lang/String.html#format(java.lang.String,%20java.lang.Object...)>; `String#format` takes a `String` and _and array of `Object`_; The `Classname...` syntax in Java means “varargs”, but it actually unpacks to an array in the compiler. So `Object...`means “Object array”; <@Suanne> ^; So if you want to use `String#format`, you must do something like: `(String/format ""Hello, %s!"" (object-array [""Larry""]))`; OR (and this is the preferred route), use `clojure.core/format` (<https://clojuredocs.org/clojure.core/format>); which does the exact same for you"
966,1554062134.3067,Suanne,"<@Simonne> Ah ok, thanks for the explanation! I’m trying to do a bit of interop right now just learn how to do it properly. I’d use the Clojure format function otherwise."
967,1554068681.3073,Pamelia,What are the best options for parsing BNFs?
967,1554068726.3075,Becki,there's something right up your alley: <https://github.com/Engelberg/instaparse>
967,1554069036.309,Suanne,`(:name person)` and `(person :name)` where `person` is a map seem to do the same thing. Is one preferable over the other stylistically? They both seem a little bit magic over using `(get person :name)`.
967,1554069358.3104,Becki,"not magic they just implement IFn. Also extremely common. There is a difference: a literal won't be null, the `person` binding might be. A null in the first position will throw whereas a lookup in null will return null; contrast `(:a nil)` versus `(nil :a)` in your repl."
967,1554071246.3121,Elfriede,"generally I don't see maps used as functions unless it's being leveraged in a higher-order function, like `(map person list-of-keys-i-want-to-lookup)`."
968,1554078748.3133,Simonne,"I see it in local scope for picking out options.; `(let [things ({:a [1 2 3], :b [4 5 6]} opt)] ...)`"
969,1554083599.3179,Bernardine,"newb here w/ an aot question.    i'm compiling a `(defrecord Foo ...)` producing a jar containing the `Foo.class` then depending upon that jar from a java project
i can successfully load `Foo.class` (ie, `Class.forName(""Foo"")`) _dynamically_ from the java project
but attempting to compile/`javac` statically against Foo (ie, `import Foo` from java), i get a compile error that the symbol can't be found; `javap Foo.class` shows nothing suspicious.  maybe something obvious, but i'm banging my head here.."
970,1554085041.319,Simonne,lotta variables there :slightly_smiling_face:
968,1554085080.3197,Simonne,"Is there a package? I can’t remember for sure, but I think Java disallows using the default package."
969,1554085148.3199,Bernardine,"ha, there is a package"
969,1554085163.3202,Jasmine,"java doesn't disallow it, it's just discouraged; maybe post the full compilation error?"
969,1554085184.3208,Bernardine,i used default package just to keep the question shorter :slightly_smiling_face:
969,1554085222.321,Simonne,<https://stackoverflow.com/questions/283816/how-to-access-java-classes-in-the-default-package>; next q: is the classpath properly set for the `javac` command?
969,1554085402.3231,Bernardine,"```
Error:(6, 30) java: cannot find symbol
  symbol:   class Foo
  location: class com.example
```"
969,1554085408.3234,Simonne,"it seems clear it’s properly set for the `java` command (since you’re able to access it via reflection), but it could be improperly set for the `javac` command"
969,1554085411.3236,Bernardine,yes the `javac -cp ...` is set; i'm able to link against other .class files; it makes me thing the .class generated by compiling the defrecord is special somehow
969,1554085485.3248,Simonne,"to my knowledge, it is not"
969,1554085649.3259,Bernardine,"this yields a successful compile/javac:
```
import com.example.*;
class Bar { public static void main(String[] args) throws Exception { System.out.println(""hello""); } }
```
this doesn't:
```
import com.example.Foo;
class Bar { public static void main(String[] args) throws Exception { System.out.println(""hello""); } }
```; this compiles and runs w/o exception:
```
import com.example.*;
class Bar { public static void main(String[] args) throws Exception { System.out.println(""hello""); Class.forName(""com.example.Foo""); } }
```"
969,1554085714.3267,Simonne,Are you overriding the classname? `class Foo`
969,1554085762.3274,Bernardine,oh good question -no ..; (i just edit my slack examples)
969,1554085820.3282,Simonne,"Like I said, the last one is mostly irrelevant. It says nothing about the compilation."
969,1554085833.3286,Bernardine,"fair.; the one that succeeds of course doesn't if i get the `javac -cp` wrong; and...
```
$ javap com/example/Foo.class 
Compiled from ""model.clj""
public final class com.example.Foo implements clojure.lang.IRecord,clojure.lang.IHashEq...
```"
969,1554086106.3298,Simonne,Yeah I dunno. Would probably need a full example.; Good luck :confused:
969,1554086179.3309,Bernardine,"hmm actually i might be on to something; i think i have package and a class w/ the same name; ok that seemed to be it; however -- this seems like it'd be a common type of collision in clojure compiles ??; ...ie i `(defrecord Foo...` within `(ns com.example)`; compiling yields a `com/example.class` and a `com/example/Foo.class`; a `javac` / static compile finds `import com.example.Foo`
and doesn't like it b/c `com.example` is a class
...this explains why the `.forName("""")` worked and not the static compile; but i guess i'm having trouble seeing why this wouldn't be a common thing; ...okay so i do have a `(:gen-class)` on the `(ns com.example)`
so perhaps a slightly or much less common sitch?; after many years of java coding i did not realize you couldn't safely have a package and class w/ the same name
```
...
com/example.class
com/example/Foo.class
...
```
^bad for javac apparently; #til; removing the `(:gen-class)` fixes the issue
i guess the lesson is don't `:gen-class` ns's containing `defrecord`'s?; ...revision: explicitly specify non-conflicting `:name` to gen-class will solve it too"
971,1554093880.3409,Elly,"Hey guys, I asked thi sin disc but none seems to know what's going on.
I'm getting:
```
SEVERE: Error creating DB connection for {:classname ""com.mysql.jdbc.Driver"", :subprotocol ""mysql"", :subname ""//&lt;ip&gt;:3306/proj_dev"", :user ""root"", :password ""A&lt;censored&gt;""}
java.sql.SQLException: No suitable driver found for jdbc:mysql://&lt;ip&gt;:3306/proj_dev
```
for migratus when running `lein migratus migrate`
the db is completely empty, first time trying to migrate anything
```
With this in project.clj
  :migratus 
  {:store :database
    :migration-dir ""migrations""
    :db {:classname ""com.mysql.jdbc.Driver""
          :subprotocol ""mysql""
          :subname ""//&lt;ip&gt;:3306/proj_dev""
          :user ""root""
          :password ""*""}})
```
I'm not sure what I'm doing wrong
I have connected to the server with MySQL Workbench; I'm trying to connect to a Google Cloud MySQL instance...; any ideas?"
972,1554101077.3446,Jake,"Hi every one, I wrote this utility as an alternative to `with-redefs` such that the redefinition is done only on that thread and not others (ie, the global definition remains the same and redefinitions are per-thread). This is a fork from <@Ferne>’s original solution <https://gist.github.com/gfredericks/7143494>.

Would appreciate if you could check it out to suggest improvements/corrections: <https://gist.github.com/mourjo/c7fc03e59eb96f8a342dfcabd350a927>

cc <@Merilyn>"
973,1554101945.3453,Kandra,"Hmm. Has anyone else noticed a really slow startup times with `lein repl` when using JDK12?; My REPL timeouts almost always with JDK12, maybe 1 out of 10 succeeds to connect. With JDK10 it works normally"
973,1554102118.3464,Roslyn,try clojure 1.10.1-beta1; there was a performance regression regaring user.clj that 1.10.1-beta1 addressed: <https://dev.clojure.org/jira/browse/CLJ-2484>
973,1554102555.3472,Kandra,"Oh, that has to be it! Cheers; Yeah, I can confirm that after changing to 1.10.1-beta1 REPL starts up normally"
974,1554115624.3499,Vada,"hi all, i'm looking for a good API client HTTP project for reading the source code and design as muster; do you have any example in the `clojure` ecosystem and lib in the opensource word?  like it could be dunno, any library with rest-client"
974,1554116654.3514,Xiao,"Anyone using nginx-clojure and got it running with openjdk 10+? Project doesn't really seem maintained anymore.; Or perhaps someone can advise a better deployment method these days, with high performance?"
975,1554118897.3523,Min,define high performance? what's the use case
975,1554119023.354,Xiao,"Real time bidding, just want to squeeze out as much performance as possible, and nginx-clojure had decent benchmarks."
975,1554119025.3541,Min,most of the time aleph or jetty is good enough. Not sure nginx-clojure performs better at all
975,1554119261.3555,Xiao,"You're probably right, the difference isn't extreme <https://github.com/ptaoussanis/clojure-web-server-benchmarks/tree/master/results/60k-non-keepalive#60k-non-keepalive>"
975,1554119327.3566,Tawnya,"Hey guys, I just downloaded clojure via the installer for windows (it downloaded as powershell module). I need help getting it started."
975,1554119411.3578,Min,"aleph also scores better than openresty (same models as nginx-clojure I think) on other benchmarks, anyway I bet the kind of platform you're building will likely not have a bottleneck at this level"
975,1554120476.3584,Jasmine,Please ask in <#CFN4QDHPS|clj-on-windows> for help...
975,1554128319.3592,Vita,I use nginx-clojure but i think it doesn’t handle java versions above 8 right now. I don’t think there’s much active development happening but it’s been stable for us.
976,1554129188.3595,Lesha,"Anybody have experiences to share using Akka with Clojure? I found a couple of small wrapper projects which look inactive. My main concern would be around the requirement that actor classes be serializable, so I'd think you would have to be cautious about typical Clojurisms like grabbing state in a closure."
977,1554134820.3633,Lana,"I was trying to point some of my users at the Clojure documentation to show all the options for `spit`, and hit a brick wall. The `spit` doc string does not list them, <https://clojuredocs.org/clojure.core/spit> and even if they are resourceful enough to look up the entry for `writer` that does not list them. I basically would need to teach them how to bring up a REPL and spelunk through the source code in order to get a definitive list. And they are mostly not software developers. This seems… unfortunate?"
977,1554135434.3636,Jasmine,"jira welcome, I don't think there is one I'm aware of"
977,1554142704.0005,Jonas,"I'm looking for a way to manage state reactively, where the crucial thing is that invalidations are eager and computing the new value is lazy (ie. on deref)"
976,1554142714.0007,Jonas,"I was thinking an agent with for each chunk of state I care about, that eagerly invalidate their listeners. but how can I override the deref behavior?"
978,1554143377.0017,Dann,"does this match the semantics of a cache at all? with core.cache you can easily get custom access / lookup behaviors; (while storing the cache itself in an atom, agent, whatever's apropriate)"
978,1554143464.003,Jonas,"hm, I wasn't thinking of it in terms of a cache at all. it's not a typical cache, but perhaps I could (ab)use hundreds of 1-element caches for this.; the use case is a large reactive system, containing many hundreds of entities and links between them, but where only a handful of entities are ""live"" at any given time.; if the invalidations are eager, the views for the few things that are live will know they need to rerender. meanwhile, the rest of the world might be invalid but that's harmless."
978,1554143619.005,Dann,"hmm, sounds a lot like what react does under the hood actually"
978,1554143656.0057,Jonas,not dissimilar in principle.
978,1554143661.006,Dann,"what's the difference between ""hundereds of 1-element caches"" and ""a cache with an index"""
978,1554143702.007,Jonas,"depends on whether invalidation happens at the entry level or the cache level, I guess. I'm reading the core.cache docs now."
978,1554143827.0087,Dann,I guess you'd need it loop it through - the cache forcing function would need to look up its data sources in the cache and invalidate it's descendents? now that I think about it you probably want a proper reactive system and not hacking it direclty out of cache / agent building blocks(?)
978,1554144020.0098,Jonas,"well, I mentioned agents because that's what it felt like when I was vaguely thinking about it last night. but I think there's a bunch of extra bookkeeping to do that pushes me to use a default implementation. I'll probably end up building each reactive block out of a handful of refs I transact over, I guess."
978,1554144050.0103,Dann,there's a whole book about this btw <https://www.amazon.com/Clojure-Reactive-Programming-Asynchronous-Applications/dp/1783986662>; it uses rxjava iirc
978,1554144099.0113,Rosaline,"react, if I understand, doesn't actually use caches(so avoids figuring out cache invalidation), but diffs the virtual dom to determine what needs doing"
978,1554144168.0121,Dann,"yeah, by extension you could use it to turn data dependency in a data flow app into smart invalidations, but that's still a stretch I think"
978,1554144257.0134,Jonas,"for my purposes, the wiring of dependencies is explicit, so I don't need to infer it. I just want to avoid having to unwire and rewire things as the user navigates.; anyway, I'm just building a prototype, so I'll just hack something together and not sweat it too hard for this first POC."
978,1554144324.0141,Lana,"OK, I created one. I forgot that I even had an account on the JIRA. Thanks! Hopefully it was formatted correctly and sufficiently informative."
978,1554144392.0143,Dann,"it uses rxjava, futures, and core.async in various examples"
979,1554145520.0145,Jasmine,"thx, I added a patch"
980,1554146003.0149,Loria,Is there any way to dynamically un-extend a protocol?
980,1554146009.015,Lana,"Wow, that was fast! :smile:"
978,1554146063.0159,Dann,assign method implementations that all throw unimplementederror?
980,1554146194.0169,Loria,"use-case: I have a default `java.lang.Object` implementation of a `Foo` protocol; then I extend it to `clojure.lang.Seqable` in the REPL; afterwards I realise I don't want that implementation to include hash maps, so I change that to a `clojure.lang.Sequential`; how do I disassociate `Seqable` so that calling a Foo method on a hash map falls back to the default `Object` implementation?; (without restarting the entire REPL)"
980,1554146798.022,Dann,"<@Loria> the extension of the method is stored with the protocol implementation (iirc in the var itself or its metadata) and can in theory be removed, I don't know if there's anything that would be portable though; <@Loria> this should be enough info for a short term hack, but no promises it would work with the next clojure release ```(ins)user=&gt; IFoo
{:on user.IFoo, :on-interface user.IFoo, :sigs {:frob {:name frob, :arglists ([this]), :doc nil}}, :var #'user/IFoo, :method-map {:frob :frob}, :method-builders {#'user/frob #object[user$eval145$fn__146 0x42f33b5d ""user$eval145$fn__146@42f33b5d""]}}
(ins)user=&gt; (extend Object IFoo {:frob (fn [x] [:obj x])})
nil
(ins)user=&gt; IFoo
{:on user.IFoo, :on-interface user.IFoo, :sigs {:frob {:name frob, :arglists ([this]), :doc nil}}, :var #'user/IFoo, :method-map {:frob :frob}, :method-builders {#'user/frob #object[user$eval145$fn__146 0x42f33b5d ""user$eval145$fn__146@42f33b5d""]}, :impls {java.lang.Object {:frob #object[user$eval162$fn__163 0x3e14c16d ""user$eval162$fn__163@3e14c16d""]}}}```; usually protocol / interface / multimethod changes are the one reason I do an unconditional repl restart, and I try to work on my design in such a way that those would change extremely rarely (which makes sense, as they are all meant to be top level entry points for other code)"
980,1554147802.0245,Loria,"tried doing `(def Foo (update Foo :impls #(dissoc % clojure.lang.Seqable)))`, but that didn't work; guess I'll just have to restart the repl.. had lots of ""testing data"" state built up from evaluating commented forms which I didn't want to lose, but that's probably another sign of general sloppiness"
980,1554148493.0274,Dann,"I'd suspect `alter-var-root` rather than def/update to be the right path, if anything worked"
980,1554149212.028,Loria,"hmm, that doesn't do the trick either"
981,1554150129.0288,Jasmine,protocol choices get baked into per-call-site caches so it's probably difficult to do this fully without restarting your repl; easier to do it now before I forget about it :)
982,1554157689.0301,Carita,"Hello, I’m having some issues working with mutable Java arrays and can’t find what is going on.

This code is supposed to return `5` but returns `0`

```
(let [m (to-array [0 0 0])
      _ (for [i (range 3)]
          (aset m i 5))
      x (aget m 2)]
  x)
;; =&gt; 0
```

Now, when I eval it one form at a time it correctly returns `5`

```
(def m (to-array [0 0 0]))
;; =&gt; #'user/m
(for [i (range 3)]
  (aset m i 5))
;; =&gt; (5 5 5)
(aget m 2)
;; =&gt; 5
```

Maybe I’m missing something obvious :thinking_face:"
982,1554157857.0314,Becki,classic laziness. `for` returns a lazy collection and is not a good choice for performing side effects like mutating an array. What you are seeing is that nothing is realizing the collection so no work is ever done. the result is that the original array contains 0s rather than 5s
982,1554157892.032,Carita,"right, of course, thanks!"
982,1554157910.0324,Becki,do you know the best way to fix it or want to ponder/work at it some more?; (or already know the answer :)
982,1554157974.0329,Carita,"I was going to try a `doseq`, is that enough? :thinking_face:"
982,1554158075.0333,Becki,that's what i would do
982,1554158082.0335,Carita,"cool!, thanks :+1:"
983,1554158990.0356,Shawanda,"&gt; if the invalidations are eager, the views for the few things that are live will know they need to rerender. meanwhile, the rest of the world might be invalid but that's harmless.
<@Jonas> isn't this how some CLJS view libs work? E.g see Reagent (`reaction` and `ratom`), Rum (reactive components and derived atoms), hoplon+javelin, etc."
984,1554161105.0364,Debora,"hey guys, whats the cleanest way to append something to the end of a vector within a thread last macro; `(-&gt;&gt; v (conj e))` and `(-&gt;&gt; v (concat [e]))` don't work for obvious reasons; am i stuck having to create a let binding for this?"
984,1554161456.039,Suanne,Are there any compelling reasons to prefer the `loop` and `recur` pattern over recursive function calls?
984,1554162188.0398,Shawanda,<@Debora>could be the case for `as-&gt;` instead of `-&gt;&gt;`
984,1554162776.0405,Otelia,"<@Debora> I don't understand why you say your first example doesn't work, this works for me:
```
(let [c [1 2], v 3] (-&gt;&gt; v (conj c)))
=&gt; [1 2 3]
```; Oh, v is the vector not the value. Never mind."
984,1554162943.0419,Dann,"<@Debora> -&gt;&gt; and as-&gt; are written so they can be nested inside -&gt;; you can use -&gt; at the top level, and use -&gt;&gt; / as-&gt; for parts of the pipeline inside that need to use the tread-last behavior; ```user=&gt; (-&gt; [] (conj [:a 0]) (-&gt;&gt; (into {})))
{:a 0}```"
984,1554163354.0438,Otelia,"<@Dann>, that is really good to know! But undocumented, right?"
984,1554163385.0444,Dann,"hmm... I thought I saw it documented somewhere, let me see if I can dig it up; there are examples here and there, but I don't find anything mentioning that all the -&gt; related macros are designed to work inside -&gt; <http://clojuredocs.org/clojure.core/as-%3E#example-568eeddae4b0f37b65a3c280>; oh wow this one - I never thought of using `as-&gt;` with destructuring <http://clojuredocs.org/clojure.core/as-%3E#example-5b5e08e9e4b00ac801ed9e3a>"
984,1554163996.046,Otelia,"I guess it's implied that nesting would work, since it isn't prohibited.; That is an interesting one with as-&gt; and :as."
984,1554164496.053,Bernardine,"i'd like to use clojure to generate some `defrecord` classes (and some helper methods) that i intend to consume from Java... eg:
```
(ns my.core
  (:gen-class :name my.core.Support :methods [^:static [getEvents [] ...]]))

(defrecord Event [^String name ^Date date_])
(def -getEvents [] ...seq of Events...)
```
from Java i should be able to stuff like this:
```
import my.core.Event;
import my.core.Support;
...
public static void main(String[] args) {
   events = new ArrayList&lt;Event&gt;(Support.getEvents()); 
   // ^^ i get ClassCastException here b/c the imported Event is loaded by AppClassLoader
   //     but the Events produced by the clojure-compiled gen-class are loaded by clojure's DynamicClassLoader
   //  ... what's the best way to do this kind of thing
}
```"
984,1554164751.0534,Dann,"don't you have to load Support before Event at the very least?; I've found calling Clojure via Java to be much easier with the clojure.lang.RT static methods (var, require, etc.) rather than trying to use gen-class namespaces as classes"
984,1554165379.0562,Bernardine,hmm i do need to statically link/compile in my case.. .. wondering if there's a way to tell Clojure to load certain classes like these instead of dynamically complie them
984,1554165430.0566,Dann,"you can't call the clojure API from the java code?; if you properly aot-compiled you will be able to import the classes, and the classes will in turn initialize clojure if it isn't initialized yet"
984,1554166482.0595,Debora,oh sweet <@Dann> didn't know you could nest `-&gt;&gt;` and `as-&gt;` inside a `-&gt;`... feel like i'm gonna overuse this thoroughly now
984,1554166501.0599,Dann,"(a gotcha is that with eg. lein, it assumes that your java needs to be compiled before your clojure, and here I think you really want the opposite); that's fixed with ~`:prep-tasks [""javac"" ""compile""]`~ `:prep-tasks [""compile"" ""javac""]` (fixed); <@Bernardine> what type are you defining for getEvents to return in gen-class btw?; (I assume java.util.Collection by context); <@Bernardine> this compiles:"
985,1554170921.0649,Bernardine,"interesting thx for that noisesmith, let me try something
incidentally i'm using clojure-maven-plugin not lein so let me what i can find out here"
984,1554172287.0684,Bernardine,"<@Dann> very cool. thank you for doing that repro. it led me to a fix... while `lein` excludes the `.clj` sources from the built target/jar files, `clojure-maven-plugin` (what i'm using) does not do this by default
so the presence of my `clj` source was causing clojure to prefer loading the defrecord by dynamic compilation rather than using the `.class` file that the static/linker was using - so the `Event` loaded by the java compiled code was not the same as the `Event` getting dynamically produced by clojure/DynamicClassLoader
anyway i'm able to configure out the clj sources so that all is getting loaded by the AppClassLoader and now i'm working---thx again !"
986,1554176146.0689,Jasmine,"note that this is not a public api and you should not rely on it. Instead, you should use the Clojure Java API - <http://clojure.github.io/clojure/javadoc/>"
987,1554193431.0699,Xiao,"Anyone had issues with `lein deps` constantly failing with something like `Could not transfer artifact amazonica:amazonica:pom:0.3.123 from/to clojars (<https://repo.clojars.org/>): Connection reset` during `docker build` and remember a solution?; This particular dependency doesn't seem like the issue, it's different every time. Works fine outside of docker."
987,1554198387.0711,Isa,"sounds like issue about docker environment; or your Internet connection; How to figure out how to mute logging for Java dependency? I use `flyway` and it make so huge mess in REPL by printing even debug info. In the past this was working `(.setLevel (Logger/getLogger ""org.flywaydb"") Level/WARNING)`, but not today (new ver. of flyway? I guess they changed logger or something). How to deal with such situations?; on the end jdbc use logback, flyway use who knows what, how to deal with this mess?"
988,1554207564.0747,Isa,"I mean what is the one right way to set level for logging? I have to do it separately for slf4j, log4j, logback etc. or is the way to do it in one consistent way? Should I use slf4j or logback?"
987,1554207588.0749,Isa,"or maybe <https://github.com/fzakaria/slf4j-timbre> ?; In most of examples I see people set this levels by logback, not in slf4j even if they use it; another question: If one of my dependency use log4j, but another use logback I guess logback will capture log4j input as facade.; How to control it?; Personally I use timbre as logger, but Java libraries make a mess sometimes"
989,1554211833.0765,Xiao,"I ended up using a multi-stage build and compiling the uberjar outside of the runtime environment. Was able to get it to work then, and with a smaller final image, so yay"
990,1554214744.0776,Benedict,"Ages ago I think I saw some people talking about the <http://4clojure.com|4clojure.com> site. I'd like to contribute and get it working well, e.g. this <https://github.com/4clojure/4clojure/issues/309> would be good to fix.; Anyone have any pointers?"
991,1554229381.0793,Lyda,"On <http://repl.it|repl.it> one can write clojure programs, if that's what you ask."
992,1554231086.0805,Mireille,has anyone used ions in production and can vouch for it? considering using it for a small production project
992,1554231301.0806,Benedict,"Not quite. 4clojure is a learning platform, which works well but has some shortcomings and it seems to have been abandoned. I wondering if anyone knows the authors or has tried to get it active."
992,1554231345.0808,Lyda,"aaah, I thought that you want a replacement for <http://try-clojure.org|try-clojure.org>"
993,1554234951.0814,Tamika,Does clojure have some command-line tools which are required by some clojure projects to run?
993,1554234976.0816,Tammera,some projects depend on leiningen
993,1554235085.0834,Tamika,"More specifically, I am trying to run 'lein repl' in one such project's root, and I get 'clojure.lang.ExceptionInfo: Could not find clojure executable {:tried-paths [""/usr/local/bin/clojure""]}'  which seems to indicate I should have /usr/local/bin/clojure"
993,1554235244.084,Tammera,`/usr/local/bin/clojure` is installed by homebrew on my macos system. What are you using?; its part of clojure itself
993,1554235285.0846,Tamika,I was trying Fulcro (following this documentation here: <http://book.fulcrologic.com/#_about_this_book>); So it seems it's not related to leiningen actually but how that Fulcro template is set up
993,1554235777.0869,Tammera,"I am sorry, but I don’t know.; maybe ask in <#C68M60S4F|fulcro> ^^!"
993,1554235980.0875,Tamika,"Yeah! good idea, thanks Lennart :slightly_smiling_face:"
994,1554239267.0879,Dann,"yes, the core clojure project has cli-tools that are installable via your package manager (eg. homebrew on a mac)"
995,1554255739.0893,Ruthann,Hi. How can i use com.cognitect.aws/email to use email on AWS?
993,1554256085.09,Jasmine,<#C09N0H1RB|aws> is a good place to ask this
995,1554256270.0903,Ruthann,Thanks <@Jasmine>
996,1554293440.0978,Fran,"Hi. I'm trying to use `compile` with a gen-class. I get a class not found exception when the constructor is defined taking a class from a lib I'm using. I can import that same class, and changing the type to eg String makes compile work. Any caveat about types for constructor args and class path etc?"
996,1554294178.0979,Adria,"Looks like flyway uses slf4j bindings, so if you use logback, you should be able to set the flyway log level in your logback.xml (or whatever method you use). I haven’t tried it myself though"
996,1554294645.099,Fran,Hm. This was with tools.deps - if I instead try with lein all is well.
997,1554295059.0991,Cindie,there's also the channel <#C6QH853H8|tools-deps> where you might have more luck than here :smile:
996,1554295651.0993,Fran,"Yep, realized this after testing it with lein."
998,1554296485.1009,Star,"what would be closest and cleanest way to have ""cron jobs"" in Clojure. Something to run every some time from within web app. Like @Scheduled in Java Spring..."
998,1554296693.1026,Lane,<@Star> Java's ScheduledExecutorService works well but you can also write something custom with a core async go loop and timeout
999,1554297721.1029,Shanell,quartz via clojurewerkz/quartzite is quite popular
997,1554300408.1072,Aubrey,There’s also juxt/tick
1000,1554301469.1079,Tammera,and `chime` and `at-at`
997,1554302062.1085,Aubrey,Someone should write a comparison for those!
997,1554302723.1088,Meagan,I've used tick before and found it worked well :+1:
999,1554302810.1102,Tammera,"yeah, the scheduling part of tick is deprecated tho :disappointed:"
1001,1554304628.113,Brent,Is there a better way to split a list of pairs into lists of the firsts and seconds than `[(map first pairs) (map second pairs)] `? Thank you!
997,1554305388.1131,Isa,"Finally I did `(.setLevel (org.slf4j.LoggerFactory/getLogger ""org.flywaydb"") Level/WARN)` but still I don’t feel it :slightly_smiling_face:"
999,1554305417.1133,Isa,Also I have logback because jdbc use it; So probably dependency from jdbc (logback) bind slf4j to logback… who knows how this hell works :slightly_smiling_face:; I use timbre in my code
1002,1554306381.1151,Emmie,"I've used quartzite before, while it works great, it's a bit heavy with some learning curve as you kind of need to know how Quartz works."
1002,1554307402.1158,Aubrey,Oh. Good to know. They advocate using tick over quartz in the readme...
1003,1554308318.1164,Lemuel,"Is there a stateful transducer like ""reductions""?"
1003,1554308564.1174,Meagan,i'm trying to bundle a Clojure desktop app to be executed stand-alone on macOS &amp; Windows. anyone know of some resources on how best to do that with JDK 11?; I want to supply my own JRE with the app; I tried packr but I can't figure out how to use it with JDK 11 yet
1002,1554309315.1186,Isa,"`(map (juxt first second) [[1 2 3] [4 5 6] [7 8 9]])`; or `(map (partial take 2) [[1 2 3] [4 5 6] [7 8 9]])`; ah no, sorry you want it to have in different way"
1002,1554309411.1192,Brent,thx but I want the opposite: `([1 2] [4 5] [7 8])` -&gt; `([1 4 7] [2 5 8])`
1002,1554309532.1194,Sixta,Plan is to undeprecate later
1002,1554309991.1196,Dorla,"There's one in cgrand's `xforms` library along with many other transducers:
<https://github.com/cgrand/xforms/blob/master/src/net/cgrand/xforms.cljc#L491>

Repo: <https://github.com/cgrand/xforms>"
1002,1554310081.1207,Shawanda,I used `javapackager` for this (a long time ago though so not sure about JDK 11)
1002,1554310120.1214,Angelita,"Is ""Clojure Programming: Practical Lisp for the Java World"" still a relevant book to learn clojure?"
1002,1554310144.1217,Meagan,it looks like javapackager was removed from JDK 11 :confused:; ugh
1004,1554310505.1229,Meagan,hm. looks like I might be able to use a backported version
1002,1554310512.1231,Meagan,that's being worked on for JDK 13
1004,1554310816.1239,Antione,i seem to recall a new-ish clojure lib for building UIs (not seesaw); anyone know the name of it?
1004,1554310847.1243,Angelita,fn-fx?
1004,1554310884.1245,Meagan,cljfx
1004,1554310900.1248,Antione,"that's the one, thanks"
1002,1554310947.1252,Meagan,"yeah. just got done creating a simple app; seems good, still don't understand a lot; now I'm trying to figure it out how to distribute it to my coworkers who might not have JDK 11 :grimacing:"
1005,1554313505.1257,Roslyn,<@Antione> join <#CGHHJNENB|cljfx> :smiley_cat:
1006,1554318950.1265,Isidro,High level noob question: would using datomic ions for a normal page serving ring app (i.e. not an api or event triggered code etc) be a bad fit for some reason?
1005,1554324006.1276,Vinnie,has anyone encountered any sort of linting / analysis tools that could detect whether a change on a clj codebase maintains some notion of backward compatibility?
1005,1554324236.1294,Sixta,"I think that's Rich Hickey's research project, when I asked a while ago, I was told it's not close to fruition yet."
1005,1554324284.1301,Vinnie,"will be very interested to see what he comes up with :slightly_smiling_face:
coincidentally, this question came up after thinking about the spec-ulation talk; and thinking about how i want to do versioning in my clj projects"
1005,1554324519.1316,Isreal,My little hobby app was macOS only. FWIW I used <https://github.com/Jorl17/jar2app> along with JavaAppLauncher built from <https://bitbucket.org/infinitekind/appbundler/>
1007,1554326665.1321,Lemuel,ah!  thanks!
1008,1554334504.1328,Antione,anyone know who runs the logging? seems broken
1008,1554334771.1337,Becki,<https://twitter.com/plexus/status/1110594418573230085>
1005,1554334788.1342,Becki,from a while ago. possible you could reach out to <@Charlyn>
1008,1554335096.1352,Celestine,<@Antione> Most channels here are mirrored into Zulip via <@Silvana> (which you can invite to any channel it isn't already a member of). <https://clojurians.zulipchat.com/#narrow/stream/180378-slack-archive>
1008,1554335332.1358,Antione,"thanks <@Becki> and <@Celestine>; other question for ya: I remember alex miller saying something about some interesting business required to get constant-time dispatch in `case`. I've been reading over it, but wondered if anyone here knew the details well enough to give their take on what's going on here.

the deeper i dig, the more questions i have; `max-switch-table-size`, `case-map`, `prep-ints`, `prep-hashes`, `max-mask-bits`, `maybe-min-hash`, etc. etc.; curious about why `case-map` builds a `sorted-map`, where the value for `max-mask-bits` comes from; and other curious bits"
1008,1554335680.1416,Dann,so as I understand it the big picture is constructing  a lookup table out of your case call at compile time (you probably know that part already)
1008,1554335718.1422,Antione,"yeah, i might be misremembering, but i feel like there was some relation to the bytecode that's emitted maybe?"
1008,1554335751.1429,Dann,"right, case is a special form, that means it takes your form as input, and produces byte code as output; and the job with case is to turn the whole call into one table lookup (which is why all dispatch must be compile time literals - you can't calculate the dispatch correctly otherwise); the rest of what you find there is implementation of that concept (as I understand it)"
1008,1554335842.1447,Antione,"err, is `case` a special? i didn't think it was; it's a macro"
1008,1554335868.1452,Dann,"oh, right, `case*` is the special"
1008,1554335901.1455,Antione,"ahhhh, ok, i missed that earmuff"
1008,1554335935.1458,Dann,"yeah, I elided that distinction above as well; so the `case` macro does a bunch of prep work with the input form, and produces data that's tied to the implementation details of the `case*` special form (bit-mask, hash implementations ...)"
1008,1554336058.1477,Rosaline,"there are two constant time jvm dispatch instructions tableswitch and lookupswitch, and case ends up being one or the other; lookupswitches need things ordered, which I guess is the purpose of the sorted map"
1008,1554336107.1486,Dann,<@Antione> <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Compiler.java#L8754>
1008,1554336117.1489,Antione,<https://github.com/clojure/clojure/blob/2cc37bb56a9125a1829c73c505e32995e663059a/src/jvm/clojure/lang/Compiler.java#L8754> for anyone following along; jinx; <@Rosaline> do you know offhand which one gets picked when?
1008,1554336178.1503,Dann,that's a big class...
1008,1554336189.1507,Rosaline,no; tableswitch is for a dense jump table
1008,1554336206.1514,Antione,"(btw, none of this is necessarily important for me to know, but i love a good mystery)"
1008,1554336243.1519,Rosaline,"basically you are dispatching contiguous numbers; lookupswitch is for  sparse; so a good deal of case's complexity is likely trying to massage things in to a dense table if it can, falling back to sparse; the jvm instructions are also all for numbers, so case has to decide on a strategy for turning things that aren't numbers in to numbers"
1008,1554336508.155,Antione,"gotcha, have been banging on it trying the number of tests and variation in types to produce :sparse version; but have only been able to find :compact so far; <@Rosaline> and <@Dann> thanks very much for the explanation"
1008,1554336703.1566,Rosaline,actually I vaguely remember rhickey talking about min-hashing on irc around the time case was added now that I look at it
1008,1554336750.1574,Antione,prep-hashes and prep-ints only go sparse if the mask is 0
1008,1554336772.158,Rosaline,"min-hashing is, I think, the technique for constructing a dense dispatch table; <http://clojure-log.n01se.net/date/2009-10-28.html#15:54a>"
1008,1554337087.1588,Antione,taken it way back
1009,1554337091.159,Antione,takin'*
1008,1554337093.1592,Rosaline,"perfect minimum hashing, googling min-hashing gets you other interesting things"
1008,1554337980.1607,Antione,"what im struggling to do: find a situation where `(maybe-min-hash (map int tests))` or `(maybe-min-hash hashes)` produce `[anything 0]`; ah, there we go; `(or (maybe-min-hash (range 8193)) [0 0])`; maybe-min-hash produces `nil`, and then we get a `0` mask, which causes `:sparse`, which gets us a `lookupswitch`; though i'll admit i still don't totally understand what scenario would cause prep-ints to get to the final branch ""; compact case ints, with shift-mask"". perhaps `tests` and `thens` which are massive?; i've managed to kill my repl, so i'll leave it there :slightly_smiling_face:"
1010,1554348833.1656,Deann,Can someone explain in simple terms why errors are so cryptic in Clojure?
1010,1554349444.1661,Celestine,"Which version of Clojure are you using? They're much improved in Clojure 1.10.; But it's also very subjective and it really depends on what languages you've used before you come to Clojure.; My background was C/C++/Java so Clojure was just ""regular stacktraces"" for me and it included a message and the filename / line number of each piece of the call stack so -- for me, based on past language experience -- it was easy to find the bits that referred to my code and therefore figure out what the error was.; There are some messages that seem odd at first but you quickly learn to translate from ""the error message you get"" to ""the mistake you made in your code"".; <@Deann> Can you give some specific examples?"
1010,1554351626.1722,Deann,"I guess that is true as I am coming from writing Python Django which can have long stack traces. I am using 1.10, but I keep watching videos of clojure and people typically joke about the error messages."
1011,1554351682.1732,Deann,"I was wondering if there was a reason that people joked about it. Like is it an unsolvable problem, or was it just a low priority in past versions?"
1010,1554351746.1746,Deann,"Many times the error message doesn’t filter my error to the top, so I have to filter through the filename, line ref to find where my code is breaking."
1010,1554354366.1758,Celestine,"<@Deann> Yeah, the long stack traces have been a long-standing (bad) joke in Clojure...; There have always been lots of tools to ""improve"" the output but I think it was always a bit of an overblown joke :neutral_face:"
1010,1554354595.1785,Suanne,"I’d like to use `(case (type thing) ...)` and match on whether it’s a string or a long, but I can’t figure out how to indicate either."
1010,1554354704.1791,Celestine,"Because Clojure mostly attracted more experienced developers in the early days, the stack traces weren't a big deal really... and they only became an issue as Clojure started to get more popular, IMO :slightly_smiling_face:"
1010,1554354753.1792,Katherina,"<@Suanne> Try the instance? function.
```
(instance? String ""hello"")
true
```; also using `cond` here could be  better.
```
(cond
    (instance? String var) ""a string""
    (instance? Long var) ""a long""
    :else ""no idea"")
```"
1010,1554354905.1796,Suanne,"<@Katherina> Thanks! Is there a way to avoid the deep nesting that happens when doing a bunch of if/else ifs, or is it unavoidable?

```
(defn get-port
  [port]
  (if (instance? String port)
    ""it was a string""
    (if (instance? Long port)
      ""it was a number""
      ""it was something else"")))
```; <@Katherina> Ah, you answered my question. Thank you!"
1010,1554354960.1801,Katherina,:smile:
1010,1554356068.1824,Suanne,"A bit confused how to output an error message and stop function execution when I’m given some bad data since there is no early return ability.

```
  (let [port (get-port (first args))]
    (if (= port nil) ; function returns nil if data bad
      nil ; early return
      (do (println (format ""Listening for connections on port %d."" port))
             (run-jetty handler {:port port}))))
```

I could do something like this but it seems pretty ugly. Especially if there was a bunch more data being validated."
1010,1554356136.1831,Shavonda,You could throw an exception 
1010,1554356198.1846,Suanne,"So inside of `(get-port)` I could throw an exception for whatever kind of error took place (out of range, wrong data type, bad format), catch it inside the same function to output the relevant error message, and then throw another exception that the caller doesn’t catch?"
1012,1554356237.1855,Shavonda,Also check out ‘if-let’. 
1012,1554356267.186,Tammera,"(and `when-let`, which is `if-let` with only the positive branch and a convenient do block inside ^^)"
1010,1554356414.1885,Shavonda,If you want to print a message and exit the function you could put a println and throw in a do block. It might help to see the full function here though. 
1010,1554356486.1891,Tammera,the other alternative is monadic error handling with something like promenade or cats
1010,1554356507.1896,Suanne,"Thanks for the suggestions, I will explore these recommendations tomorrow and might ask some more questions. Have a good night."
1010,1554356508.1897,Tammera,but monads can be scary
1013,1554362514.1902,Brent,"You could also use clojure spec to define what you expect of your arguments and check them all at once (with e.g. spec/valid?) and output a message with spec/explain (though you might want to include the library Expound for more human-friendly errors); What is your use case? If it is a main function, just throw the exception, JVM will catch it and print. If it is to be called by others, why should you print an error? Just include it in the exception, throw it, and let the caller handle it in any way it likes.; If you want to check multiple errors, you could ```
(cond
  (nil? port) (ex-info ""Illegal argument: no port"" {:id :illegal-argument :arg :port :val :missing})
  (not (int? port)) (ex-info ""Illegal argument: port must be an int"" {:id :illegal-argument :arg :port :val port})
;; ...
:else ; all checks passed, we can proceed
(run-jetty ...))``` A little silly example but you get the point."
1014,1554366074.1911,Tiesha,"since `map` takes multiple collections, you can do:
```(-&gt;&gt; [[1 2] [4 5] [7 8]]
     (apply map vector))
=&gt; ([1 4 7] [2 5 8])```"
1013,1554391491.1918,Brent,"Nice! But it will break if there are too many elements, map isn't defined for any number of args"
1015,1554391597.1925,Onita,"hey everyone. has there been any work toward developing a debugger along the lines of the common lisp one? i don’t know a lot about the jvm, so maybe this isn’t even a possibility in clojure.; found this, gonna play around with it: <https://github.com/gfredericks/debug-repl>"
1016,1554392755.1935,Cherise,"Hi, is it recommended to run `clj -m myproject.core` in a Docker container in production? Or better to use an uberjar?"
1016,1554392941.1936,Tiesha,"I don’t see that limitation… just ran it for a vector of 50000 pairs without issue…
`(apply map vector (partition-all 2 (range 100000)))`; am I misunderstanding what you mean by too many elements?"
1015,1554396888.1955,Marlyn,"<@Cherise> there are tradeoffs to both approaches. AOT compilation can get faster load times.  You can AOT with an uberjar, or not, or with `clj` or not.  I don't recommend running `clj` but instead use `clojure` in Docker; (clj == rlwrap clojure)"
1017,1554399019.1962,Clarine,"What’s the meaning of the hash sign here?
<https://github.com/juxt/yada/blob/master/ext/multipart/src/yada/multipart.clj#L37>; Below it is a function without it, just ^bytes"
1017,1554399074.197,Dann,"`#^` is an old syntax for metadata; ```user=&gt; (meta #^:foo {})
{:foo true}``` <@Clarine>"
1017,1554399270.1974,Clarine,"cool, so it’s optional now."
1017,1554399389.1983,Jasmine,I still find it jarring when I run across this now
1017,1554399391.1984,Dann,"yeah, it's the same as `^` as far as I can tell"
1017,1554399399.1986,Jasmine,it is the same; the syntax was simplified
1018,1554400008.1991,Brent,Does map take up to 50k arguments or am I missing something? Or does apply do something else than (map fn pair1... pair50000)?
1017,1554400319.2001,Clarine,"Someone hinted that this issue <https://dev.clojure.org/jira/browse/CLJ-1472> would also be relevant for GraalVM native.
I tested the patch but alas, I still could not compile code using spec with it."
1018,1554401001.2005,Brent,"Ah I see <https://stackoverflow.com/questions/2735600/why-is-there-a-limit-of-max-20-parameters-to-a-clojure-function>
&gt; First of all, the limit only applies to required positional arguments; you can always use the variable arity case (&amp; more-args in the function's signature) to handle as many arguments as you want to
Thanks, today I learned 2 useful things!"
1017,1554401033.2013,Jasmine,"note that there is a cycle between clojure depending on spec and spec depending on clojure, so verifying something like this is probably a little challenging; or at least more challenging than it appears at first :)"
1017,1554401205.2023,Clarine,what I did was build the clojure git checkout with the patch applied. That yielded clojure 1.11.0-master-SNAPSHOT and I depended on that one in my other project.; gotta go now
1017,1554401377.2031,Jasmine,"yeah, you need to recompile spec based on that Clojure, then depend on both the modified Clojure and the modified spec.alpha; spec.alpha is aot compiled so has bytecode emitted according to the old Clojure core"
1019,1554402296.2045,Clarine,"Thanks, I’ll try when I get home "
1020,1554404009.2061,Suanne,"Hey, I’m trying to write a simple `ring` application. In the REPL, when I execute `(run-jetty)`, the function takes over and is impossible to get out of. The only way is to kill the entire REPL process."
1020,1554404314.207,Evonne,<@Suanne> IIRC there’s a `:join` setting you can set to false to keep it from taking over your repl
1020,1554404316.2071,Dann,`:join false` should help there
1020,1554404349.208,Suanne,Ah yes I discovered that option. Now the problem I’m facing is starting and stopping that function now that it’s been executed.
1020,1554404373.2084,Dann,"the call should return an object you can access and ask it to shut down; also if you provide your handler function as a var, you can redefine the handler without restarting the server"
1020,1554404581.2098,Suanne,Alright so I’m seeing that this object returned is a `org.eclipse.jetty.server.Server`. How do I determine how to interact with this? Do I look up the Java documentation? Or is this something Clojure specific?
1020,1554404625.2108,Dann,"the javadoc for that object should be useful, iirc it has a `.stop` method, anything clojure itself provides will start with `org.clojure...`"
1020,1554404642.2113,Suanne,Also where was I supposed to find out that this returns an object other than just asking people who already know here? It’s not obvious in the docs at all?
1020,1554404673.2118,Dann,"This should be covered in the clj-http docs somewhere. Perhaps in a non-obvious way...; <@Suanne> <https://ring-clojure.github.io/ring/ring.adapter.jetty.html> - in general clojure functions return something useful, when in doubt I'd check :D; ```Adapters are used to convert Ring handlers into running web servers.``` - that might imply ""returns the server"""
1020,1554404772.2132,Suanne,"That’s the page I was looking at. Alright, well that’s definitely not obvious at all to me. Thanks for pointing it out."
1020,1554404806.2138,Dann,"I would be surprised to see something that has the job of ""creating an x"" that doesn't return it; (not to say this doesn't exist, but it seems inconvenient and I'm not thinking of examples except maybe ""signal handler"" or ""default uncaught exception handler"")"
1020,1554404860.2147,Suanne,Yeah agreed. I should have thought of it.
1020,1554404887.2151,Dann,also good to remember if you implement a function meant to create something
1020,1554404975.2164,Suanne,"As far as ring is concerned, would the `handler` passed to `run-jetty` be a reasonable place to implement a router that would pass control off to different functions based on the requested URI?"
1020,1554404992.2166,Dann,"that's precisely where that belongs, yes; there are multiple routing libs (I like bidi and polaris myself, compojure is probably the most popular)"
1020,1554405070.2182,Suanne,Alright thanks! I’m probably going to implement a simple one myself as a learning experience.
1021,1554405589.2192,Somer,Is it possible to get the symbol of a `defn` in that `defn`'s body?
1020,1554405704.2205,Dann,if there's a way I'm sure it's not a public feature and would be liable to break in future releases - why not a wrapper macro for defn that passes in or otherwise exposes the var symbol?
1020,1554405792.2217,Somer,I could but I am already using a wrapper defn for certain things (i.e. APM tracing) and I'd need to throw more stuff into that. It seems like it'd be useful to get the name of the current function.
1020,1554405801.2219,Dann,"```(ins)user=&gt; (defmacro ndefn [n &amp; all] `(let [~'var-name '~n] (defn ~n ~@all)))
#'user/ndefn
(ins)user=&gt; (ndefn foo [x] (println ""calling"" var-name) x)
#'user/foo
(ins)user=&gt; (foo 1)
calling foo
1
```; it's useful, clojure doesn't provide it"
1020,1554405883.2225,Somer,This is interesting... <https://www.mail-archive.com/clojure@googlegroups.com/msg13017.html>
1021,1554405891.2227,Somer,"Essentially:
```
(-&gt; (Throwable.)
      (.getStackTrace)
      (first)
      (.getClassName))
```"
1021,1554405985.2241,Becki,can you explain what you are trying to solve? Often a different approach can help. But there for sure are real necessities like this
1020,1554406004.2247,Suanne,"I’m trying to make a function that will kill the previous server if it is defined, but there’s a problem in that the first time `server` isn’t defined. Is there a way to change a symbol `'server` to an identifier at runtime?

```
(defn start-server
  []
  (if (resolve 'server)
    (.stop server))
  (def server (run-jetty handler {:port 8080 :join? false})))
```"
1020,1554406073.2264,Dann,"you could consider `(def server)` at the top level for clarity, then `alter-var-root` which can use the previous value of the var while redefining"
1020,1554406075.2265,Somer,I want to write a spec-assert function that will have the function's name in the error message string. Obviously you can figure out function's name from the stack trace but it'd be nice to make it super obvious.
1020,1554406129.2271,Harris,"```user=&gt; (defmacro fname [] `'~(-&gt; @clojure.lang.Compiler/METHOD .objx .name clojure.repl/demunge symbol name symbol))
#'user/fname
user=&gt; (defn foo [] (fname))
#'user/foo
user=&gt; (foo)
foo
```"
1021,1554406132.2273,Harris,:upside_down_face:; don't use it for real
1020,1554406171.2281,Dann,<@Harris> that's fascinating - how likely would it be to work in the next clojure release?
1020,1554406184.2284,Harris,"hasn't changed at least in the past 5 years; but it has lots of caveats :P; ```user=&gt; (defmacro fname [] `'~(-&gt; @clojure.lang.Compiler/METHOD .objx .name clojure.repl/demunge symbol name symbol))
#'user/fname
user=&gt; (defn foo [s] (for [_ s] (fname)))
#'user/foo
user=&gt; (foo [1])
(foo/iter--157--161/fn--162/fn--163)
```; the only safe way to use it is `(defn foo [..] (let [fname (fname)] ..))`"
1020,1554406270.23,Dann,ahh because for creates nested fn instances
1020,1554406782.2312,Meagan,FWIW it was not obvious to me at all either. I hunted around for examples until I found one that called `.stop` on it
1020,1554406998.2317,Suanne,"Ok here is what I did and it works:

```
(def server nil)

(defn start-server
  ([port]
   (if server
     (.stop server))
   (alter-var-root #'server (fn [&amp; args] (run-jetty handler {:port port :join? false}))))
  ([]
   (start-server 8080)))
```"
1020,1554407134.233,Dann,my though was more like `(def server nil) (defn start-server ([port] (alter-var-root #'server (fn [s] (when s (.stop s)) (run-jetty ...))) ([] ...))`; but effectively the same result
1022,1554407177.2338,Suanne,"Ah I see, so I’d have access to the original value of the var there."
1020,1554407203.2343,Dann,"yeah, that's the premise of alter-var-root, is insuring when you redefine you have access to the latest value"
1023,1554407506.2347,Suanne,Much nicer!
1020,1554407793.2362,Suanne,"That’s weird, I accidentally typed port 80 and it worked. And my browser was able to connect to it. Isn’t that not supposed to work for security reasons (ports under a certain number)? As far as I am aware, I’m not running the process with super user permissions. Although this is on macOS so perhaps I’m not fully understanding how it gives processes permissions.; Not really relevant to Clojure though."
1024,1554408736.2383,Derick,"hello guys
may you help me...
I need to compile a little library of mine to be used for an webapp that runs on JDK 7... can I use Clojure 1.9 and just set the Java path to that old version of JDK?"
1020,1554408805.2401,Clarine,<@Jasmine> Tried your suggestion. Still getting that error. Full output here: <https://gist.github.com/borkdude/73634b2e2ea8e22a7d39c06dc7c628f0>
1020,1554408959.2416,Suanne,"It seems that my REPL executes `(def server nil)` whenever my editor saves the source file, messing up the code since the server reference is lost. Is that expected behaviour?"
1024,1554408963.2417,Clarine,"The relevant bit is probably this:
```
Error: unbalanced monitors: mismatch at monitorexit, 96|LoadField#lockee__5436__auto__ != 3|LoadField#lockee__5436__auto__
Detailed message:
Error: unbalanced monitors: mismatch at monitorexit, 96|LoadField#lockee__5436__auto__ != 3|LoadField#lockee__5436__auto__
Call path from entry point to clojure.spec.gen.alpha$dynaload$fn__2628.invoke():
```"
1020,1554408996.2425,Dann,"<@Suanne> oh yeah, ring's `wrap-reload` would do that, the easy workaround is to use `defonce` instead of `def`"
1020,1554409120.243,Suanne,Ok that worked. This is something that ring is doing?
1020,1554409165.2436,Dann,"yeah, the wrap-reload middleware wraps your handler in a function that checks for changed files and reloads them when each request comes through"
1020,1554409215.2439,Suanne,"Ok interesting.; Previously you said if you “provide your handler function as a var, you can redefine the handler without restarting the server”, can you explain a bit more about this?"
1020,1554409316.2453,Celestine,"<@Suanne> If you use `#'handler` instead of just `handler`, you pass a `Var` so that introduces another level of indirection."
1020,1554409327.2456,Emmie,"I believe you can, just make sure you're compiling and running with the same version to be on the safe side. The best way to find out is to try it :slightly_smiling_face:"
1020,1554409347.2461,Celestine,That allows you to redefine `handler` (in the REPL) and the wrapped `Var` will point to the updated function.
1020,1554409417.2464,Suanne,That is very useful. Thanks!; I have to learn exactly what `#'variable` does.
1020,1554409496.248,Dann,"it's precisely what <@Celestine> said - it is a reader macro that instead of looking up the value in `variable` gets the var object that currently stores it; when you run `def` and the var already exists, the var is reused and a new value is put into it; and when you call a var, it is looked up and the contents are called; I was looking for an article for a full explanation of this pattern... might find one"
1020,1554409557.2495,Suanne,Thanks for the explanation.
1020,1554409571.25,Dann,this might help <https://clojuredocs.org/clojure.core/var>
1020,1554409582.2503,Suanne,Are most people coming in to Clojure with a deep knowledge of Java? I know how to write software in Java but I’m not fully familiar with the libraries and such.
1020,1554409611.2509,Derick,"I'm trying, now, a safer path: leiningen + clojure 1.8"
1020,1554409611.2511,Dann,"hmm, that above article on `var` should also include passing a var to a long-running higher order function (I might fill that in today...); I learned java via Clojure, there's a benefit to at least learning how to read javadoc and convert to clojure interop"
1020,1554409645.2519,Derick,initially I was planing to use 1.9 and deps.clj
1020,1554409654.2523,Dann,because often using a java lib directly is better than a wrapper
1020,1554409727.2529,Celestine,<@Suanne> People come to Clojure from a variety of backgrounds. There are certainly a lot of people coming to Clojure with next to no knowledge of Java.; (and there are people coming in with _lots_ of knowledge of Java too)
1020,1554409748.2536,Clarine,"I saw Clojure as a fun way to learn more about the JVM/Java, since I had to deal with it at work :wink:"
1020,1554409866.2559,Suanne,I’m just a bit confused about how much Java I should be learning in addition to Clojure. An example of my recent confusion is why a lot of ring stuff seems to end in documentation of Java classes. Is it software written in Java that has Clojure wrapper library making it more palatable for Clojure? But then you still have to drop out of Clojure here and then to do stuff (like stop a server for example).
1020,1554409972.2576,Clarine,"<@Suanne> Ring itself is a representation for requests and responses and functions dealing with those, in Clojure. But a webserver is usually not written in Clojure from scratch. That’s where you’ll see a adapter layer that translates back and forth from the Java world. E.g. ring-jetty-adapter."
1020,1554410073.2589,Farrah,I just started Clojure/ClojureScript and I almost feel like its totally opposite to Java from what I've seen; A lot more fun tho haha
1020,1554410265.2616,Celestine,"<@Suanne> How much Java interop you see in Clojure will depend on exactly what libraries you use. Re: stopping a server in a Ring application, the default Jetty adapter exposes a Java class in the Jetty library that you have to call `.stop` on, but if you use `http-kit` instead, calling `run-server` returns a handle on the running server and to stop it you just call the handle as a function, for example <https://github.com/framework-one/fw1-clj/blob/master/examples/usermanager/main.clj#L101-L123>; I came to Clojure sort of via Java. I started doing Java back in 1997. Picked up Groovy in 2007, picked up Scala in 2009, and then Clojure in 2010 and I've been using it in production since 2011.; (in among all that was CFML -- ColdFusion -- running on JVM for years, since I worked at Macromedia/Adobe for seven years!)"
1020,1554410521.2636,Emmie,"Personally, I haven't seen issues compiling a jar with an older jdk and running it with a newer version, but it's usually safer to not mix and match"
1020,1554410575.2638,Jasmine,"if you have feedback, put it on the jira. not something I'm working on right now."
1020,1554410697.2657,Michael,"i'm seeing what seems like counterintuitive behavior with into, wondering if anyone has any insight. this returns a hash map (losing original order) instead of an array map
```
(into (array-map) (for [i (range 10)] [(keyword (str i)) i]))
```"
1020,1554410703.2659,Tammera,I think that Clojure runs on the JVM is one of its benefits. The JVM is such a great platform
1025,1554410886.2667,Suanne,Alright thanks for the insights.
1026,1554410895.267,Milford,"<@Michael> Beyond a certain size, `conj`ing onto a map will cause it to become a hash map for perf reasons."
1026,1554410918.2673,Michael,oh interesting; didn't know that could change the map type
1026,1554411120.2678,Milford,<@Michael> See last sentence of <https://clojure.org/reference/data_structures#ArrayMaps>
1026,1554411230.2681,Michael,thanks!; i suppose i just want (apply array-map...)
1026,1554411276.2687,Milford,"Or, perhaps a sorted map?; That would base things on the keys, instead of insertion order"
1026,1554411350.2701,Michael,yeah i'm consuming data from another api and need to maintain the original order which is likely sorted but not something i really want to assume and rely on
1026,1554411469.2716,Celestine,"<@Michael> Something to consider: maintain two data structures -- a fast (unordered) hash map for lookup and a vector of the keys in the order you need them. That way you can produce the ordered set of key/value data whenever you need it, but you benefit from normal hash map ops when you don't."
1026,1554411512.2722,Dann,also APIs that break if the keys in a map are in unexpected order shouldn't exist and are much more common than they should be
1026,1554411573.2728,Michael,"well its not that really, more just that the order coming back from the api is meaningful; this should be a map of less than like 10 items"
1026,1554411597.2736,Tammera,at some point I am going to write a test helper that deliberately reorders sets and maps
1026,1554411604.2741,Dann,"oh, I'm dealing with a JSON api right now where changing key order does break it"
1026,1554411607.2742,Michael,but the switch from array to hash happens between six and 10 items haha; sounds fun
1026,1554411624.2745,Dann,that's a good idea
1026,1554411664.2751,Celestine,<@Michael> How exactly is the API returning the data? JSON?
1026,1554411672.2753,Michael,yeah
1026,1554411704.2759,Celestine,I'm not sure how you're going to get from JSON to any Clojure data structure and retain the ordering from the JSON object :disappointed:; (short of writing a custom JSON parser?)
1026,1554411746.277,Michael,"well its a json array, i'm converting the json array to a lookup map for internal use and using the lookup map also as an ordering reference; basically i should probably do what you suggested"
1026,1554411890.2781,Celestine,"Yeah, I would keep the array for ordering and create a hash map for fast (unordered) lookup in that case."
1026,1554411971.2786,Michael,:thumbsup:; probably a good opportunity for some linting rules around that
1027,1554413062.2806,Antione,"<@Celestine> i puzzle a bit when I hear you're still rockin' the CFML. are you still actually using it? i surfed over to the 2018 release page and see features added like NEW: string literals and NEW: NULL support, which seems kind of crazy to me."
1026,1554413149.282,Antione,"no judgement, to each their own, just curious if there's something specifically that keeps you using it beside your familiarity"
1027,1554416280.2835,Celestine,"<@Antione> We recently retired our primary CFML app at World Singles Networks, in favor of the React.js frontend / Clojure backend we've been working on for a few years (we starting migrating sites to the new platform ages ago but we had about 100 sites to migrate so it took a while :slightly_smiling_face: ); We still have two more CFML apps -- one internal only that is already partly rewritten in Clojure, and one small external app that is scheduled for a rewrite in Clojure ""soon"".; We've been slowly migrating from CFML to Clojure since 2011 :slightly_smiling_face:; We've used a free, open source CFML engine since 2009 BTW, not the Adobe implementation. And the FOSS engine had a lot of modern features long before Adobe added them too..."
1027,1554416443.2867,Antione,gotcha. i messed with coldfusion in i wanna say 97? but i remember almost nothing about that experience.
1027,1554416501.2885,Celestine,"Ah, back then it was all `&lt;TAG&gt;`-based and a proprietary C++ engine (interpreter). Since 2001 it's run on the JVM and evolved into quite a nice dynamic scripting engine with closures and metaprogramming etc."
1027,1554416504.2886,Antione,"i was wondering if you'd pop in with: ""CFML is nice because ____________""; but sounds like it's not nice enough to not port it"
1027,1554416553.2898,Celestine,"Back in 2011, I created a library that allowed CFML engines to load Clojure code and call it seamlessly (`cfmljure` -- of course!) and that's how we've migrated away from CFML, from the bottom up.; So our CFML code can include stuff like ```			variables._fb = JavaJDBC.find_by_keys(
				core.get_in(
					application.clojure_component,
					core.vector(
						core.keyword( ""database"" ), core.keyword( ""pooled-db"" )
					)
				),
				core.keyword( ""facebook_member"" ),
				core.hash_map(
					core.keyword( ""site_id"" ), this.getSiteId(),
					core.keyword( ""member_id"" ), this.getId()
				)
			);
``` :slightly_smiling_face:"
1027,1554416626.2914,Antione,"yeah, i've been aware of that, but didn't know if the idea was to keep it around instead of using it to slowly strangle the CFML out of it"
1027,1554416644.2918,Celestine,`(jdbc/find-by-keys (get-in app [:database :pooled-db]) :facebook_member {:site_id site-id :member_id id})`
1027,1554417691.2954,Emmie,"On a previous job, we introduced Clojure in a similar fashion, we had a Java class with a main method, that would make RT calls to load namespaces and then invoke the entry point of the Clojure application.

It wasn't pretty, but it looked like a classic Java Maven app with a Clojure library :slightly_smiling_face:"
1027,1554417892.2978,Celestine,"We have about a dozen standalone Clojure apps now and a lot of the code in those apps started as ""library code"" called from our CFML code base, so it's been a very smooth migration from CFML to Clojure since we could rewrite everything piecemeal without any service impact for our customers.; And being able to REPL into running CFML apps to apply patches occasionally has also been very useful :slightly_smiling_face:"
1027,1554418783.2993,Emmie,"YES! They thought we were wizards, that application did eventually become a proper Clojure application, but the words ""functional programming"" and ""clojure"" triggered some people ¯\_(ツ)_/¯"
1027,1554431316.3005,Chandra,"Trying to use `lein kibit` with a dependency that uses `.cljc` files, getting `No namespace: foo.bar.baz found` as an error. Does anyone know how to resolve this?; I am tracing it back, `kibit` uses `org.clojure/tools.reader`, and `[clojure.tools.reader$read_namespaced_map invokeStatic ""reader.clj"" 760]` is where it is crashing, but I’m not very familiar with this reader lib, and it is not clear to me that `cljc` support is provided…"
1028,1554439911.3022,Yoko,<@Meagan> <https://mail.openjdk.java.net/pipermail/openjfx-dev/2018-September/022500.html>; javapackager distro for JDK 11
1028,1554440154.3028,Georgina,Devious; I like it
1029,1554444843.3035,Cherise,Thanks!
1030,1554446686.3056,Karren,"I've just run `jcmd &lt;pid&gt; <http://VM.info|VM.info>` in a docker container running our Clojure application on OpenJDK 11 (Ubuntu).
In the ""Internal exceptions"" section I've found a few instances of this exception:
```
Event: 4103.838 Thread 0x00007f800400c800 Exception &lt;a 'java/lang/ClassCastException'{0x00000000c78ba0b0}: class clojure.lang.Keyword cannot be cast to class java.lang.CharSequence (clojure.lang.Keyword is in unnamed module of loader 'app'; java.lang.CharSequence is in module java.base of loader
```
I couldn't find any info about this one (or what exactly the ""Internal exceptions"" mean in this context) so I'm wondering if it's something I should worry about."
1030,1554454562.309,Jaimee,"I've just encountered a strange bug:
`labels-probs (sort-by :score &gt;= (map #(do {:score %2 :label %1}) labels clean-probs))`

This was crashing for one of my inputs (`clean-probs` is a list of double) with a comparison not respecting contract error. Yet I checked the data, all the elements of the list are valid floats (just, some extremely small, goes to E-39 iirc).
So I figured I might as well do `(map #(if (&lt; % 0.001) 0 %)` to `clean-probs` and it worked, it doesn't crash anymore; But I don't understand why `&gt;=` was crashing and not `&lt;`."
1030,1554455170.3101,Sixta,<@Jaimee> your stack trace would probably be useful :slightly_smiling_face:
1031,1554455594.3107,Tiesha,sweet! :slightly_smiling_face:
1030,1554456211.3115,Jaimee,"ok I'll get it (it's not accessible anymore, but I can rollback to a commit that had this problem)"
1032,1554460085.3127,Bart,"i've got a list of tables, and would like to ""merge"" them in a way such that the new table orders them by element order, i.e; Table merging; so my three 3x2 tables turn into one 9x2 merged by element. racking my brain on how to do this"
1031,1554461358.3145,Loria,"your example shows a 9×2 result table, not 3×6?"
1032,1554461467.3147,Bart,"oh yeah, i changed the result. it should be 9x2 like it is now; so merging the nth vector in each table together in a new vector"
1032,1554461553.3152,Loria,`(apply map concat list-of-tables)` should do it; the multi-arity versions of map and mapcat can come in useful in these situations
1032,1554461613.3156,Bart,"aaaah, damn. that's nice :slightly_smiling_face:"
1033,1554464975.3162,Emmy,"does anyone know why this might behave differently in prod (heroku) to local dev?
```
(defn fn-name
  [f]
  (as-&gt; (str f) $
    (clojure.main/demunge $)
    (or (re-find #""(.+)--\d+@"" $)
        (re-find #""(.+)@"" $))
    (last $)))
```; (am using it to publish the name of a routing handler in monitoring); locally it correctly knows the function name but in prod it seems to produce `:`"
1034,1554474484.3173,Chandra,"Turns out, this is because I was using `#foo.bar.baz{:a 1}`, and I don’t think the reader knows how to handle it."
1032,1554474500.3175,Chandra,Fix was to use `{:foo.bar.baz/a 1}` instead
1035,1554479057.3177,Otelia,"Since it seems to be a pure function, it must be getting a different input param in production. I suggest printing the input param in production, and then you can use that value to reproduce it locally and debug it."
1033,1554482848.3183,Dann,"this means that some code is trying to do string operations on keywords (maybe you already know this); from your stack overflow thread:
&gt; I suppose, neither your application nor the JDK code would ever deal with a clojure.lang.Keyword
this is wrong, of course, we use keywords all the time"
1036,1554484259.3195,Lemuel,Is there a function available somewhere to abbreviate namespace/package names?  e.g.  net.eraserhead.foo.bar -&gt; n.e.foo.bar?
1033,1554484334.3206,Dann,"<@Lemuel> what's the use case for abbreviating? require with :as allows that for clojure namespaces, but there's no equivalent for java packages; `(require '[clojure.string :as c.s])`"
1033,1554484455.3219,Lemuel,"This is for logging.  I have fully qualified symbols for rule names, and I'm logging a table of fire counts.  With the full namespace, it pushes the counts off the screen.; I've seen it in logging excpetions before...  I guess it wasn't in the new pretty errors, huh?"
1033,1554489595.3238,Dann,"<@Lemuel> I know there are libraries that change default stack trace printing, and I'm sure each logging library has some way to alter how it prints packages"
1033,1554492753.3245,Shonda,<@Lemuel> that's default type behavior with logback setups. We have that here.
1037,1554493807.3264,Suanne,"I’m having a bit of trouble understanding why this code continues to realize the sequence:

<https://pastebin.com/raw/XSsdrLqS>

You can see a REPL session and clarifying question at the bottom."
1033,1554494052.3271,Meagan,"```
(filter vampire?
           (map get-details ids))
```
`filter` forces the first lazy seq created by `map` to be realized"
1037,1554494081.3274,Meagan,IIRC how it works; you'll need to use transducers if you want to chain them without realizing the whole seq
1037,1554494138.3281,Suanne,"Ok, I do not know what a transducer is at this point."
1037,1554494239.33,Meagan,transducers are a way of composing operations on lazy sequences like `map` `filter` etc.
1037,1554494272.3309,Evonne,<@Suanne> See also “chunking”: <http://www.tianxiangxiong.com/2016/11/05/chunking-and-laziness-in-clojure.html>
1037,1554494352.3322,Suanne,<@Evonne> Ah ok I think I see some chunking happening. Because if I give a very large range it only seems to realize the first 32 elements.
1038,1554495623.3326,Faustino,check this out… I wrote the Fibonacci Sequence in 3 different langs…
1037,1554495633.3329,Faustino,<https://github.com/natetech333/algorithms/blob/master/README.md>; feel free to comment on the github and improve it
1039,1554499506.3345,Rosanna,Are there any good clojure.tools.deps parallel test runners out there? Can’t seem to find any with a google search.
1039,1554499680.3349,Jasmine,<https://github.com/clojure/tools.deps.alpha/wiki/Tools> collects a bunch of stuff
1039,1554501614.3352,Rosanna,Thanks! I’d looked in there but neither of the options for clojure supported running tests in parallel unfortunately.
1037,1554502684.3368,Nedra,"has anyone ever ran `codox` from the command line, or otherwise in the absence of `boot` or `lein`?"
1040,1554508313.3382,Lura,How can I implement a protocol on a value (map with many keys) and retain the ability to update the map without losing the protocol?
1040,1554508428.3384,Dann,this is what defrecord is for
1040,1554508488.3388,Lura,"The keys are namespaced, and optional, and numerous, the type of thing you would spec; Or are you suggesting (defrecord [m] …)"
1040,1554508506.3394,Dann,"why would defrecord care about that?; what I mean, is you use defrecord to define a new map type which extends the protocols / interfaces you are targetting; it doesn't need to define any of those keys in its declaration - you are free to add any key you like; ```user=&gt; (defrecord Foo [x] Object (toString [this] (str ""foo with x:"" x)))
user.Foo
user=&gt; (map-&gt;Foo {:x 42 :bar/y 4 :z 22})
#user.Foo{:x 42, :bar/y 4, :z 22}
user=&gt; (str *1)
""foo with x:42""

``` (fixed to include a namespaced key)"
1040,1554508727.3413,Lura,"Thanks, you are right; (assoc *1 ::bar 43)
=&gt; #user.Foo{:x 42, :y 4, :z 22, :user/bar 43}

I did not expect this to work"
1040,1554508826.3421,Dann,"if you dissoc x, it downgrades to a hash-map, last I checked"
1040,1554508852.3424,Lura,"Yeah, so (defrecord [mandatory-id]…) and then we good"
1041,1554514055.3438,Elaine,"When I start <#C03RZMDSH|datomic> -ions + <#C6N245JGG|shadow-cljs> in the same repl, my JVM just freezes.
How can I debug this? I think that I'm running out of threads"
1042,1554529522.344,Sixta,"I'm using eftest; Libraries don't need to explicitly support tools.deps, they just need to be a clojure library; <https://github.com/weavejester/eftest/pull/51> might help you"
1043,1554545940.3448,Johnson,which platform does that run on? JVM can take quite a few threads so its unlikely you are running out?
1041,1554553223.345,Elaine,"It's a jvm11@linux. I'm using a i7 so there is 8vcpu.
When jvm freeze, it keep at ""0%"" of cpu usage.
When I query first, the start shadow, it keep compiling forever (web UI works, but do nothing about stop/start builds )
When I start shadow first, then query, the query freezes / lock my repl"
1041,1554554120.3452,Johnson,can you be a bit more detailed and tell me what code exactly you execute?; I have basically never seen a JVM freeze so that sounds very weird to me; but in general: why are you running shadow-cljs as part of a datomic ion? that makes little sense to me?
1041,1554554609.3458,Elaine,"It's just my dev setup. I like to keep everything in one repl.
At home I will try to make something reproducible"
1044,1554560921.3483,Sebrina,"I could use a little help designing an algorithm. How would you go about transforming between the two formats? ```{:logger {:name :logger
          :deps [:render]}
 :render {:name :render
          :deps [:store]}
 :store {:name :store
         :deps [:router]}
 :router {:name :router
          :deps []}}

;; Would like to format as:

[[:router []]
 [:store  [:router]]
 [:render [:store]]
 [:logger [:render]]]
```; I implemented a gross solution in JS by first transforming the input into `{:router {:store {:render {:logger {}}}}}` then walking it again to build a list like the bottom. However, I feel like I’m making it messier\more complicated than it needs to be."
1044,1554561448.3516,Guy,"I am using the <https://github.com/metosin/compojure-api/wiki/Component-integration#using-closures> but how does this work in development env? In the case of `defroutes` it is a var and evaling(c-x c-e) changes just works. In the case of closure, I have to keep restarting the server."
1044,1554561673.3517,Fatima,"```
(reduce-kv (fn [res k v] (conj res [k (:deps v)])) [] input-map)
```; ```
(mapv (fn [[k v]] [k (:deps v)]) input-map)
```; ```
(mapv (juxt first (comp :deps second)) input-map)
```"
1044,1554562620.3524,Alleen,this doesn't give the right order <@Fatima>
1044,1554562653.3526,Fatima,"Ahh, order matters?"
1044,1554562689.3528,Alleen,"I guess so, but can't speak for the OP; the problem being solved here is topological sorting; there's generic solutions e.g in loom <https://cljdoc.org/d/aysylu/loom/1.0.2/api/loom.alg#topsort>"
1044,1554562920.3535,Fatima,"Ahhh, I thought it was simply transforming data format to another, which is quite trivial though. It’s likely that I didn’t get the point from the example. :slightly_smiling_face:; But yeah, now looking at it it makes sense. I’d maybe look how integrant or component does that."
1044,1554563046.354,Alleen,the algorithm is not very complex so it's not rare too see ad-hoc implementations in libraries having to do some kind of dependency resolution
1045,1554564374.3588,Tonya,"<@Guy> Component out-of-the-box needs a little setup to have it work well in a hot-reloading environment. I'm assuming you're using CIDER + Emacs, my setup defines reloading functionality for component called user/reset in dev/user.clj. Then I have key chord C-x C-r setup to call user/reset, which refreshes component. It works perfectly. For example, I could define some new functionality for a closure, test it with C-x C-e, and then hit C-x C-r to see the changes appear.; <@Guy> This isn't my own idea it's based off the article: <http://thinkrelevance.com/blog/2013/06/04/clojure-workflow-reloaded>. Though the article won't get you all the way, if you follow through it and tinker with your emacs config for a bit, you'll be able to find a good solution. If you want to check out my .emacs config file I can send it over in a private message."
1045,1554564707.3602,Guy,<@Tonya> Thanks for the link; I doing the same thing. I though there could be a better way since I have to keep firing (reset) all the time.
1045,1554564976.3627,Tonya,"<@Guy> yeah I hoped as well, if you find one message me about it. Though I think it's unsolvable due to components use of protocols.; Here's my elisp code for resetting component."
1045,1554565732.3644,Sebrina,"Oops sorry for not being clear but yes, order does matter.; Thanks for the help, finding out the name of the algo for it is a ton of help!"
1045,1554569381.3657,Guy,<@Tonya> <https://github.com/clojure-emacs/cider/blob/master/doc/miscellaneous_features.md#reloading-code>; <https://lambdaisland.com/blog/2018-02-09-reloading-woes>
1046,1554569496.3662,Guy,None; worked
1046,1554569652.3675,Tonya,<@Guy> so this will save and refresh component every time you reset buffer?
1045,1554569656.3677,Tonya,Thank you for the link.
1046,1554569674.3682,Tonya,Also what happens when there are errors in the saved buffer?
1046,1554569959.3685,Guy,"<@Tonya> you can turn the logger on `*cider-ns-refresh-log*`; now I change my code, do C-M-r, that does the magic."
1047,1554574048.3713,Sonny,"Is it possible to compose aliases in deps.edn? For example, if my `~/.clojure/deps.edn` contains a test alias (adding test directory to the path) and a cider alias (adding some cider libs), can I create a dev alias in my main project deps.edn which says, ""switch on the test and cider aliases when dev is used""?"
1047,1554574100.3715,Meagan,I don’t believe so; you can add them both in the args. e.g. `-A:test:cider`; but you can’t create aggregates; that would combine them by name like `-A:test-cider` like you’re saying
1047,1554574478.3764,Sonny,"Ok, thanks. What I was really trying to do here was to configure cider to start with the dev alias by setting `cider-clojure-cli-global-options` to `-A:dev` and then configure the dev profile on a per project basis. I suppose I can either just put all of the config in the project dev alias (little duplication, but nothing too worry too much about), or get into `.dir-locals.el` stuff, though emacs seems to complain about setting this the `cider-clojure-cli-global-options` variable in dir locals. Apparently it ""may not be safe"", but I am not sure exactly what determines that. Probably simpler to do the first thing I suppose."
1047,1554574527.3767,Meagan,yeah. it’s super annoying to set those options right now in CIDER; we should open up a ticket; I hate that message that pops up everytime I open a new file :anguished:
1047,1554574625.3784,Sonny,"It does seem to give me an option to say, ""Mark this variable as safe in the future"", but I am not sure I understand _why_ it is unsafe. Something makes me anxious about overriding a message like this without fully understanding it :slightly_smiling_face:"
1047,1554574651.3787,Meagan,one of the things I’ve noticed is sometimes those settings bleed between projects
1047,1554574679.3791,Sonny,"Ahhh... yeah, that would be a little unsafe I guess :slightly_smiling_face:"
1048,1554578632.3808,Becki,If you cider jack in with a prefix argument you can edit the actual startup form. Makes it easy to tweak those without knowing which config to set
1048,1554579027.3811,Meagan,I just want to `SPC m '` and not think about it :upside_down_face:
1049,1554582143.3833,Nieves,Hello. I want to present you yet another nobody needed Clojure gebugging library :slightly_smiling_face: Which channel would be right for it?
1050,1554583790.3838,Aubrey,<#C06MAR553|announcements> ?
1049,1554583861.3846,Nieves,"maybe, I'm not sure. thanks, I'l post it there"
1051,1554610815.3855,Donetta,quil looks neat - reminds me of SDL - is there anyone out there combining openjfx + quil in some way? (maybe with the new cljfx lib?)
1052,1554613747.3858,Rosanna,This is great. Thank you.
1053,1554651972.3885,Valrie,"hey folks, just out of curiosity, why the indentation on clojure source code is so weird ? for example <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Ref.java>"
1051,1554655145.3903,Rosaline,"it is the style rich prefers, any in some places other slightly different formatted code has been patched in, and in general rich doesn't like patches that just fiddle with formatting; I forget the name of the style; it is vaguely similar to <https://en.wikipedia.org/wiki/Indentation_style#GNU_style>"
1051,1554655326.3914,Valrie,even gnu style has some indentation
1051,1554655374.3921,Rosaline,"that is why I said vaguely similar, I forget if it is exactly one of the named styles, or just an idiosyncratic style rich picked up; maybe more like whitesmith's above it"
1051,1554655454.3928,Valrie,it's weird; ofcourse it should looks fine to the author
1051,1554655504.3942,Rosaline,"it is not a modern style, sure; although, I guess what people usually use these days is basically k&amp;r style which would hardly be called a ""modern"" style"
1051,1554655642.3957,Valrie,yeah but i never saw a style with no indentation. it just drive the programmer crazy i guess
1051,1554655798.3979,Rosaline,"Compiler.java is way worse on that front, because of patches with slightly different styles, and sometimes rich will put a block (like an if condition) around some code without re-indenting it, which I guess maybe makes diffs easier to read? I dunno; I think maybe the compiler even mixes tabs and spaces due to patches"
1051,1554655877.3989,Valrie,"hmmm i'm kinda disappointed, i expected much more from clojure in this regard"
1051,1554655920.4003,Rosaline,"it is there, it works well"
1051,1554655971.4016,Valrie,"yeah , but it discourage other people to contribute or even read the code, and honestly clojure is not doing well in documentation so for some stuff you have to look at the code"
1051,1554655985.4018,Rosaline,then go write some docs
1051,1554656026.403,Valrie,"yeah i know, but as far as i talked with people, clojure is not welcoming in regard to documentation specially in source code level"
1051,1554656036.4034,Rosaline,"you are upset that someone did work and made it available to you for free, and you don't like the internals of it?"
1051,1554656074.4041,Valrie,no i'm upset because clojure contribution policy is not friendly enough to people who willing to help
1051,1554656089.4047,Rosaline,"that is complicated; rich has different priorities from other people, and it is his party, so other people are unhappy about his decisions"
1051,1554656126.406,Valrie,"i'm reading the code anyway for my own sake, why not to fix it as i go along and even right some comments in the source code for the next guy ( which i common ) but yet ....; you know, i'm wondering how other programming languages handle this situation  ?"
1051,1554656230.4086,Rosaline,"basically, you say ""willing to help"" but rich disgrees that help is needed or wanted in that direction (or that he wants to spend time managing the ""help""), and that is taken as being hostile to contribution"
1051,1554656248.409,Valrie,"and at the end of the day it is simple, a guy like me make some patches and you as the author merge it if you like it and ask for change if you don't like it"
1051,1554656267.4093,Rosaline,there is a third option there of course; just ignore you because I have other things to do; both of your options make a demand on the time of the author
1051,1554656302.4105,Valrie,yeah unfortunately that's the current situation
1051,1554656315.4109,Rosaline,"to merge your work, or engage in dialog with you about it"
1051,1554656331.4115,Valrie,but that's how free/open source software works
1051,1554656355.4121,Rosaline,"that is complicated; it is easy to see why you (or I) might prefer one of those two options, but it requires the maintainer of the project to pour even more time in to their project, and be managing contributions instead of developing their project"
1051,1554656472.4139,Valrie,"i can see your point, but it's not a new problem"
1051,1554656487.4144,Rosaline,of course not
1051,1554656491.4146,Valrie,there are bigger projects that have the same problem.; linux kernel for example; it's massive but they handle it much better that clojure; i guess clojure core team can do a similar thing; after all contribution can lead to good things
1051,1554656586.417,Rosaline,the linux kernel actually has companies that employee people entirely to work on it
1051,1554656611.4177,Valrie,yeah but they way they handle contribution is good
1051,1554656634.4185,Rosaline,"because they have the resources to devote to it; clojure is many orders of magnitude smaller, and has, I think no full time resources whatsoever; maybe one person; but it isn't rich's job"
1051,1554656755.4214,Valrie,"hmmm, it isn't rich's job, but at the same time he is the one that has the final saying on it; you can see the problem , right ?"
1051,1554656793.4225,Rosaline,"but you also see how it isn't a problem for rich, right?"
1051,1554656802.4227,Valrie,yeah; that's why i'm saying what linux does make sense here
1051,1554656820.4233,Rosaline,it doesn't; organizational structure isn't free
1051,1554656871.4249,Valrie,"it does friend. in linux, Linus has the final saying, but there is subsystem who has several leaders who are responsible for managing the contributions and patches; clojure can do the same"
1051,1554657016.427,Rosaline,"linus for example says he trusts most of the subsystem maintainers because he has been working with them for 5-15 years, clojure is 11 years old at this point; linus also spends most of time still managing those contributions"
1051,1554657056.428,Valrie,yeah but even now there are people around rich who at least i know they are very involved with clojure
1051,1554657086.4285,Rosaline,"and linus is, as far as I know, paid to work on that fulltime"
1051,1554657101.4291,Valrie,yeah he is
1051,1554657185.4299,Rosaline,"it would be great if rich could work on clojure fulltime; he did spend maybe one or two years at the start(before it was made public?) working on it fulltime living off of his savings; which, in my experience, feels terrible. so I completely understand reluctance to be in a similar situation again."
1051,1554657355.4325,Valrie,"i can understand every thing you said; but at the end of the day I'm pretty sure community will be helpful here, if he let them."
1051,1554657429.4342,Rosaline,"but it isn't that simple; ""the community"" wants a bigger stake in it, and wants rich to do more work, but the community hasn't bothered to figure out how it is going to pay him"
1051,1554657529.436,Valrie,i agree
1051,1554657584.4368,Rosaline,"just figure out the latter part, the former part is nothing, as you say there are plenty of examples, etc to follow there"
1051,1554657666.4383,Valrie,"hmm i'm not sure what you meant by ""but the community hasn't bothered to figure out how it is going to pay him"""
1051,1554657702.439,Rosaline,"until then, it doesn't surprise me that when people charge in demanding change at the center nothing happens, but when people go out and build what they want without trying to make it some official project, good things happen (clojuredocs, this slack); I mean this is an exchange right? you are demanding an awful lot without figuring out first what you are willing to exchang to get it"
1051,1554657769.4402,Valrie,hmmm i don't know about that
1051,1554657790.4408,Rosaline,you want something right?
1051,1554657795.4411,Valrie,"I'm not demanding anything, I'm offering"
1051,1554657811.4417,Rosaline,but you are not happy when your offer isn't taken?
1051,1554657821.442,Valrie,"the source code has a problem, or somebody else has a good idea to add to clojure,; it's not a demand though"
1051,1554657852.4435,Rosaline,"but rich disagrees that it is a problem or that it is a good idea, or doesn't have the time to review it so ignores it"
1051,1554657853.4436,Leticia,what  could be  the reason  for  httpkit to throw timeout  exception  on  a perfectly healthy request?; curl works just fine
1051,1554657899.4449,Rosaline,"people basically don't make offers like a queue though; if you offer to a queue, it either takes it or it doesn't; people make an ""offer"" and it is a demand on the attention of the person the offer is being made to; and people get offended when their ""offer"" is summarily rejected; so when people make an ""offer"" it is clearly more of a ""demand""; and then their ""offer"" is summarily rejected, they want the process to change in some way"
1051,1554658094.4521,Valrie,"hmmm, it doesn't seem right"
1051,1554658135.4542,Rosaline,"basically what it comes down to is you want the process to change, rich is comfortable with the current process, and you won't offer him anything to induce him to change it"
1051,1554658159.4551,Valrie,"for example, i can read the code, after some struggles to understand it, i can just do my thing and forget about it"
1051,1554658161.4552,Marcia,":100: :point_up:to everything <@Rosaline> said; &gt; It’s complicated; <@Rosaline> also brings up another good point <@Valrie> -&gt; if you see a certain benefit to changing the indentation / docs, why not make a separate project that will auto-indent Clojure core (ala `gofmt`)? That way, anybody interested can use your new tool, while it in no way breaks existing JIRA patches, etc. and doesn’t take up mental/time bandwidth of people who are not concerned about the indentation."
1051,1554658226.4577,Valrie,I can ignore it but i can spend some time on it  ( for free and without any demand ) and make offer some improvements.
1051,1554658253.4584,Rosaline,"I think some kind of annotated source for clojure would be really great, I have a branch on my fork of the clojure repo on github where I started something like that, many years ago, but just didn't have the time/attention/whatever to finish it and keep it up; improvements from your point of view"
1051,1554658307.4599,Valrie,"yes, but i'm not going to merge it you  know, like many other open sources projects, people can review it; it's so simple; clojure is not a special case or anything, it's not the first FOSS project facing this problem nor the last one; but there is a point to learn from history of other projects; how they handled this case ?"
1051,1554658407.4631,Rosaline,"that is your perspective on it though, you see it has some kind of natural progression of a project"
1051,1554658424.4634,Valrie,"<@Marcia> you have a point, but it doesn't summarized only in indentation"
1051,1554658469.4648,Rosaline,or keep an up to date branch with lots of comments that is so valuable that everyone references it all the time
1051,1554658546.4666,Valrie,yeah i don't think me adding code to my own fork without review would be valuable for others to refer to
1051,1554658583.4675,Rosaline,but you are willing to ask rich to maintain your comments
1051,1554658594.4679,Valrie,"no,"
1051,1554658602.4684,Rosaline,that is what your pr would be
1051,1554658608.4686,Valrie,anyone who knows about clojure or an specific subject can review them
1051,1554658618.4689,Jasmine,"Let me make it really easy. This is not something that Rich or I want to spend time on, including spending time to explain or debate why we don’t want to spend time on it. We realize this probably makes some people unhappy. "
1051,1554658682.4692,Valrie,"thanks; good use of ""end of discussion"" :laughing: (joking)"
1051,1554658788.4715,Jasmine,Feel free to discuss all you like :)
1054,1554658857.4728,Rosaline,"I think it is to some degree very telling, that none of the proposals are like ""hey, rich laid a gold egg in clojure, how do we get him nice and happy and continuing to give us more eggs"" and are all like ""that goose that laid the golden egg is in the way of me doing what I want, how do we change the process so I can do what I want"""
1051,1554658890.4736,Rosaline,"we can keep discussing it, because, for example, this slack isn't run by rich or alex; someone in the clojure community thought it would be neat and made it"
1051,1554658945.4748,Valrie,"yeah but there is no point discussing it; contribution is something that people in charge have to care about it to begin with; us talking, wouldn't change anything"
1051,1554658986.4763,Rosaline,in charge of what?
1051,1554658995.4767,Valrie,source code and clojure in general
1051,1554659052.4775,Rosaline,"clojuredocs, for example was started and run for a long time without any connection with rich or ""the people in charge""; (it may still be, I am not sure)"
1051,1554659198.4801,Valrie,"hmmm what can i say, clojure ""project"" is not in any way special in compare to other FOSS projects. I'm pretty sure other projects faced the same issue. We ( i don't think i can say we anymore ) can either learn from them and open the door to other people who wants to help or can keep going like this and hope for the best.; I hope that I'm wrong and the current workflow is the best way to do it"
1051,1554659384.4828,Rosaline,"No project starts that way, so the question is, at what point did all the projects you are suggesting as examples change to allow for more delegation, and I would be shocked if that doesn't coincide with the fortunes of the original creator becoming more secure (via sponsorship, or patronage)"
1051,1554659482.4849,Leticia,"i feel out of place with  my  down to  earth  questions, but  here’s another one: anybody had this problem when  &lt;!! while blocked would prevent the shell  from responding to os sugnals, like ^C?"
1051,1554659485.485,Valrie,i don't know what to say anymore friend. you're putting a question mark on top of lots of FOSS software out there
1051,1554659594.4861,Rosaline,"no, I am just suggesting that if you want to see change the thing to work on is some way to pay rich and others to work on clojure fulltime, not lobbying them to change their process without offering anything in return; <@Leticia> the behavior will depend a lot on the repl you are using; for example nrepl repls are typically split in to client and server jvms, where you code is actually execute on the server jvm"
1051,1554659717.4893,Valrie,"ok so you're saying that i should spend my time improving the code base, and pay the core members to consider my contribution ?"
1051,1554659724.4895,Rosaline,so ^C on the client jvm may not do what you want
1051,1554659739.4901,Leticia,it’s lein repl in a shell on macos; pretty  default setup i think
1051,1554659763.4906,Rosaline,"<@Valrie> again, improving in your point of view; you've already made the judgment that your changes are good, so if they are not considered or not well received something is wrong"
1051,1554659864.4925,Valrie,"no, i didn't say that; as i mentioned before ""reviewing the changes"" is really important"
1051,1554659886.4934,Rosaline,you have used the word improve or improvement over and over again
1051,1554659944.4952,Valrie,hmmmm i don't know any other word to use in this context
1051,1554659962.4956,Rosaline,"you are have a set of changes you would like someone to spend time reviewing and determining if they represent an improvement, and if the improvement covers the cost of maintenance; that is review is valuable work, for example it is part of the job I am paid to do"
1051,1554660013.4972,Valrie,hmmm you're missing the point of FOSS
1051,1554660038.4979,Rosaline,is the point of foss that when you do work for free you get to demand that other people do work for free?
1051,1554660059.4985,Valrie,did i as for money ?
1051,1554660069.4991,Rosaline,I didn't say you did
1051,1554660070.4992,Valrie,or did anybody asked anything in return ?
1051,1554660091.5005,Rosaline,I said you did work for free (your set of changes) and you are demanding that others do work for free (review those changes)
1051,1554660107.5009,Leticia,"speaking of code improvements and reviewing - linus had stopped looking at other people’s code directly  long time ago, he would only  pull updates from few trusted top-level maintainers. there’s just too many “improvements” everybody would like to suggest and only  24 hours in a day."
1051,1554660200.5022,Rosaline,"I would suggest you are missing the point of f/oss, in that the entire point is to give your the source to empower you to make the changes you want, it says nothing about forcing upstream to take in your changes; to quote the fsf's definition ""“Free software” means software that respects users' freedom and community. Roughly, it means that the users have the freedom to run, copy, distribute, study, change and improve the software."""
1051,1554660380.5038,Valrie,hmmm we have a different perspective then
1051,1554660494.5051,Rosaline,if your perspective is at odds with the fsf's view on the definition of free software then I wonder where it comes from
1051,1554660509.5056,Tammera,"Lein repl uses nREPl, so that should be interruptible "
1051,1554660710.5095,Valrie,i believe in free software and everything in fact i'm a gnu contributor. but the way clojure source code is going forward is far from community base development. you're saying rich's time is important and other people have to pay him to review their changes which are made out of the desire to help
1051,1554660937.5129,Rosaline,"I am not say they have to, I am saying your perspective is completely ignoring the fact that he is a finite person and needs to work to live, and you are make demands on his time without in turn offering anything to him"
1051,1554660988.5143,Valrie,"i'm aware of that, what i'm saying is ""it's not have to be like it"""
1051,1554661036.5154,Rosaline,"and I am saying that change is also something that takes review and work to achieve, and you are asking for it without providing any inducements; (changes to code, and changes to organization); everyone wants to suggest changes, no one wants to provide a means to support those changes"
1051,1554661179.5167,Valrie,what type of support ? financial ?
1051,1554661187.517,Rosaline,"basically, yes"
1051,1554661208.5177,Valrie,"that's where we are different; If i had a company that uses clojure , I wouldn't hesitate to sponsor clojure; in some degree"
1055,1554661287.5205,Rosaline,"like, it is easy to say, ""hey linux has this structure, we shuld copy it""  but no one has said ""hey, the X key figures in linux development are supported in ways Z, W, and Y, how can we do that for the X key clojure figures so clojure can have a process like linux's"""
1051,1554661289.5206,Valrie,but you shouldn't expect people to pay money to the author in return for considering some patches
1051,1554661312.5208,Rosaline,why not though?
1051,1554661371.5226,Valrie,because the fact that i spend my free time working on clojure to help it grow ( even if i'm the only one thinking like this ) is enough. I have to live as well.; i want to help others by any mean.
1051,1554661414.5241,Rosaline,"rich has already, as discussed, spent years of doing that fulltime, and continues to do that (but I guess not fulltime)"
1051,1554661423.5245,Valrie,if every FOSS project start charging thier contributors there would not be any FOSS project left anymore
1051,1554661434.5248,Rosaline,so why can you demand he give more of his free time to review your change?
1051,1554661497.5259,Valrie,what i'm saying is that like other project the author can trust some people and let them deal with these kind of stuff. or even; like many other projects a third person can review the change first and leave his review; it's not have to be just one person
1051,1554661536.5274,Rosaline,"what I am saying is you are doing the same thing again, just at another level removed; e.g. from the code level to the social/org level"
1051,1554661920.5305,Valrie,"anyway, we were discussing something that is not going to change."
1056,1554663580.5314,Marguerita,"hey, does Clojure have a big boring web framework yet? something like Django or Rails"
1056,1554663624.5319,Valrie,as far as i know luminus is the closest to what you're asking for
1056,1554663951.5323,Marguerita,"thanks, I'll check it out :)"
1056,1554664686.5326,Jasmine,Coast is a new thing like that
1057,1554671182.5334,Malik,"is there an equivalent in clojure for elixir's IO.inspect? <https://hexdocs.pm/elixir/IO.html#inspect/2>; something that prints the representation of a value and then also returns that value, so you can inject it in chains of calls to inspect values; I wrote my own but I figured there might be some way that already exists; ```(defn- inspect
  ([v]
   (println v)
   v)
  ([message v]
   (println message v)
   v))
```"
1057,1554671260.5348,Meagan,i wish :upside_down_face:
1057,1554671303.5355,Malik,I guess we're always cursed to miss things from other languages
1057,1554671312.5358,Meagan,I write it in almost every project.; I wish that’s what `tap&gt;` did
1057,1554671409.5366,Malik,"organization-wise, do you keep like a util namespace in your projects for this sort of thing?; there are a bunch of simple useful things like this that I find myself adding"
1057,1554671472.5376,Meagan,"i usually just define it kind of ad-hoc since I usually only need it while debugging; in one of my projects I have it in a common `test.utils` ns because the test runner rarely prints helpful things, so I use it for finer-grained debugging in my tests"
1057,1554671551.5387,Malik,ahhh ok; thanks; that sounds reasonable
1058,1554674347.5402,Tammera,<https://github.com/clojure/tools.trace>; Is that what you are looking for ^^?
1059,1554681829.545,Suanne,"Can someone help me understand if I have found an error in Brave Clojure?

It gives an implementation of `partial`:

```
(defn my-partial
  [partialized-fn &amp; args]
  (fn [&amp; more-args]
    (apply partialized-fn (into args more-args))))
```

I wrote this function to use with it:

```
(defn print-args
  [&amp; args]
  (loop [index 0]
    (println (format ""arg #%d: %s"" index (nth args index)))
    (if (&lt; index (dec (count args)))
      (recur (inc index)))))
```

But it doesn’t seem to behave like the built-in `partial` and gives arguments out of order:

```
=&gt; ((my-partial print-args ""Today"" ""was"" ""a"") ""good"" ""day"")
arg #0: day
arg #1: good
arg #2: Today
arg #3: was
arg #4: a
nil
```

As opposed to:

```
=&gt; ((partial print-args ""Today"" ""was"" ""a"") ""good"" ""day"")
arg #0: Today
arg #1: was
arg #2: a
arg #3: good
arg #4: day
nil
```

I don’t understand why this happens because the implementation of `my-partial` seems correct to me. I don’t understand why the arguments are given out of order. The relevant line is `(into args more-args)`."
1060,1554682261.546,Meagan,`into` uses the semantics of whatever collection it’s collecting into. `&amp; args` is a seq
1060,1554682304.5469,Suanne,<@Meagan> And seqs have stuff pushed onto them?
1060,1554682311.5471,Meagan,"so when elements are added to the `args` seq, it adds them to the head; yeah"
1060,1554682354.5477,Suanne,<@Meagan> Hmm. So the implementation in the book is actually wrong?
1060,1554682373.5479,Meagan,could be
1060,1554682482.5485,Suanne,"<@Meagan> Here is the usage example in the book:

```
(def add20 (my-partial + 20))
(add20 3) 
; =&gt; 23
```

This example works because addition is commutative, right? So either the author flubbed it or purposefully didn’t complicate the implementation and purposefully used a simple example where order didn’t matter."
1060,1554682498.5487,Meagan,"also they’re not using many args; but yeah, pretty much; I’m guessing it’s a mistake"
1060,1554682576.5502,Suanne,Yeah I would hope so because I’ve sank way too much time into trying to understand why I don’t get it. It’s probably a mistake.
1060,1554682677.5509,Meagan,I think the easiest fix is to change `into` -&gt; `concat`
1060,1554682814.5511,Suanne,"Yes, that does the trick!; Thanks for the help.; <@Meagan> I was about to submit a message to the repository of the book but it has dozens of issues and pull requests that haven’t been addressed in years, doesn’t seem worth the time. Now I’m starting to doubt the quality of this resource. But it’s been helpful so far so I guess I’ll stick with it a bit longer."
1060,1554689668.5534,Harold,maybe you can repeat your question in the ghost town that is the <#C0FM7N1SM|quil> channel .
1060,1554692490.5541,Shonda,"<@Suanne> it's a good resource, stick with it."
1061,1554711508.5554,Clarine,"I’m trying to use `print-stack-trace` with GraalVM, but that doesn’t work since it has reflection issues (which can be resolved using type hints); I’ll post a JIRA; <https://dev.clojure.org/jira/browse/CLJ-2502>"
1062,1554715200.5581,Margit,Does anybody know what is the motivation for having single-argument `=` arity in Clojure which always returns `true`? Is this a technical detail or is there a mathematical reason for it?
1063,1554721236.5613,Jeannette,"how to spec a hashmap, whose keys are not specs themselves? say I need to provide spec for a hashmap whose keys are string literals and not keywords?  should I be using something other than spec/keys?; I am using a multimethod that dispatches based on deriving the spec of an incoming message.; should I just roll my own spec (with contains?) or is there something in the std library or a simple way of working with spec/keys that i am not aware of?"
1064,1554723936.5652,Loria,"I suppose it's so you can do things like `(apply = coll)` to mean ""are all elements in `coll` equal?"" without having to treat the trivial 1-element case differently"
1062,1554724134.5655,Margit,"However, you still have to handle 0-element case explicitly, so I don't know if the victory is huge here."
1064,1554724193.5657,Loria,"yeah, I was about to say that ""mathematically"" it makes sense to have a 0-argument arity that always returns true also"
1064,1554724218.5659,Margit,I'm not sure it is obvious what 0 or 1-argument `=` should return.
1064,1554724253.5662,Loria,but it might be problematic to have `=` not be the complement of `not=`
1064,1554724290.5664,Margit,"`not=` is derivative from `=`, it just follows suit"
1064,1554724312.5666,Loria,"I think of `=` as saying ""are my arguments all equal?"""
1064,1554724314.5668,Margit,"However, `(not= 1) =&gt; false` makes even less sense to me.; &gt; I think of `=` as saying ""are my arguments all equal?""
Are equal to what?"
1064,1554724334.5672,Loria,to each other
1064,1554724341.5674,Margit,What if there is no other?
1064,1554724363.5676,Loria,"then it's trivially true; same reason why `&lt;` has a 1-argument arity; which should make even less sense unless you think of it as saying ""are my arguments all in ascending order?"""
1064,1554724448.5683,Margit,"What you describe is actually different, it's ""Doesn't the collection contain distinct elements?""; There is a place for a function that behaves like that, but it's a stretch to link that and `=`; &gt; are my arguments all in ascending order?
That interpretation of &lt; makes sense, so I don't question it."
1064,1554724684.5689,Loria,"well, the alternative would be to throw an exception, which makes things harder to reason about; I think it's also convention among other lisps to define `=` in this way"
1064,1554724806.5693,Margit,"In contrast, it would catch mistakes like `(= value #_missing-comparison)`.; &gt; I think it's also convention among other lisps to define `=` in this way
Yeah, that is a valid argument.; However, all from eq/eql/equal variety expect exactly 2 arguments."
1064,1554725481.5711,Jasmine,"You could use s/conformer to keywordize, then use s/keys; Right now, we don’t have anything to specifically support keys as strings"
1064,1554725951.5721,Jeannette,thx
1065,1554732463.5741,Mariela,"```
&gt; (-&gt; '[^int? ^some? a] first meta)
{:tag int?}
```

Is `^some?` swallowed (lost) here?

(I realise it is not expected to pass functions as metadata, but I'm developing a little sth)"
1065,1554732616.5754,Harris,"well, `^foo bar` is the same as `^{:tag 'foo} bar`, and `^foo bar baz` is the same as `^{:tag 'foo} ^{:tag 'bar} baz`, which is semantically `(with-meta (with-meta baz {:tag 'bar}) {:tag 'foo})`; so it's not ""lost"", you're overriding it; (same as doing `(assoc (assoc {} :foo 1) :foo 2)`)"
1065,1554732720.5765,Deb,I think the tools.logging library has a functions like that called `spy` and `spyf`. <@Malik>
1066,1554732937.577,Deb,"<@Valrie> Maybe the author was traumatized by OOP, and in order to repress the painful memories, indents the code as if the `class` line does not exist."
1065,1554732965.5772,Mariela,Great expl! Thanks
1067,1554734871.5779,Latonya,"If you wanted to start a repository that was a fork of the Clojure source code, retaining its original license, and added comments and reformatted code, and added documentation, you may be able to find others interested in answering questions or providing review comments, or even contributing to such a repository.  It seems unlikely that Rich Hickey would be one of the people willing to spend time on that project, though.; There are other people besides Rich who know at least parts of that implementation quite well."
1068,1554735467.5783,Malik,"ahhh cool, very similar to what I want"
1067,1554735494.5785,Valrie,Yeah i wanted to do that but kinda think that the problem is in people's view of the whole thing
1068,1554737445.5793,Wilford,"I’m trying to pass a custom deftype over a core.async channel, and it seems to coming out of the other side as a seq, losing its type information and structure.; Is this a known thing, or is there something I’m missing?"
1068,1554737537.5799,Jasmine,doesn't ring a bell
1069,1554737747.5801,Jasmine,"```user=&gt; (require '[clojure.core.async :as a])
nil
user=&gt; (deftype Foo [x])
user.Foo
user=&gt; (def c (a/chan 1))
#'user/c
user=&gt; (a/&gt;!! c (-&gt;Foo 1))
true
user=&gt; (def c2 (a/&lt;!! c))
#'user/c2
user=&gt; (class c2)
user.Foo
user=&gt; (ancestors (class c2))
#{clojure.lang.IType java.lang.Object}
user=&gt; (.-x c2)
1
```"
1068,1554737753.5803,Jasmine,looks fine to me with a simple test
1068,1554737832.5806,Wilford,"Yeah, I think I’ve worked it out; this particular deftype implements ISeq; That seems to be enough for it to treated as one — if I remove that implementation it makes it through intact"
1068,1554737904.5819,Harris,I think I know what's going on; can you give me a small repro for this?
1068,1554737985.5824,Wilford,"hold on; <https://gist.github.com/clarkema/48da41fb5cf720f7f5bbba2428d5299a>; try that as is, and then comment out the iseq implementation"
1068,1554738303.5832,Harris,"ty; yeah so this is not what it appears to be ;); ```user=&gt; (-&gt;Segment 0 :foo [1 2 3])
(1 2 3)
user=&gt; (class (-&gt;Segment 0 :foo [1 2 3]))
user.Segment```; nothing at all with `core.async`; it's just that print-dup gives priority to `ISeq` over `IType`; so the object is printed as if it was a seq; print-dup or whatever is responsible for printing here, I can never remember what does what; one of those multimethods anyway"
1068,1554738445.5856,Wilford,hmm
1068,1554738456.5861,Harris,which is weird because I thought there were appropriate prefer-methods; let me check
1068,1554738461.5865,Wilford,this actually cropped up because I’m trying to match on it (using core.match) on the other side of the channel
1068,1554738497.5872,Harris,"looks like the prefer-methods is just for records, not types"
1068,1554738509.5876,Marlyn,printing what you took out of the channel can make it look like types are being lost; but they're not
1068,1554738599.5887,Wilford,"yeah, it does still have the correct type; so something else is being weird"
1068,1554738626.5896,Harris,well you've told clojure that Segment is a seq so it's printing it using the seq printer; arguably not the best behavior but that's how it works now; if the type is definitely getting lost maybe you have something that tries to pr-str/read-string the value?
1068,1554738709.591,Wilford,it’s possible that it’s actually to do with the match treating it as a seq
1068,1554738728.5912,Harris,likely; you should probably make that type seqable instead of a seq directly if you can
1068,1554738841.5918,Wilford,I think I can live without it being a seq; it was mostly for completness; Kind of a weird interaction though; thanks
1070,1554742274.5935,Becki,I guess that explains why a lot of things implement a “to seq” style rather than directly implement seq ; I remember a comment in core match about destructing problems since the types implemented both seq and assoc protocols
1068,1554744142.5951,Dann,"if you use `Control-\` or use jstack you can trigger a dump of the stack traces of all running threads. My hunch is that something is running and not getting expected input.; If it helps, this is very close to being an adjacency-list / tree transform, which is well studied and well documented. And loom itself has code that turns a tree into an adjacency list and visa versa (every tree can be converted to an adjacency list, an adjacency list can only be converted to a tree if its graph is non-cyclical, directed, and each node has only one incoming link)"
1068,1554745243.5971,Harris,"yes, the general advice is to make types ISeqable instead of ISeq, when you care about them being more than simple seqs; which doesn't really make the type less powerful since most collections operate on seqables instead of just on seqs"
1068,1554749051.5986,Sebrina,Thanks <@Dann>. Learning the term helped me find a section about it in an algorithms text book I impulsively bought but never used. After reading that section then watching a youtube talk on topological sorting I was able to implement a depth-first-search topological sort for directed-acyclic-graphs on my own :smile:
1068,1554749078.5988,Dann,"nice; adjacency-lists are especially useful in a language with immutable data structures, as they allow cycles and complex nested updates without doing a tree worth of mutations"
1068,1554749307.5992,Sebrina,"Ah that makes sense, the book’s solution used an AdjacencyList but it also used a mutable list to track what was visited. I’m not quite sure how to handle that part in an immutable language without something like an atom.; Actually I take that back. The recursive function would need to return the updated sorted list and the updated visited list is all."
1068,1554750081.5996,Dann,"precisely - we can use normal updating / recursion tricks, and it's simplified since it's flattened"
1071,1554756026.6024,Margit,"Did anyone ever have a problem that JVM doesn't flush SoftReferences even when the heap is 99% occupied, and everything is spinning in FullGC most of the time? I'm using hot Java recompilation heavily which inflates DynamicClassLoader's `classCache`, and it never clears."
1072,1554757248.6031,Rosaline,the simplest explanation is your soft refs are being held strongly somewhere
1071,1554757931.6036,Margit,"Nope, they are not. Explicitly triggering OutOfMemoryError clears them out."
1073,1554758128.6039,Jasmine,well DCL only clears cache when you define a new class; due to Java recomp are you never defining new classes?; and thus never triggering a clear?
1073,1554758234.6051,Margit,"&gt; due to Java recomp are you never defining new classes?
It's the opposite, I define new classes all the time with `defineClass`.; I'm using Virgil, here's how a class gets defined there: <https://github.com/ztellman/virgil/blob/master/src/virgil/compile.clj#L129>; In fact it might not even be related to Virgil/Java compilation as I'm using tools.namespace too, and the main contributors to inflated heap seem to be some big data objects that are referenced by Clojure function classes, which are in turn kept around by `classCache`.; I took a heap dump of the application, and MAT couldn't find any live paths to GC roots from those big objects. FullGC was doing nothing. However, as soon as manually triggered OOM, those softrefs successfully disappeared."
1073,1554758901.6104,Rosaline,"when you say ""explicitly triggering an outofmemoryerror"" what mechanism are you using to do that?"
1073,1554758917.6108,Margit,"<@Jasmine> Interestingly enough, right now the `DynamicClassLoader.rq` is empty, but those SoftReferences are still there.; <@Rosaline> `(long-array 5e8)`"
1073,1554758937.6116,Rosaline,"and on what thread are you raising that exception, and what happens if you raise a different exception on that thread?"
1073,1554759043.6123,Margit,Just the REPL thread. Other exceptions won't do anything.; I learned that trick here: <https://stackoverflow.com/questions/3785713/how-to-make-the-java-system-release-soft-references/3810234#3810234>
1073,1554759228.6147,Rosaline,"it sounds like you are allocating small enough amounts of memory that the full gc recovers a very small amount about that seems to be enough so refs aren't cleared, and then you allocate again, so full gc runs again, etc; either increase or decrease your heap size"
1073,1554759256.6153,Margit,"Yep, it looks exactly like what is happening."
1073,1554759295.616,Rosaline,(or fiddle with gc tuning params)
1073,1554759430.6183,Margit,"I doubt changing the heap size would work here, it's currently set to 7g for devtime, and the leak manifests itself very slowly, it takes hundreds of reloads before the heap becomes occupied enough to cause lags and hangups. And it never goes past it, I was at 100% OldGen util, and it still refused to give up those SoftRefs.; &gt; (or fiddle with GC tuning params)
That one could possibly work, yet it is still strange to me that such behavior could be the default. Maybe switching a GC would help, but I don't want to move away from ParGC during development."
1073,1554759550.6209,Rosaline,"if it is what I described the issue is in the relationship between the gc cycles and the mutator cycles, it isn't an issue of heap size per se, but changing the heap size will change the gc cycle and hopefully break the relationship; you may want to try g1"
1073,1554759718.623,Margit,"I prefer a predictable GC in development, but this is subjective and another story. Thanks for the help, anyway."
1073,1554759719.6231,Rosaline,as of java 9 g1 is the default collector
1074,1554760319.6238,Jasmine,"in java 12, I know the new ZGC actually has support for parallel class unloading, which might be helpful for you"
1073,1554760352.6244,Jasmine,"in general though, I'd say this is a level of gc tuning that I am aware of, but not an expert in :)"
1073,1554760627.6267,Margit,"Interesting, I didn't link this problem to class unloading. They could indeed be related. I gonna study the GC logs, see if there's a mention of it there.; On a different note, I had a huge success running Clojure with ShenandoahGC, hope to write about it someday."
1074,1554761081.6278,Jasmine,would love to read that; would make a great conj talk ;)
1075,1554798910.6316,Aubrey,"Hot damn the cognitect-aws API is good! Never before had done any AWS API work (I barely even know how AWS works), and I managed to cobble together a working Route53 utlity namespace in about an hour. Love it!"
1075,1554799291.6331,Latonya,"There was a project years back where someone did such a thing, and in particular they were trying to create a ""literate programming"" version of the Clojure source code.  They made some progress, and their work is probably still available in the public somewhere, but it is likely for a version of Clojure that is not the most recent, e.g. maybe the part that was done is up to date for Clojure 1.4 or so.  I may be misunderstanding what your goal is, but realize that detailed documentation of such a code base is many, many person-months of effort.  Not everyone may share your desire to spend such time on it.; Here is a link to the one I have heard about, last updated in 2012: <https://github.com/daly/literateclojure>   You can search for Tim Daly's name on the Clojure Google group for messages from around that time for some discussion of it."
1076,1554801932.6337,Valrie,Thanks man. But it is not going to work. The vision of people is wrong about FOSS that's why it is not going to work.
1074,1554803604.6349,Jaimee,"So, this:
```
        labels-probs (sort-by :score &gt;=
                              (map #(do {:score %2 :label %1})
                                   labels clean-probs))
```

gives me a
```
java.lang.IllegalArgumentException: Comparison method violates its general contract!
        at java.util.TimSort.mergeHi(TimSort.java:899)
        at java.util.TimSort.mergeAt(TimSort.java:516)
        at java.util.TimSort.mergeCollapse(TimSort.java:439)
        at java.util.TimSort.sort(TimSort.java:245)
        at java.util.Arrays.sort(Arrays.java:1438)
        at clojure.core$sort.invokeStatic(core.clj:3115)
        at clojure.core$sort_by.invokeStatic(core.clj:3119)
        at clojure.core$sort_by.invoke(core.clj:3119)
        at closs.stages.classifiers$parse_results_threshold.invokeStatic(classifiers.clj:26)
```

error, but clean-probs is entirely made of floats, I'm confused..."
1074,1554803657.6353,Margit,"<@Jaimee> There must be a NaN somewhere in the values.; NaN's cannot be compared, so the sorting algorithm freaks out.
```
user=&gt; [(= ##NaN ##NaN) (&gt; ##NaN ##NaN) (&lt; ##NaN ##NaN)]
[false false false]
```"
1074,1554803774.6363,Jaimee,"Ok I will try using Double/isNaN to filter them out; thank you; <@Margit> can an underflow error lead to this also ?; Because even if I filter the NaN out, it still crashes, I printed the vector I have no NaN in my vector, but `8.690312E-37` (among other)"
1074,1554804266.6387,Margit,"I don't know if underflow can cause this, but this doesn't look like an underflow to me. This number is within float range it seems.
```
user=&gt; Float/MIN_VALUE
1.4E-45
```; Could you post your vector?"
1074,1554804300.6397,Jaimee,"```
(0.0 0.0 0.0 0.0 0.0 3.6712243E-31 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 3.2708435E-36 0.0 0.0 0.0 0.0 1.6565916E-12 0.0 1.0 0.0 8.690312E-37 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0)
(0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 1.0 0.0 5.2775614E-29 1.0 6.7907166E-7 0.0 0.0 0.0 0.0 3.689431E-32 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0 0.0)
```; Can it be that `println` replaces values randomly ?"
1074,1554804394.641,Margit,"Could as well exclude that possibility, try `pr` instead of `println`; Try sorting `(take 10 ...)` of your sequence, will it still fail?"
1074,1554804687.6417,Jaimee,No
1074,1554804782.6432,Margit,"I would do a poor man's binary search here to try to figure out who's to blame. Something like `(-&gt;&gt; (partition-all 10 values) (map #(do (println ""Sorting %"") (sort %)))`."
1074,1554804826.6435,Jaimee,"I will try that, thank you for the help"
1074,1554804853.644,Margit,"You are welcome, will be interesting to know what was the problem in the end"
1074,1554804929.6448,Jaimee,Yeah I think I won't have a choice than diving in because the problem is not even determinist it seems
1077,1554808905.6455,Latonya,"You may want to check for Float/isNaN, too.  I think maybe Double/isNaN only checks for NaN's of type Double, so will not find any Float NaN values, if you have any in your data.; Never mind, some experiments I just ran at the REPL indicate that Double/isNaN returns true regardless of whether you give it a NaN of type Double or Float.; This StackOverflow answer mentions that someone encountered this exception when sorting float and/or double values, but that seems odd to me that the floating point values are not given a total order by the default comparator: <https://stackoverflow.com/a/33971198>; Do you perhaps have a mix of some Float and some Double values in your data?"
1078,1554811592.6485,Cherise,"Does anyone have experience logging to Stackdriver using clojure.tools/logging?; Using the standard appender does not do anything

Dependencies:
```
                 [ch.qos.logback/logback-classic ""1.2.3"" :exclusions [org.slf4j/slf4j-api]]
                 [org.slf4j/slf4j-api ""1.7.26""]
                 [org.slf4j/jul-to-slf4j ""1.7.25""]
                 [org.slf4j/jcl-over-slf4j ""1.7.25""]
                 [org.slf4j/log4j-over-slf4j ""1.7.26""]
                 [org.clojure/tools.logging ""0.4.1""]

                 ;; Stackdriver
                 [com.google.cloud/google-cloud-logging-logback ""0.87.0-alpha""]]
```

Logback.xml:
```
&lt;!-- <https://cloud.google.com/logging/docs/setup/java> --&gt;
&lt;appender name=""STACKDRIVER"" class=""com.google.cloud.logging.logback.LoggingAppender""&gt;
  &lt;!-- Optional : filter logs at or above a level --&gt;
  &lt;filter class=""ch.qos.logback.classic.filter.ThresholdFilter""&gt;
    &lt;level&gt;INFO&lt;/level&gt;
  &lt;/filter&gt;
  &lt;!-- Batched logging requests get immediately flushed for logs at or above this level --&gt;
  &lt;flushLevel&gt;WARN&lt;/flushLevel&gt;
&lt;/appender&gt;
```; Nevermind they do show up, but in another log; The default “java.log”; Thanks!"
1078,1554812620.6511,Latonya,"If it is convenient to determine the distribution of types of values in the collection you are sorting, I would be curious to see the output of `(frequencies (map type c1))`, where `c1` is your collection of values."
1079,1554821531.6523,Jaimee,"<@Latonya> so I tried something:
```
  (let [clean-probs (into [] (aget result-array 0))
        labels-probs (try (sort-by
                           :score &gt;=
                           (keep identity
                                 (map #(when (&gt;= %2 0.0001)
                                         {:score %2 :label %1})
                                      labels clean-probs)))
                          (catch Exception e
                            (println e)))
```
this somehow works with no error"
1080,1554827088.654,Shayla,"Quick question, if I’m looking to build a somewhat simple event queue or pipeline for processing changes to app state, is it worth using core.async? "
1080,1554827463.6548,Jasmine,"If it’s just a series of fns, probably not; If you want queuing and possibly stage concurrency, maybe so"
1081,1554831105.6562,Shayla,"cool, thanks!"
1082,1554831225.6581,Tamie,"```(def nested-map {:a {:b 1}})
(defn my-func [m]
  ;; some magic
  )
(my-func nested-map)
;; =&gt; 1
```; how to achieve the `;; some magic` part?"
1082,1554831357.6591,Shayla,`(:b (:a m))` is the simplest
1082,1554831376.6597,Tamie,right...ok
1082,1554831384.6603,Shayla,also `(get-in m [:a :b])`
1082,1554831521.6605,Deb,"Wondering if people have stories of using the STM in 'real world' code. I have used atoms a lot but have yet to see a use for the STM. I see some old Java code where it looks like it could be useful, if I could ever port it, but I'd need a way to coordinate the in-memory var changes with an external commit to a DB. Some online examples of STM show ""bank accounts"", but with no way to connect the transaction to external storage, I don't see how that would really work past a simple demo."
1082,1554831583.6617,Tamie,`(comp :a :b)`
1082,1554831623.6626,Tanesha,I usually rely on a handler being called after the DB trx commits. Your memory changes could still fail though but the assumption is that the DB holds the Truth anyways ; Ie. It’s not a proper 2 phase commit 
1082,1554831746.6637,Jasmine,<@Shayla> don't forget `(-&gt; m :a :b)` too :)
1082,1554831767.664,Shayla,ha I thought of it but didn't post! glad you did
1082,1554831834.6648,Jasmine,macroexpands to `(:b (:a m))` but reads left to right. prob faster than `get-in`.
1082,1554831899.6652,Shayla,"oh wow, really?; I didn't know that!"
1082,1554831940.666,Jasmine,"not a difference that would likely matter, but last time I checked, yeah; you're basically adding another var deref/invoke so kind of has to be; I think either -&gt; or get-in read the best, and I think that trumps other considerations; (:b (:a m)) has to be read inside-out, and comp is imo always the worst thing to read"
1082,1554832136.6688,Deb,"A digression from `-&gt;` but I saw this recently and was laughing at the names of the macros. The diamond wand, the trystero furcula, etc., ...  <https://github.com/rplevy/swiss-arrows>"
1082,1554832190.6692,Shayla,Agreed. Reading comp feels very awkward
1082,1554832236.67,Jasmine,"many have died on the hill of arrow fetishization - this is but one of many; as the greeks said, moderation in all things; less is more, etc"
1082,1554832360.6715,Deb,Haha. :slightly_smiling_face: Yup. I found the first few (similar to `as-&gt;`) useful at least.
1082,1554832456.6728,Jasmine,"I draw the line at understanding the word ""furcula"""
1082,1554833171.6744,Lavonia,"^^ The last arrow macro you'll need :rolling_on_the_floor_laughing:
<https://github.com/randomcorp/thread-first-thread-last-backwards-question-mark-as-arrow-cond-arrow-bang>"
1082,1554833198.6747,Jasmine,now that one makes sense; we're going to add that to core
1082,1554833455.6756,Deb,"If you relax your eyes, it becomes a 3D diagram of the data flow, like those magic eye stereograms."
1083,1554833514.6757,Tamie,"i needed a quick snappy creation of a function...what do u guys prefer?
```#(-&gt; % :a :b)
(comp :a :b)
```"
1083,1554833537.6759,Shayla,"those are different, which is the issue; to match, the second should be `(comp :b :a)`"
1083,1554833595.6768,Tamie,"sure, but which do you prefer to read?; `(map (juxt :total (comp :login :author)))`"
1083,1554833632.6772,Shayla,that looks readable
1083,1554833664.6774,Tamie,is that better than: `(map (juxt :total #(-&gt; % :author :login)`
1083,1554833825.6776,Jasmine,I prefer everything to `comp` :)
1083,1554833870.6778,Tamie,:arrow_right:  thx guys! :slightly_smiling_face:
1084,1554847094.6848,Brent,"Hi! I need to merge a bunch of maps but the merge fn depends on the key. I couldn't find a shorter, simpler, easier to understand solution than copying `merge-with` to `merge-with-kvv`  that invokes the merge fn as `(f key val1 val2)` instead of just with the two values. Or is there a better way?"
1084,1554854603.6891,Kacy,The arrow I've probably heard requested most frequently is a version of `cond-&gt;` that threads the value through the tests too
1084,1554866242.6903,Celestine,"<@Kacy> <https://github.com/worldsingles/commons/blob/master/src/ws/clojure/extensions.clj> (pulled out of our code base at work) `[worldsingles/ws-commons ""0.1.1""]`"
1084,1554866383.6909,Kacy,"<@Celestine> oh nice, I like that one; thanks"
1084,1554866524.6912,Lana,"Interesting! And it looks like they are making good progress on the one they are going to release officially. Until then I am getting by fine using my JDK 8 javapackager pointed at a current OpenJDK distro to build my Mac app, and one of my kind Windows users has set up an sftp server that uses a third-party tool to create a nice MSI installer."
1085,1554867967.6916,Celestine,"And heavily production-tested :slightly_smiling_face:; <@Suanne> Have you asked in <#C099W16KZ|emacs> ?; (It's been too long since I used Emacs to be able to remember, I'm afraid)"
1085,1554872023.695,Suanne,"<@Celestine> No I have not, will do. How can I discover what channels exist on this workspace? Also, what editor are you using for Clojure if you don’t mind me asking?"
1085,1554872067.6959,Celestine,"Depending on the Slack client, there should be a label on the left `Channels` which you can click to browse all the hundreds of channels..."
1085,1554872095.6967,Suanne,"<@Celestine> Ah ok I just found that, thanks!"
1085,1554872102.697,Celestine,"...but it's a fair rule of thumb to assume ""There's a channel for that!"" and just use the switcher (control-k) and start typing :slightly_smiling_face:; (and there's <#C04V84U7G|slack-help> if you need to ask more detailed questions about how-to-slack :slightly_smiling_face: ); I switched from Emacs to Atom (+ ProtoREPL) after using Emacs for years... and at the end of last year I switched to Atom + Chlorine.; I talk a bit about that journey here <http://corfield.org/blog/2018/12/19/atom-chlorine/>"
1085,1554872247.6998,Suanne,"<@Celestine> Ok, I’ve been using VS Code which has decent integration with Clojure and the REPL. Why did you switch? I find Emacs might be so complicated that I’m spending too much time configuring it and not enough time learning.; <@Celestine> I’ll check that out."
1085,1554872261.7004,Celestine,"Yup. That. :slightly_smiling_face:; I've tried VSCode several times. Calva is coming along nicely. But I just prefer Atom.; (I have an Insider build of VS Code which I dip into from time to time); My workflow these days is to fire up Cognitect's REBL with a Socket REPL and then connect Atom/Chlorine to it and run them side-by-side, so I can ""inspect"" values directly into REBL, and take advantage of `tap&gt;` for debugging."
1085,1554872522.7034,Suanne,I’ll check these things out. I tried out Atom before. VS Code seems very similar to me. I don’t mind either of them.
1085,1554872573.7041,Celestine,Part of what I love about Chlorine is that it's written in ClojureScript and I can hack on it live while I'm editing my work projects :slightly_smiling_face:
1085,1554872797.7047,Suanne,"That’s the beauty of this stack. I’m still a bit of a beginner, haven’t tried ClojureScript yet."
1085,1554873013.706,Celestine,"We tried cljs at work about four years ago and it was a pretty rough experience back then so we decided to move forward with JS and React.js on our front end for the time being. But things have changed a lot and cljs is much, much more mature these days so we might look at it again for some projects in future.; (we've been doing Clojure in production since 2011)"
1085,1554873119.7069,Suanne,What specific industry is that?
1085,1554873165.7074,Celestine,"Online dating. World Singles Networks.; We have dozens of dating websites, all powered by Clojure on the back end and React.js on the front end.; Over 80k lines of Clojure."
1086,1554874364.7096,Loria,"Is there a better way of writing this function?
```
(defn lazy-distinct
  ""return a lazy sequence of coll that terminates
  when a repeated value is encountered""
  [coll]
  (-&gt;&gt; coll
    (reductions (fn [[seen _] x]
                  (if (contains? seen x)
                    (reduced :end)
                    [(conj seen x) x]))
      [#{} :start])
    ;; drop :start and :end markers
    (drop 1)
    (drop-last 1)
    (map second)))
```"
1085,1554874678.7115,Celestine,That seems very complicated... What's with the start/end markers? Aren't you just going to return the original sequence up to the first item that you've already seen?
1085,1554874707.7125,Loria,"yeah, seems like I'm missing something very simple here :sweat_smile:"
1085,1554874751.7136,Celestine,`(reduce (fn [[seen coll] x] (if (seen x) (reduced coll) [(conj seen x) (conj coll x)])) [#{} []] coll)`; It's not lazy but...
1085,1554874854.7148,Loria,"yeah, for my purposes I need it to be lazy; i.e. the iterator might be infinite but if it does ever cycle back to a repeated value I want it to terminate"
1085,1554874977.7162,Celestine,"Hmm... interesting... So you'd have to track a potentially near-infinite set of ""seen"" values?"
1085,1554875041.717,Loria,"I guess so, but practically I'm only using the first couple of elements off the seq; so for performance reasons I also don't want the whole thing to be realized"
1085,1554875061.7177,Celestine,"In which case, why do you care whether it's lazy or eager?; Oh, gotcha."
1087,1554875726.7201,Adria,"You can use clojure.core’s distinct transducer, except return a reduced value when a repeated value is encountered.
```
(defn take-unique []
  (fn [rf]
    (let [seen (volatile! #{})]
      (fn
        ([] (rf))
        ([result] (rf result))
        ([result input]
         (if (contains? @seen input)
           (rf (reduced input))
           (do (vswap! seen conj input)
               (rf result input))))))))

(sequence (take-unique) coll)
```"
1085,1554875758.7205,Celestine,"Or this `lazy-seq`-based version with a helper: ```user=&gt; (defn ld [coll seen] (cond (empty? coll) [] (seen (first coll)) [] :else (lazy-seq (cons (first coll) (ld (rest coll) (conj seen (first coll)))))))
#'user/ld
user=&gt; (defn lazy-distinct [coll] (ld coll #{}))
#'user/lazy-distinct```"
1085,1554876508.7207,Sixta,I think tools.does.alpha has a helper like that
1088,1554877636.7214,Loria,Thanks for both those approaches! I learnt a bit more about transducers from this :slightly_smiling_face:
1085,1554878442.7224,Celestine,`sequence` of a transducing function is a good approach (but a bit more code that a simple lazy seq).; One day all processes will be made that way (transducers) :slightly_smiling_face:
1088,1554878583.7236,Loria,"I'm still finding it hard to gain intuition about what transducers are ""doing"" under the hood; or rather what mental model to use when thinking about them - even though I can follow the logic it's still seems like this magical passing around of higher-order-functions; `comp` of transducers behaving in a ""backwards"" manner being one of the more confusing things"
1088,1554878845.7273,Celestine,"Yeah, they definitely take some getting used to. Especially since it's very hard to exercise all _three_ arities."
1088,1554883330.7314,Lavonia,"<@Loria> I found it useful to watch the *Transducers* talk Rich gave at Strange Loop a couple of times.
I also found it helpful to understand `IReduceInit` first, then move on to transducers."
1088,1554888542.7322,Danna,"I can't shake off the feeling that its confusing design to use  different arities for different lifecycle moments; I understand that its the most efficient way to work with the jvm and is thefore a good pragmatic choice; but transducers would be easier-to-grasp if they were defined using a record
`(defrecord Transducer [init-val iterate-fn wrapup-fn])`
IMHO"
1089,1554888994.7337,Chiquita,can anyone tell me how to learn clojure openscad. Thanks
1090,1554891800.7385,Shawnta,"Hi there!
I solving ""Sum of the first nth term of Series"" from <http://codewars.com|codewars.com> on clojure, and when I write solution I recived like ""time out execution error"".
I solve the same problem on haskell and take execute time, it's about 0.166972266s on 25000 value of nth series.
This is a clojure and haskell code that does the same thing.
```clojure
(defn series-sum [n]
  (-&gt;&gt; (map #(/ 1 %) (range 1 (java.lang.Integer/MAX_VALUE) 3))
    (take n)
    (reduce +)
    double
    (format ""%.2f"")))
```
```haskell
import Text.Printf

series :: [Double]
series = map (1/) [1, 4 ..]

seriesSum :: Integer -&gt; String
seriesSum n = printf ""%.2f"" $ sum $ take (fromInteger n) series
```
Can anyone tell me, who I can solve this problem on clojure faster? Thank you in advance.; As example on clojure with 3000 of nth series execute time is 7971.811645 msecs versus 0.002140344s on haskell"
1090,1554892492.7392,Loria,does it help if you change it to `#(/ 1.0 %)`?; currently it's doing rational arithmetic instead of floating-point
1090,1554892740.7397,Margit,I can confirm that it's 3ms-ish this way.
1090,1554892756.7399,Shawnta,"Yes. It helped.
I guess I do not know something. :hushed:"
1090,1554892961.7403,Loria,I'd be interested how Haskell compares with its Rational implementation
1090,1554894144.7406,Margit,"Rational arithmetic being the default for division in Clojure has bitten a lot of people, you are not the first one, unfortunately."
1091,1554894886.7408,Sena,Just curious. Did the answers match?
1092,1554898325.741,Min,"``` 
(defn series-sum
  [n]
  (-&gt;&gt; (range 1 (java.lang.Integer/MAX_VALUE) 3)
       (transduce (comp (map #(/ 1.0 %)) (take n))
                  +
                  0.0)
       (format ""%.2f"")))
```
^ should be slightly faster; after warmup it clocks at 1.2 ms on my laptop for 25k vs 3.6 for the slightly modified version of yours"
1092,1554898610.7416,Nieves,now it is time to test `loop` variant :slightly_smiling_face:
1092,1554898920.7418,Margit,"If run enough times, first solution is 0.4ms vs 0.1ms for <@Min> solution."
1092,1554898959.742,Min,"unrolling the whole mess in loop for sure is faster, but too much stuff to type :stuck_out_tongue:; transduce version is close enough to the haskell version in terms of syntax"
1092,1554899096.7424,Nieves,of course. but how said one haskeller - better way do make an unefficient programs is to write code on lazy languages as on the strict ones and do the opposit way :slightly_smiling_face:; anyway naive recursion in haskell in this task will be slower an take a HUGE amount of ram )
1092,1554899278.7428,Min,won't ghc optimize away the lazy parts since the return value will force computation?
1092,1554899334.743,Nieves,it depends on compiler O option ); by default - not )
1092,1554899345.7434,Min,I thought this is where its type system could help with :slightly_smiling_face:; got it
1092,1554899434.744,Nieves,"but you can always add strict evaluation thru $! or any else, but it is needed to remember )"
1092,1554899467.7442,Margit,"For those interested, this compiles pretty much to identical Java code, and takes ~20us.
```
(defn series-sum [n]
  (loop [i 1, j 1, acc 0.0]
    (if (&lt; i n)
      (recur (unchecked-inc-int i) (unchecked-add-int j 3) (unchecked-add acc (/ 1.0 j)))
      (format ""%.2f"" acc))))
```"
1092,1554899492.7444,Min,"yeah, I tend to prefer explicitness in these cases. Too much magic kills the magic; 20ms? that's way too much no? error in unit?"
1092,1554899594.7448,Margit,"```
(decompile
(defn series-sum [n]
  (loop [i 1, j 1, acc 0.0]
    (if (&lt; i n)
      (recur (unchecked-inc i) (unchecked-add j 3) (unchecked-add acc (/ 1.0 j)))
      (format ""%.2f"" acc)))))
```

```
    public static Object invokeStatic(final Object n) {
        long i = 1L;
        long j = 1L;
        double acc = 0.0;
        while (<http://Numbers.lt|Numbers.lt>(i, n)) {
            final long n2 = i + 1L;
            final long n3 = j + 3L;
            acc += Numbers.divide(1.0, j);
            j = n3;
            i = n2;
        }
        return ((IFn)const__8.getRawRoot()).invoke((Object)""%.2f"", (Object)acc);
    }
```; Yes, sorry, 20us"
1092,1554899617.7453,Min,nice
1092,1554899677.7455,Nieves,"loop wins as usual :grin:; and about haskell you can uncomment and compare time and memory peak :wink:
<https://rextester.com/KONQV13764>"
1093,1554907979.7476,Colette,The API Docs link at the bottom of of spec-alpha2 README is broken. Is this a known bug? <https://github.com/clojure/spec-alpha2>
1093,1554908748.748,Jasmine,"yeah, I've never got around to building it; typically it builds off releases and we haven't done one; <@Colette> I generated it, waiting on github to publish, but should eventually show up at <https://clojure.github.io/spec-alpha2/>"
1093,1554909992.7493,Colette,Thanks <@Jasmine>
1094,1554926160.7514,Coletta,"Looks like `<https://clojurians-log.clojureverse.org>` archives are down, showing a Null Pointer Exception; Perhaps only certain routes <https://clojurians-log.clojureverse.org/datomic/2017-09-19> for example"
1094,1554926282.7521,Tammera,"<@Charlyn> you are maintaining that right?; He is not in this channel, but I think through the magic of ambigous slack options I have maybe summoned him :’). Some parts of clojurians slack log appears to be down."
1095,1554927935.7526,Celestine,This was raised in <#C04V84U7G|slack-help> and I tagged him there as well.
1095,1554928429.7528,Tammera,Thanks!
1096,1554930409.754,Clarine,"when do I need `requiring-resolve`? I am loading some namespaces lazily (for performance, I don’t need them every instance of the program)."
1096,1554930795.7547,Jasmine,are there likely to be multiple threads doing same ns at the same time?
1096,1554930795.7548,Dann,~I thought it was a convenience for the lazy-loaded require/resolve pattern~
1096,1554930947.7552,Jasmine,it is ^^
1096,1554930975.7558,Dann,"nice - but now I see the thread safety thing too, which is nice"
1096,1554930980.7559,Jasmine,"it has the added benefit of using the (private) `serialized-require`; which is a temporary crutch until we can better fix `require`; eventually, `serialized-require` should just revert to `require`"
1096,1554931712.7574,Clarine,"multiple threads? at the moment, no"
1096,1554931777.7578,Jasmine,"then, just `require`"
1097,1554931816.7589,Clarine,"I’m hitting the locking issue with GraalVM again when using requiring-resolve, which can be patched, but if I don’t have to :slightly_smiling_face:"
1096,1554931831.7591,Jasmine,no need to
1096,1554932110.7603,Clarine,"hmm, I think this lazy require approach isn’t working at all with GraalVM since it needs eval basically right. so I’ll scratch that idea"
1096,1554932484.7605,Jasmine,"yeah, I was wondering how that worked :)"
1098,1554933547.7609,Dann,can you use the var method via interop?
1098,1554934009.7629,Marlyn,You're gonna want to make sure Graal sees the classes so that it can compile them all; by preloading them
1098,1554934254.7636,Dann,"ahh right, which means the whole ""last minute lazy require"" thing is pointless anyway, I think"
1099,1554936146.7638,Mariela,"I'm late to the party, but I heavily use something I called `rcomp` which is simply reverse + comp. That way things read left-to-right, just like with OOP dot notation

...and specifically, things keep flowing left-to-right in -&gt; and -&gt;&gt; chains"
1100,1554961535.7654,Suanne,Is it possible to get ParEdit working in the Clojure REPL (the one invoked with `lein repl`)?
1100,1554966944.7665,Deb,<@Suanne> Which editor are you using? I can turn on paredit-mode in the REPL in Emacs.
1100,1554966978.7671,Suanne,"<@Deb> I’m not using an editor, I’m using a terminal."
1100,1554967040.7676,Deb,"Oh, okay. Without an editor wrapping the terminal/repl, then I don't know the answer."
1100,1554969513.7691,Suanne,"<@Deb> I’ve also got it working in the CIDER REPL with ParEdit in Emacs, but I’m trying to transition away from Emacs in favor of VS Code, which I run a regular terminal inside of with the REPL. I’ve got pretty much everything working for my own workflow as it would be in Emacs with CIDER, but I can’t figure out this one minor thing."
1100,1554970834.7699,Sixta,<@Suanne> I think rebel-readline does paredit.
1100,1554974256.7701,Deb,"<@Suanne> I wanted to try that too (VS Code). Do you have key combos to quickly eval/reload things in the REPL, without having to cut-n-paste? In Emacs, commands like `cider-eval-defun-at-point`, `cider-eval-sexp-at-point`, `cider-load-buffer`."
1101,1554988100.7712,Wilford,I have a little golfing challenge if anyone's feeling bored on a Thursday afternoon:  <https://gist.github.com/clarkema/61464cb52ba107047c28cdff0539d030>; I'm looking for the absolute _fastest_ way to loop over an index from 1 to n
1101,1554989024.7718,Jasmine,"loop should be fastest; you're ruining  it with the boxed constant prob; up-to; ```(time (loop [i 1]
        (inc i)
        (if (&lt; i 100000000)
          (recur (inc i)))))```; is like 45ms; alternately, this should have similar effect:; ```(def ^long ^:const up-to 100000000)```; might help the other timings too"
1102,1554989664.7754,Jasmine,and actually the inc i would be even faster if using unchecked math. you can turn that on as the default AND get warnings about boxed usage like this:
1101,1554989674.7756,Jasmine,"```user=&gt; (set! *unchecked-math* :warn-on-boxed)
:warn-on-boxed```; ```user=&gt; (time (loop [i 1]
        (inc i)
        (if (&lt; i up-to)
          (recur (inc i)))))
Boxed math warning, NO_SOURCE_PATH:3:13 - call: public static boolean <http://clojure.lang.Numbers.lt|clojure.lang.Numbers.lt>(long,java.lang.Object).```"
1101,1554989721.7762,Wilford,"<@Jasmine> That's really interesting, thanks!"
1101,1554989754.7768,Jasmine,"with unchecked math and avoiding boxing, more like 32 ms; should basically be emitted as essentially the same bytecode you'd get from a tight java numeric loop on a long counter (although more natural in Java to use ints)"
1101,1554989905.7784,Wilford,I'll have a go with that in the real example (up-to in real life is actually the result of .size on a java.util.ArrayList
1101,1554990799.7794,Jasmine,"you can type-hint it or coerce it at point-of-use too - result of .size is an int, and a coercion to primitive long will be required somewhere. best to do it explicitly once, then every time through the loop if possible."
1101,1554991247.7797,Wilford,"yup, that's shaved a pretty nice chunk off; thanks :slightly_smiling_face:"
1103,1554997720.7821,Noemi,"I need to add a content-type/application-json header to a luminus swagger endpoint that looks like
```[""/json"" {:get (constantly (ok (json/write-str {:foo ""bar""})))}]```
any thoughts?; I'm getting
  ```""content-type"": ""application/octet-stream"",```
instead.; the new luminus/swagger uses reitit so I think things may be different than before."
1103,1554998017.7836,Michael,can you call defmacro within defmacro?
1104,1554998919.7839,Meagan,I would not :stuck_out_tongue: what’s the use case?
1104,1555001039.7847,Sixta,"You can do it though, might be a little tricky."
1105,1555001946.7851,Jasmine,do you mean emit or call?; defmacro-emitting macros are definitely possible and useful. also quite painful to write.
1106,1555003611.7887,Shayna,"<@Noemi> if you have a content-negotiation middleware in the mw chain, it should do the formatting for you, there is a example here: <https://github.com/metosin/reitit/blob/master/examples/ring-spec-swagger/src/example/server.clj#L82>"
1105,1555003741.7893,Suanne,Yes I believe those are all available.
1105,1555004403.7904,Jasmine,still looking for more experience reports feedback on the Clojure 1.10.1-beta2 changes in error reporting if anyone has the opportunity to live with it for a bit. See <https://www.reddit.com/r/Clojure/comments/bc264v/clojure_1101beta2_is_now_available/ekn9qr3/> for an example.
1105,1555008902.7914,Celestine,I just updated our code base to use Beta 2 and all tests pass (of course) -- the next failure that I hit will make me appreciate CLJ-2497 being fixed :slightly_smiling_face:
1107,1555010877.7937,Xiao,Anyone fancy a 4clojure type exercise? A function that takes a vector and an item in that vector and shifts the item right or left by one.
1107,1555010945.794,Becki,"items in the vector are distinct?; ie, `(shift :left :a [:x :x :a :x :a :x])` returns what?"
1107,1555011068.7951,Xiao,"Yep, distinct; `(shift :left 1 [1 2 3 4 5])` -&gt; `[5 2 3 4 1]`; `(shift :left 3 [1 2 3 4 5])` -&gt; `[1 3 2 4 5]`"
1107,1555011655.7982,Suanne,Check out the Calva package for VS Code.
1107,1555011663.7985,Jasmine,"cycle, drop x, take n handles that (computing x appropriately for right/left); oh, shifts single item not the whole thing"
1107,1555011714.7996,Becki,i was looking at `split-with #(not= e %)` and then recombining based on left or right; `(let [[before [_ &amp; after]] (split-with #(not= e %) coll)` and  play from there
1108,1555013258.8004,Xiao,"```
(defn shift [direction i coll]
  (let [[before [_ &amp; after]] (split-with #(not= i %) coll)]
    (if (= direction :left)
      (if (butlast before)
        (vec (concat (butlast before) [i] (take-last 1 before) after))
        (vec (concat (take-last 1 before) after [i])))
      (if (empty? (rest after))
        (vec (flatten (concat [i] before)))
        (vec (flatten (concat before [(first after)] [i] [(rest after)])))))))
```
Pretty ugly but it works; Can tidy it up a bit"
1108,1555013350.8013,Dann,if this was 4clojure I would make [[1] [2] [3]] an input (to rule out using flatten)
1108,1555013449.8017,Xiao,"I think it still works, because i flatten after splitting"
1108,1555013466.8023,Dann,it would return the wrong output
1108,1555013474.8025,Xiao,Flatten just lets me make everything a seq so that concat doesnt blow up
1108,1555013491.803,Dann,there are solutions that don't force you to destroy the structure of your input
1108,1555013499.8032,Xiao,"You're right, it breaks when using flatten; i.e. `:right`; I'm sure there are, what i have is very inelegant"
1108,1555013720.8056,Jasmine,"I'd get rid of :right / :left and use  +/- in index; is i an index? or is that a value to match?; I guess value, so nvm. I totally misunderstood (twice now) what this is doing. :)"
1108,1555014005.8083,Xiao,"Yes, bad naming, sorry; `x` would be more idiomatic?"
1108,1555014171.8091,Jasmine,"well, `i` was confusing :)"
1108,1555014194.8095,Dann,`el` `elt` or `needle` might be good
1108,1555014229.8099,Jasmine,"`cheese` (""who moved my cheese?"")"
1108,1555014851.8127,Xiao,"I'll have to try again tomorrow, brain is tired. :sleeping_accommodation:"
1108,1555014906.813,Dulcie,"Can I use a bit of java interop?
```
(defn shift [direction item coll]
  (let [f (case direction :left dec :right inc)
        pos (.indexOf coll item)]
    (when (not (neg-int? pos))
      (let [target-pos (mod (f pos) (count coll))
            overlay {target-pos item, pos (nth coll target-pos)}]
        (reduce (fn [coll [position new-value]] (assoc coll position new-value)) coll overlay)))))
```"
1108,1555014981.8136,Xiao,"Sure, I asked in the <#C03S1KBA2|clojure> channel after all. Too bad i'm wanting it for clojurescript, oops :man-facepalming:; Looks like it can translate fairly easily; `(.indexOf (make-array coll) item)` :slightly_smiling_face:"
1109,1555017039.8165,Dann,<@Dulcie> doesn't that when ensure that you return nil if ~you step past the index~ the item isn't found?
1109,1555017149.8168,Dulcie,It does; I wasn't sure what the requirement was for that; ¯\_(ツ)_/¯
1110,1555018084.8189,Suanne,Is there a more semantic way to do a catch all in a `cond`?
1109,1555018110.8194,Jasmine,`:else` is traditional; all keywords are logically true
1109,1555018139.8202,Tammera,oh! today I learned
1109,1555018145.8204,Jasmine,so you could also just say `:catch-all` if you wanted :)
1110,1555018158.821,Suanne,"Ahh interesting, thanks!"
1109,1555018171.8214,Suanne,`:else` is the convention then.
1109,1555018174.8216,Jasmine,"it is; on occasion, I add a bit of whimsy"
1109,1555018193.8221,Tammera,I just kinda assumed `:else` was something `cond` understood
1109,1555018206.8225,Suanne,"I like the word `:otherwise`, so I’ll probably go with that."
1109,1555018216.8226,Tammera,but … ofcourse not
1109,1555018411.823,Dann,there are linters that accept :else but not :otherwise
1109,1555018493.8233,Tammera,always make code the least surprising right :slightly_smiling_face:
1109,1555018647.8235,Suanne,"Ok, you’ve convinced me."
1109,1555019000.8242,Becki,i like a convention in `cond-&gt;` to use `:always`
1111,1555019281.8245,Celestine,"```user=&gt; (cond-&gt; 1
:please inc
:don't  inc
:do     inc
:this   inc)
5
user=&gt; 
``` (runs away)"
1109,1555019324.8252,Tammera,"Even apostrophes in keywords, you madman"
1111,1555019386.8254,Celestine,"`:&lt;&gt;&lt;` :slightly_smiling_face:; ```user=&gt; :&lt;&gt;:&lt;&gt;:&lt;&gt;
:&lt;&gt;:&lt;&gt;:&lt;&gt;
user=&gt;``` (I was a bit surprised multiple `:` were accepted!)"
1111,1555019545.826,Jasmine,"""A symbol can contain one or more non-repeating ':'s"" and ""Keywords are like symbols"""
1109,1555019581.8262,Jasmine,"that said, I wouldn't recommend it :)"
1111,1555020381.8264,Celestine,"Ah, thank you. I'm sometimes not quite sure whether something is intentionally accepted (and documented) or not when it comes to literal keywords :slightly_smiling_face:"
1109,1555020472.8266,Celestine,"(and UTF-8 just adds a whole newer layer of fun on top of all this!); ```user=&gt; (let [💩 42] (* 💩 💩))
1764```"
1112,1555020864.8272,Faustino,I forgot what the -&gt; does
1109,1555021065.8281,Celestine,"`-&gt;` is ""thread first"" so it threads the value (initially `1`) into each of the expressions for which the test expression is truthy.; So it ends up being `(-&gt; 1 inc inc inc inc)` (because all those keywords are truthy) which is `(inc (inc (inc (inc 1))))`"
1109,1555021138.8291,Jasmine,<https://clojure.org/guides/threading_macros>; although that page probably needs some better examples
1109,1555021241.83,Celestine,"Yeah, especially around the use of `as-&gt;` since it doesn't show it nested inside `-&gt;` :disappointed:; `(-&gt; 42 inc (as-&gt; x (* x x)) dec)`"
1109,1555021565.8335,Tammera,Well that makes more sense in non Latin scripts ^^. I kinda wonder whether there are many people using bindings with non-Latin names
1113,1555022633.8342,Gonzalo,"is there any way to combine regexes, other than combining strings and then using re-pattern?; I already have regexes and i need to concatenate them to find a larger pattern"
1113,1555022966.8357,Dann,"<@Gonzalo> this is the full API - I think making strings, combining, then making a new pattern is the most direct thing <https://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html>"
1113,1555023169.8361,Gonzalo,Thanks <@Dann>
1114,1555026125.8392,Vinnie,"I have a curious situation where attempting to evaluate any expressions (even something as simple as `1`) inside of a Clojail sandbox on an app running inside a Docker container trips an exception:
```
Exception in thread ""async-dispatch-8"" java.security.AccessControlException: access denied (""java.io.FilePermission"" ""/var/log/yetibot/yetibot.log"" ""read"")
```
the app is completely crippled after this point (any sort of IO will fail), even outside of the sandbox.

this *only* happens when running the Docker container on Digital Ocean.
I run the same image on an internal VM at work and it works fine. it also works locally (outside of Docker).

ideas? :thinking_face:; code is really basic <https://github.com/yetibot/yetibot/blob/b71d354d6868942bb860b3e6772a18601daf39d9/src/yetibot/commands/clojure.clj#L15-L16>"
1114,1555026221.8396,Celestine,"I assume it is tripping up trying to write the log file...?; (although it says ""read"")"
1114,1555026243.84,Vinnie,"yes, though writing logs should happen outside of the sandbox, and normally works fine; it's only when i try invoking the sandbox that it starts happening.; and once it happens, any http request also trips the same exception; only way to recover is to restart the docker container as far as i know; i also put a very permissive java policy file inside the docker image. i don't know much about java policy though.; this is what it looks like when attempting to make an http request after it's been crippled:

```
java.security.AccessControlException: access denied (""java.net.NetPermission"" ""getProxySelector"")
        at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)
        at java.base/java.security.AccessController.checkPermission(AccessController.java:895)
        at java.base/java.lang.SecurityManager.checkPermission(SecurityManager.java:322)
        at java.base/java.net.ProxySelector.getDefault(ProxySelector.java:96)
        at clj_http.core$get_route_planner.invokeStatic(core.clj:227)
```; the very mysterious part is why the same docker image works on one VM but not on a DigitalOcean VM."
1114,1555026518.8414,Celestine,I'd be tempted to follow a Digital Ocean support path at that point I think... ¯\_(ツ)_/¯
1114,1555026552.8416,Vinnie,yeah. i might try that. i'm pretty baffled
1115,1555057586.0022,Clarine,"Best way to get the butlast element of a seq?
```
(first (take-last 2 coll))
```
?"
1115,1555058712.0032,Lavonia,"```(first (rest (reverse coll)))``` maybe?
and ```(first (rest (rseq coll)))``` for a vector I think"
1115,1555058818.0038,Clarine,"`reverse` is not lazy, so I think that would be worse than take-last"
1116,1555060765.0056,Tarsha,`(last (drop-last col))` ?. also linear though i’m not sure you can prevent that
1115,1555061731.0063,Clarine,last + drop last is going to walk through the collection twice I think
1117,1555062013.0083,Jeannette,am I doing something unidiomatic if I end up with a channel inside a channel?
1118,1555064053.0092,Merna,I don't know about unidiomatic but I think I'd struggle to understand what was going on of I came across something like that
1118,1555064158.01,Henry,"If you're doing request-reply over channels, putting a reply-to channel along with the request is a reasonable way to do it I think."
1115,1555064620.0108,Adria,<@Clarine> There's `take-last`
1115,1555064647.011,Clarine,"yeah, see above :slightly_smiling_face:"
1115,1555067384.0121,Leeann,Got stung by `sort-by` today :disappointed:
1119,1555067424.0126,Leeann,"It has two arities, one with, and one without a comparator:; <https://clojuredocs.org/clojure.core/sort-by>; What stung me is that the one without the comparator, uses `compare` which returns -1, 0, 1 (as one would expect) as a comparator, whereas the arity with a user-supplied comparator expects a comparator which returns a boolean value.; Hmm, reading through the implementation, this seems even stranger, that indicates that I’m wrong :disappointed:; Ok, so the problem isn’t there it’s that I had big numbers :confused:; ```
user=&gt; (sort - [23413461236412630 10000000000000000 1 0 -1])
(-1 0 1 23413461236412630 10000000000000000)
user=&gt;
```"
1115,1555068258.0165,Justin,"I don’t understand the `(sort -)`, that’s not proper comparator. Do you want `(sort &gt;)` perhaps?"
1119,1555068269.0168,Leeann,"Yeah,; I guess I was thinking in terms of the result of running a comparator on two things, and not on a thing that implemented `Comparator` in java.; (as the doc clearly stated, my bad); a (untyped) comparator is a binary operation that returns -1, 0, 1"
1119,1555068348.0194,Justin,"Alright :) `-`  just happens to work, a function of two numbers returning an int…"
1119,1555068401.0203,Leeann,"I guess a comparator is a `(whatever, whatever) -&gt; negative, 0, positive`; I think that’s the standard way of doing sorting chars  in C. Just subtract the chars from each other and you’re good.; What’s funny is that `-` seems to work as a comparator for numbers that are integers, but not for longs…"
1119,1555068560.0232,Justin,"pretty much, Java already comes with that, Clojure builds on top. `(sort #(compare %2 %1) [\a \b \c])`"
1119,1555068577.0235,Leeann,"```
user=&gt; (sort - [1, 2 -3, 0, 5, 10, 100, -1000])
(-1000 -3 0 1 2 5 10 100)
user=&gt;
```"
1119,1555069552.0241,Justin,"that’s likely integer truncation in action, you can see with `(map (memfn intValue) [23413461236412630 10000000000000000 1 0 -1])`"
1119,1555071552.0292,Leeann,"`sort` seems to bottom out with this `let` here:; ```
     (let [a (to-array coll)]
       (. java.util.Arrays (sort a comp))
       (with-meta (seq a) (meta coll)))
```; And I guess I’m not able to parse ` (. java.util.Arrays (sort a comp))`; which `sort` is the `sort` in ` (. java.util.Arrays (sort a comp))` referring to?; It should be referring to this:; <https://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html#sort(T[],%20java.util.Comparator)>; The plot thickens :slightly_smiling_face:; `public abstract class AFunction extends AFn implements IObj, Comparator, Fn, Serializable `; and becomes even thicker:; ```
public int compare(Object o1, Object o2){
        Object o = invoke(o1, o2);

        if(o instanceof Boolean)
                {
                if(RT.booleanCast(o))
                        return -1;
                return RT.booleanCast(invoke(o2,o1))? 1 : 0;
                }

        Number n = (Number) o;
        return n.intValue();
}
```; which probably means that sorting by a function which can return numbers which are bigger than `Integers` may or may not work. I guess."
1120,1555074413.035,Clarine,any good clojure wrappers for lmdb-java?
1121,1555077178.0351,Ming,"<https://github.com/shriphani/clj-lmdb>

<https://github.com/hiteshjasani/clj-lmdbj>

I found these"
1121,1555077195.0355,Clarine,Just tried the latter one; thanks!
1121,1555077280.0367,Epifania,"anyone have any good recommendations for a library to help doing benchmarks of external binaries?; (I don't want to benchmark things that are written in clojure/java, so basically will be using `java.shell` to run the programs but like to use clojure for setup/timing/teardown)"
1121,1555078918.038,Clarine,<@Epifania> you mean record the time of external processes?; <https://github.com/clj-commons/conch> is convenient for scripting
1121,1555079035.0393,Epifania,"<@Clarine> was looking for a framework-like tool to help me structure the tests themselves, but thinking about it, wouldn't be hard to do myself. Conch looks very helpful for other things, so thanks for sharing that"
1122,1555081409.0405,Priscila,anyone uses cloudfoundry?
1122,1555088185.0422,Ana,thanks
1123,1555089946.044,Ivana,For those interested in writing fast scripts in Clojure this might be interesting <https://github.com/jeroenvandijk/clojure-scripting>
1123,1555090079.0444,Arvilla,"Hey all, learn-awesome is an open-source, community effort towards collecting links to awesome learning resources categorized by topics, formats, &amp; difficulty. The idea is to build humanity's universal skills graph. The page about Clojure could use some work though. Would appreciate people here sending pull requests :slightly_smiling_face: <https://github.com/learn-awesome/learn-awesome/blob/master/programming-languages/clojure.md>"
1124,1555091492.0449,Maximina,Anyone tried to use <https://www.testcontainers.org/> for their integration tests but for Clojure?; I only found a java library (which we can use i guess)
1125,1555100914.0498,Onita,"not sure if this would be better in beginners, but it looks like my repl in cider is actively running some computation and blocking others. is there any way to tell what’s going on, or do i need to profile the jvm activity?"
1125,1555101090.0505,Rosaline,"That is very unlikely; well, I guess it depends on how you read your statement"
1125,1555101150.0522,Dann,you can get all the stacktraces in a vm without a profiler
1125,1555101162.0526,Rosaline,"I read it has ""nrepl is blocking other threads from doing things"""
1125,1555101182.0532,Onita,"no, not quite"
1125,1555101188.0537,Rosaline,"if you mean ""I sent something to nrepl and it is still running, and I can send anything else to nrepl until it is done, what do I do?"""
1125,1555101189.0538,Onita,"just the repl is unresponsive, presumably because it’s doing something else"
1125,1555101226.055,Dann,"with jstack, or even sending the process a signal, you can get the stack traces, and it should be pretty straightforward to see which one would be blocking io for the repl thread"
1125,1555101237.0553,Rosaline,"a lot of it is going to highly specific to the nrepl client, and any middleware you are using"
1125,1555101249.0558,Dann,but you can also get the impression it's blocked because of unclosed parens or strings
1125,1555101261.056,Rosaline,so you might be better off asking in <#C0617A8PQ|cider>
1125,1555101293.0567,Dann,"also, nrepl itself is a threaded implementation of a network protocol, you can disconnect or reconnect, no matter what the active IO is doing in one client"
1125,1555101460.0574,Onita,"gah, ok. it looks like my panacea of mashing c-c has reached its end-of-life. thanks"
1126,1555102836.0576,Magdalena,[ANN] Cognitect Labs' aws-api 0.8.292 <https://groups.google.com/forum/#!topic/clojure/uvOzyfBrbyc>
1127,1555104586.0584,Clarine,"I’m running this code on Java source code from OpenJDK in a Java 11 environment:
```
$ clj
Clojure 1.10.0
user=&gt; (import '[javax.tools ToolProvider DocumentationTool])
javax.tools.DocumentationTool
(let [dt (ToolProvider/getSystemDocumentationTool)]
    (.run dt nil nil nil
          (into-array [""-public""
                       ""--source-path"" ""/Users/Borkdude/git/openjdk-jdk11/src/java.base/share/classes""
                       ""java.lang""])))
/Users/Borkdude/git/openjdk-jdk11/src/java.base/share/classes/module-info.java:307: error: ';' expected
        <http://jdk.crypto.ec|jdk.crypto.ec>
                     ^
/Users/Borkdude/git/openjdk-jdk11/src/java.base/share/classes/module-info.java:309: error: ';' expected
        <http://jdk.crypto.ec|jdk.crypto.ec>
                     ^
2 errors
1
```
What’s wrong here?"
1127,1555104677.0588,Rosaline,"module-info.java is not actually java source, if I recall"
1127,1555104717.0591,Clarine,I would expect that java tools could cope with this?; or should I blacklist these files somehow
1127,1555104881.0602,Rosaline,it may depend on if the tools version you are using understands modules
1128,1555105434.0606,Jasmine,module-info and package-info are intentionally invalid java source filenames
1127,1555105462.0611,Jasmine,such that their addition was guaranteed not to collide with existing source files
1127,1555105700.0617,Clarine,"what should I do with this?
```
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by clojure.lang.InjectedInvoker/0x0000000800232040 (file:/Users/Borkdude/.m2/repository/org/clojure/clojure/1.10.0/clojure-1.10.0.jar) to method com.sun.tools.javac.file.JavacFileManager.getJavaFileObjects(java.io.File[])
```; the code looks like this inside a  `let`:
```
dt (ToolProvider/getSystemDocumentationTool)
fm (.getStandardFileManager dt nil nil nil)
files (.getJavaFileObjects fm (into-array java.io.File [f]))
```"
1127,1555105748.0623,Jasmine,<https://clojure.org/guides/faq#illegal_access>
1127,1555105797.0628,Marlyn,`--illegal-access=debug` will give you a trace
1127,1555105801.0629,Jasmine,making it non-reflective is prob your best bet
1127,1555105804.0631,Marlyn,^
1127,1555105828.0635,Jasmine,`(.getJavaFileObjects fm (into-array java.io.File [f]))` is reflective; type hint fm to the generic interface and you're probably  good; fm  is probably typed as the concrete actual type; `(.getJavaFileObjects ^javax.tools.StandardJavaFileManager fm (into-array java.io.File [f]))`
1127,1555106021.0652,Clarine,"well, the warning from warn-on-reflection says:
```
Reflection warning, clj_kondo/Doclet.clj:62:15 - call to method getJavaFileObjects on javax.tools.StandardJavaFileManager can't be resolved (argument types: unknown)
```; it’s this method: <https://docs.oracle.com/javase/9/docs/api/javax/tools/StandardJavaFileManager.html#getJavaFileObjects-java.io.File...->"
1127,1555106165.0663,Jasmine,"which has File[], Path[], and String[] overrides; it does seem like it should know enough to work there but maybe the reflection stuff isn't matching componentype?"
1127,1555106222.0673,Clarine,"actually this works too:
```
files (.getJavaFileObjectsFromFiles fm [f])
```
without a warning"
1127,1555106276.0676,Jasmine,"I'd have to look more deeply to understand why; could maybe hint `^""[Ljava.io.File;""`"
1129,1555107226.0693,Onita,"could you guys help me decipher what is going on here? i got this from a thread dump, and i feel like i may have my jetty server configured incorrectly
```
""qtp247078080-91"" #91 prio=5 os_prio=31 tid=0x00007fd0b02d1800 nid=0xea03 waiting for monitor entry [0x0000700012c87000]
   java.lang.Thread.State: BLOCKED (on object monitor)
        at ring.middleware.reload$reloader$fn__5707.invoke(reload.clj:10)
        - waiting to lock &lt;0x0000000789c20aa0&gt; (a java.util.concurrent.LinkedBlockingQueue)
        at ring.middleware.reload$wrap_reload$fn__5718.invoke(reload.clj:38)
        at common.server$wrap_exception_handling$fn__6898.invoke(server.clj:35)
        at ring.middleware.ratelimit$wrap_ratelimit$fn__5858.invoke(ratelimit.clj:50)
        at ring.middleware.json$wrap_json_response$fn__5126.invoke(json.clj:87)
        at ring.middleware.json$wrap_json_body$fn__5101.invoke(json.clj:44)
        at ring.middleware.content_type$wrap_content_type$fn__5078.invoke(content_type.clj:34)
        at ring.middleware.not_modified$wrap_not_modified$fn__5178.invoke(not_modified.clj:53)
        at ring.middleware.keyword_params$wrap_keyword_params$fn__5158.invoke(keyword_params.clj:36)
        at ring.middleware.params$wrap_params$fn__5196.invoke(params.clj:67)
        at ring.middleware.cors$handle_cors.invokeStatic(cors.clj:171)
        at ring.middleware.cors$handle_cors.invoke(cors.clj:160)
        at ring.middleware.cors$wrap_cors$fn__8210.invoke(cors.clj:185)
        at ring.middleware.session$wrap_session$fn__6847.invoke(session.clj:108)
        at ring.adapter.jetty$proxy_handler$fn__5043.invoke(jetty.clj:25)
        at ring.adapter.jetty.proxy$org.eclipse.jetty.server.handler.AbstractHandler$ff19274a.handle(Unknown Source)
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
        at org.eclipse.jetty.server.Server.handle(Server.java:499)
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:311)
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:258)
        at org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:544)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:635)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:555)
        at java.lang.Thread.run(Thread.java:748)
```"
1127,1555107286.0699,Onita,"i have an api being served with a series of middlewares, but i’m not sure where in this stack the problem actually is"
1127,1555107330.0703,Marlyn,looks like a deadlock here: <https://github.com/ring-clojure/ring/blob/master/ring-devel/src/ring/middleware/reload.clj#L11>
1127,1555107447.0712,Onita,hmm. so perhaps i tried to reload code too many times?
1129,1555107466.0715,Onita,it seems like this middleware shouldn’t be in production. is that correct?
1129,1555107625.0717,Rosaline,yes
1129,1555107641.0719,Onita,cool.
1127,1555107883.0736,Rosaline,if that is actually a deadlock there should be another thread in the stacktrace in the critical section and not leaving it for some reason
1129,1555107943.074,Onita,yeah there’s one other mention of it in the dump
1129,1555107964.0744,Rosaline,but if you got a single dump that is just where the threads where at that time; it isn't an indication of anything
1129,1555108006.0752,Onita,i took it again and it showed the same thing; in addition the application isn’t responding anymore; forgot to mention that
1129,1555108130.0763,Rosaline,"I would expect to see a lot more threads stuck then, I think the jetty default threadpool might be 50? every single one would stop in the same place"
1130,1555119715.0782,Faustino,I just learned that Clojure and Scala are both using tries for their list data types (persistent/immutable). But Elixir uses linked lists which can be spread all over the RAM (inefficient). Could this contribute to Clojure/Scala being better at data crunching? And Elixir is more for horizontal scaling because it doesn’t share memory.
1130,1555119866.0784,Rosaline,No
1131,1555124647.0791,Faustino,"I made a mistake. Actually, Elixir can do vertical and horizontal scaling. It’s just not made for sharing memory (number crunching) like Clojure can do?"
1132,1555136969.0804,Suanne,"What is the difference between using `require` and `:require`?

This code using `require` returns an error:

```
(ns hello-world.core
  (require [clojure.set :as set])
  (:gen-class))
```

The error message is “syntax error macroexpanding clojure.core/ns”.

But this code using `:require` compiles just fine:

```
(ns hello-world.core
  (:require [clojure.set :as set])
  (:gen-class))
```"
1132,1555137255.0814,Sixta,"<@Suanne> the first is invalid inside of ns, it used to work by coincidence, now it doesn't."
1132,1555137380.0823,Suanne,"<@Sixta> And which is conventional to use, `:require` inside of `ns` or `require` outside of it?"
1130,1555137667.0828,Andera,"What's the "":-""; Is it part of spec?; It seems it's some kind of type hinting?; E.g. (s/defn make-consumer :- FranzConsumer 
...)"
1132,1555139710.0854,Sixta,Inside of ns is conventional; It's a type hint in the library schema
1133,1555153867.0869,Clarine,"Is it safe to assume that Clojure aliases dominate over Java class imports?
```
(ns foo (:import [java.lang Thread]) (:require [clojure.core :as Thread]))
(Thread/+ 1 2 3) ;;=&gt; 6
```"
1133,1555155971.0891,Justin,"They seem to integrate “nicely” <@Clarine> but wouldn’t put that in my code. Do you have an use case in mind?
```
(ns foo (:require [clojure.core :as Thread]))
(Thread/+ 1 1) ;; 2
(Thread. ""Hello"") ;; java.lang.Thread 0x49872d67
```
(BTW No need to import Thread)"
1133,1555156001.0895,Clarine,"well, it clashes when you call a static method on Thread; I have no use case, but when analyzing code it’s good to know what to expect"
1133,1555156048.0903,Justin,"yeah, just tried. So no nice integration."
1133,1555156075.0908,Clarine,"I think Clojure requires/aliases are prioritized, so I’ll assume that for now"
1133,1555156091.091,Justin,evidence seems to confirm that
1133,1555177233.0917,Meagan,so I’m thinking of doing a dirty thing and making some breaking changes to a library I maintain; mainly re-naming some functions. I’m curious if anyone’s ever done work on creating syntax transforms for Clojure that can be run on projects to help with migrations like this.
1133,1555181279.0935,Macy,"<@Meagan> perhaps something like this: <https://github.com/boot-clj/boot/blob/master/boot/core/src/boot/core.clj#L343-L351>; you can see it in use on line 357 of that file, for example"
1134,1555181651.094,Lavonia,"I believe the mainstream opinion is, don't break consumers. Have you considered deprecating instead of breaking?"
1133,1555181741.0942,Meagan,I have :slightly_smiling_face: these functions are really a part of a set of idioms and naming conventions that I want to change for users of my library; I’d prefer to rename them and then give my consumers a utility to convert their code from the old naming contention to the new naming convention
1135,1555184637.0947,Faustino,I think it’s a deadlock too. After reviewing some videos on C concurrency… I can see the monitoring thread in the error. I am curious though… I thought Clojure tries to avoid using synchronization locking concurrency? Is the Clojure code using some Java locking code?
1135,1555184675.0949,Celestine,I would strongly recommend introducing a new namespace with the new API and announcing to your users that the original API namespace is deprecated and encourage them to switch to the new namespace.; But then keep the old API namespace around for a long time (just don't maintain it).
1133,1555185955.0953,Meagan,"I think even with deprecation, it would still be cool to have utilities that could help refactor code when API migrations occur. it sounds like this hasn’t been something people have done in Clojure; hah, and then I recalled <https://github.com/xsc/rewrite-clj> :smile:"
1133,1555187309.0964,Celestine,"Yeah, a migration utility could well be a good idea, depending on how much code out there depends on your library."
1136,1555189398.0969,Tammera,does it make sense to use leiningen and tools.deps side-by-side?; like with lein-tool-deps. I am asking because tool.deps has nice git integration
1137,1555191038.0976,Celestine,"Based on my experience writing and using `boot-tools-deps` -- Boot + `deps.edn` -- I would say that, ultimately, you'd be better off just switching to `clj` completely.; These integrations tend to have limits. Basic stuff works well. More complex stuff tends to have weird behaviors.; Boot and Leiningen might be different enough that the limitations I hit with Boot don't impact you in Leiningen in the same way... If I were you, I'd chat with Rick about any known limitations (when he's around)."
1137,1555191336.0982,Tammera,"right, thanks! I must admit that I spent as little time as possible dealing with _configuring_ tooling, but I start to see that not having Git deps is starting to be a nuisance"
1137,1555191337.0984,Celestine,"At work, we started with Leiningen back in 2011, switched to Boot at the end of 2015, and then introduced `deps.edn` last year, via `boot-tools-deps`, at first, but then switched completely to `clj`. We've been very happy with the switch."
1137,1555191484.0987,Tammera,"yeah at my work all of our projects use lein, but… to be quite honest, I don’t know why. I’ll investigate some more; maybe switching whole makes more sense!"
1137,1555192154.0991,Celestine,"Chat to Rich when he's around, and see what limitations he's aware of with the `lein` integration.; As the author of `boot-tools-deps`, I wouldn't recommend the hybrid approach with Boot, except as a bridge to migrating from Boot to `clj`. Some of that is to do with how Boot deals with dependencies, the classpath, pods, and so on."
1138,1555192691.101,Mariela,"<@Meagan> although slightly hacky, I think one also can do that sort of thing with <https://github.com/clojure-emacs/refactor-nrepl/#find-symbol>. I've used both tools (refactor-nrepl + rewrite-clj) and the latter can be a bit low-level."
1139,1555197384.1014,Ruthann,Anyone have experience with enums in lacinia?
1140,1555214927.1031,Loria,"Is this guaranteed to match up elements in a set `s` with their mapped ones?
`(zipmap s (map f s))`"
1137,1555215588.1042,Celestine,"<@Loria> Yes, both `zipmap` and `map` call `seq` on their argument -- and `seq` returns the same ordering on repeated calls for the same object (collection)."
1140,1555215862.1051,Loria,thanks!
1141,1555231095.1053,Andera,Thanks Dominicm!
1142,1555240938.1064,Adria,"The following probably happens because of something in `with-in-str`. What would be the best workaround?
```
(with-in-str (str (char 13))
  (.read *in*))
; =&gt; 10
```; Got it by binding `*in*` to a StringReader manually."
1143,1555244697.1093,Arturo,"what are the implications of using clojure values as keys in a `java.util.WeakHashMap`?; actually, think i just answered my own question - guess they will be GC’d as usual, with no particular guarantees"
1144,1555249554.112,Jasmine,"In general, Clojure values are just Java objects, so nothing special. One possible exception are keywords, which are interned and shared across the runtime"
1145,1555250761.1145,Adrianne,"what is the current recommended way to do desktop GUI in clojure? Still seeaw? I would like to avoid the clojurescript/electron route as much as possible. Also, are there any GUI designer tools that work with either seesaw/whatever is more recommended now?"
1143,1555251623.1163,Shaneka,"there are couple other viable options:
- <https://github.com/cljfx/cljfx>
- <https://github.com/fn-fx/fn-fx>
but I haven’t done any Clojure GUI work, so can’t compare"
1146,1555254658.1184,Cira,hey there :slightly_smiling_face: Anyone know a small real-world code snippet that demonstrates why Clojure can't be statically analysed? (e.g. something `def`ing things based on a data file or similar)
1146,1555255023.1186,Roslyn,"There is a library that generates defs from files with sql queries, don't remember what's it's name; yesql!"
1146,1555255151.1191,Cira,"oh right, that's a good one"
1147,1555269844.1205,Malik,is it expensive to convert a vector to a sequence?; it seems like (hashmap|vector|set) -&gt; sequence happens *a lot* and I don't have a sense for how expensive that is; and not sure how to get a sense of that
1147,1555270055.1234,Becki,"```
	public Seq(IPersistentVector v, int i){
		this.v = v;
		this.i = i;
	}
```
seems to be about it; two pointer assignments"
1147,1555270119.1242,Fredda,"I'm not sure if a conversion takes place. IIUC, 'sequence' is an abstraction that collections implement. So certain functions will treat it sequentially"
1147,1555270155.1248,Malik,so first and rest and next just index into the vector?
1147,1555270189.1255,Fredda,"Well, it's a trie underneath, so there's a sort of conversion for any operation (depending on the size); But, yeah, IMO it's not like a ""conversion"" to an different thing... Moreso a particular view over it."
1147,1555270256.1276,Faustino,The docs say that the vector is contiguous… does that mean they are placed side by side in memory?
1147,1555270257.1277,Malik,"ah, ok; I was hoping it was something like that; I couldn't imagine how expensive it would be without that being the case"
1147,1555270361.1293,Fredda,<@Faustino> persistent collections are rich collections of 32 element arrays
1147,1555270410.1305,Faustino,is 32 element the same as 32 bits?
1147,1555270412.1307,Fredda,"So it's more likely the elements with one of those arrays are contiguous in mem, than in other parts; No, in java and js, those arrays are not typed"
1147,1555270486.1315,Faustino,"It says the sequence is based on the ISeq, IPersistentList"
1147,1555270613.1331,Fredda,Perhaps I'm wrong and there is a significant cost to using a collection as a sequence. But I didn't think it was any heavier than than its most efficient ability to iterate across the collection.
1147,1555270666.1339,Faustino,My guess is you are correct. Because I’d guess that the sequence is just the edge nodes of the trie data tree structure in memory
1147,1555270693.1343,Fredda,"Like, a seq is printed as a list, but that's not to say the vector is being converted into a list first."
1147,1555270743.1348,Faustino,1 notable different though in the docs… conj adds to the front of a sequence. but adds to the end of a vector; I am highly interested in this… let’s thread the conversation; I am reading the docs. How lists and vectors are FIFO or LIFO; <https://purelyfunctional.tv/guide/clojure-collections/#fifo>
1147,1555271213.1371,Jasmine,Seqs on vectors are just views into the vector and are highly efficient
1147,1555271290.1382,Faustino,<@Jasmine> so the sequence just walks down the edge of the trie?
1147,1555271319.139,Jasmine,"Effectively, yes. I mean you can read the code, it’s pretty straightforward I think"
1147,1555271347.1394,Fredda,Aye
1147,1555271371.1404,Jasmine,Normally seqs have some overhead in caching the resulting sequence (effectively a linked or chunked linked list); Vectors seq is more efficient as it just piggybacks the vector
1147,1555271435.1415,Faustino,but Clojure doesn’t use any linked lists underneath? Right?
1147,1555271448.1419,Jasmine,Clojure lists are linked lists
1147,1555271466.1425,Faustino,wow… I thought they were array based
1147,1555271466.1426,Jasmine,Sequences are usually linked lists; Chunked seqs are links of arrays
1147,1555271490.1433,Fredda,32?
1147,1555271494.1436,Jasmine,So more memory efficient; Yes
1147,1555271501.144,Faustino,"ahhh ok. I must be reading conflicting info from the web; because some docs said that Clojure lists were array based, next to each other in memory, touching"
1147,1555271600.1467,Fredda,Are Java or js arrays really guaranteed to be contiguous in physical memory?
1147,1555271612.1472,Jasmine,Java arrays are
1147,1555271619.1475,Faustino,"wait a second… why don’t I see any middle insertion methods on the Clojure ISeq (lists) if they are linked lists?; there is only conj, adding at begining and end… which would point to using an array structure"
1147,1555271677.1488,Jasmine,In general Clojure provides only “efficient” operations; The efficient place to add elements to a linked list is at the head
1147,1555271717.1498,Faustino,"I thought a linked list can have insertion done at any point, in constant time?; because it just looks up the memory address"
1147,1555271753.1508,Becki,if you have a linked list you have a node and a pointer to the rest; so to insert in the middle you have to start following the links
1147,1555271803.1518,Faustino,I can’t just insert based on the nth term?
1147,1555271811.1521,Becki,sure. but first ya gotta get there
1147,1555271821.1525,Tammera,a linked list is really just a node pointing to another node
1147,1555271831.1527,Faustino,so I have to walk the linked list to find the nth term?
1147,1555271835.153,Becki,yup
1147,1555271835.1531,Tammera,yep!
1147,1555271843.1535,Becki,its like a scavenger hunt
1147,1555271852.1537,Faustino,wow. I was really confused about that.
1147,1555271878.1539,Tammera,its a tree without branching :wink:
1147,1555271901.1543,Fredda,It's a vine ;)
1147,1555271922.1547,Tammera,I am coining “unary tree”
1147,1555271925.1549,Faustino,why would anyone want to use one?; if the insertion writes are linear complexity… makes no sense to me
1147,1555271946.1557,Fredda,For function application ;)
1147,1555271989.1567,Faustino,"ahh, so you use them to chain functions together?"
1147,1555271990.1568,Fredda,"Really, vectors are almost always preferred; No, I just mean that because Clojure is a lisp we always use lists to apply functions, with the function in the operator position of the list"
1147,1555272095.1606,Tammera,"well unless you want to prepend, thats `O(n)` in an vec and `O(1)` in a list. The moral of the story, different datastructures have different trade offs"
1147,1555272169.1624,Faustino,"I must have read some erroroneus docs… that said Clojure uses arrays, contiguous, for sequences… when I was comparing it to Elixir"
1147,1555272172.1625,Becki,<https://clojure.org/reference/sequences> read up on sequences here.
1147,1555272207.1635,Faustino,"I think Lennart was the one who pointed out linked lists don’t do well on the CPU l1, l2 cache"
1147,1555272214.1639,Jasmine,<http://insideclojure.org/2015/01/02/sequences/> and <http://insideclojure.org/2016/03/16/collections/> are some longer things I’ve written that you might find useful
1147,1555272225.1643,Faustino,"because they can be spread all over RAM and can’t be loaded in 1 step like arrays can, contigous"
1147,1555272236.1646,Tammera,"I did not, but I have read it sometimes"
1147,1555272305.1668,Jasmine,And some of the faq entries <https://clojure.org/guides/faq>
1147,1555272310.1669,Becki,that's true. and Clojure does some tricks mentioned earlier (chunking) to bridge this gap. The gain you get is that lazy sequences can be used interchangeably with standard collection types when this interface is pervasive.
1147,1555272386.1679,Tammera,"if you care about cache misses, you are fairly deep into optimising tho, first write code, then make it fast :wink:"
1147,1555272417.1684,Faustino,"Elixir uses linked lists as their basic type, for lists… and because the CPU can’t grab the data in 1 step… it makes threading less efficient… when the CPU has to lock memory… and do several steps to get the linked lists from all over RAM; I think this is a reason why Clojure is faster and has lower level threading models; <@Tammera> but you posted that info on Java Fibers… Which is like Actors… but it sounds lower level too. If clojure takes advantage of Fibers… I think that will be fantastic"
1148,1555272591.1706,Fredda,Does Elixir have shared memory between processes?
1147,1555272602.171,Faustino,<@Rosalia> no shared memory; the only way to share is off-site; or through message passing; this is a big reason I love clojure. We can thread stuff with shared memory… and we can also setup the actor model; This is the reason Clojure is better at number crunching… But can also handle horizontal scaling with Actors. And Fibers can be a game changer for us.
1147,1555272837.1747,Fredda,"Aye, I don't think elixir is designed for high performance, local number crunching"
1148,1555272847.1751,Fredda,Which is fine
1147,1555272860.1755,Faustino,"correct. Elixir is setup for distributed computing; I am not knocking it. It’s great for its purpose. But I do think Clojure is more robust for number crunching, and horitzontal and vertical scale"
1148,1555272938.1767,Fredda,Fibers / project loom will be interesting
1147,1555272976.1775,Faustino,"ya, it could make Clojure scale horizontally from day 1, without extra setup… just like Elixir"
1147,1555272980.1776,Becki,i remember tim baldridge recently laying out why Clojure is not great for number crunching. I think it was on a reddit post about game design in Clojure?
1147,1555273107.178,Faustino,<@Becki> Clojure isn’t good for number crunching?
1147,1555273118.1782,Becki,i'm looking for his post; read the discussion here: <https://www.reddit.com/r/Clojure/comments/b7zymd/sean_murray_at_gdc_2019_a_new_perspective/>  tim's username is halgari; i've never done heavy number crunching in clojure. so i like to listen to arguments and experiences from people much smarter than me :slightly_smiling_face:
1148,1555273335.18,Meagan,immutable data structures will always be at a disadvantage when it comes to raw efficiency
1147,1555273521.1812,Faustino,"<@Becki> he is talking about game programming (C, C++)"
1148,1555273555.1825,Fredda,"Well, the flexibility of persistent data structures is never going to be as fast as typed arrays"
1147,1555273561.1827,Faustino,Games can’t handle the pauses in Garbage Collectors
1147,1555273587.1834,Kate,:sideeye:
1148,1555273600.1837,Fredda,What lilactown said
1147,1555273623.1842,Faustino,I agree with <@Meagan>; Clojure uses tricks though… like lazy-seq
1147,1555273657.185,Kate,Games aren't unique in realtime programming. Any allocation strategy is going to fail if you abuse it.
1147,1555273687.1855,Faustino,"I think pauses in the garbage collector is ok for non user facing stuff, e.g. machine learning; I’d glady make the trade off if it means I don’t code it in C"
1148,1555273713.1861,Kate,"sure, obviously batch processing is just a race to the finish line."
1147,1555273737.1865,Faustino,I benchmarked a small test. Clojure lazy seq is as fast as C.
1147,1555273769.1874,Fredda,"Yeah, despite being super flexible, Clojure is pretty fast"
1147,1555273779.1876,Becki,i don't believe you. (re: lazy seq is as fast as C)
1147,1555273804.1882,Faustino,<https://github.com/starchild33/algorithms>
1147,1555273805.1884,Becki,i'm assuming your terminal printing was the same speed in a C program as with clojure :slightly_smiling_face:
1147,1555273821.1891,Faustino,"my clojure lazy seq on the nth term of fibonacci was as fast as C; around 1 second to find the 40th nth term; well, I did use cython, from python recursion script; I didn’t write it in raw C"
1147,1555273885.1909,Tammera,"also, comparisons of language A is as fast as language B usually highly depends on your implementations in A &amp; B. I can write number crunching Python thats faster than C if I butcher the C impl."
1147,1555273901.1911,Kate,i heard PyPy is faster than cython; (implementations matter)
1147,1555273917.1918,Becki,i don't see any C in there
1147,1555273925.1921,Faustino,I am going to write it in Raw C. then compare it to clojure.
1147,1555273964.1934,Becki,the python version is the naive recursive solution
1147,1555273971.1938,Faustino,yea; but Clojure optimizes recursion with a lazy-seq. So I cheated a little.
1147,1555274000.1952,Fredda,I wonder if/how clojure's concurrency abstractions will fit with loom/fibers
1147,1555274049.1961,Faustino,let me write some more today… and try a naive recurssion in Clojure compared to C. I am sure C is faster in that case though
1147,1555274050.1962,Becki,it's a totally different algo. you did the count up version in clojure and the naive exponential version in python
1147,1555274067.1965,Faustino,"ya, it’s not accurate enough. I cheated."
1147,1555274098.1973,Becki,lol. well lets not claim Clojure is as fast as C if there is 1) no C and 2) different algos used in the python versus clojure verions :slightly_smiling_face:; but i like your enthusiasm and willingness to actually benchmark
1147,1555274124.1985,Faustino,"I think I should restate it as… Clojure can use tricks to speed up to C level performance; I’ll rewrite it today, with a more accurate comparison… and share it"
1147,1555274188.2,Becki,i look forward to it.
1147,1555274194.2003,Faustino,I am biased towards Clojure… you can see my bias
1147,1555274198.2006,Becki,i am too :slightly_smiling_face:
1147,1555274309.2048,Fredda,"Like, could a fiber backed atom be as simple as a cljs atom? Or does interruptibility on the jvm complicate that?"
1147,1555274380.2063,Jasmine,"In general, Clojure should be approximately as fast as Java. jit optimized Java is generally fast enough for the majority of programming uses. Where it’s not, there are options to use faster libs as a consumer. ; 99% of users never need that though"
1147,1555274681.2069,Erna,"The main issue I ran into when using `lein-tools-deps` was that the dependency resolution for `lein` is similar, but not the same as `tools.deps`. So, even with the same dependencies, the resolutions might be different if you use (for example) `lein uberjar` you could potentially get different versions of some libraries than if you ran the `clojure` script. I would second <@Celestine> in recommending that a hybrid approach only be used during transition."
1148,1555275166.2082,Kate,My very sloppy Clojure use is 80-99% as fast as Java. Once in a while I tune it up with just a tiny bit of effort. Mostly it is sufficient.
1147,1555275171.2084,Faustino,omg. I mis-spoke. Clojure Binet Formula is as fast as C recursion
1148,1555275318.212,Becki,ha. can you find the point where clojure's single computation is faster than c's recursion?
1148,1555275326.2123,Fredda,There may be certain kinds of problems where persistent data structures are already the most performant abstraction. Like an editor that can edit files larger than what's in memory. I think have to implement some shared structure thing anyway.
1147,1555275410.213,Faustino,<@Becki> hahahaha this is an interesting comparison.. working on it now
1147,1555275423.2136,Becki,you were using 40 earlier i think.
1148,1555275448.2148,Kate,persistent data structures are a convenience for programmers to ensure certain types of design correctness
1147,1555275452.215,Fredda,Or if you were trying simulate a universe of stars that don't fit in memory all at once
1148,1555275479.2155,Kate,that convenience is overhead
1147,1555275494.2159,Kate,it's not going to pay off except in time correctness
1148,1555275501.2162,Kate,time to correctness
1148,1555275540.218,Fredda,Unless the problem itself looks embarrassingly like a persistent data structure problem
1148,1555275557.2183,Kate,there are lower overhead ways of ensuring correctness but they cost developers more at design/review time; what is a persistent data structure problem?
1148,1555275616.2196,Fredda,It doesn't have to be only about correctness. the shared structure of persistent data structures allows for efficiencies that are harder to achieve without that shared structure.; Especially over infinite data sets for instance
1148,1555275637.2205,Kacy,"a ""convenience for programmers"" - doesn't this describe every single tool?"
1148,1555275642.2206,Kate,harder how? in developer effort? that's what i've been saying.; mg: as in the opposite of fundamental to computation
1148,1555275663.2214,Kacy,"compilers are ""convenience for programmers"", you should be writing assembler yourself"
1148,1555275670.2216,Kate,"ok, no; that's asinine"
1148,1555275713.223,Fredda,"Harder to reason about, sure. But in terms of polynomial difficulty,; persistent data structures may be the minimal polynomial complexity for certain kinds of problems that have shared structure"
1148,1555275760.224,Kate,Can you be little more concrete about that?
1148,1555275768.2242,Kacy,well I think the premise of the question fundamentally kind of silly
1148,1555275783.2246,Kate,Polynomial complexity as I usually hear it refers to computational complexity
1148,1555275806.2251,Fredda,Navigating a procedurally generated universe of stars that don't fit in memory
1148,1555275826.2254,Kate,that sounds like an application not a computation problem
1148,1555275844.2257,Fredda,"Hmm, perhaps; There's this YouTube video of a guy that built an editor using persistent data structures implemented in c++. They call them postmodern data structures lol; It'd be pretty interesting to see that implemented in clojure"
1148,1555275956.228,Kate,cool
1148,1555275976.2286,Fredda,"Def check out that video sometime! It's worth a watch; This might be it <https://youtu.be/sPhpelUfu8Q>; another efficiency perk of Clojure's persistent data structures: snapshots. So if you have some problem that needs a consistent view of snapshots of data across some threads, mid-computation, then persistent data structures already solved the problem for you. People rarely use the snapshot capability though AFAIAA"
1149,1555281070.2323,Suanne,Why would a function have a `*` at the end of its name? My guess is that it’s a convention indicating that the function generates a lazy sequence. For example `evens*`.
1149,1555281228.2329,Celestine,"It's often used to indicate an ""implementation"" function. You'll often see it as the name of a function behind a macro.; You'll also see it for the implementation of some special forms in Clojure itself. Both `fn` and `let` are technically ""Special Forms"" but they are implemented as macros that expand to ""calls"" to `fn*` and `let*` respectively (which are implemented directly in the compiler).; Where I've also seen it used a lot is for functions that implement a cache: if `foo` is the cached version of the function, it will often be implemented in terms of `foo*` which will be the uncached version of the function.; Does that help <@Suanne> ?"
1149,1555281467.237,Suanne,<@Celestine> Hmm. I think I understand. In other languages I would expose the modules function with a friendly name and then have another function behind the scenes that does the actual work (because it needs extra parameters for example). So this is a convention for that sort of pattern?
1149,1555281521.2379,Celestine,"Yes, it's a fairly common pattern for implementation detail functions."
1149,1555281558.2387,Suanne,<@Celestine> In JavaScript I would usually pre- or post-fix an `_` for this same purpose.
1149,1555281586.2393,Celestine,"Yeah, I've seen that convention in C/C++ as well."
1149,1555281633.2403,Suanne,"Side note, something I love about Lisps is using a dash as-a-separator for names. It’s by far the most natural way to do this in my view and it’s a shame most other languages don’t do the same."
1150,1555288344.2428,Ermelinda,"Any idea how I can achieve this in Compojure:
```
(def app
  (-&gt; (wrap-defaults (get-app-routes handler) site-defaults)
```
I want to define the routes based on the hostname. The problem of course is `handler` above is not defined."
1149,1555288473.2433,Latrice,I beleive you’re missing a closing parens or 2
1150,1555288535.2437,Latrice,"but other than that, what is get-app-routes?"
1149,1555288711.2467,Ermelinda,"I am not missing parens. I just omitted some middleware. get-app-routes looks like this for now:
```
(defn get-app-routes [handler]
  (defroutes app-routes
    (GET ""/"" [] ""Hello"")))
```"
1150,1555288771.2485,Latrice,"you don’t seem to use the handler, do you need to do something odd and dynamic?"
1150,1555288780.249,Ermelinda,The idea is to return different `app-routes` based on the hostname that I can get from the handler request object
1150,1555288791.2492,Latrice,"aaaaahh.. I see..; I can’t think of any clear solution for this since I don’t understand the case very well.
My last bit of advice is you might be able to get away with just using routes instead of defroutes because it doesn’t seem like you’ll use app-routes directly anyway.; maybe middleware might be the way, maybe just a conditional in the routes themselves. :sweat_smile:  sorry I can’t be more useful, hope someone else can help."
1150,1555289829.2564,Ermelinda,"Thanks, I guess I'll keep trying."
1150,1555297422.2572,Faustino,"I finished my results of comparing Clojure, C, Python/Jython/Cython, Ruby/Jruby for the nth term of Fibonacci."
1151,1555297444.2574,Faustino,<https://github.com/starchild33/algorithms/blob/master/README.md>
1152,1555324429.2682,Frederick,"Hi, I have a simple TTL cache built around an `(atom {})` the logic that gets a value either finds an entry or gets a new one if the entry was missing or already expired (the loading of the entry involves a short Redis IO op). Dead simple.
Now, I want to improve it and make it thread-safe. It is not _not entirely_ thread safe because 2 threads can find a missing/expired entry and trigger a load (redis call) simultaneously.
How would you recommend locking the IO per key?
1. `(locking cache-key ...)` comes to mind but is not so the Clojure way (also, I’ll have to maintain an additional map of locks)
2. maintaining a map of entry as ‘loading’ `ref`s where every load from DB is a transaction on the corresponding ref. This also sounds overly complex.
Any more inspirations?"
1153,1555326929.269,Toccara,"Hello guys, is it possible to overwrite the functionality of default protected java method from clojure?"
1154,1555327293.2693,Holly,"Hi guys, what do you use for queuing? Ideally redis-based?"
1153,1555327302.2696,Holly,I was checking farmhand but it's a bit buggy
1154,1555327567.27,Frederick,<@Holly> out of process queuing?
1154,1555327723.2703,Holly,<@Frederick> yep
1154,1555327799.2711,Frederick,if you are looking at redis libraries i would recommend carmine
1154,1555327890.2713,Toccara,clojure.lang.PersistentQueue/EMPTY
1154,1555328093.2716,Frederick,that’s in-process ^
1155,1555330433.2717,Vita,core.cache has composable caches and the ability to define a custom cache. I wonder if you implemented a custom cache that uses redis to back it and then composed it with the built-in ttl cache if that would give what you want <https://github.com/clojure/core.cache/wiki/Extending>
1154,1555332485.2723,Holly,"<@Frederick> carmine looks great, but I would need some kind of ui to check the data, as well as retries and such; I'm looking for something like sidekiq"
1156,1555336402.2744,Cira,"is there a nicer way to write this:

```(defmacro define-multiple [things]
  (into []
        (for [[k v] things]
          `(def ~(symbol (name k)) ~v))))

(define-multiple {:a 3 :b 2})
```"
1156,1555336792.2749,Jasmine,"I don't think that's doing what you want; usually if you're emitting multiple top-level things, it's best to wrap it in a `do`"
1154,1555339767.277,Zona,"```(defmacro defmany 
  [definitions]
  `(do ~@(for [[k v] definitions]
           `(def ~(symbol (name k)) ~v))))```; something like that maybe ?; `for` returns a list of forms, e.g. `((def a 1) (def b 2))`, so using `~@` splices the outer set of parens away; ```(macroexpand-1 '(defmany {:a 1 :b 1}))
=&gt; (do (def a 1) (def b 1))```"
1157,1555354701.2806,Ermelinda,Is there a way in a Ring web app to get the hostname *before* defining Ring's handler?
1157,1555354909.2814,Dann,"if the result of `(clojure.java.shell/sh ""hostname"")` is correct, that would be one way to get it; you could also ensure that it's set in the environment or passed as an arg to -main"
1157,1555355322.2831,Rosaline,"the server-name that you get in a ring request is from the value of the client sent Host header, and not your hostname"
1157,1555355377.2842,Ermelinda,"Yeah, I want to determine the subdomain the request is coming from before creating Ring's handler"
1157,1555355386.2844,Rosaline,"basically ""this is who the client thinks you are""; so without a client, you can't have that"
1157,1555355473.286,Ermelinda,"It's for a SaaS system using subdomain but the company offers multiple products. For that reason, I need to set a different set of routes based on the subdomain.; I thought I could get it to work like this: `(as-&gt; handler x (wrap-defaults (get-routes x) site-defaults)` but it turned out the routes are parsed on the startup only."
1157,1555355726.2909,Rosaline,"It doesn't matter what it is for though, right? You are asking to get the value of the host header,  which is sent by clients each request, and can vary, before a request has been sent, which is impossible; What routing library are you using? Most of them can route base on the host header"
1157,1555355826.2929,Ermelinda,I tried Compojure and bidi; bidi has subdomain facilities but they need to be hardcoded
1157,1555355896.294,Rosaline,You will have to hard code them
1157,1555355917.2946,Ermelinda,There are hundred if not thousands of them; I will need to ping the DB to see which app to use for the provided subdomain before creating the routes
1157,1555356037.2975,Rosaline,"You'll need you create a handler, which takes a request, hits the DB, looks up base on the host header, then generates the routes and applies them to the request; Basically stop def'ing routes as global(which is terrible any way), because you need to parameterize them; Def'ing routes as a global value (as seen in lots of docs and tutorials) means 1. Parameterizing your routes doesn't work 2. Your handlers have to globals too"
1157,1555356447.3032,Ermelinda,When can I define them if not globally? That's all I saw in the docs like you mentioned.; Any bits of code I can refer to?
1157,1555356712.3041,Rosaline,Use routes instead of defroutes
1157,1555356752.3046,Ermelinda,"Ok, I will give that a try. Thanks."
1158,1555359127.3058,Adrianne,when should I use `partial` rather than the `#(func arg1 arg2 %)` syntax?
1158,1555359471.3063,Malik,maybe when it's `#(func % arg1 arg2)`?; err don't use partial for that; rather
1158,1555359514.3079,Adrianne,"that's the thing, I use the `#()` syntax all the time, and I'm not sure where I should use partial instead"
1158,1555359520.3082,Becki,I think people prefer to read the anonymous function version rather than the partial. but partial isn't out of place i don't think
1158,1555359525.3084,Adrianne,`#()` looks cleaner to me
1158,1555359539.3089,Malik,"I tend to just use `#()` all the time, too"
1158,1555359549.3092,Becki,there is no should. I think someone mentioned that had the anonymous version been around earlier in Clojure's life `partial` might not have been made
1158,1555359678.3105,Shayla,"`partial` is nice cuz it very plainly says, ""i'm returning a function that is just waiting on final input""; `#()` to me says, ""this is an anonymous function"" and requires a different kind of parsing; `partial` feels like clojure's version of currying"
1158,1555359734.3119,Jasmine,"My advice would be, don't use `partial`"
1158,1555359745.3122,Shayla,"oh? well, okay then!"
1158,1555359789.3128,Jasmine,"which is not to say that people don't, and it's fine that they do, but `#()` is imo the Clojure way to do this; just my own opinion and it's ok for others to have their own preferences :)"
1158,1555359871.314,Shayla,"What feels more ""Clojure"" to you about `#()`?"
1158,1555360300.3177,Becki,"one thing a partial obscures the remaining calling convention whereas `#(func %1 :foo %2)` is clear that it expects two more args. Also, if you refactor the signature of the function `partial` might no longer be up to the task leading to needless churn in a diff. For instance, `(defn foo [a b c])` you can use `(partial foo a b)` but if you change the signature to `(defn foo [a c b])` you can no longer partial this application and you would have to switch to `#(foo a % b)` instead of just changing the position of the `%` and the `b`"
1158,1555360740.319,Ermelinda,I got it to work based on the tips you provided. Thanks :slightly_smiling_face:
1158,1555360853.3202,Celestine,Also `#(func 1 2 %)` compiles to a function directly whereas `(partial func 1 2)` compiles to a call (to `partial`) that returns a function. The performance difference is tiny -- I'm mentioning this more to highlight there is a runtime element to `partial` whereas the anonymous function is a compile-time expression.; (I'm one of those folks who still tends to use `partial` but I admit that I'm moving away from it...)
1158,1555360971.3218,Becki,it has an elegance to me sometimes but i'm moving away from it as well.
1159,1555362380.3225,Harris,"`partial` also captures the var value instead of the var, so it can lead to surprising behavior when using dynamic vars for example"
1159,1555362449.3231,Onita,a poll: should you ever use a macro if you can use a function?
1159,1555362484.3236,Harris,"```user=&gt; (def ^:dynamic *a*)
#'user/*a*
user=&gt; (def f (partial + *a*))
#'user/f
user=&gt; (def g #(+ *a* %))
#'user/g
user=&gt; (binding [*a* 1] (g 1))
2
user=&gt; (binding [*a* 1] (f 1))
Execution error (ClassCastException) at user$eval164/invokeStatic (REPL:1).
clojure.lang.Var$Unbound cannot be cast to java.lang.Number
```; <@Onita> if it's convinent, yes, but you should also have the function version for when you want to use it in a higher-order context, or when the value needs to be resolved at runtime"
1159,1555362575.3254,Becki,"what's the best reaction for ""that's a good point i hadn't considered. thanks"""
1159,1555362587.326,Harris,"e.g. clojure has `with-binding` and `with-binding*`; one is a macro on top of the function; sometimes you need to use the function version when the binding map is built at runtime; but often it's not and the macro version is just less verbose to use; to add on this, `partial` also causes the stacktrace to point at `partial$fn&lt;whatever&gt;` instead of making acustom class, which can make debugging way harder"
1159,1555362821.3296,Onita,"hmm, ok"
1159,1555362859.3302,Mariela,"Interesting points in favor of `#()`. Normally I favor `partial` because `#(% ...)` looks like someone swearing in a comic book

But yeah looks like I should switch"
1159,1555363262.3309,Adrianne,"if I have a lazy `repeat` in clojure, can I turn it into a lazy vector I can use with `assoc`?"
1160,1555363298.3315,Marlyn,vectors are not lazy -- they have a fixed length
1160,1555363423.3321,Adrianne,is there an equivalent of assoc that can be done on a lazy seq?
1159,1555363459.3327,Becki,what are you trying to achieve. often its best to take a step back and figure out if there's a better way
1159,1555363480.3331,Adrianne,"I'm trying to create a brainf**k interpreter, as an exercise. This is for the tape."
1160,1555363758.3342,Becki,"you could use `map-indexed` and something like
```
(let [index 3]
 (map-indexed (fn [i x]
                (if (= i index) :replaced-value x))
              (range 6)))
(0 1 2 :replaced-value 4 5)
```"
1160,1555363777.3345,Rosaline,use a map; a map is a better model for the tape
1160,1555363849.3353,Becki,"if you can drop your lazy requirement, which you probably can?"
1160,1555363877.3361,Rosaline,the lazy requirement is nonsensical
1160,1555363892.3365,Adrianne,I don't really see how a map makes a better tape model than a vector when the tape is a sequence?
1160,1555363908.3373,Becki,your current woe would be solved
1160,1555363909.3374,Rosaline,a map allows for a sparse representation
1160,1555363920.3379,Adrianne,the lazy thing was because I thought doing a lazy tape was elegent and solves the bf interpreter problem of running out of tape
1160,1555363941.3384,Rosaline,e.g. with a map you can assoc a value in for 1e3 without needing a value in the map for everything between 0 and that
1160,1555363966.3387,Adrianne,that actually makes more sense; thanks
1161,1555364706.3406,Suanne,"Can you help me understand the difference between these two forms of generating a lazy sequence?

```
(defn evens-v1
  ([]
   (evens-v1 2))
  ([n]
   (lazy-seq (cons n (evens-v1 (+ n 2))))))
```

```
(defn evens-v2
  ([]
   (evens-v2 2))
  ([n]
   (cons n (lazy-seq (evens-v2 (+ n 2))))))
```

As far as I can tell, these both behave identically. Their return types are `LazySeq`."
1161,1555364767.3414,Rosaline,"the boundary of laziness is lazy-seq, so you would say evens-v1 is slightly more lazy and evens-v2 is slightly more eager"
1160,1555364860.3432,Rosaline,"so with evens-v1, when you call it returns a lazy seq, and when you call first or rest on it, the body of the lazy-seq call is executed and cached, and first or rest is called on it; with even-v2 when you call it, it cons's n on to the unforced lazy seq constructed by lazy-seq and returns that; the type of a lazy seq doesn't change, regardless of if it has been forced or not"
1160,1555365041.3466,Suanne,"Ok, so the difference is basically negligible but version 1 is truly lazy since v2 starts creating that sequence (albeit a single element of it) when you call it even before it is realized."
1160,1555365093.3474,Rosaline,"correct, the difference in this case is negligible, but it can be larger, it depends on the amount of computing required to construct that initial element"
1161,1555365114.3476,Suanne,Thanks for the explanation!
1160,1555365168.3484,Rosaline,"I am not sure I have come across a case where it mattered a lot, but in general I try and hoist lazy-seq calls up as high as possible so they wrap as much of the function body as possible"
1160,1555365185.3487,Suanne,That makes sense.
1160,1555365891.3515,Kayce,"can someone help me with a bit complex regex/replace problem.
I need anything that matches to be wrapped one way, anything that doesn’t match the other way, e.g.: if given string like:
“Donec vitae dolor color or sotamayor” I want to highlight everything that matches “or”, basically I want it to become something like:

```
[:span ""Donec vitae dol""
 [:span.h ""or""] [:span ""col""] [:span.h ""or""] [:span "" ""] [:span.h ""or""] [:span ""sotamay""] [:span.h ""or""]
```; matching part is relatively easy… but I can’t figure out how to replace things that do not match"
1160,1555366187.353,Dann,"<@Kayce> I'd be inclined to use the `.find` `.end` methods, each returns a numeric index you can use with subs"
1162,1555366225.3537,Dann,and then use cons and recursive calls (maybe with lazy-seq even)
1160,1555366282.3543,Dann,"take string, call `.find` get a start index, call `.end` get end index, cons two strings, then self-call"
1160,1555366333.3549,Kayce,hmm… but why can’t it be two pass string/replace?
1160,1555366363.3557,Rosaline,<https://github.com/ztellman/automat> could be useful
1160,1555366366.356,Dann,"string/replace could be possible, but I think the self-call cons approach is easier to think about"
1160,1555366457.3572,Kayce,"so like if I want for example wrap anything that doesn’t match “or” and place it between “^” and “$”… :
```
(clojure.string/replace
 ""Donec vitae dolor color sotamayor""
 #""(?!or)""
 #(str ""^"" %1 ""$""))
```
except it’s not working as I would like it to ;("
1160,1555366604.358,Rosaline,"I am not sure regex syntax is flexible enough for what you want; but a regex is a kind of finite state automata, and automat is a more flexible way to construct those; I am no regex wiz, but I think your issue is, regex is a character by character scan, and you are trying to say, chunk things in to groups that are not this two character sequence; but a regex would only match the character sequence at a time, so even if it did work, you would get lots of two character slices; which is actually almost what you get with your ^$ example"
1162,1555367369.3632,Becki,"```
(let [states {\o {:string :o}
              \O {:string :o}
              \r {:o :or}
              \R {:o :or}}]
  (reduce (fn [[acc [state buffer or-buffer]] c]
            (let [new-state (get-in states [c state] :string)]
              (case new-state
                :string [acc [:string (str buffer or-buffer c) """"]]
                :o      [acc [:o buffer (str c)]]
                :or     [(conj acc buffer (str or-buffer c)) [:string """" """"]])))
          [[] [:string """"]]
          ""Donec vitae dolor color or sotamayor""))

[[""Donec vitae dol"" ""or"" "" col"" ""or"" "" "" ""or"" "" sotamay"" ""or""]
 [:string """" """"]]
```"
1162,1555367514.3635,Dann,"```egret.run=&gt; (re-split-seq ""Donec vitae dolor color or sotamayor"" #""or"" (fn [x] [:span.h x]) (fn [x] [:span x]))
([:span ""Donec vitae dol""] [:span.h ""or""] [:span "" col""] [:span.h ""or""] [:span "" ""] [:span.h ""or""] [:span "" sotamay""] [:span.h ""or""] [:span """"])
```"
1160,1555367525.3637,Dann,"imperfect, but it's a start"
1162,1555367570.3639,Dann,"```(defn re-split-seq
  ([s re marked unmarked]
   (let [matcher (re-matcher re s)]
     (re-split-seq s re marked unmarked matcher 0)))
  ([s re marked unmarked matcher unmatched]
   (let [found? (.find matcher)
         start (when found? (.start matcher))
         end (when found? (.end matcher))]
     (if found?
       (cons (unmarked  (subs s unmatched start))
             (cons (marked (subs s start end))
                   (re-split-seq s re marked unmarked matcher end)))
       (list (unmarked (subs s unmatched)))))))```"
1162,1555367641.3643,Rosaline,(or use java.util.Scanner)
1160,1555367753.3647,Kayce,I need it to work in Clojurescript (preferably)
1160,1555367766.365,Rosaline,use automat
1160,1555367937.3659,Dann,"in js you'd want `.search` (returns index of start of match) and `.lastIndex`; and you'd use a RegExp instead of matcher (I assume in cljs #"""" is already a RegExp)"
1160,1555368300.3687,Kayce,"sorry guys… I got dragged into fixing an issue in an RC. Thank you all for your suggestions, I will try them!
:spock-hand: <@Dann> <@Rosaline> <@Becki>"
1163,1555380260.3712,Leisa,"Looking for Clojure-scriptable 3D/physics environments. Know about Arcadia and <#C0FM7N1SM|quil> but want to know what else is out there. Big plus if a world/system can be created entirely in code, ideally all Clojure/script."
1163,1555380786.3783,Wesley,"Hi <@Leisa> .  I don't have the answer but wonder if Zulip would be a good place to ask.  (Do I remember that you used to to ABM modeling in Clojure?  I've been working on a little library to make it easier to use MASON in Clojure.); Would someone be willing to post a pointer to instructions for deploying to Clojars with Leiningen without signing?  I'm sure the info is there somewhere, but the `lein` help on this is not very clear to me give what I don't know, and the docs on the web seem to focus on signing.  I may be overlooking the crucial bit ...."
1164,1555386437.3793,Malik,"why is clojure's destructuring of maps so weird? ```user=&gt; (def artist-map {:painter :monet :novelist :austen})
#'user/artist-map
user=&gt; (let [{painter :painter writer :novelist} artist-map] (println ""The painter is"" painter) (println ""The novelist is"" writer))
The painter is :monet
The novelist is :austen```; in elixir/erlang and other languages it's more like: ```iex(4)&gt; %{:painter =&gt; painter, :novelist =&gt; writer} = %{:painter =&gt; :monet, :novelist =&gt; :austen}
%{novelist: :austen, painter: :monet}
iex(5)&gt; painter
:monet
iex(6)&gt; writer
:austen```; but clojure goes `{symbol keyword}` instead of `{keyword symbol}`"
1163,1555386558.3816,Celestine,"<@Wesley> You'll need something like ```:repositories {""clojars"" {:url ""<https://repo.clojars.org>"" :sign-releases false}}``` in your `project.clj` file."
1164,1555386629.3829,Celestine,(or your `~/.lein/profiles.clj` file)
1164,1555386635.3831,Malik,"javascript works the same way as elixir/erlang, apparently; I'm used to things being done differently but usually they make some kind of sense to me. this really doesn't"
1164,1555386696.3843,Celestine,<@Malik> you can do `(let [{:keys [painter novelist]} artist-map] ...)`
1164,1555386756.3846,Malik,say what now?
1164,1555386818.3852,Celestine,You only need the form you showed if you want to rename the matches (as you did with `writer`)
1164,1555386819.3853,Malik,"oh, found it in the docs; that's cool and all, but I'm still stumped as to why it's in the form `{symbol keyword}`"
1164,1555386878.3871,Celestine,I pretty much always use the `:keys` form -- I just the other day used the long form because I was renaming a substructure match.
1164,1555386881.3872,Malik,it's so counterintuitive to me
1164,1555386899.3876,Celestine,Because you normal bind `symbol` to `expression`.; So destructuring binds `symbol`s to `keyword` selections from the right hand side expression.
1164,1555386937.3883,Malik,ohhhhhh; because you can call `(:keyword artist-map)`
1164,1555387055.389,Frederick,"<@Vita> I wonder where are you aiming at. The core.cache implementation does not ensure that a fetch for a single key is called once. on the contrary:
```(defn get-data [key]
  (cache/lookup (swap! cache-store
                       #(if (cache/has? % key)
                          (cache/hit % key)
                          (cache/miss % key (retrieve-data key))))
                key))```
assumes that `retrieve-data` can be called multiple times since if multiple threads race on the missing key branch than the `atom` implementation will trigger a retry for the ‘loosing’ thread. Since the eviction policy I implemented is very naive (and that is quite okay for me), what I am looking for is just to ensure that `retrieve-data` is ensured to be called once per TTL expiry and not more. This is since I want to protect my DB against a flood of requests once the TTL of many object expires. <@Celestine> maybe you have some ideas?"
1164,1555387344.3893,Celestine,<@Frederick> Check through the open issues on the repo: there's discussion of exactly that issue and an example of how to ensure `retrieve-data` is only called exactly once.
1164,1555387627.3895,Frederick,"<@Celestine> no issues on that github page: <https://github.com/clojure/core.cache>
what m i  missing?"
1164,1555388021.3916,Wesley,<@Celestine> great--thanks much.  I wasn't even sure what config file I should be looking at.
1164,1555388154.3917,Frederick,"<@Celestine> no issues on that github page: <https://github.com/clojure/core.cache>
what m i  missing?; I think that the issues are not open. is there an open jira sute for those?; <@Celestine> I think I found it here: <https://dev.clojure.org/jira/browse/CCACHE-50>"
1164,1555389106.3924,Celestine,"Right. I have a notebook with ideas about how to make higher-level usage of the caches easier. There are some gotchas with TTL as well because `lookup` can cause cache expiry so the simple, obvious usage can return `nil` -- which `cache.memoize` has to deal with."
1165,1555413077.3944,Leticia,what’s idiomatic way to deduplicate messages from one channel into another within some window of X messages?
1166,1555414714.3958,Rita,"Would anybody know why I'm getting this error message getting the Client for Datomic cloud ```Unable to resolve entry point, make sure you have the correct version of com.datomic/client on your classpath```"
1167,1555419489.3981,Leisa,"<@Wesley> Just looked into Zulip but not sure how to get started and find where you're suggesting I ask about this. Pointers? Clojure-scripted MASON might indeed be useful for me, especially if it could really all be done from Clojure.; If anyone else has pointers to Clojure/script-scriptable environments for 3D simulations/physics, beyond Arcadia and <#C0FM7N1SM|quil>, I'd love to hear about them!"
1167,1555419683.3999,Evonne,Have you looked at <https://github.com/oakes/play-cljc> ?; (Successor to <https://github.com/oakes/play-clj>)
1168,1555420279.4005,Otelia,try <#C03RZMDSH|datomic> channel?
1167,1555423120.4035,Ciara,"<@Leisa> searching on Zulip yields results from streams you're subscribed to. Searching for 'quil' yields results from the following streams for me: *clojure-stl* (<https://clojurians.zulipchat.com/#narrow/stream/152255-clojure-stl>), *data-science* (<https://clojurians.zulipchat.com/#narrow/stream/151924-data-science>) and the *slack-archive* (<https://clojurians.zulipchat.com/#narrow/stream/180378-slack-archive>)"
1167,1555423707.4041,Leisa,Thanks <@Ciara>
1169,1555424548.4085,Brent,Hello! Any tips how to stop symbol included inside ` from being fully qualified? See ``` (let [s 'hello] `(defn ~s [] nil))``` produces `(defn myns.core/hello [] nil) ` Thank you!
1169,1555425172.4088,Harris,````(defn ~'hello [] nil)```
1170,1555429179.4104,Shayla,Are the macro characters processed from left to right/outer to inner?
1170,1555429337.4107,Meagan,what do you mean by “macro characters”?
1170,1555429466.4114,Shayla,"sorry, didn't want to say symbols, I mean the tilde and apostrophe and others"
1170,1555429548.412,Meagan,"still not sure I completely understand the question, but syntax quotes and other symbols operate the same as any other clojure form; e.g. ` will syntax quote the following _form_ and everything inside it; another way of thinking about it: `'(foo bar)` is the same thing as `(quote (foo bar))`; ` and ~ operate the same"
1171,1555432891.4145,Jasmine,All of them operate on the next read form
1172,1555433740.4146,Dann,"another reason is that the destructuring form is a hash-map, and you can't have a hash map that uses the same key multiple times

there are valid reasons to destructure on the same key twice in one destructure"
1171,1555443629.4175,Wesley,"<@Leisa>, well there are a bunch of data science people hanging out on Zulip lately, mostly in the data science section, but posting elsewhere.  What you're asking about isn't data science per se, I suppose, but there may be some overlap, and if nothing else, the data science people are interested in graphical representations such as quil.  Yes, you can do everything in MASON from Clojure, although there have to be parts that smell of Java.  More soon."
1172,1555443757.4185,Wesley,"Also, I haven't done anything with 3D MASON.  It's possible that my library has some 2D bias, but I don't think so.  If so, I'll fix it.; Ah, I see, eval2020 responded usefully."
1172,1555445290.4222,Tammera,"Spec question: Say that I have a graph of _nodes_ and _edges_ modelled as a map with those keys. Now lets say that I want to spec that all nodes are connected. I can write a predicate `is-connected?` that takes the entire graph, and says whether it is connected yes or no. But for large graphs, that will be hard to track down. Is there a way to _also_ be able to spec it in such a way that I can also explain which node was not connected?; Example: `{:nodes [:a :b :c :d] :edges [[:c :d]]}` is invalid because `:a` and `:b` are non-connected"
1172,1555445542.4245,Lane,What about `{:nodes [:a :b :c :d] :edges [[:c :d] [:a :b]]}`?; What I mean is that you might need a more precise definition of connected.
1172,1555445996.4278,Tammera,"Right, in reality I am interested in their degree, I am however struggling with writing a spec that is evaluated for each node with the graph as “context”. There is no way to determine the degree of a node without knowing to which other nodes it is connected to."
1172,1555446184.4287,Jasmine,you are really just in the land of writing a function I think; spec is not going to help you with this problem much; there is not currently a way for predicates to give a more precise answer than valid/invalid
1172,1555446264.4307,Lane,"Yes, you should write a predicate that test whether the graph is connected and use it in your spec for the whole graph. If it is not you can write another functions that will return the potential ""culprits""."
1172,1555446281.431,Jasmine,"explain can potentially tell you a more detailed reason why; or a set of ""problems"""
1172,1555446323.4319,Tammera,"I can attach a custom explanation, right? Because saying that it failed `is-connected?` is the thing that I am trying to avoid; or… I want to be more specific than that"
1172,1555446431.434,Lane,But you don't have to do this inside spec. You can detect that the graph is not connected by applying your spec and in a second time call a function that will identify the subgraphs.
1172,1555446460.4345,Jasmine,I'm not sure that spec is giving you any value in what you're describing over just writing functions
1172,1555446602.4362,Tammera,"right, yeah I just wanted to add it to the other things being checked with specs, but maybe I indeed shouldn’t. Such that checking with `s/valid?` gives you the “entire” picture. I’ll hammock over that, thanks as always!"
1173,1555447200.4386,Huey,Has anyone had issues using `scroll` from clojurewerkz/elastisch API pointing to ES version 6.4.2? This method works fine for ES 5.x.
1174,1555453158.4395,Faustino,@jp are you trying to do infinite scroll?; are you implementing infinite scroll?; I wrote those from scratch in JS. Saving the position on the page and loading it…. is a deal breaker in terms of UX. I don’t like infinite scroll for that reason.; Infinite scroll does not add value to UX… You could just write an ajax pagination if you want a better user experience. If you are just trying to save the user from needing to refresh a web page/
1175,1555461379.4402,Dann,<https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-scroll.html>
1175,1555461572.4422,Mohamed,"I have in coming datastructures for requests like this
```
[{(ucv.ui.root.signon/login {:email ""<mailto:admin@foobar.com|admin@foobar.com>"", :password ""letmein""})
  [:session-key :logged-in? :user-id :firm-id :pos/id :user/id :firm/id]} :com.wsscode.pathom/trace]
```
And I want to log them, but omit any whitelisted keys (like `:password`), but otherwise log the datastructure completely as is (don’t want to change vectors to lists or anything). What the recommended way of doing that?; I tried `clojure.walk/poswalk` but even with `identity` that changes the datastructure; oh wait no, i forgot to prevent the list from being treated as code; so, seems like postwalk can work, is that the recommended approach for something like this?"
1176,1555463357.4431,Tonya,what do you want to log them to? plaintext?
1176,1555463743.4433,Faustino,Why can’t you just query the search page by page… instead of setting a scroll timeout parameter?; Solr/ElasticSearch should be able to paginate your search; it sounds like scroll is for clients that cannot keep track of the same search url
1176,1555463888.4439,Mohamed,just logging with timbre
1177,1555468038.4442,Tonya,yeah to remove the :password field in an arbitrarily nested structure postwalk is your best bet
1178,1555473506.4444,Lavonia,"`postwalk` should do well. If you want to preserve the datastructure though (i.e, not everything should be coerced to seqs which print as lists) check out the library `specter`. Code for things like this also ends up being faster and less ceremonious."
1179,1555482716.4532,Alleen,"I want to write a clojure function in java, and that function may throw an exception that is unknown at compile time.

in clojure I can throw anything, anywhere :
```
(fn [error] (throw error))
```
So clearly the JVM bytecode allows this and it does the expected thing at runtime. But if I try to do that in java, `javac` gives the finger :
```
new AFn() {
            public Object invoke(Object error) {
                throw (Throwable) error;
            }
        };
```
`unreported exception java.lang.Throwable; must be caught or declared to be thrown`

is there a compiler or language trick to make `javac` happy there ?; found my answer <https://stackoverflow.com/questions/4519557/is-there-a-way-to-throw-an-exception-without-adding-the-throws-declaration>"
1180,1555499274.4553,Clarine,"With clojure.tools.reader, how do I set the “current ns” when reading auto-namespaced keywords?
```
(binding [r/*alias-map* {? 'foo}] (read-expressions ""(ns foo) #::{:b 1}""))
```; or do I set `*ns*` to `'foo`?; that works:
```
(binding [*ns* (create-ns 'foo)
            r/*alias-map* {'foo 'foo}] (read-expressions ""(ns foo) #::{:b 1}""))
```
but I’ve no idea if that’s how it should work"
1180,1555499635.4568,Harris,"`read-expressions` can't really work consistently in clojure jvm; consider `""(ns foo (:use bar)) (foo)  #::{:b 1}""` with `(ns bar) (defn foo [] (in-ns 'bar))`; if you accept this limitaion, then yes, bind `*ns*` manually; no need for alias-map; but the model of clojure is read-eval-loop; not read-loop"
1180,1555499755.4599,Clarine,"read-expressions is my own function, which should emulate the read-eval loop; so I’m going to mess with `*ns*` there"
1180,1555499788.4606,Harris,then if you eval the `ns` form before reading the map it should `set! *ns*` automatically; and there should be no need to bind it
1180,1555499822.4614,Clarine,"I’m not going to eval anything, just static code analysis"
1180,1555499830.4616,Harris,"ok, that's what I'm saying; it cannot work in the general case in clojure; because clojure is not static like clojurescript; and the read/eval phases are not split"
1180,1555499871.4631,Clarine,because there can be non-top-level in-ns expressions you mean?
1180,1555499883.4634,Harris,"same reason why you can't macroexpand a full file w/o step by step evaluation; this can work in clojurescript, not in clojure; it can work in clojure for the 90% of the real world code, but by convention"
1180,1555499922.4642,Clarine,"yeah, I guess I’m going to have to live with that"
1180,1555499951.4649,Harris,"right, then yes, `(binding [*ns* (create-ns ..)] ..)` is the best you can do; modulo doing some crazy analysis but I don't think you want to go there; yes"
1180,1555499990.4657,Clarine,90% is good for now
1180,1555500005.466,Harris,I'm just inventing that % btw :)
1180,1555500013.4662,Clarine,I think you’re not far off :wink:
1180,1555500074.4667,Harris,being able to do this stuff is why CL has `eval-when` and racket has defined phases; clojure has nothing equivalent; it's not the easiest language to build tooling/analysis for; but often it doesn't really matter to be fair
1181,1555501546.468,Toccara,Hello guys; what is the best way to override protected java method ?; for example:; None; i would like to write this piece of java in clojure
1181,1555501852.4703,Min,"In theory with gen-class I think, in practice writing it in java feels cleaner/faster; there was also once a discussion about this on jira, but it's gathering dust: <https://dev.clojure.org/jira/browse/CLJ-1255>"
1182,1555503056.4715,Jasmine,"Well aware of it, hoping to consider for 1.11 when we get there; You can find various utilities Clojure uses for this in clojure.lang.Util, like the sneakyThrow() method."
1182,1555503186.473,Min,excellent
1183,1555503795.4734,Alleen,"exactly what I need, thanks !"
1184,1555507277.4741,Toccara,:+1:
1185,1555509341.4756,Zona,"how useful are code reloading libraries like Component, Mount or Integrant? I worry that I'm diving into using a workflow I don't really need."
1185,1555509613.4771,Aubrey,You could start with just an atom holding your database connection pool - then go with one of those libraries when you need a second atom and dependencies between them. 
1185,1555509988.4775,Patrice,"as soon as you have resources that need to be initialized and restarted (database connection pools, HTTP server, job scheduler etc), it starts to make sense to use this pattern. I found Component to have too much bureaucracy and mount to be too “magical”, so these days I feel that integrant is a very good middle way"
1186,1555511548.4867,Huey,<@Faustino> thanks for your response! I am not trying to implement anything UX related- I simply want to retrieve all the data from a given index which is too much data to fetch at once (more than 10K records). I can definitely look into pagination instead. `clojurewerks.elasticsch` did a good job with `scroll-seq` in that it was very simple to retrieve all data with one call so I was hoping to use it in in a newer ES version.
1186,1555511710.4888,Alysa,"Just throwing this out there as a GUI alternative. I'm slow, still learning Clojure, time-constrained  but I think a productive exercise is to translate  the guiserver.lsp file written in newlisp to clojure. The actual GUI part is written in Java and spun up separately from a jar and the guiserver.lsp talks to it over a socket. I think it would be a very nice addition as a clojure librsry. If you play with it first in newlisp, you'll find its plenty responsive and complete enough."
1186,1555512872.4923,Faustino,"hmm. thinking. When I worked with Solr Lucene, I remember just iterating through the pages by page number in the get url portion."
1187,1555519300.4938,Madeleine,"They're not very useful to be honest; Don't use them until you feel a need for it; Especially if.you have this worry, it probably means you don't need them."
1188,1555519881.4954,Fausto,Anyone know of something like `clojure.core/eduction` except where the *input* is itself a reducible?; Another way to say it would maybe be “something that could wrap a given reducible with a transducer xform”
1188,1555519961.4965,Rosaline,"that is what eduction does; my mistake, actually eduction doesn't call seq when printed either"
1188,1555520142.4985,Marlyn,it's the print mechanism that calls seq on it
1188,1555520147.4987,Rosaline,"oh, yes it does"
1188,1555520148.4988,Marlyn,I think I logged a bug on this
1188,1555520154.499,Rosaline,"yeah, print-sequential"
1188,1555520178.4992,Marlyn,"<https://dev.clojure.org/jira/browse/CLJ-1747>; ```
(defn less-promises-eduction [xform coll]
  (reify clojure.lang.IReduceInit
   (reduce [_ f init]
     ;; NB (completing f) isolates completion of inner rf from outer rf
      (transduce xform (completing f) init coll)))
```"
1188,1555520321.0012,Fausto,"<@Rosaline> Heh, how about that. I assumed from the docstring it needed a coll, and I saw that error when trying it at the repl :slightly_smiling_face:; Thanks very much"
1189,1555524994.0045,Raina,"I have a function that returns a lazy sequence, and I want to lazily concat invocations of this function. So I wanted to use `concat`, but I heard that it has performance issues and that each concatenation deepens the call stack. Is there some other way I can achieve this?; For instance if you had a function `(get-page n)` and it returns 10 items or nil, and you wanted to return a sequence of items that lazily calls `get-page` in the background as needed, what would you do?; and each call has a cost so you don't want to chunked-seq 32 calls at a time"
1189,1555525168.0068,Jasmine,<https://dev.clojure.org/jira/browse/CLJ-1906> is a longer exploration of this problem
1189,1555525390.0083,Rosaline,there are kind of 2 things there: 1. paginated api calls 2. concat; for concat I wouldn't worry
1189,1555525423.0094,Raina,I heard a couple of people complain about that
1189,1555525456.0105,Rosaline,"the problem with concat occurs when you use it in particular ways, but for example `(apply concat (get-pages ...))` is generally safe"
1189,1555525483.0111,Raina,And it's not `(concat ...seqs...)` it's really `(concat page 1 (lazy-seq (concat page2 (lazy-seq (concat page-3...`; A sequence of concats on 2 args
1189,1555525512.012,Rosaline,"yeah, don't do it that way; build a seq of seqs, then apply concat"
1189,1555525543.0127,Raina,but I don't know in advance how many subsequences I need to fetch
1189,1555525554.0132,Rosaline,that is fine
1189,1555525556.0134,Raina,I'm not going to load all pages then apply
1189,1555525574.0138,Rosaline,apply won't load all the pages
1189,1555525575.0139,Raina,that defeats the purpose altogether
1189,1555525768.0163,Rosaline,"`(apply concat s)` forces the first two elements of s (the first two pages) and then the rest will be forced as you walk the seq; but in general, lazy-seqs are not the best abstraction for io, which is why in my initial proposal on CLJ-1906 linked above I suggested something that just implements IReduceInit; exactly how and when pages are forced if you use lazy-seqs will also depend a lot on where/if you put the `(lazy-seq ...)` inside get-page (assuming it has one)"
1189,1555525944.0192,Raina,yeah I am aware of that; I think I'll read the discussion in that ticket
1189,1555526007.0207,Rosaline,"<https://ce2144dc-f7c9-4f54-8fb6-7321a4c318db.s3.amazonaws.com/reducers.html> is a thing I wrote a while ago about using reduce for this kind of thing, it talks about reducers which are kind of old news these days, clojure has grown even more reduce related features since then (transducers, the interfaces Reduce and ReduceInit)"
1190,1555528098.0215,Tamie,i seem to recall that there was a way to inspect or print out the intermediate values of the threading macros...  like an audit or something...  does that ring a bell for anyone?
1190,1555528352.0222,Dann,"`(-&gt; foo (f) (doto println) (g))` is one pattern for a quick hack; ```user=&gt; (-&gt; 42 (+ 10) (doto println) (* 2))
52
104```"
1190,1555529212.0229,Tamie,"How do I add metadata, this doesn't work:
```
(-&gt; (map (fn [x] ^{:a 1} x) [1 2 3])
    first
    meta)
;; ==&gt; nil
```"
1190,1555529260.0233,Dann,"numbers don't accept metadata, you need a type which supports it; the metadata is implemented as a field on the object that has it, if the object doesn't define the field there's nowhere for metadata to go; it might be more straightforward to use `(fn [x] {:a 1 :val x})` and then use `(map :val)` at the last step, rather than putting the metadata on the thing, you mix the thing in with the metadata"
1191,1555529634.0263,Onita,"hey everyone. i noticed that my heap usage according to visualvm has been increasing monotonically since i launched my application in the repl. is there anything going on under the hood that could be contributing to this outside of my application, or do i definitely have a leak somewhere?; about 1mb every two seconds or so"
1190,1555529763.027,Dann,the biggest gotcha I can think of is an indefinite lazy-seq where you hold onto a reference to the head
1191,1555529797.028,Onita,"oh, weird. it just dropped to about half and started increasing again"
1190,1555529805.0282,Dann,"but also it's normal for the jvm gc to let your app usage ramp up indefinitely until some limit is hit - you can test this by specifying a lower max usage; OK, that's normal jvm behavior, it's batching some things for perf reasons"
1191,1555529830.0288,Onita,interesting; so this isn’t indicative of a problem?
1190,1555529865.0297,Dann,"a normal run of a well-behaved app will look like a sawtooth, where garbage slowly accumulates then all goes down at once"
1191,1555529872.03,Onita,"yeah, that’s exactly what it looks like"
1190,1555529882.0302,Onita,cool. thanks; so i wonder if i need to keep my maximum steady-state usage to less than the vertical offset of this sawtooth; or if it’ll clean up before pushing me over the edge
1191,1555530413.0318,Jasmine,depends a lot on your app. how much resident memory does the app actually need? how fast does it produce garbage objects? etc. there are a few hundred knobs to turn for GC.
1191,1555530845.0325,Onita,"hmm, ok. are there any resources you could point me to in learning to formulate the right questions to ask here?"
1191,1555531030.0332,Jasmine,"it's a big topic, probably worth doing some googling. I don't have a canonical resource to point you to."
1191,1555531294.0356,Celestine,"<@Onita> Folks who are new to the JVM are often shocked by how much memory it takes up but it's a highly tuned platform and its ability to transparently use and release memory is part of what gives it the power it has... In production, we run processes with between 1GB and 4GB max heap typically -- mostly toward the low end of that -- and those are pretty high traffic processes.; (we have multiple, small services in Clojure now -- previously we had a monolithic web app in a different tech on the JVM and it needed 10-15GB of heap to stay high performance)"
1191,1555531470.0373,Onita,"cool, much appreciated"
1191,1555531604.0376,Malik,ohhh interesting ; thanks
1192,1555535564.0386,Madeleine,"The default GC for the JVM are optimized for performance, not for memory; Every GC run, that is, having to loop over objects, identify garbage, and clean it up, takes CPU away from your app; And also will hit your CPU caches and all. Making them cold again for your own computations; Thus what it generally does is wait until absolutely necessary before cleaning up; So it'll just let garbage accumulate until you run out of memory; That's a typical server workload style. Where it assumes your process is the main thing your OS is running, and thus it's better to maximise all your memory use and trade it for better performance"
1193,1555537521.0437,Faustino,What kind of tech did you have on the JVM to run the monolith? A web framework? I am just wondering which stack takes 15 GB to run.
1192,1555540553.0443,Tanisha,"<@Onita> This is a good overview of the GC options: <https://dzone.com/articles/choosing-the-right-gc>; It's a bit old, so it's leaving out a new GC coming in Java 11 (<https://www.opsian.com/blog/javas-new-zgc-is-very-exciting/>)"
1194,1555542112.0503,Donetta,"Is there any concept of inheritance ala common lisp CLOS defclass extending another class and fulfilling its type checks of the parent (particularly for multi method dispatch)?  Like, if I have a defrecord Person, and want multi dispatched on class. And want an Employee to extend person defrecord without redundant list of field names in arg vector,  and would like a defmethod foo Person to work on an Employee instance"
1194,1555542249.0519,Rosaline,no
1194,1555542308.0529,Celestine,"CFML. It would run in a lot less, but the best performance was when we cranked the heap up to 15GB, so the GC had plenty of leeway to do its work (we we using the G1 collector so we could minimize pauses and have reliable throughput)."
1194,1555542366.0541,Rosaline,"what you are describe is a typical oop type/class hierarchy, which to some degree clojure rejects(while still having to interop with that kind of thing on the java side) as a good way to organize data.; <https://clojure.org/about/rationale#_object_orientation_is_overrated>"
1194,1555542702.0551,Jasmine,Clojure rejects concrete inheritance
1194,1555542933.0556,Malik,why someone would be inheriting concrete is another question entirely
1194,1555543395.0559,Faustino,"wow, Cold Fusion. I remember that framework. It was just before Rails started gaining traction."
1195,1555546824.0568,Celestine,"These days CFML has both a commercial implementation (Adobe) and an open source implementation (Lucee). It evolved into a JS-like scripting language that compiles-on-demand to JVM bytecode (like Clojure), with a traditional OO model (unlike JS's prototype stuff), and it supports some metaprogramming, closures, map/filter/reduce etc. And it changed from Cold Fusion to ColdFusion some time in the 90's :slightly_smiling_face: I first encountered it when I worked at Macromedia and they bought Allaire (who created it in '95).; We migrated piecemeal to Clojure -- I wrote a small CFML library that did some classpath ""magic"" and used Clojure's Java API to `require` and call into arbitrary Clojure code: ```;; Clojure code
(some.namespace/func arg1 arg2)

// CFML code
clj.some.namespace.func( arg1, arg2 );``` :slightly_smiling_face:; Then we rewrote our code from the bottom up, until we had enough built to start spinning off individual Ring/Compojure apps.; I even have an adapter, written in CFML, that can call Ring handlers written in Clojure, and bridges cookies and session management across the two, so we can rewrite our remaining app one controller method at a time :slightly_smiling_face:"
1195,1555547686.0577,Onita,thanks!
1196,1555549485.0579,Faustino,I know that companies will hire you on the spot for Cold Fusion… because the talent pool is so tiny.
1196,1555549584.0581,Celestine,That's how I got hired into my current company -- where I introduced Clojure to replace CFML :slightly_smiling_face:
1196,1555550215.0583,Faustino,is it a good strategy as one grows in their career? Opposed to working for startups just doing full stack dev?
1196,1555551986.0595,Celestine,I'm server side only and I don't like startup / Silicon Valley culture :upside_down_face:; Front end stuff is just too annoying for an old dog like me to want to put up with!
1196,1555552752.0607,Faustino,ohhh believe me too… JS fatigue is hitting me too. I think JS is driving tons of people nuts.; <https://dmitripavlutin.com/6-ways-to-declare-javascript-functions/>; 6 ways… omg wow
1197,1555554503.0707,Wesley,"If the lib you need requires concrete inheritance, then you have to do it anyway.  In a specialized domain, you may not have a choice.  And the Java programmers who wrote it are just doing what makes sense in that world.  I personally would rather Clojure was a little more accommodating of this situation, but I accept that this is probably unlikely to change.  (I have fought the `gen-class` and contained it.); Ah, got it.  Too tired.  Feet stuck in it."
1197,1555554647.0723,Donetta,"I like the fact that I can use a class from defrecord as an early guard against invalid inputs to calls I want to make on it, for instance:
```
         (defmulti alive? class)
         (defmethod alive? UnitModel [{:keys [hp]}]
           (&gt; hp 0))
```; But, if there was any CL CLOS like facility, it would be even nicer if I could have a more specialized call like:
```
(defmethod alive? UndeadModel [{:keys [hp]}]
  (&lt; hp 1))
```; to me, its nicer to read a very small specialized/dispatching function, rather than a big case/cond within a defn that has to hold all current and future logic"
1197,1555554846.0746,Rosaline,"`(defn alive? [{:keys [hp]}] (&lt; hp 1))`; in general, using defrecords purely as data containers is kind of gross, use a map"
1197,1555555009.0761,Donetta,"I want flip flopped alive logic - if the unit is normal, hp &gt; 0, if its undead, hp less than 1.  If its some future type, like ""plant"", maybe its alive or dead based on which season of the year it is; I mean I could just use a 'type' key in a map and a case to choose which fn to dispatch to; just seems odd there is no built in facility to handle it"
1197,1555555092.0773,Rosaline,"you could do that, and you can use the hierarchy facility to do whatever; <https://clojure.org/reference/multimethods>; but using it is kind of gross and weird, it is very rare to come across"
1197,1555555228.0794,Donetta,"Started with a plain map, was attempting to refactor for cleaner code; basically, a combo of defrecord / spec and a custom factory fn (`make`) so I can ensure I always have valid state units in game; I was just hoping to branch it out into MobModel and PlayerModel actually, so I could keep AI logic separate from player specific functionality - in current iteration it is just plain maps and mobs become mob by having the :mob key added to their map; just seems kind of fast and loose and future error prone (when I have to backtrack through 100 function calls in the future and identify all fields a unit should have)"
1197,1555555483.0824,Rosaline,"spec works much nicer with plain maps vs records; I am not sure what you mean about back tracking through 100 function calls, if you have a spec that says what should be in a map, you have a spec"
1197,1555555531.0837,Donetta,sorry that was under the current iteration where I didn't really bother with it
1197,1555555536.084,Rosaline,"you can insert validation where you want it; or leave it out, or only validate when running tests, or whatever"
1197,1555555767.0859,Celestine,I'm so out of touch -- I know only two ways in JS! :rolling_on_the_floor_laughing:
1198,1555556267.0869,Donetta,What am I screwing up on the spec here?
1197,1555556283.0876,Wesley,A defrecord is simpler than spec if you don't need spec for other reasons.
1197,1555556288.0878,Donetta,"The error is:
         Execution error (ExceptionInfo) at expound.paths/in-with-kps (paths.cljc:183).
         Cannot convert path. This can be caused by using conformers to transform values, which is not supported in Expound; I'm assuming my args have to be wrapped in s/cat or something"
1197,1555556549.0907,Oleta,Yeah I think you’re correct - you need an ‘s/cat’ for args 
1197,1555556566.0918,Donetta,"So, even with s/cat it works now, with good input; but bad map, it just throws that error"
1197,1555556573.0927,Rosaline,Also it is better to use namespaces keys
1197,1555556574.0928,Donetta,"vs letting me know a bad instrumentation; namespaced keys is a lot of work when its user inbound json populating the keys though; well, maybe there is a wrapper for namespace keys to/from json"
1197,1555556606.0941,Celestine,Articles like that are why I detest JavaScript :upside_down_face: (but I now know a lot more about JS than I did before I read that!).
1197,1555556617.0947,Donetta,"i remember looking and flat maps, not terrible, nested ones, bad"
1197,1555556668.0974,Rosaline,"I dunno about the expound stuff, I think I am using it somewhere to get some nicer spec errors in one place, but otherwise I am not familiar with it"
1197,1555556683.0978,Oleta,"Hm, that might be a bug in Expound then related to errors on ‘fspec’ if this is happening on latest expound. "
1197,1555556709.099,Donetta,"afaik, i'm not explicitly calling it explicitly anywhere, unless cider (Emacs) is injecting some call - I am on clojure 1.10"
1197,1555556744.0999,Oleta,Perhaps a dependency is using it?
1197,1555556753.1001,Donetta,"`(alive? {:hp 30 :name ""Bob""})` - that call is fine, works alright.  This one: `(alive? {:xhp 30 :name ""Bob""})` error"
1197,1555556807.1016,Oleta,"(I saw something similar with return values for fspec, that are keys, so I think it might be expound bug). Feel free to file a bug and I’ll look into it. "
1197,1555556840.1024,Rosaline,"Something is pulling expound for you, and overwriting specs error reporting with it"
1197,1555557161.1055,Oleta,It’d be best to find what is doing that (maybe look at deps tree to start) but in a pinch you could reset the default printer. I’m on my phone but something like ‘set! s/*explain-out* s/explain-printer’
1197,1555557226.1056,Faustino,I spent half the day looking for a Javascript function in the codebase… only to find out that some weird function definition was used… so ya… JS is a pain in that regard. I think that’s why so many people love TypeScript.
1197,1555557272.1059,Donetta,ty; I guess that's what I get for running code I didn't fully read yet :slightly_smiling_face: (luminus lein template); `(alter-var-root #'s/*explain-out* (constantly expound/printer))`
1197,1555557443.107,Oleta,"Ah, yeah, that’ll do it :)"
1197,1555557563.1071,Faustino,"I was feeling older today too. But a girl cheered me up. She said that us seniors are actually very valuable. The reason we feel like a small group is that the industry is on a 30% growth rate. So you and I started out when the entire workforce was smaller. She pointed out there’s a huge population size skew. My dad always felt like his age was against him. But it’s simply not true. Experience matters a ton in this field. Looking back, I’ve made so many mistakes that only a senior version of me could understand now. For starters… jumping on a technology too soon only to end up using it for six months. Mostly JS tech stuff that keeps changing."
1197,1555557875.1081,Oleta,<@Donetta> do you have expound 7.2 as a dep?; I looked closer at that code and now I’m not so sure why you’re getting that error. Just curious if you happen to have an earlier version. 
1197,1555558478.1107,Donetta,"It was 7.1, a definite PEBKAC error (I altered the templated clojure version from 1.9 to 1.10 and nothing else) :disappointed: 7.2 does seem to fix it, thanks again!"
1199,1555561175.1109,Fredda,"can't you do that with hierarchies?; For dispatching, you may have fun with polymethods and dispatching off of `s/valid?` or whatever <https://github.com/johnmn3/dispacio#spec-validation-dispatch>"
1200,1555582613.1132,Stasia,"just roll your own version of component, it's very easy, focusing just on getting a minimal system map. i've found it useful in all my projects. it helps things not to get out of hand, and makes testing simpler; but as with anything, try it out, and see if it helps you; you probably can't just rely on people's opinions, because like this thread, some people will say don't use them, others will swear by them. :slightly_smiling_face:"
1200,1555593384.1143,Zona,"at the moment I'm defining `start` and `stop` functions in a top level namespace, and putting stuff like my http server into atoms using `defonce`"
1201,1555593386.1145,Zona,it seems to work
1201,1555593909.1164,Kristine,"If I have a clj-time date-time (which is UTC), say `(date-time 2019 4 18 12 0 0)`, but I want it to become the same date in Europe/Amsterdam, ie, it should be:
`2019-04-18T12:00:00.000+02:00`, how do I do that; ie. i don’t want it to shift hours, ie. I _don’t_ want to end up with `2019-04-18T14:00:00.000+02:00`"
1201,1555594149.1184,Jolanda,<https://www.joda.org/joda-time/userguide.html#Changing_TimeZone>
1201,1555594373.1191,Kristine,"aah no it’s this: `(.withZoneRetainFields input-date (DateTimeZone/forID ""Europe/Amsterdam""))`; thanks <@Jolanda>"
1202,1555595237.1196,Patrice,"but I guess you have to start and stop them in a particular order, right?"
1203,1555596600.1199,Zona,"I suppose so. Isn't that built into the order I evaluate the start functions?; I can see where there'd be a tipping point in system size, and it's just simpler to define integrant keys"
1204,1555603602.1208,Rolanda,Who here uses <https://github.com/cognitect-labs/transcriptor> in anger?
1205,1555606152.1215,Tamie,"```(meta ((fn [x] ^{:k 9} x) {:a 1})) ;; ==&gt; nil 
(meta ^{:k 9} {:a 1})              ;; ==&gt; {:k 9} 
(-&gt; {:a 1} ^{:k 9} meta)           ;; ==&gt; nil
```"
1205,1555606316.1223,Jasmine,the `^` syntax is applied *at read time* to the next read form
1205,1555606342.1229,Becki,`(-&gt; {:a 1} ^{:k 9})` will throw a read error meaning you are putting it on the meta form
1205,1555606430.124,Jasmine,"so in the first line, it's applied to the symbol x, which is not going to be ignored when compiling the fn.
in the second line, it's  applied to the literal map `{:a 1}`
in the third line, it's applied to the symbol `meta`, where it won't do anything; if you want to apply metadata to things at runtime, it's better to use `with-meta`; ```(meta ((fn [x] (with-meta x {:k 9})) {:a 1}))  ;; ==&gt; {:k 9}
(meta (with-meta {:a 1} {:k 9}))               ;; ==&gt; {:k 9}
(-&gt; {:a 1} (with-meta {:k 9}) meta)            ;; ==&gt; {:k 9}```"
1206,1555607368.1264,Tamie,okay...thank you!
1205,1555607777.1265,Jasmine,"this throws a read error because there is no ""next"" form to apply it to"
1207,1555609521.1269,Yuri,Are there any weird gotchas I need to know if I'm combining `clojure.core.async` code with promises?
1207,1555609547.1271,Rosaline,don't; are you talking about clojurescript and js promises?
1207,1555609623.1276,Yuri,"No, JVM clojure and Java Promises; I want to combine async code with http-kit because I had problems with Java blocking IO hanging"
1207,1555609680.1281,Rosaline,"well, java doesn't have promises (at least not in the jdk); if you are having trouble with blocking io, switch to non-blocking is only going to make your io problem harder to debug"
1207,1555609825.1308,Yuri,"The information I've found seems to imply that the trouble with blocking IO is inherent to blocking IO, an unreliability in linux's blocking select call, and that async IO will react to that unreliability better"
1207,1555609834.1313,Dann,"<@Yuri> a Clojure promise is just a container that starts empty and can only have a value assigned once - it's hypothetically useful to communicate between async operations, but has very few features; and really a channel is a better fit if using core.async"
1207,1555609894.1329,Rosaline,"clojure's promise is built around blocking (it blocks execution when deref'ed) so while combining it with core.async is possible (and core.async uses them under the hood here and there), in general you pickup core.async because you don't want threads to hang around blocked which is at odds with promises"
1207,1555609906.1332,Dann,waiting on a promise can introduce the kind of deadlock core.async is designed to eliminate
1207,1555609917.1333,Yuri,"Yeah, so no derefing in a go block; Got it"
1207,1555610111.1348,Dann,"a go block using channels is a much nicer alternative to js promise chaining, with the same semantics (each channel read or write in a go block is conceptually equivalent to a `.then` invocation)"
1207,1555610150.1349,Yuri,"Yeah, but the pure core.async HTTP client implementations are a tad barebones? Maybe a little immature"
1207,1555610210.1357,Dann,"you might want to look at aleph, which is dedicated to nonblocking IO with an abstraction that's very similar to core.async channels; <https://github.com/ztellman/aleph>"
1207,1555610270.1363,Yuri,"Oh, cool"
1207,1555610276.1365,Dann,"aleph uses manifold, which integrates directly with core.async as well"
1207,1555610365.1366,Yuri,"Nice, that works perfectly; I ran into it when looking at web servers, but glossed over that it integrates with core.async"
1207,1555611132.1383,Rosaline,"cognitect's aws-api library make's use of cognitect http client library which seems to have a core.async interface which I haven't been able to find the source for, but seems to be get'able from maven, and appears to be apache licensed; <https://mvnrepository.com/artifact/com.cognitect/http-client/0.1.87> <https://github.com/cognitect-labs/aws-api/blob/master/src/cognitect/aws/client/api.clj#L9>"
1207,1555611272.139,Sixta,I think it is closed source; I think this was mentioned in the talk
1207,1555611307.1398,Rosaline,"ah, I haven't seen the talk"
1207,1555611308.1399,Marlyn,what <@Rosaline> said is true; it is not closed source
1207,1555611514.1408,Rosaline,so if you felt adventurous you could grab that library and make some wild guesses at how to use it
1207,1555611727.1409,Yuri,"That sounds very interesting, but somewhat fraught"
1207,1555611804.1415,Marlyn,there are a few limitations of the cognitect http-client (streaming support being the largest one); we're thinking about whether/how to support that for aws-api
1208,1555617039.1427,Donetta,"Very nice, thanks"
1209,1555623415.1439,Becki,"i thought java defaulted strings beginning with a zero to base 8 when parsing? ie, `(Integer/parseInt ""09"")` should throw?; is that cljs or am i just confused?"
1209,1555623645.1444,Dann,"that's for literals in source code, not parsing"
1209,1555623675.145,Becki,yes just remembered that's a read-string and literal issue. thanks <@Dann>
1209,1555623713.1456,Jasmine,the `Integer/decode` method can do  this
1209,1555623722.1459,Dann,"also since clojure defaults to longs, I almost always use Long/parseLong for such use cases"
1209,1555623805.1467,Becki,was about to ask a question :slightly_smiling_face:; just making sure parseInt wasn't a footgun with radix
1209,1555623833.1473,Jasmine,"yeah, that one assumes you know the radix"
1209,1555623875.1475,Dann,"```=&gt; (Long/parseLong ""100"" 32)
1024
```"
1210,1555626849.1515,Adelaida,"for those that use `clojurewerkz.elastisch`, my team recently moved from elasticsearch `5.6` to `6.4` and a majority of the functions broke, but were fixed by passing in `{:content-type :json}` when calling `clojurewerkz.elastisch.rest.connect` i.e. ```(esr/connect host {:content-type :json})```; Apparently `clojurewerkz.elastisch.rest.document.scroll-seq` had a similar issue but i eventually fixed it by actually just copying the `scroll` and `scroll-seq` function from their github and just pasting it into the same .clj file; Since `scroll-seq` returns a lazy sequence i think there's some weirdness with *fully* evaluating the rest calls which causes the `content-type` to be lost since the exception i was getting indicated a json parser error; i verify this by doing a `(take 5 (esd/scroll-seq ...`; figure i share in case some else out in the clojure community is also using the `clojurewerkz.elastisch` library and `scroll-seq`"
1211,1555627866.1574,Malik,"does anyone know of a good clojure newsletter? like elixir weekly, ruby weekly, golang weekly (I'm noticing a pattern here)"
1210,1555628243.1579,Alice,<@Malik> I know of Daniel Compton's at <https://www.therepl.net/> and Eric Normand's at <https://purelyfunctional.tv/newsletter/>
1210,1555628261.1583,Malik,"those are the two I know of as well; I should have mentioned that bit; thanks for sharing them, though"
1210,1555628676.1596,Jasmine,I post every week at <https://insideclojure.org> 
1210,1555628790.1599,Malik,"oh, cool; oh, cool, I own both of your books; I haven't _read_ both of your books, but I did buy them, and intend to; I setup an IFTTT to email me when there are updates. thanks!"
1210,1555630075.1614,Jasmine,I only ask that you buy them :)
1210,1555630935.1616,Malik,ha!; I actually bought programming clojure twice. once on pragprog and once on the kindle (you have to buy it as a kindle book to get syncing between devices)
1212,1555632030.1651,Celestine,"I have all three editions of Programming Clojure :slightly_smiling_face: And Clojure Applied and Getting Clojure, both editions of Clojure In Action and both of The Joy Of Clojure, also Clojure Cookbook and Clojure Programming. All in PDF, sync'd to every device I own via Dropbox. And in OneDrive I have three Clojure books from Packt (not a very good publisher, IMO) and Zach Tellman's Elements Of Clojure. And I'm _still_ missing some!; Carin Meier's Living Clojure is noticeably absent. What else?"
1212,1555632109.1661,Kacy,"Professional Clojure is absent, although don't know about ""notably"""
1212,1555632121.1663,Celestine,"Ah, who publishes that?"
1212,1555632153.1665,Kacy,Wrox
1212,1555632187.1671,Celestine,"Ah... not a publisher I look at very often... isn't it part of O'Reilly these days?; (mind you, Packt is _also_ part of O'Reilly now I think?)"
1212,1555632212.1681,Kacy,I have no idea
1212,1555632269.169,Celestine,Oh. You're one of the authors! 'grats! Writing a book is a major achievement! (I've started three and never got past the outline)
1212,1555632343.1705,Kacy,"Thanks! I would have never finished, except it went down like, ""hey want to write about Datomic in our Clojure book?"" ""Great, I'm in!"" ""Ok you have a month"""
1212,1555632383.1712,Celestine,"Hahaha... yeah, writing schedules are why I've never gotten further than the outline and those early discussions with publishers..."
1212,1555632662.1728,Kacy,It was fun to write. Although everything else was misery
1213,1555660533.173,Fernande,"i don't know about in anger, but i've tried it a bit.  i think <@Andrea> has too: <https://oli.me.uk/2017/10/06/an-introduction-to-transcriptor/>"
1213,1555664731.1737,Roselia,<@Celestine> how was the Elements of Clojure for you?
1213,1555664863.1738,Andrea,"Yep, not in anger though either :blush: I wrote a lein plugin for it and found it interesting. I think a regular test suite still does it for me but it might suit others better!"
1214,1555686137.1767,Setsuko,"I'm using ```(defn foo
  [y z]
  (let [x (some-long-operation y)] (map #(+ x %) z)))``` as a way to force eval the `some-long-operation` function. Are there any other ways of forcing the evaluation of the form inside the # macro?; In order to keep the structure something like this ```(defn foo
  [y z]
  (map #(+ x (some-long-operation y)) z))```"
1214,1555687647.1774,Lane,"```
(defn foo
  [y z]
  (map (partial + (some-long-operation y)) z))
```"
1215,1555688910.178,Dann,"`(doall (some-long-operation  y))` will force evaluation of the lazy-seq, your original version doesn't actually force anything; ```=&gt; (let [foo (map println (range))] nil)
nil
```"
1215,1555689235.1784,Setsuko,"got it, thanks for the suggestions!; and by force I guess I meant executes only once :slightly_smiling_face:"
1214,1555689947.1788,Lane,<@Setsuko> That was my understanding. The partial should do that for you. But your first piece of code works as well.
1216,1555691564.1791,Dann,"oh, in clojure I've only heard ""force"" mean making sure a lazy seq is realized at a specific code boundary, I've never seen it used as a synonym for cache or reuse"
1216,1555692372.1793,Celestine,"I really like it -- because it tackles topics that a lot of books don't cover. Some of it was ""old news"" but it was deep and thought-provoking, for the most part."
1216,1555693843.1826,Maricela,xpost from <#C053AK3F9|beginners> for a broader audience: I tried a simple ETL pipeline in Clojure and Python to get a sense of pros/cons of implementing in both languages. I was surprised that Clojure wasn't much faster and only marginally shorter. Any thoughts why? <https://github.com/andharris/pipeline>
1215,1555694305.1828,Dann,"I'm not sure, but one suspicion I have here is the usage of spec. My vague understanding is that it's not optimized for performance, and the intended usage is to use it during development / testing and turn it off for production code.; I think you could write a much more efficient data validator by hand (or use a less featureful and more performance oriented validation library); Also, core.async is great for coordinating tasks, but I don't think it's the most performant option here either. If the goal is parallelization rather than coordination, you'll get much better throughput with ExecutorService or a wrapper like claypoole.; <https://github.com/TheClimateCorporation/claypoole>"
1215,1555694630.1862,Mariela,"I'm looking for a `proxy [java.io.Writer]` that I can bind to `*out*`, such that concurrent threads `println`ing to it won't cause jumbled output

...might be super easy to implement, but who knows, maybe an existing solution covers some edge cases, has unit tests etc ^^"
1215,1555694650.1864,Maricela,Thanks for the feedback
1215,1555694682.1868,Rosaline,or just use a real logging library
1215,1555694751.1869,Mariela,I cannot mutate arbitrary libraries to use my logging library. They use `println`
1215,1555694754.1871,Maricela,I'll see if swapping out claypoole for parallelization helps
1215,1555694793.1873,Rosaline,life is too short for bad dependencies
1215,1555694847.1875,Mariela,"I have used claypoole successfully in a handful of projs. Here's a self-contained example of how I tend to use it (eagerly partition the work to match cores + distribute the workload evenly)

<https://github.com/clojure-emacs/refactor-nrepl/pull/247/files>"
1215,1555694895.1877,Dann,"also, if throughput is bottlenecked by IO rather than CPU (which is very possible here), limiting by cores is probably a mistake"
1215,1555695065.188,Rosaline,I am not sure that is solvable by binding *out*
1215,1555695167.1882,Maricela,Yeah I guess if IO is the bottleneck it will slow down both implementations
1215,1555695212.1884,Dann,"you might try making a /dev/null variant for both - that might give a better idea of the language perf difference if IO dominates the task; or perhaps the message here is ""if IO dominates the task time, just pick any language you like"""
1215,1555695248.1888,Maricela,good point
1215,1555695263.189,Rosaline,"a binding of *out* can only see when `.write` is called on itself, which doesn't tell it when a logical unit of output is complete from one thread"
1215,1555695366.1893,Mariela,"I'll give it a think. Given this stub:

```
(proxy [java.io.Writer] []
    (append [&amp; _])
    (close [])
    (flush [])
    (write [&amp; _]))
```

...`close` cleanly delimits the end of a message. And `(Thread/currentThread)` delimits the concurrent parts; scratch that"
1215,1555695502.1897,Rosaline,"yeah, no one every calls .close on `*out*`"
1215,1555695548.1899,Mariela,Maybe `flush` then. And I'd manually bind `*flush-on-newline* true` to ensure flush is invoked at the end of a message
1217,1555698324.1907,Hattie,"The I/O possibility occurred to me too, but I notice that in the original Grammarly post they show all 4 cores maxed out, so I figured it probably wasn't that.; I hadn't noticed the use of spec (I only looked at the Grammarly version) but that seems like a real possibility too. I'd definitely be curious to see whether swapping the `spec/valid` calls for a simple hand-written validator would make a big difference (and that could be one place where type hints would make a difference).; Or just comment out the `filter` line and see how much difference that makes."
1217,1555699100.1913,Dann,"order of magnitude difference for a simple case ```(cmd)user=&gt; (s/def ::foo int)
:user/foo
(ins)user=&gt; (time (dotimes [_ 1000000] (int? 1)))
""Elapsed time: 11.172124 msecs""
nil
(ins)user=&gt; (time (dotimes [_ 1000000] (s/valid? ::foo 1)))
""Elapsed time: 123.692794 msecs""
nil
```; to be fair, that int? check might be friendlier to inlining by hotspot than the actual code checking your data format"
1217,1555699379.1928,Liliana,"I want to do aot but there's one function call that I'd like to not run during the aot compilation. Without skipping aot on the whole class, can I use some variable to know if clojure is compiling?"
1217,1555699477.193,Dann,"```user=&gt; (doc *compile-files*)
-------------------------
clojure.core/*compile-files*
  Set to true when compiling files, false otherwise.
nil
```"
1218,1555699489.1933,Otelia,the s/def uses int instead of int?
1217,1555699493.1936,Dann,"it's good practice to put nothing with side effects on the top level of your code; (delay can be helpful for this - you can create a delay globally but only evaluate it once it's forced); ~that's idiomatic~ -- it's actually not, that's my mistake"
1217,1555699587.1952,Liliana,"ah good point, yes, it's a graal app that I'm working on, and it needs to start making native calls, but the pointers must be created at runtime; works! thanks <@Dann> :slightly_smiling_face:"
1217,1555699638.1956,Dann,"```(ins)user=&gt; (s/def ::foo int?)
:user/foo
(cmd)user=&gt; (time (dotimes [_ 1000000] (s/valid? ::foo 1)))
""Elapsed time: 88.051523 msecs""
nil
```"
1217,1555699727.1962,Rosaline,you can always not aot compile too
1218,1555699849.1965,Rosaline,"oh, graal, meh"
1217,1555700285.1966,Maricela,"The interesting thing to me is that I use a pretty heavy handed approach to schema validation in the python implementation too. I'm surprised spec adds this much overhead, but I must have a misunderstanding of it's intended use. I was assuming this was the exact use case for spec"
1217,1555701676.197,Dann,"just because spec is 8 times slower doesn't mean it's a bottleneck in this case - it's a good idea to profile for stuff like this; and I could be wrong about it's intended use case, I'm not a spec expert, I've heard the truism ""don't use it in hot loops, only use it at boundaries"" but really this code is both a hot loop and a boundary"
1219,1555702652.1974,Maricela,"Tested without validation and it doesn't have a material impact, so not the bottleneck. Time for me to learn how to profile a Clojure program.; &gt; doesn't have a material impact; maybe that's not fair. it has an impact but doesn't seem to be a primary bottleneck. Really just seems like it will need some profiling to really understand"
1219,1555702909.198,Dann,"you can use a standard java profiler, visualvm (sometimes known as jvisualvm) is free, yourkit gives full licenses for use on open source projects; there's an art to translating from the vm level stuff (designed to map more or less directly to java classes) when profiling clojure (classes made via weird generated bytecode from a handwritten compiler)"
1220,1555707499.1991,Becki,"pmap doesn't do any parallelization below 512 elements, is that right?; starting to doubt that but remember something cares about 512"
1220,1555707873.1997,Jasmine,reducers
1220,1555707928.2004,Becki,thanks so much! that was bothering me :slightly_smiling_face:
1220,1555708075.2014,Jasmine,pmap is parallel over 2+# processors
1221,1555708859.2018,Harold,"Sotnikov's Web Development with Clojure. I think it is a great 1.5th or 2nd Clojure book to get people to ""hello http""; Quick Clojure is a good one for when I've spent some time away from the language and I need a reminder."
1220,1555709338.2023,Magdalena,[ANN] Cognitect Labs' aws-api 0.8.301 <https://groups.google.com/forum/#!topic/clojure/TXxEx-2OV2s>
1222,1555758115.2068,Loria,"Is there such a thing as a ""lazy set"" collection in Clojure?; I'm imagining something with constant-time `contains?` lookup for items that have already been realized, but which lazily defers additional elements which are not yet needed; ```
(def primes
  (lazy-set (filter prime? (range 10000))))

;; Only computes as many elements as needed until a match is found
(contains? all-primes 7) ;; =&gt; true

;; constant-time, because `3` has already been found in the set
(contains? all-primes 3) ;; =&gt; true

;; Forces evaluation of the entire collection to ensure an item does *not* exist in the set
(contains? all-primes 6) ;; =&gt; false
```"
1222,1555764025.2094,Roselia,"<@Loria> ```
(defn make-lazy-predicate
  [coll]
  (let [state (atom {:mem #{} :unknown coll})
        update-state (fn [{:keys [mem unknown] :as state} item]
                       (let [[just-checked remainder]
                             (split-with #(&lt;= % item) unknown)]
                         (if (seq just-checked)
                           (-&gt; state
                               (assoc :mem (apply conj mem just-checked))
                               (assoc :unknown remainder))
                           state)))]
    (fn [item]
      (let [next-value (first (:unknown @state))]
        (get-in (if (or (nil? next-value)
                        (&lt; item next-value))
                  @state
                  (swap! state update-state item))
                [:mem item])))))

(def lazy-even? (make-lazy-predicate 
                  (filter (fn [n] 
                            (Thread/sleep 100) 
                            (even? n)) 
                          (iterate inc 0))))
```
However, if coll\\seq is not infinite, predicate returns false when value is out of range.
Can be modified to throw exception on `(nil? next-value)` if you need that."
1223,1555765136.211,Marcelle,"Hello! Using `clojure.xml`, how do I output XML with double quotes, not single ones? (e.g. `&lt;foo bar=""123""&gt;&lt;/foo&gt;` not `&lt;foo bar='123'&gt;&lt;/foo&gt;`)?"
1222,1555769963.2125,Loria,"Wow, thanks! I'll study that code and see if it can be modified for my needs :slightly_smiling_face: Creating a lexically bound atom in a closure like that is definitely something new to me"
1222,1555770275.2127,Otelia,"FWIW I recently did a bunch of profiling and discovered some unexpected changes in the free Java tools.
- jvisualvm was changed to jmc (Java Mission Control) as of Java 8
- jmc is also available in Java 9
- in Java 10 to 12 there is no jmc in the jdk

jmc was spun out by Oracle as an open source project as of Java 10 but has not been released yet. They're trying to get jmc 7 done but it's not there yet. You can build it from sources, and I did that and it seems to work. But the simpler thing is to use Java 8/9 for profiling until jmc 7 is released.

It doesn't work to use the Java 8/9 jmc on JFR files generated by later releases of Java, the format is incompatible."
1222,1555770365.213,Roselia,good luck :i_love_you_hand_sign:
1224,1555772305.216,Nieves,"Hello. Can you give me some examples of clean functions, that can be tail or non-tail recursive and made stackoverflow and/or calculated long time (better both of these) without memoization? I wanna test something.; with arguments on which it occurs"
1224,1555772908.2168,Marcelle,"<@Nieves> it's e.g. ```user=&gt; (defn boom1 [] (loop [] (recur)))
#'user/boom1
user=&gt; (boom1)
```; but what do you mean ""clean"" functions?"
1224,1555772946.2175,Nieves,"what about without jokes?; something like
```
(defn coin-change [s coins]
  (cond (= s 0) 1
        (or (&lt; s 0) (empty? coins)) 0
        :else (+
                  (coin-change s (rest coins))
                  (coin-change (- s (first coins)) coins))))
(coin-change 10000  '(1 5 10 25 50))
```"
1224,1555773029.2192,Marcelle,"<@Nieves> w/o jokes, I clearly remember one first videos on `core.typed` has given example of functions which give StackOverflow. Only I can't find that video now :disappointed:; ah, here it is: <https://youtu.be/a0gT0syAXsY?t=15>"
1224,1555773214.2197,Nieves,"thanks, I'l see; it seems that video explains an example of SO cause of error in code, but not correct function with limited Java stack, like my example above"
1225,1555776512.2232,Cira,I have a Clojure process that's not exiting despite me calling `shutdown-agents` — what else might I be missing here?
1226,1555776897.2243,Nieves,so maybe there is another Cllojure messenger where I can ask my question? can anyone suggest?
1225,1555777332.2263,Marlyn,"<@Cira> check what threads are running on it by calling jstack on the pid. You might have another naughty thread that isn't the agent executors; There are programmatic ways of enumerating the running threads, too"
1224,1555782578.2291,Madeleine,"<@Nieves> Fibonacci is a good example of that. It can be written recursively with or without tail recursion.; Without tail recursion:

```
(defn fib [n]
 (if (&lt;= n 1)
  n
  (+
   (fib (- n 1))
   (fib (- n 2)))))
```

With tail recursion:

```
(defn fib [n]
 (loop [n n a 0 b 1]
  (cond
   (= n 0)
   a
   (= n 1)
   b
   :else
   (recur
    (- n 1)
    b
    (+ a b)))))   
```

<@Nieves>"
1226,1555787129.2324,Alease,is there a built in function/macro that takes a set of symbols and returns a map with keys that mirror the symbol and value being the value behind the symbol. for example `(let [a 1 b 2] (toMap a b))` -&gt; `{:a 1 :b 2}`
1226,1555787154.2327,Harris,no
1226,1555787265.2332,Becki,there was a clojureverse discussion on this which included at least one implementation; i think its a great idea by the way; <https://clojureverse.org/t/shortand-clojure-syntax-for-properties-on-hashmaps/1918/24>
1226,1555787516.2345,Alease,it's one of the few things I like in JS lol
1226,1555787803.2349,Roselia,is it save to use persistent vector reference from which transient one was created?
1226,1555788515.2363,Jerome,"Yes, `(transient my-var)` creates a transient version of the original var without changing the original one"
1227,1555789272.2385,Nieves,"<@Madeleine> thanks. But even exponential recursive Fibonacci can not fall in SO, cause universe is died before :slightly_smiling_face: And iterative one is a simply tail-recursive.
I wanna test my SO-problem solver I write in Clojure. I just want more test cases, for make me sure. Cause all tests I can create are passed :slightly_smiling_face:"
1228,1555792503.2391,Roseann,"Hello All!
I'm using clj-jade to render a Jade template, passing an array as parameter: `(jade/render ""index.jade"" {""param1"" [1 2 3]})`
My friend is using Pug.js, and can do `param1.length` to get the size of the array, but it doesn't work when using clj-jade.
How can I extent `clojure.lang.PersistentVector` to add a static field `length` that will be initialized when the vector is created?"
1228,1555792931.2394,Jasmine,You should not want to do this; Vectors implement Java Collection which has a size method and Clojure collections which have a count function.
1228,1555793492.2433,Roseann,"<@Jasmine> Yes, size method works fine in clj-jade."
1228,1555794071.2437,Madeleine,"Hum, I'm not sure what you mean then. Just remove the loop/recur and instead call the function back and the tail recursive one will SO.; ```
(defn fib [n a b]
 (cond
  (= n 0)
  a
  (= n 1)
  b
  :else
  (fib
   (- n 1
   b
   (+ a b)))))
```; ```
(fib 100 0 1)
```

That will SO"
1228,1555794438.2443,Nieves,"Ok. I write a function, that evaluates any function on any arguments without SO and I want to test it. You write a trivial example, that evaluates also. But it can be evaluated also with recur or trampoline, in opposite with my example above. I hoped in more complex examples &amp; cases to test"
1228,1555794550.2445,Madeleine,"Oh I see. So you're trying to implement real tail call optimization?; As far as I know, there's nothing that can't be done with loop/recur and trampoline."
1228,1555794646.2449,Nieves,"No :slightly_smiling_face: Real TCO is a trivial task on trampolines. I implement ANY CO, not only tail. See again my example - it is not tail call; And if you think that any can be evaluated with trampolines, can you show it on my example coin-change?"
1228,1555795112.2453,Madeleine,Hum... You mean for algorithms that actually need a stack? You convert them so they don't SO?
1228,1555795137.2455,Nieves,Yes
1228,1555795156.2457,Madeleine,"Ah I see, cool; So you re-write them so their stack is allocated on the heap?"
1228,1555795249.2461,Nieves,Yes. With an optional memoization and by adding of only some chars in function code&amp;
1228,1555795255.2463,Madeleine,"You know that you can use the `-Xss` jvm option to increase the stack size limit in Java?; Just mentioning it, I still think what you're doing sound cool.; I think reversing a list is a good example"
1228,1555795290.2469,Nieves,"Yes. I played with it, but max Xss more less than heap"
1228,1555795337.2471,Madeleine,"True, a function stack contains a lot of additional data that arn't necessarily relevant to the algorithm, so using the fn stack is always more memory hungry"
1228,1555795350.2473,Nieves,And increase default thread stack in Java is not a good idea - a lot of threads will break the heap; reversing list is also a tco ); in realization with accumulator I mean; but you are right - it can be non tail call implementation
1228,1555795485.2482,Madeleine,"Ya, but I often see it done without tco; And the non tco is much more readable and logical in my opinion."
1228,1555795636.2486,Nieves,"```
(defn bar [n] (if (= 0 n) 0 (+ n (bar (- n 1)))))
.......
(time (eval-cs bar 100000))
""Elapsed time: 675.22869 msecs""
5000050000
```; such trivial examples works fine, as I mentioned"
1228,1555795711.2491,Madeleine,"Ya, sorry, I very rarely implemented an algorithm that absolutely needed a stack. So I can't think of anything right now."
1228,1555795800.2493,Nieves,Thanks anyway! I just slightly glad about my rezult and want to test and tell about it for anybody )
1228,1555795958.2496,Madeleine,"Ya, if you make it open source, I'll definitely keep it in mind, if one day I have this problem. Its not a problem I have often, but I'm sure if I did, I would love to find a library like the one you're making."
1229,1555796103.2498,Loria,What about non primitive-recursive functions like the Ackermann function?
1228,1555796105.25,Nieves,"Thanks. I have to make it slightly pretty-organized, and then I'l open it. But to be honest I'm disappointed a little, that it did not interested anyone exept you ); Gooooood point - I'l try Akkermann now"
1228,1555796176.2504,Loria,I believe it's theoretically proven that it cannot be reduced to a form which doesn't involve the stack
1228,1555796246.2506,Nieves,"Yes, it is not a primitive recursion. Give me some minutes to test )"
1228,1555796254.2508,Loria,"there you go :slightly_smiling_face:
```
(defn ack [m n]
  (cond
    (zero? m) (inc n)
    (zero? n) (ack (dec m) 1)
    :else     (ack (dec m) (ack m (dec n)))))
```"
1228,1555796341.251,Nieves,"Ok, thanks for sharing ); Looks like it not working by directly using my method. But I'l try to modify it! Thanks again :slightly_smiling_face:"
1230,1555797080.2516,Roselia,<@Jerome> but transient is not about vars :smiley:
1228,1555797128.2517,Madeleine,I think QuickSort might be another one where you can't get rid of the stack.
1230,1555797170.2527,Madeleine,Looks like generally its optimized by putting it on the heap and doing it iteratively.
1228,1555797190.2534,Jerome,"Yeah it’s about seqs, but a seq will always be bound to a var?.."
1228,1555797201.2536,Nieves,Can you show the exact code example for source?
1230,1555797202.2538,Roselia,its about collections
1230,1555797240.2546,Jerome,How is a collection different from a seq?
1228,1555797256.2549,Nieves,Naive QuickSort I mean. Or it like not real QS as Haskell examples everywhere? )
1230,1555797258.2551,Roselia,sequence is abstraction
1228,1555797271.2552,Madeleine,:stuck_out_tongue_closed_eyes: I'm afraid I'm not smart enough at this moment to put it together.
1230,1555797301.2557,Jerome,Sure
1230,1555797326.2561,Nieves,So anyway I have to made a research with Akkermann
1230,1555797381.2572,Roselia,"well collection too, nvm; however they are different entities in terms of implementation"
1230,1555797454.2577,Madeleine,Good luck 1; !
1228,1555797567.2581,Nieves,Thanks again. I'l say the results about Ack and QS in a time.
1228,1555798007.2588,Shanelle,"People, I have two questions:"
1231,1555798481.2592,Shanelle,"- who is using the Clojure client, for Kubernetes?; - which ZeroMQ bindings are used?; so two questions, the scopes of those are unrelated to each other"
1228,1555799750.2606,Nieves,"It works :slightly_smiling_face:
```
(time (eval-cs ack 3 14))
""Elapsed time: 1991.828241 msecs""
131069
(time (eval-cs ack 4 1))
""Elapsed time: 853.480078 msecs""
65533
```; But I was needed to slightly tweak an algorythm; Now I'l try to find QS code your mean"
1228,1555800077.2612,Madeleine,":thumbsup:; <@Jerome> seq are collections which support the `first`, `next`, and `more` fns. While collections only support `count` and `empty` and `=`.; See: <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/ISeq.java> and <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/IPersistentCollection.java>; Also more relevant to Clojure, functions that work over seq takes the seq as the last argument, while those that work over coll (that aren't seq) take it as the first argument."
1228,1555801007.2649,Jasmine,<http://insideclojure.org/2015/01/02/sequences/>; <http://insideclojure.org/2016/03/16/collections/>; ^^ those might be helpful
1228,1555801293.2656,Nieves,"""QS"" also works w/o SO, but very (!) unefficient :slightly_smiling_face:
```
(defn qs [l]
  (if (empty? l)
    []
    (let [[p &amp; xs] l]
      (concat
       (qs (filter #(&lt; % p) xs))
       (list p)
       (qs (filter #(&gt;= % p) xs))))))
.............
(time (eval-cs qs (-&gt;&gt; 10000 range reverse)))
""Elapsed time: 51633.130523 msecs""
[0 1 2 3 4 5 6 7 8 9 10 11 ..........
```"
1228,1555801496.2674,Jerome,"Sure, but in the context of transients they’re used identically? Just `(transient ...)` to create a transient version; And that’s the same for seqs and collections; *treated vs. used; I’ve also just gotten into the colloquial habit of referring to a lot of things as seqs even if they aren’t technically...; Which is maybe worth breaking"
1228,1555846690.2709,Roselia,"<@Jerome> see, transient wants implementation of IEditableCollection interface as its input, only few collections implement that interface
<https://gyazo.com/23105ead02ad141f14e8243c3e17ea17.png>; <https://gyazo.com/dac646e544a72b82a5f02dd45289a832.png>; anyway i found the answer in Emerick's book"
1228,1555847395.2725,Jerome,"Yeah, you’re right. I’ve gotten in the bad habit of just referring to anything I can call `seq` on as a seq, which is incorrect ; But my original answer is correct I believe"
1228,1555847439.2739,Roselia,"answer to my question was, 'yes'"
1228,1555847445.2742,Jerome,"If you pass a collection to `transient`, you can still safely use the original reference; Right"
1228,1555847455.2746,Roselia,right; :smiley:
1228,1555847460.275,Jerome,:+1:; That would be terrible if you couldn’t!
1228,1555847569.2757,Roselia,"yeah, transients is a bit tricky to understand at first; but thanks to awesome clojure design it's all uniform
<https://gyazo.com/8c6e5901537e02c95073ef290956eb64.png>"
1232,1555852286.2835,Eryn,"People of Clojure, I have a question. I read somewhere that it's possible to connect Clojure REPL to java app in debug mode. Did Anybody try that? Could you please share your experience/links here ? I saw one repo in GitHub, but it's more than 5 years old. It would be nice to have a modern way of doing that."
1232,1555852343.2841,Kate,Is there a way to force *use-context-classloader* false for an Uberjar?; axiom-dom.jar won't load because it expects to classload /META-INFO/axiom.xml
1233,1555857075.2864,Roberto,"is there a way to get the ""next"" item of an item in a sorted map?"
1233,1555857468.2871,Roselia,<@Roberto> what kind of items do you store in the sorted map?
1233,1555857507.2874,Roberto,"a record type; but I have found another way to implement what I want; essentially I need to keep an index which  will allow traversing the collection one at a time; and I just found out .indexOf is implemented for vectors, therefore I can use a vector instead of a sorted map and just play with the index"
1233,1555857723.2901,Roselia,<@Roberto> drop over seq of map doesn't work for you?
1233,1555857882.2926,Roberto,"the use case is following: the keys are strings (the filename), the values are record types, and I need to iterate over the sortedmap (either by keeping the index, but this does not exist in a map, or by keeping the key)"
1233,1555857931.2938,Roselia,"i'm not an expert, i think we can split sequence by take-while \\ drop-while so effectively next item will be the first element of drop-while sequence"
1234,1555858768.2944,Loria,"I wonder if it's possible to implement the functions ""loeb"" and ""moeb"" in Clojure? <https://github.com/quchen/articles/blob/master/loeb-moeb.md>; just out of curiosity, I tried playing around with `lazy-seq` and memoization but couldn't get it to behave lazy enough to actually evaluate; here's a (non-working) translation of the Haskell code
```
(defn loeb [fs]
  (lazy-seq
    (map (fn [f]
           (f (loeb fs)))
      fs)))

(loeb
  [(constantly 1)
   #(inc (second %))
   #(inc (first %))])
;; should=&gt; (1 3 2)
```"
1233,1555859953.2971,Roselia,"<@Roberto> ```
(def my-map (sorted-map ""e"" 5 ""d"" 4 ""c"" 3 ""b"" 2 ""a"" 1))

(defn create-iterator
  [coll]
  (let [state (atom (seq coll))
        update-state (fn [state] (swap! state rest))]
    (fn []
      (let [item (first @state)]
        (update-state state)
        item))))


(def my-iterator (create-iterator my-map))

;;=&gt; #'junk.core/my-map
;;=&gt; #'junk.core/create-iterator
;;=&gt; #'junk.core/my-iterator
;;(my-iterator)
;;=&gt; [""a"" 1]
;;(my-iterator)
;;=&gt; [""b"" 2]
;;(my-iterator)
;;=&gt; [""c"" 3]
;;(my-iterator)
;;=&gt; [""d"" 4]
;;(my-iterator)
;;=&gt; [""e"" 5]
;;(my-iterator)
;;=&gt; nil
```; must be thread safe"
1235,1555860333.3,Liliana,"Hi, does anyone have good solution to a fast reset-able timeout. I'm already using core.async, but I'm thinking about a classical problem of making a action _foo_ depending on the last time action _bar_ was called, but action _bar_ could be called dozen or hundred times a second and so performance matters a bit."
1235,1555860817.3015,Meagan,"are you saying you only want the reaction to be run once every x interval, even if the trigger is fired n number of times within the interval?"
1235,1555860887.3024,Liliana,"<@Meagan> think of it a bit like idle counter, last time there was an interaction then fire the action once (screen saver for example); I'm thinking now of timeout in an atom and close! it every time there's an action (and replace it with a new timeout)"
1235,1555860934.3033,Meagan,"I can't tell if you're saying no, my interpretation is wrong, or yes, my interpretation is right; I _think_ you're talking about debouncing"
1235,1555861047.3039,Liliana,:slightly_smiling_face: that could be
1235,1555861098.3045,Meagan,"in which case there's this simple CLJS example:
<https://gist.github.com/swannodette/5888989>; there's probably a simpler way, without core.async"
1235,1555861182.3056,Liliana,"thanks, exactly what I need!"
1236,1555864627.3066,Loria,"How can I ""subclass"" a lazy sequence to extend a custom protocol?; similar to `defrecord` for maps; ie. I don't want all `clojure.lang.Sequential` or such to support the protocol, but only a custom type which should still remain compatible with all library functions"
1236,1555875687.3083,Nieves,"If you want to see a sources, I just published a link on github in announcements"
1237,1555876145.3106,Roberto,"<@Roselia> thanks, but I need to go both ways, forward and backward (it's essentially scrolling though a file list). it needs to be fast. i started with a sorted map, because I wanted to also have fast access by filename. i am now using a vector instead, which works, but does not have fast access by filename; a combination of sorted-map with vector would probably work, I was just trying to use only sorted-map, but I guess I need something like LinkedHashMap"
1238,1555876857.3118,Meagan,you could perhaps extend a particular sequence to your custom protocols via metadata
1239,1555878640.3124,Otelia,"There is <https://github.com/frankiesardo/linked> although I haven't tried it.

I would probably maintain both a vector and a hash map, if both types of access must be extremely fast and the list is largish.

Another approach is to just use a vector in name order, and do a binary search within the vector when doing a name lookup."
1239,1555879487.3127,Loria,"Oh! I didn't know you could extend protocols using metadata, looks like a new thing in 1.10"
1239,1555880188.3131,Roselia,"<@Otelia> just checked it, doesnt allow for previous\next node navigation"
1240,1555887361.3173,Alease,"i'm trying to calculate a per-frame movement factor for a cursor i'm drawing  For example I have
```(defn next-pointer
  ""Moves the pointer, taking to account speed""
  [{:keys [x y direction speed active] :as pointer} frame fps]
  (let [[dx dy] direction
        norm-time (mod frame fps)
        d-pixels (if (zero? norm-time)
                   speed
                   0)]
    (assoc pointer
           :x (+ x (* dx d-pixels))
           :y (+ y (* dy d-pixels)))))
```
In this example, there's a speed of the format `pixels/second`.  I want to determine at each frame by what factor I should increase x.  My first approach was to determine the position of x at an origin, but due to adding to the x, it became more of an acceleration.  In this case, I kind of lazily just get the next speed only when I'm at a ""second"" which is hardly smooth.  The missing piece is the other part of that if.  I've tried making `norm-time (/ (rem frame fps) fps)` to see if that would help, but it gives me kind of a stepping movement.  I'm always bad at factoring time in my drawing apps, is there a missing link I'm not seeing; direction is simply a unit vector so it's either 0 1 or -1 for any element in the vector; here's some more code for context <https://github.com/dantheobserver/drawing-experiments/blob/master/src/experiments/12_pixel_paintbrush.clj>; I guess I need to keep track of dt"
1239,1555891676.3193,Otelia,"A vector seems like the best choice, if binary search is fast enough for you.; If you're using Clojure on the JVM you can use Java's binary search:
```
(java.util.Collections/binarySearch [""a"" ""b"" ""c""] ""b"")
=&gt; 1
```"
1240,1555892975.3198,Alease,"that seemd to be it, I just had to pass in dt, and keep it updated each frame
```(defn next-pointer
  ""Moves the pointer, taking to account speed""
  [{:keys [x y direction speed active] :as pointer} dt]
  (let [[dx dy] direction
        d-pixels (* speed dt)
        next-x (+ x (* dx d-pixels))
        next-y (+ y (* dy d-pixels))]
    (assoc pointer
           :x next-x
           :y next-y)))
```"
1241,1555902059.3201,Harold,"Thanks got posting this. I was dozing off in front of an Elixir tutorial when I saw this and it woke me up.

Downloaded your experiments and went through them, getting acquainted with clojure2d. I'll certainly have to show 07_dedication.clj to a cat (actual feline) I know.

It seems like some complexity with this speed thing can be removed. In my doodles, I typically express the speed in the number of pixels x/y it will change each frame. Then the distance it will travel each second is dependent on the frame rate, which is actually an effect I'd want as if I was changing the speed of a projector.; Ya. I have speed and direction combined."
1240,1555911790.3209,Alease,"Haha, dedication is actually something I found in a tweet for pico8, I wanted to disect it and replicate it in clojure2d, to little success.  Need to find the tweet to show it.; I try to translate as much to something ""relatable"" so I don't have to do guesswork or adding magic numbers to get movevement down.  But most of it I'm trying to work my way into understanding without looking at formal graphics programming info."
1242,1555940177.3228,Augusta,"I have a question, `iterator-seq` returns a lazy seq or not? I need to work with a possible infinite iterable class in Java."
1242,1555940476.323,Otelia,"Since iterators are lazy I think the answer has to be yes.; Or a better way to say it is that if the iterator is lazy, the sequence will be lazy."
1243,1555940904.3241,Murray,"Hi, folks. Can I give a name to a test case with `clojure.test/are`?
Or how can I know which case failed in the report?"
1242,1555946516.3254,Augusta,thanks
1244,1555949392.3266,Ginger,Some comments on this would be much appreciated: <https://stackoverflow.com/questions/55797382/idiomatic-rest-wrappers-in-clojure>
1244,1555958429.327,Harold,Sounds good. I might translate some of your experiments into Quil
1243,1555962912.3272,Mariela,"```
(are [input expected] (testing input
                          (= expected
                             (system-under-stest input)))
  x y
  a b)
```; i.e., add `testing` with a dynamically-built string"
1245,1555976699.3278,Samual,"You may study a generic Swagger client, Martian (<https://skillsmatter.com/meetups/8426-clojure-bytes>); and also consider the Cognitect AWS client wrapper as a more sprawling example.

By the way, maybe ""Java 11"" will eventually solve this, but here is a severe case of complecting.  The two API wrappers you mentioned, and Martian, are coupled to Apache's HTTP Client; while Cognitect's AWS API wrapper apparently delegates to some Jetty thing.  For ""something special"", I would like to mix and match:  use any API wrapper with any HTTP library.  If I have a biggish app that already has a way of managing HTTP connections, retries, pooling, throttling, etc.... with Netty, say...  the API wrappers should participate in that!"
1245,1555989122.3283,Alease,"feel free, many of them are unfinished, or simply ideas that I took to a point that I was satisfied with, but may not make much sense now.  It's my sketchpad really."
1245,1555990975.3323,Noemi,"I'm finally getting productive with clojure, but now I'm finding out that sizable (read: useful) projects take forever to load a repl (I use cider/emacs)... we're talking a couple minutes per bounce... what am I doing wrong?"
1246,1555991125.3329,Jasmine,"if you're using user.clj and a very recent JDK version, you might have stumbled into a Java performance regression"
1245,1555991152.3334,Jasmine,"jdk 1.8u202+, 11.0.2, 12,  etc; see <https://dev.clojure.org/jira/browse/CLJ-2484> - we are testing a workaround in 1.10.1-beta2; you could try downgrading your java version or upgrading Clojure to 1.10.1-beta2 to see if that helps"
1245,1555991588.3363,Celestine,"<@Noemi> As a sanity check, I just timed my REPL startup time -- via `clj` with a profile that contains every single dependency our 80,000+ line Clojure project uses, which also starts a Socket REPL and starts up Cognitect's REBL tool. A cold start to a live REPL with REBL open takes just under 12 seconds on my Mac."
1245,1555991623.3366,Noemi,"ok, so it's something wrong with my setup, for sure.; and that's crazy fast, btw."
1245,1555991649.3372,Celestine,"Per Alex, it could be the JVM regression if you're on either of those versions...; I think 12 seconds is _slow_ :slightly_smiling_face:"
1245,1555991707.3379,Noemi,"java version ""1.8.0_92""
Java(TM) SE Runtime Environment (build 1.8.0_92-b14)
Java HotSpot(TM) 64-Bit Server VM (build 25.92-b14, mixed mode)"
1245,1555991754.3384,Celestine,"(without REBL and the Socket REPL, starting a plain REPL takes about 8 seconds for comparison); OK, so on that version of Java/JVM it's unlikely to be the regression Alex mentioned."
1245,1555991816.3397,Noemi,"it's very likely something wrong with my code, right?; I mean, that can affect things, I'm guessing."
1245,1555991830.3404,Celestine,Maybe ask in <#C0617A8PQ|cider> and/or <#C099W16KZ|emacs> and see if they can suggest ways to optimize startup?
1245,1555991842.3407,Noemi,sounds like a plan.; I could generate a new project and see how long that takes.
1245,1555991923.3424,Celestine,"Also, I'm starting a REPL into the `user` namespace which means it doesn't need to load my main namespace."
1245,1555991946.3428,Noemi,lein repl on a project generated with ```lein new app test``` took about 11 seconds.; I usually just lein repl at the root of the project... how would I specify a namespace?
1245,1555992054.3446,Celestine,"It depends what's in your `project.clj` -- when the REPL starts, is it in `user` or some project-specific ns?"
1245,1555992062.3449,Noemi,"aha ok; I'll look.; user; so it's not that.; it is a big luminus rest service type thing, so it's a larger project.; well, you've given me a few things to look at in the morning."
1245,1555992200.347,Celestine,"```(! 780)-&gt; lein new app timing
Generating a project called timing based on the 'app' template.
(! 781)-&gt; cd timing
(! 782)-&gt; time lein repl &lt; /dev/null
nREPL server started on port 57337 on host 127.0.0.1 ...
timing.core=&gt; Bye for now!

real	0m7.290s
user	0m5.564s
sys	0m0.490s
(! 783)-&gt; time lein repl &lt; /dev/null
nREPL server started on port 57351 on host 127.0.0.1 ...
timing.core=&gt; Bye for now!

real	0m6.634s
user	0m5.467s
sys	0m0.486s
(! 784)-&gt; 
``` 6.6 vs your 11."
1245,1555992247.3472,Noemi,"ok, both are close enough for me :wink:; probably is something to do with cider/emacs and all that, per what you were saying."
1245,1555992380.348,Celestine,"Leiningen adds a lot of overhead, compared to the CLI/`deps.edn` stuff, just FYI: ```(! 787)-&gt; clj -A:new app timing.core
Generating a project called timing.core based on the 'app' template.
(! 788)-&gt; cd timing.core/
(! 789)-&gt; time clj &lt; /dev/null
Clojure 1.10.1-beta2
user=&gt; 

real	0m4.462s
user	0m11.724s
sys	0m0.563s
(! 790)-&gt; time clj &lt; /dev/null
Clojure 1.10.1-beta2
user=&gt; 

real	0m1.385s
user	0m2.742s
sys	0m0.194s
(! 791)-&gt; 
``` 6.6 goes down to 1.4 :slightly_smiling_face:"
1245,1555992422.3484,Noemi,"thanks for all the help!; I'll also look at the CLI/deps.edn stuff, which I know nothing about."
1245,1555992611.3491,Celestine,We love it. We switched from Boot to CLI last year (after switching from Leiningen to Boot just over three years ago).
1245,1555992668.3501,Jasmine,"the luminus setup usually has a user.clj file and loads (and compiles) a large set of your project and dependent files on startup. I would look more carefully and see if  you're doing something at the top level somewhere in addition to that too.; like def'ing something that loads from a database, et c; you can often use  a `delay` to avoid doing that too eagerly"
1247,1555993110.3518,Madeleine,"Any way to spec something as a list or a cons? Is there a pred for that? Basically, I want a pred for clojure code"
1245,1555993118.3521,Madeleine,To spec a macro
1247,1555993226.3525,Madeleine,"Hum, looks like seq? could do"
1245,1555993655.353,Jasmine,"generally, I find it's best to spec inputs to macros  using the regex ops"
1247,1555993670.3533,Jasmine,"so, `cat`, `*`, etc"
1247,1555994863.3535,Madeleine,I have `(s/+ seq?)`; Where it takes one or more s-exprs; Would you do something different?
1248,1555997588.3553,Karren,I've also found (and it was a  long time ago) that luminus-based projects have quite a long startup time; and it was a very simple service actually. It's perhaps because of many depedencies it introduces...
1249,1556004645.3564,Roselia,whats the difference between fn and fn*? Can't find a declaration of latter.
1249,1556004800.3571,Celestine,"`fn` is technically a ""special form"" but it is implemented as a macro that calls `fn*` which is part of the compiler; Like `let` is a special form too, but it is also implemented as a macro that uses `let*`..."
1249,1556005374.3584,Roselia,"<@Celestine> great, thank you"
1250,1556014620.3601,Elayne,"I am writing some cljc code and realizing that there must be something about JVM-clojure and namespaced type hints that I don’t understand. If I have a type/record, I seem to be able to use its name as a type hint within its own namespace, but not from another namespace? example: <https://gist.github.com/mhuebert/3269ac0b5bebebb93de9c497a33a694f>; None; None"
1250,1556015207.3615,Coralie,"<@Elayne> in jvm clojure MyType will be a generated class, you'd need to import it"
1250,1556015430.3618,Elayne,"<@Coralie> ah, ok, thanks!"
1251,1556018902.3626,Harris,"you don't necessarily need to import it, you simply need to refer to it as a class rather than as a Var; `n/T` is not valid syntax for classes in clojure/jvm; it needs to be `n.T` (namespace aliases are not valid either,`n` must be fully qualified); it's unfortunate that clojure script diverged for deftypes"
1251,1556019370.3673,Elayne,so I guess it needs to be `^hints.my_type.MyType` - also munging the `-` to `_`
1251,1556019526.3683,Coralie,"yes -- import would just allow shorter naming, `MyType` (closer to `t/MyType` from the example)"
1252,1556019586.3692,Jasmine,I would prob do `(s/+ any?)`
1251,1556019616.37,Elayne,so `(:import hints.my_type.MyType)`
1251,1556019628.3703,Jasmine,There are a lot of valid Clojure forms that are not seqs
1251,1556019704.3712,Elayne,"and then I suppose I would refer `MyType` in the cljs version, so that a plain `^MyType` annotation works for both"
1253,1556022217.3716,Harris,yep
1254,1556033055.3728,Roselia,"does subvec allows for garbage collecting of unused nodes
say if we want [1 2 3] -&gt; [2 3] what is my options aside from vec -&gt; seq -&gt; vec"
1254,1556033105.3739,Jasmine,"ideally, don't use a vector in the first place if you need to remove elements any place but the end; subvec will keep the original vector in memory so will not be gc'ed"
1254,1556033166.3753,Roselia,"alex, thanks for everything you are doing for us btw, i'm a fan :smiley:"
1254,1556033219.3757,Jasmine,:thumbsup:
1255,1556035084.3758,Madeleine,"Thanks, I'll have a look at it again. I guess I'm not sure why I ever tried to restrict it in the first place."
1254,1556035583.3763,Jasmine,usually not worth it in macro args
1256,1556037506.3778,Kate,is there a way to set *use-context-classloader* false before clojure starts?
1254,1556037768.3786,Jasmine,how are you starting clojure?
1257,1556041083.3813,Elaine,"How do i create a var in a another namespace?
I know that it is not common, but I'm doing a DSL that ""compiles"" to <#C08TC9JCS|clara>, and clara use vars in namespaces..."
1258,1556041198.3814,My,"Hey all, we’ve written a post on the Amperity Eng blog on Greenlight (our Clojure integration testing library). <https://eng.amperity.com/posts/2019/04/greenlight>"
1254,1556041242.382,Kate,<@Jasmine> java -jar [uberjar] args
1256,1556041308.3832,Kate,this code runs when i 'lein run' it but some jars fail their static initializers that try to classload XML expecting to get the system classloader (AFAIK)
1254,1556041390.3833,Jasmine,`intern` <http://clojure.github.io/clojure/clojure.core-api.html#clojure.core/intern>; user.clj is loaded pretty early in the RT - you could try adding one that sets `*use-context-classloader*`
1254,1556041662.384,Elaine,NICE!
1254,1556041827.3845,Kate,thx
1259,1556043017.3873,Aubrey,"Oh wow that is seriously cool. I’ve seen the project before but never got the value proposition. Are you aware of <https://github.com/caioaao/kaocha-greenlight> ? I’m using kaocha for running other tests. ; Silly question, can all the clojure.test compatible assertions be used? "
1259,1556056597.3912,My,Hey <@Aubrey> thanks we have seen that. I think the answer to your question is yes they should work. Feel free to file an issue if you find out this isn’t the case
1260,1556092717.3975,Enola,"Hello.
I'm trying to use `org.apache.commons.io.input.ObservableInputStream` to make sure that I remove the file that I just streamed.
For that I need to extend the abstract class `org.apache.commons.io.input.ObservableInputStream$Observer` and override some of its methods. I tried using `proxy` but the overridden methods are not called.
Is this because they're not public and have the default visibility instead?
My next step is to use `gen-class`. Is there anything simpler for this task?"
1259,1556094701.3986,Enola,"Ah, my Java's a bit rusty - package private methods cannot be overridden from another package at all. And the corresponding bug in Common's JIRA says: ""Fixed, will be in 2.7, whenever that comes."" Oh well."
1260,1556096907.3998,Enola,"New question - is there any way to use Java files in a Clojure project while keeping the working REPL? I don't want to reload Java files, I just want them to work. Right now I just keep getting `ClassNotFoundException`."
1260,1556097066.4001,Roselia,do you mean (import)?
1260,1556097100.4006,Enola,"Well yeah. Only the java file is within my project source files.; It seems that Leiningen allows you to specify `:java-source-paths`. The thing is, I don't use Leiningen and Boot - I just use `clj`."
1260,1556097357.4015,Ivana,<@My> Looks good! Am I right to observe that the step idea has some overlap with ideas from Cucumber? Or is that just accidental?
1260,1556097479.402,Roselia,"<@Enola> from <https://clojuredocs.org/clojure.core/import>
```
;; For cases when 'import' does not do it for you, i.e. ""live-coding""
;; You can use the DynamicClassLoader, ClassReader and the Resolver.
;; <https://github.com/clojure/clojure>

(def dcl (clojure.lang.DynamicClassLoader.))

(defn dynamically-load-class! 
  [class-loader class-name]
  (let [class-reader (clojure.asm.ClassReader. class-name)]
    (when class-reader
      (let [bytes (.-b class-reader)]
        (.defineClass class-loader 
                      class-name 
                      bytes
                      """")))))

(dynamically-load-class! dcl ""java.lang.Long"")
(dynamically-load-class! dcl 'org.joda.time.DateTime)

;; From that point the dynamically loaded class can be
;; used by the Reflector to invoke constructors, methods and to get fields. 
```"
1260,1556097605.4023,Enola,"But it requires a corresponding `.class` file, doesn't' it? I'm getting `Execution error (IOException) at clojure.asm.ClassReader/readStream (ClassReader.java:300).
Class not found` with it."
1260,1556097610.4026,Roselia,"thats all i found, tbh i'm interested myself; yeah seems like; found <https://github.com/ztellman/virgil> for lein and boot"
1260,1556097878.4035,Enola,"Yep, I could use <https://github.com/tailrecursion/javastar> that it mentions to just `slurp` that java file. :smile:; Found this: <https://www.mail-archive.com/clojure@googlegroups.com/msg103900.html>
More than half a year old but is probably still true.
```
clj is not a build tool, only a pure Clojure runner, so without something 
additional to do Java compilation, you can’t use it in a mixed source project.
```"
1260,1556098583.4048,Lecia,Any suggestions/reads/libs on how to stub an external RESTAPI service in my tests? So far I am thinking of <https://github.com/myfreeweb/clj-http-fake>
1260,1556098773.4055,Ivana,I'm curious too. I think Clojure is missing a library like this <https://github.com/lostisland/faraday>
1261,1556106349.0008,Lecia,the one I mentioned above is the Clojure adaptation of <https://github.com/chrisk/fakeweb>. Have you heard of that?
1261,1556106886.0011,Ivana,No I haven't heard of it (but doesn't say much actually)
1261,1556108324.0035,Lecia,Also saw this <https://github.com/johanhaleby/stub-http>
1262,1556109133.0055,Zona,"what's the best way to modify a macro that expects a literal Seq to evaluate functions/symbols passed to it?
```(defmacro old-printy
  [print-this]
  (if (seq print-this)
    `(print ~print-this)))```
Passing `'[a b c]` works, but `(def print-these '[a b c])`/`(old-printy print-these)` throws exception.

So far I have this
```(defmacro new-printy 
  [print-this]
  (let [evaluated-print-this (cond 
                               (fn? print-this) `(~print-this) 
                               (seqable? print-this) `(seq ~print-this)
                               (symbol? print-this) `(into [] ~print-this)
                               :else print-this)]
    `(print ~evaluated-print-this)))```; I forgot the `(if (seq evaluated-print-this))` in the second one :face_with_rolling_eyes:"
1263,1556109930.0077,Roselia,"i'm just starting with core async, if i want some transformations on a channel data is that a proper way to do it?
```
(defn filter
  ([c] (filter (chan) c))
  ([c' c]
   (go (while true 
         (&gt;! c' (&lt;! c)))) ;; logic here
   c'))
```"
1263,1556109968.008,Jasmine,"no, channels can take a transducer"
1263,1556109996.0084,Roselia,"alright ill look into it, is above pattern useful for something?"
1263,1556110019.0089,Jasmine,"`(chan 10 (filter odd?))`; that's a channel, buffer size 10, that you can put numbers into and only odds will come out; also, fyi there's <#C05423W6H|core-async> for more in-depth questions"
1263,1556110157.0102,Roselia,"yeah, noted its just seems completely silent"
1263,1556110179.0106,Jasmine,just waiting for you :)
1263,1556110188.0108,Roselia,haha
1264,1556112090.0112,Augusta,"How do I organize a deps.edn project with java source files?; I have something like this:
```
src/
   -  clj/
        - my-namespace/...
   -  java/ 
        - my-namespace/...
```; But when I import my java classes, clojure is unable to find them"
1264,1556113714.0136,Madelene,"<@Augusta>: `tools.deps` is not a build tool, so you can’t do that without compiling those java classes — and for that you need to look into build tools; <https://github.com/clojure/tools.deps.alpha/wiki/Tools>; or just use leiningen; which will do that"
1264,1556114884.0148,Augusta,"Ok, migrated to leiningen, but having the same error"
1264,1556115003.015,Madelene,did you set <https://github.com/technomancy/leiningen/blob/master/sample.project.clj#L306> ?
1264,1556115195.0155,Augusta,oh
1265,1556121689.0161,My,"I certainly don’t know anything about it, but can ask internally from contributers"
1266,1556122154.0172,Rosanne,"Hi, is there something like <https://github.com/metosin/ring-swagger> but which does the reverse? So it transforms a swagger spec (or open api spec) into a working mock API endpoint?"
1264,1556123985.0181,Jolanda,"It’s not Clojure, but this is close: <https://github.com/yayoc/swagger-to-mock>"
1267,1556124540.0187,Elaine,"There is some ""style guide"" for project's layout?"
1267,1556124653.019,Jolanda,<https://github.com/onyx-platform/onyx/issues/887>
1268,1556137790.0222,Leda,"those of you that use Schema for data spec, there is any way to validate some data against a schema without returning an exception, only true or false ?; <@Rosanne> if you find something like that, let me know, i'm using swagger too"
1268,1556137977.023,Dann,"~you can replace `s/check` with `s/valid?`~
oh, schema not spec, - plumatic/schema also has a function that you can use s/check
it appears schema and spec us valid vs. check in opposite ways(?)"
1268,1556138071.0232,Leda,"i'll try; check returns nil if  data matches the schema; how weird; s/validate throws an exception, so i have to handle it in order to not break my entire app. and i don't want to handle it"
1268,1556138262.0255,Dann,"because there's often only one way to be correct, and many ways to be wrong"
1268,1556138294.0261,Leda,"guess i'll have to make a wrapper fn to handle it; and make it return true or false; or i can use s/check with `nil?`
which i think it's very weird to read"
1268,1556138434.0275,Dann,<@Leda> `(complement s/check)` - returns a function which returns true or false in the way you want
1268,1556138492.0278,Leda,"oohh, how smart; thanks!"
1269,1556139855.0317,Tori,"Hello everyone :wave:. I just created an account here so it would be nice to introduce myself :slightly_smiling_face: My name is Radek, I'm from Poland. Not yet a clojure dev yet aiming to become one in some time. Currently working as a PHP/JS dev (w/ +10 years of experience). Proud owner of ErgoDox, VIM maniac. Currently watching season 2 of One Punch Man :stuck_out_tongue:"
1269,1556140009.032,Celestine,"Be sure to check out the wide range of channels here -- you'll find <#C053AK3F9|beginners> very helpful for early questions as you're learning the language (folks in there have opted in to helping new folks!). Pretty much every library in common use has a channel here somewhere -- and if you have questions about Slack itself (or this Slack in particular), there's <#C04V84U7G|slack-help>"
1269,1556140174.0328,Tori,"awesome, thanks for quick introduction :slightly_smiling_face:"
1269,1556140187.0331,Roselia,Poland Strong! :flag-pl: Greetings from Russia! :flag-ru:
1270,1556141592.0348,Wesley,"```(defmacro old-printy
  [print-this]
  `(if (seq ~print-this)
     (print ~print-this)))```"
1270,1556142020.0355,Stephen,"Is the rest API has swagger, you could maybe use one of the java generated servers <https://github.com/swagger-api/swagger-codegen/wiki/Server-stub-generator-HOWTO> to bad clojure is no option."
1270,1556142061.0357,Wesley,"Not sure if this handles all of the intended cases, <@Zona>:```
(defmacro new-printy
  [print-this]
  `(let [evaluated-print-this#  (cond 
                                  (fn? ~print-this) (~print-this)
                                  (seqable? ~print-this) (seq ~print-this)
                                  (symbol? ~print-this) (into [] ~print-this)
                                  :else ~print-this)]
   (print evaluated-print-this#)))
```; I guess Slack's thread function doesn't like wide code."
1271,1556144672.0367,Zona,"I missed out keyword and probably a few more, but it seems overly laborious to have to cond based on type. I wonder if there's a better method?"
1272,1556174055.0373,Rosanne,"Thanks, I’ll take a look at it!"
1273,1556182221.0393,Kami,"Hello everyone :slightly_smiling_face: My name is Jean, I’m from France :flag-cp:. I’m a Clojure(Script) developer."
1270,1556183945.0399,Emile,Season 2 of One Punch Man is great!
1274,1556187120.0416,Mira,"Hi there, is there a way to load a jar into a running repl? So that I can then `require` ""the contents"" of the jar?"
1270,1556187386.0417,Tori,<@Emile> IKR ? Awesome stress reliever :slightly_smiling_face:
1274,1556187721.0428,Sixta,"<@Mira> tools.deps has an add-lib that would work for you, and also pomegranate has something too"
1274,1556189099.044,Mira,"<@Sixta> thanks! can't seem to find it though, am I looking at a wrong thing: <https://github.com/clojure/tools.deps.alpha/search?q=add-lib&amp;type=Code> ? the whole `repl` ns seems to be missing"
1275,1556189745.0445,Clarine,"if you have a list ’(1 2 3), what’s the most efficient way of adding something to the front AND the end?; I don’t care what the resulting data structure is, as long as it’s seqable"
1275,1556190504.0451,Sixta,I think if you have a list there's no efficient way to append to the end
1275,1556190544.0453,Clarine,right. would `(concat the-list '[the element])` make sense?
1275,1556190714.0455,Sixta,"Does to me, yeah :); I believe it's only on a branch"
1275,1556190813.0459,Mira,"cool, thanks!"
1276,1556191487.0472,Star,what exactly is `Clojure contrib`?
1276,1556191547.0482,Latonya,"A set of Clojure libraries, all with the same license and requirement that contributors sign the Clojure CA (Contribution Agreement), so that the code can be relicensed later if desired.; I believe this is a complete list of them: <https://dev.clojure.org/jira/secure/BrowseProjects.jspa#all>  If not, they are all under the <https://github.com/clojure> Github organization"
1277,1556195093.0497,Jasmine,<https://clojure.org/community/contrib_libs>
1278,1556205256.0545,Alethea,"hey everyone, Im writing some tests to use with luminus

```
(deftest create-sales-batch
  (def req-opts {:headers {:authorization (:api-secret env)}})
  (def sales-batch [{:created-at     ""2019-04-24T02:25:00+00:00""
                     :tag-id         ""tagid""
                     :value-in-cents 1500
                     :external-id    ""e2336ed3-d03f-484e-b034-8b7540cc05c1""
                     :employee       {:name ""Antonio Carlos Jobim"" :document ""0000000000""}
                     :products       [{:name ""3x_skol_lata"" :value-in-cents 1500}]}
                    ])
  (deftest ok
    (testing ""create recharge batch without any failed items""
      (let [response (http/POST app ""/api/sales"" sales-batch req-opts)]
        (is (= 200 (:status response)))
        (is (= {:failed-items []} (:body response))))))
```

my main problem here is that `(:api-secret env)` needs to be available, and `mount/start` lives in the `:each` fixture, so I wrapped everything iniside another test.. but `eastwood` is complaining
`def-in-def: There is a def of req-opts nested inside def create-sales-batch`

I dont want to repeat `(def req-opts {:headers {:authorization (:api-secret env)}})` in every test what should I do?"
1277,1556205489.0549,Rosaline,Don't nest defs like that; Def is always global
1278,1556205832.0558,Mariela,"what stops you from using plain `let` for the bindings, and a plain `defn` for DRY?"
1278,1556206666.0561,Merna,def is inevitable
1278,1556206918.0564,Alethea,let my that
1279,1556209191.057,Clarine,"you are also nesting deftests, which is equally “bad”, since it’s basically defining a global var with a function in it"
1277,1556210167.0581,Dann,"note that you can call functions created by defn that use `is` / `testing` from within deftest, because clojure.test works via dynamic scope; those defs can exist outside the deftest, and the ""ok"" deftest can be a defn called from inside the test; of course the contents of ""OK"" can just be expanded to be the body of create-sales-batch and that probably makes more sense here"
1277,1556210279.06,Leda,"anyone who uses Swagger, there is any tool that helps with API testing using Swagger OAS 3.0 + Clojure with Ring?"
1280,1556212539.0603,Alethea,Luminus + Reitit?
1280,1556212572.0607,Leda,"i saw it, unfortunately i don't use Luminus; but no problem, i think i'll build something like that on my own"
1280,1556212779.0616,Meagan,"AFAIK reitit and spec-tools allows you to easily produce a swagger spec for a service from Clojure code, but doesn't go the other way"
1280,1556212968.0618,Alethea,"I think you can pick the desired middlewares individually, checkout the reitit repo for examples, they are not bounded to luminus; what is the best way to remove this warning? `WARNING: any? already refers to: #'clojure.core/any? in namespace: monger.collection, being replaced by: #'monger.collection/any?`; `(:refer-clojure :exclude [any?])` in everyfile that requires `monger.collection`?"
1280,1556213926.0634,Becki,"the consumer namespaces aren't shadowing `any?` form core, monger itself is"
1280,1556213959.0641,Alethea,is there a solution besides forking monger?
1280,1556213965.0643,Lesa,"If I were using that lib, I would probably use a `:rename` in my require, I don't like shadowing core functions"
1280,1556214003.0649,Becki,its too late at that point
1280,1556214020.0653,Alethea,"I'll search about :rename, shadowing core functions sounds fishy to me"
1280,1556214027.0655,Lesa,"ah, the warning is coming from within the lib?"
1280,1556214048.0659,Becki,"yes. when you load that code, a namespace is shadowing `any?` from core. it doesn't matter what someone else calls it"
1280,1556214054.066,Isreal,If only there were somebody working on a tool to help find these types of problems…
1280,1556214062.0664,Lesa,"gotcha, makes sense"
1280,1556214158.0667,Becki,it appears that this has been fixed: <https://github.com/michaelklishin/monger/blob/master/src/clojure/monger/collection.clj#L53>
1280,1556214160.0668,Alethea,"so there is nopthing to do about it?; Ill try to update monger; thx <@Becki>, that fixed the issue :slightly_smiling_face: but im curious, if they hadnt fix this there is no workaround it?"
1280,1556214391.0687,Becki,as far as i understand it yes. that code will cause a warning. the only way to fix it is to change the code
1281,1556215473.0689,Latonya,Like eastwood? :slightly_smiling_face:
1281,1556215488.0694,Celestine,(and it is only a warning -- it's not necessarily an actual problem)
1281,1556215508.0695,Clarine,"The OP wrote:

&gt; but `eastwood` is complaining"
1280,1556215514.0697,Latonya,although I have no idea if it catches deftest inside of deftest
1281,1556215528.0699,Latonya,"right, hence my smiley :slightly_smiling_face:"
1281,1556215627.0701,Clarine,"hmm, clj-kondo does:
<https://www.dropbox.com/s/shdjhtomuiuc9o2/Screenshot%202019-04-25%2020.06.41.png?dl=0>"
1282,1556217547.0706,Valerie,"Guys, anyone know of any library to do JWT authentication with Clojure?"
1282,1556217868.0711,Roselia,<@Valerie> <https://www.bradcypert.com/using-json-web-tokens-with-clojure/>
1281,1556222381.0724,Isreal,right that’s the tool I was thinking of! :simple_smile: 
1283,1556227764.0739,Sixta,"Is there a data structure which is suited to:
- Updating a singular entry by key
- Looping over / sorting items in arbitrary different ways at different times"
1283,1556227893.0744,Dann,sounds like you want a hash-map plus N sorting functions?
1283,1556228521.0763,Roselia,<@Sixta> i guess you can store it as hash-map and use sort-by to get a sorted sequence
1283,1556229313.0779,Sixta,"<@Dann> Sorta, I want to store like `{id {:extra ""info""}}` but then do something like `shuffle` on that and have a sensible way to refer to all that."
1284,1556231086.0794,Fredda,You could keep a map of key-to-index kvs. Then add an ILookup to a vector thing that defers to the map for the key-index-value lookup. You'd have to update the key-to-index map though when the vector order changes
1285,1556247758.0822,Loria,"what's the best data structure for expressing a bijective map? `A &lt;-&gt; B` where the elements within A and B are unique but could overlap; I could maintain two separate hashmaps `A -&gt; B` and `B -&gt;A` which are inverse of each other, but that seems expensive and error prone."
1285,1556248131.0843,Jasmine,<https://clojuredocs.org/clojure.set/map-invert>
1285,1556248420.0852,Marlen,I’m having some issue with the use of `pprint/cl-format` throwing an exception when run from an uberjar: `ClassCastException clojure.pprint.pfroxy$java.io.Writer$IDeref$PrettyFlush$4923d848 cannot be cast to clojure.pprint.PrettyFlush`; anyone run into this and know how to resolve? (pprint require’d via `(:require [clojure.pprint :as pprint])`); uberjar is built with juxt/pack.alpha via deps.edn
1285,1556248693.086,Loria,"constantly calling `map-invert` on a large map doesn't sound good, I'm concerned about the performance because I'll be using both forward and backwards mappings in a tight inner loop"
1286,1556250557.0862,Elaine,"you can try `#(into % (map (juxt val key)) %)`
But if you need to access you data from many ways, may be a good idea use <#C07V8N22C|datascript>"
1285,1556250744.0886,Rosaline,"Looks vaguely familiar, likely something reloading causing Pretty Flush to be redefined, so it is a new different class that doesn't match the proxy class"
1286,1556250773.0887,Loria,"Thanks! A full database is perhaps too heavy for my needs, I'm just trying to express a bijective mapping / isomorphism between two sets"
1285,1556250845.0892,Loria,"It needs to be frequently updated in an inner loop, so I can't be constantly regenerating the inverse mapping, and  some sort of persistent data sharing would be good"
1286,1556250882.0894,Elaine,"""Full database is too heavy""
datascript subtitle:
`What if creating a database would be as cheap as creating a Hashmap?`
:stuck_out_tongue_closed_eyes:"
1286,1556250928.0902,Luke,is there any library that when i add deps in lein project.clj and it auto reload it so that i needn’t restart the repl?
1286,1556250948.0903,Loria,"oops! Will have to look more into it then - I've hardly dealt with databases before; <https://gist.github.com/semperos/3835417>
Just found this implementation based on two synchronized maps :slightly_smiling_face:"
1287,1556252747.0909,Marlen,Seems it was related to some timestamp issue in uberjars; updating to a more recent `juxt/pack.alpha` seems to have fixed it
1286,1556253117.0919,Loria,you can use Pomegranate to hotload dependencies at the REPL; not sure if there's any tool to pick them up automatically from the project.clj
1288,1556254074.0928,Celestine,I ran into a similar problem with `depstar` until I fixed in my fork. The obvious default way of building JAR files is wrong. Who knew? :disappointed:; <@Luke> Boot lets you add dependencies to the REPL while you're working (using Pomegranate under the hood I think). The Clojure CLI is built on `tools.deps` and there's a branch of that which supports an `add-lib` function to add new dependencies dynamically. I have an alias for that in my `deps.edn` file.
1289,1556269154.0965,Nisha,"Is there a way to start a program, like using `lein run`, but also start nrepl in the background?; Something like <https://github.com/jimbru/lein-repl-run> does, but without a plugin."
1286,1556275688.0978,Priscilla,are there any cool clients built around datafy and nav yet? (besides rebl)
1289,1556276719.1001,Elaine,"<@Nisha> `lein run myns.dev`
where `src/myns/dev.clj` contains something like
```
(ns myns.dev
  (:require [nrepl.server :as nrepl]
            [myns.core :as core]))

(defn -main
  [&amp; args]
  (nrepl/start-server 3333)
  (apply core/-main args))
```; ""Functions and data compose better then plugins and middleware"""
1289,1556276822.102,Nisha,<@Elaine> Thanks! This is what I’m currently doing. Just curious if there’s a better way.; I spent quite some time learning what `lein run` and `lein repl` do before getting anything done. :sweat_smile:
1289,1556277052.1054,Elaine,"<@Nisha> my `myns.dev` from the current project do:
- start a <#C0K65B20P|pedestal> server (main app)
- start a <#C17JYSA3H|nrepl> server
- run ""yarn install""
- start a <#C6N245JGG|shadow-cljs> server
- start ~3 builds in shadow-cljs server
- run a ""yarn watch"" command ""forever"""
1289,1556277120.1059,Nisha,"I don’t see your code, but that’s a lot  lol"
1289,1556277186.1071,Elaine,"that about: you will need to start/stop things, maybe in some order, and you dont need to develop a plugin to do it :slightly_smiling_face:"
1289,1556277253.1077,Nisha,"like if you don’t have a plugin, you just manually do it, right?; Now I have a simple TUI app, and I just added a nrepl server to it. Maybe later I’ll have to add a repl too."
1289,1556277329.1097,Elaine,"I'm more about:If I can call `(lib/start)` I dont need to search a `lein-lib` plugin; <#C6QH853H8|tools-deps>, the new `cli` to start clojure, it does not even have a plugin system"
1289,1556277462.111,Nisha,So you prefer clj over lein?
1290,1556279428.1136,Georgina,"I’m trying to use grpc and protobufs with `lein-protoc` and I do get the simplest hello world thing working.
I don’t understand how to include dependencies tho - our company protobufs use `com.google.api.grpc/google-apis-common-protos` for example and I can’t seem to include them for `lein-proto`; There’s a <https://github.com/LiaisonTechnologies/lein-protoc#usage> `:proto-source-deps` vector but I don’t get how I point it to a jar"
1290,1556279589.1157,Keeley,"I’m going through some clojure homework that is proving beyond me, would anybody be able to assist?"
1290,1556279926.1158,Coralie,"looks like it tries to find the relevant jar among the classpath, for each of the given source-deps; so I'd try to make sure your jar is in the classpath first (e.g. as an ordinary dep), then name it in source-deps"
1290,1556280206.1169,Roselia,<@Keeley> why don't you just ask an actual question about clojure so we can brainstorm it together?
1290,1556280223.1171,Keeley,"Sounds good; This is in a Koans form; given…; ```(defn empty-set
  ""takes any input element and returns nil""
  [_] nil)

(defn singleton-set
  ""takes an element and returns a fun-set containing
   just that element""
  [el1]
  (fn [el2]
    (when (= el2 el1) el2)))
```; complete the following…; ```(defn union
  ""takes two fun-sets and returns a set that is the set
   of all elements in either set1 or set2.""
  [f-set1 f-set2]
  ;;TODO
  )```; so first create two sets; ```(def f-set1 (singleton-set :happy))```; ```(def f-set2 (singleton-set :sad))```; I tried ```(def u-set (singleton-set f-set1 f-set2))``` just to see what would happen; got wrong number of arguments as expected"
1291,1556280733.1227,Roselia,you implemented singleton-set function?
1290,1556280754.1229,Keeley,yes; see above
1290,1556281128.125,Roselia,"<@Keeley> if i understand it correctly, singleton set can be described as `a = singleton set of a`"
1291,1556281151.1253,Roselia,am i right?
1290,1556281276.1257,Keeley,That sounds correct
1290,1556281288.126,Roselia,"then implementation should be
```(defn singleton-set
  [x]
  (fn [] x))```"
1290,1556281620.1286,Keeley,"If I interpret the function in the sample correctly, it will re-assign a new value but keep the original value if identical, which sounds unnecessary; checking"
1290,1556281790.1296,Roselia,"<@Keeley> well we describing singleton set, not a pair right?"
1291,1556281804.1301,Roselia,pair must be λabf.fab
1290,1556281808.1302,Evonne,"No, the “fun set” idea is a function that returns a truthy value for elements that are members of the set."
1291,1556281820.1306,Roselia,oh
1290,1556281862.1315,Evonne,"so the union of two singleton sets should be a function that returns a truthy value if the given element is either a member of the first singleton set, or a member of the second.; <@Keeley> You’re going to need to write a `defn` that returns an `fn`. The `fn` needs to take one element and return `nil` if the element is not a member of either singleton set, or the element itself as a “truthy” result, if it is in either set."
1290,1556282515.1357,Keeley,"That sounds like verification of contents in multiple sets,  But not the combining of two sets into a single set; ```""takes two fun-sets and returns a set that is the set
   of all elements in either set1 or set2.""```; So here is a contains for a single fun set; ```(defn f-contains?
  ""takes an fun set and el and returns true only if that
   elements exists in the fun set else false""
  [f-set el]
    (= (nil? (f-set el)) false)
  )```"
1291,1556282753.1378,Roselia,"```
(defn empty-set
  ""takes any input element and returns nil""
  [_] nil)

(defn singleton-set
  ""takes an element and returns a fun-set containing
   just that element""
  [element]
  (fn [target]
    (when (= element target)
      target)))

(defn union
  ""takes two fun-sets and returns a set that is the set
   of all elements in either set1 or set2.""
  [x y]
  (fn [target]
    (or (x target)
        (y target))))
```"
1290,1556282757.1382,Roselia,like that i guess
1290,1556282778.1385,Becki,the definition of a singleton set in this exercise is a membership function. In this exercise a set is merely a function that recognizes membership
1290,1556283241.1391,Keeley,<@Jada> close
1292,1556283249.1395,Roselia,what am i missing then
1290,1556283274.1399,Keeley,need to pass false not false nil; in test
1290,1556283309.1404,Roselia,so separate nil and false
1290,1556283309.1405,Keeley,"```FAIL in (union-test) (core_test.clj:44)
true false sets
expected: (= false (u-set1 false))
  actual: (not (= false nil))```; So that answer, using or, is there a book or site that goes over this kind of topic?  It doesn’t feel intuitive to me.; I’d be happy to go over a reading assignment before the quiz."
1290,1556283692.1426,Becki,Or can’t work here
1290,1556283696.1428,Roselia,yeah
1290,1556283709.1432,Becki,It prevents sets from having the value false in them
1290,1556283911.1436,Roselia,"```
(defn union
  [x y]
  (fn [target]
    (when (or (some? (x target))
              (some? (y target)))
      target)))
```; how can we do it better?"
1290,1556284334.1454,Evonne,"<@Keeley> Ironically, I became familiar with this style of “set” programming by taking the “Functional Programming in Scala” course at Coursera."
1292,1556284346.1457,Roselia,"```
(defn union
  [x y]
  (fn [target]
    (if (and (nil? (x target))
             (nil? (y target)))
      nil target)))
```; i'm out of options; `when not and` also"
1292,1556284502.1477,Becki,"```
(defn union
  [set1 set2]
  (fn [element]
    (if-some (set1 element)
      element
      (set2 element))))
```
is how i would do it"
1292,1556284526.1482,Roselia,wasn't aware of if-some great to know
1292,1556284532.1485,Becki,i used it incorrectly though; its a binding one. so just use `(if (some? ..))`; my only thinking is if nil is an explicit case make it very clear
1292,1556284607.1503,Evonne,"If `set1` is a function (as opposed to being a clojure set), you don’t need `some?`. Just call the function."
1292,1556284680.1512,Becki,need to watch for the case when the set contains `false`; which was the original failure
1292,1556284735.1521,Evonne,"Ah, I was just re-reading the test, that’s right; The test results, that is"
1292,1556284743.1525,Jasmine,don't put logical false values in sets ;)
1292,1556284757.1528,Evonne,"lol; `(if-not (nil? (set1 value)) ...`; unit test is tricksy, my precious…; Actually, `some?` is the better choice here. I keep thinking `some?` iterates over a collection, but it’s really just “not nil”."
1292,1556285619.1556,Roselia,"but i think if-not nil? is more describing, for a person who doesn't know some?"
1293,1556285701.156,Roselia,"```
(defn union
  [set1 set2]
  (fn [x]
    (if (some? (set1 x))
      x (set2 x))))

(defn union
  [set1 set2]
  (fn [x]
    (if-not (nil? (set1 x))
      x (set2 x))))

(defn union
  [set1 set2]
  (fn [x]
    (when (or (some? (set1 x))
              (some? (set2 x)))
      x)))
```; all three for history"
1292,1556285766.1576,Evonne,"Check those, though, I think you just want `(set2 x)` where you have `x (set2 x)`; wait, no I’m reading that wrong"
1293,1556285790.1583,Roselia,yeah we have two sets
1293,1556285792.1584,Chas,"```(defn union [set1 set2] 
  (fn [v] 
    (if (nil? (set1 v))
      (set2 v) 
      v)))```; does that work?"
1293,1556285803.1589,Evonne,"ever since I quit drinking coffee, I swear… :face_with_rolling_eyes:"
1292,1556285831.1593,Evonne,"<@Chas> Yeah, that should work just fine"
1293,1556285882.1596,Roselia,now i'm confused about (set2 v) being first form in if
1292,1556286110.1615,Evonne,"The trick is that each of your “fun-sets” should return nil if the target element is not in the set. So what happens if your set is a singleton set consisting of the value `false`?; In that case, it should return `false` if you pass it `false`, meaning “The element `false` *IS* a member of this set.”; which is confusing, because we naturally assume `false` means it’s _not_ a member."
1292,1556286241.1641,Roselia,"yeah now i get it; funny thing, like an optical illusion :smiley:"
1294,1556288426.165,Elaine,"You don't need to prefer
Both have one optimal use-case
I deliver a product that my client require that `java -jar app.jar` will work, it's way easier to do with lein
But what I'm saying is that you dont need plugins."
1295,1556292047.1657,Nieves,"I think all these things comes from wide repeated suggestion in internet not to use `contains?`, cause it exists espesially  for such cases"
1295,1556292831.1665,Emmy,"Is anyone able to explain this:

```
(defprotocol P
  (foo [this a]
       [this a b]))

(deftype T []
  P
  (foo [this a]
    (println ""foo a""))
  P
  (foo [this a b]
    (println ""foo a b"")))

;; the-ns=&gt; (foo (T.) 1 2)                                                     
;; foo a b
;; nil
;; the-ns=&gt; (foo (T.) 1)                                                       
;; Execution error (AbstractMethodError) at kw-get/eval6029 (REPL:1).          
;; kw_get.T.foo(Ljava/lang/Object;)Ljava/lang/Object;
```"
1295,1556292918.1668,Jasmine,"why are are you extending P twice instead of doing it once?; ```(deftype T []
  P
  (foo [this a]
    (println ""foo a""))
  (foo [this a b]
    (println ""foo a b"")))```; I think only the second of those was taking effect the way you had it written"
1295,1556293389.1678,Emmy,... :facepalm: thanks <@Jasmine>; Misunderstood the syntax; so presumably `deftype` stays on a given protocol until a new one is supplied?; I mistakenly thought it was 1 pair of Protocol to method
1295,1556294146.1702,Jasmine,you can specify any number of methods under the protocol
1296,1556305757.1757,Marg,"I'm developing an application in which I need the user to provide mathematical formulae... I need to parse these formulae so they can be evaluated. Are there any libs doing something like that? So, I'd like to read some edn-string like:
```
{:vars [x y]
 :result (* x 5 (Math/sin (/ y 7)))}
```
(it can be infix notation as well, but just being able to read this in clojure would certainly be fine as well. I could use something like `eval`, but that's not very save :stuck_out_tongue:.
'parsing' it, would result in something like `(fn [{:keys [x y]}] (* x 5 (Math/sin (/ y 7))))`; Are there any existing 'math parsing' libraries?"
1296,1556305855.1771,Jasmine,"seems like you have valid Clojure there - no need to ""parse"", just read; you could then write an ""evaluator"" that took a list and recursively applied the first op to the latter ops, but of course that's all eval is doing"
1296,1556305931.1789,Dann,"if you want a whitelist, you could use a table ```
`{+ ~+ sin ~#(Math/sin %)...}``` and only accept symbol inputs with substitutions in the table
(edit - Math/sin isn't first class)"
1296,1556305934.1791,Jasmine,"another way to go would be to rely on eval, but put your time into whitelisting; jinx"
1296,1556306035.1812,Marg,"ok, let me try and see if I get somewhere. (Couldn't make it work now, but I might have done something wrong/weird :slightly_smiling_face: )"
1296,1556306036.1813,Dann,"you could eval after the whitelisting, or even run the substitutions as an interpreter"
1296,1556306076.1818,Marg,<@Dann> what d'you mean with _run the substitutions as an interpreter_
1296,1556306099.1824,Dann,"walk the input, look up the thing in function position, call it with the args once all are simplified"
1296,1556306114.1833,Jasmine,"ie, duplicate eval :)"
1296,1556306114.1834,Dann,and bail if you hit anything that isn't a number literal and isn't whitelisted; fair
1296,1556306135.184,Marg,:slightly_smiling_face:
1296,1556306157.1849,Loria,"<https://github.com/rm-hull/infix/> check this out, if you're looking for external libs"
1296,1556306189.186,Marg,"yeah, saw that one, was about to start trying it, but having infix wasn't the main goal :stuck_out_tongue:"
1296,1556306195.1862,Dann,"perhaps the most elegant thing is read the whole thing into lists of symbols/numbers, then tree walk and replace symbols / validate, then eval; the tree walk could just throw if it sees functions or vars that aren't allowed; or if you are OK with users hosing / abusing the machine (eg. it is their own machine) just eval :D"
1296,1556306301.1877,Marg,"lol, well, the whole point was to avoid eval :slightly_smiling_face:"
1296,1556306554.189,Alethea,"is there a way to run a fixture before ALL tests (not the one in current namespace) after ALL tests?
I need to spin up a few docker containers before the tests and shut them down afterwards, maybe I should use lein for it?"
1296,1556306624.1895,Dann,"or write a clojure program that defines a middleware around clojure.test/run-tests; the amusing thing, is if we map from symbol to safe math op, it looks like we have single quote strings ```(def math-ops
  {'+ +'
   '- -'
   '* *'
   '/ /})```; (edit: /' doesn't exist)"
1296,1556306968.1902,Jasmine,"you are inherently writing an expression evaluator. it's ok to use eval for that, this is like what a lisp is good for. :)"
1296,1556307028.1904,Dann,"```(cmd)user=&gt; (load-file ""/tmp/mather.clj"")
#'user/run-math
(ins)user=&gt; (run-math ""(+ 1 1)"")
2
(ins)user=&gt; (run-math ""(+ (sin 1) 1)"")
1.8414709848078965
(ins)user=&gt; (run-math ""(+ (System/exit 1) 1)"")
Execution error (AssertionError) at user/whitelist (mather.clj:15).
Assert failed: the System/exit operation is not allowed
op
```; ```(require '[clojure.edn :as edn]
         '[clojure.walk :as walk])

(def math-ops
  {'+ +'
   '- -'
   '* *'
   '/ /
   'sin #(Math/sin %)})

(defn whitelist
  [tree]
  (if (symbol? tree)
    (let [op (find math-ops tree)]
      (assert op (format ""the %s operation is not allowed""
                         tree))
      (val op))
    tree))

(defn run-math
  [s]
  (-&gt; s
      (edn/read-string)
      (-&gt;&gt; (walk/postwalk whitelist))
      (eval)))
```"
1297,1556307957.1915,Marg,"something like this?
```


(defn calc
      [form vars]
      (let [ops-whitelist `{+ ~+ sin ~#(Math/sin %)}]
           (walk/postwalk
             (fn [calc]
                 (if (sequential? calc)
                   (if-let [f (ops-whitelist (first calc))]
                           (apply f (map #(get vars % %) (rest calc)))
                           (throw (new Exception (str  ""Cannot perform operation: "" (first calc)))))
                   calc))
             form)))
```
running
```
(calc `(+ ""val1"" 7 (sin 0.5)) {""val1"" 5})
``` seems to work fine :stuck_out_tongue:; ouch, naming, not really pretty (twice `calc`)"
1296,1556308285.1922,Loria,"here's one that doesn't rely on eval:
```
(defn eval-math [env expr]
  (let [oops (fn [msg x] (throw (IllegalArgumentException. (str msg x))))]
    (cond
      (list? expr)   (apply (or (math-ops (first expr))
                                (oops ""Function not in whitelist: "" (first expr)))
                       (map #(eval-math env %) (rest expr)))
      (symbol? expr) (or (env expr)
                         (oops ""Undefined symbol: "" expr))
      (number? expr) expr
      :else          (oops ""Illegal value: "" expr))))

(eval-math '{x 1 y 2}
  '(* x 5 (sin (/ y 7))))
;; =&gt; 1.4092142606110496

```"
1297,1556308604.1925,Dann,I think the eval version is fine - the postwalk ensures the safety I think(?)
1297,1556308685.1938,Alethea,"im trying to put the current timestamp in a uberjar name, assuming I can run arbitrary clojure code inside project.clj (not sure its possible)

```
{:uberjar       {:omit-source    true
                   :aot            :all
                   :uberjar-name   (str ""cohmeia_api_local_""
                                     (.format (java.text.SimpleDateFormat. ""yyyy_MM_dd'_'HH_mm_ss"")
                                       (.getTime (java.util.Calendar/getInstance))) "".jar"")
                   :source-paths   [""env/prod/clj""]
                   :resource-paths [""env/prod/resources""]}
```
fails with `java.lang.ClassCastException: clojure.lang.PersistentList cannot be cast to java.lang.String`

Its possible to do this and am missing something or there is no way?"
1297,1556308690.1939,Marg,yeah... not sure how I would've done the eval thingy.
1297,1556308757.1945,Celestine,"In `project.clj` you can escape code with `~` to have it evaluated.; so ```:uberjar-name ~(str ""cohmeia..."" ...)```"
1297,1556308848.1951,Alethea,thanks :slightly_smiling_face:
1298,1556310589.1956,Dann,"one advantage(?) of the eval version is that you get hash-maps and vectors as functions, it would be good to get confirmation that whitelisting symbols is enough to make using eval safe here; I posted a working example with eval / whitelisted symbols in the other thread (the one under you saying you wanted to avoid eval...)"
1299,1556311067.196,Marg,"oh, cool, thx, I'll have a look!; thx all, I have a few versions now :stuck_out_tongue:"
1297,1556314261.1994,Angelita,So is it to better to do :use or to :require? Is use akin to :refer all?
1297,1556314609.2001,Florance,"`:require`, don’t use `:use`"
1297,1556314818.2006,Mariela,You can find other useful recomms here <https://stuartsierra.com/2016/clojure-how-to-ns.html>
1297,1556315806.2022,Angelita,"Ok, <@Mariela> will bookmark that site.; That Stuart is a well of knowledge"
1297,1556322654.206,Fernande,"<@Angelita> if you haven't done so already, perhaps you will find grepping the clojure source for sierra useful some time :slightly_smiling_face:"
1300,1556324601.2063,Madeleine,"Its better to use :refer :all mostly for conssistency; And as a way to encourage not refering :all to begin with. But instead explicitly listing what to refer, and even better, not refering anything, just aliasing instead.; But use still works. Its just that since require can now do everything and more that what use used to do, use is no longer needed."
1297,1556328831.2094,Angelita,"<@Fernande> well, just checked GitHub. Man I really should pay more attention."
1301,1556359210.2115,Yasmine,":+1:; @here help me out , which is the best framework for web development in Clojure"
1301,1556372098.2139,Caitlyn,"<@Yasmine> I think ring is a typical starting point
<https://github.com/ring-clojure/ring>"
1301,1556373833.2146,Roselia,"<@Yasmine> if you are looking for framework, re-frame, om next, luminus, fulcro, pedestal for server side?"
1301,1556374160.2151,Yasmine,Thank you guys 
1301,1556374453.216,Roselia,"<@Yasmine> just remember there is no BEST in programming, everything has its strong and weak sides, you just need to choose the one that fits your task better."
1302,1556380216.2172,Joye,Hello. I started a project using a Leiningen template. The template has since been updated. Is there a way to incorporate template changes into an existing project?
1301,1556386619.2178,Yasmine,<@Roselia> that’s true 
1302,1556395434.2209,Brent,"`partial` or `#(... %)`? Is there a clear preference in the community for one or the other?
I kind of prefer `partial` (since `#(..)` don't nest and it is fewer weird characters) but it is much longer to type and anon. fn. is more flexible as the `%` can be placed anywhere, not just at the end. I believe people use `#(..)` much more, is that a correct observation?"
1302,1556395974.226,Nieves,"As a haskeller in past, I was surprised how indirect is carryng in Clojure - in Haskell you can simply drop argumenst for this. But the same question about arguments order also exists (more `flip`-s is about it). And absence of `(* 10)` syntax also make code more verbose. I think you can use such hack for shorten type: `def p- partial` or use common reader macroses like `#(... % ...)`"
1302,1556396077.2285,Madeleine,Either or really
1302,1556396162.2306,Veola,I perfer `partial` over `#(...))` whenever possible. Less weird characters and less ambiguity. I would only use `#(...)` over it if I need to be more succinct in # of characters.
1302,1556396211.231,Madeleine,I really wish one day #() could nest; Its one of those small quirks; I wonder why it can't nest actually
1302,1556396358.2338,Florance,If you’re nesting anon functions it sounds like you should be calling `fn` (with a name! like `(fn my-fn-instead-of-partial [a b] (+ a b))` )
1302,1556396415.2341,Madeleine,Why with name; I often don't need it named; That's the issue of fn
1302,1556396540.237,Florance,So that when going through a stack trace its not a gensym’ed name. It may seem verbose with 1 or 2 levels of nesting but i’ve seen those partials be passed around for DI (Not a pattern I like…) and its next to impossible to understand what function was *actually* called via the stacktrace if you don’t have a name.
1302,1556396598.2388,Madeleine,"Hum, ya I guess for staxktrace maybe. But sometimes I'd for sure take the convenience over it"
1302,1556396611.2392,Nieves,About nested `#(...%...)` - you must have an ability to use argument of external function into internal - but with `%` or `%1` syntax it can not be realized; How you would rewrite `(fn [x] (fn [y] (+ x y)))` ?
1302,1556396680.2412,Madeleine,"Hum... Is that the only logic? I guess sometimes you need to close over the parent, but shadowing would be okay a lot of the time; I guess actually, I'm more hoping for a new form. It's a but embarrassing that I find Java's syntax better `(x -&gt; y -&gt; (+ x y))`"
1302,1556396797.2433,Florance,I mean… you can write a macro for that exact syntax if you really want it.
1302,1556396833.2442,Nieves,Magic and power of Clojure macroses allows you to write any syntax you want I hope :slightly_smiling_face:
1302,1556396865.2456,Madeleine,Its not that I really want it. Its that I find #() is a little quirky. And I wouldn't mind a core improvement on it
1302,1556396871.2458,Nieves,"Oh, I type very slow - I follow answer above :slightly_smiling_face:"
1302,1556396880.2462,Madeleine,"I always have to explain #(); It has both implicit args, which is quirky, it has the issue that it always wrap the inside in a parenthesis so you can't do #(""10"") and it can't be nested; That's a lot of quirks; I mean, minor quirks"
1302,1556396994.2491,Nieves,"As I know, `#` is a prefix of non-expandable reader macroses"
1302,1556396997.2493,Madeleine,"But still; I don't know what would necessarily be better though.; Maybe just `#(x y (+ x y))` and have it be nestable; Basically, #() would assume the last expression is the fn body and everything before are the symbol args"
1302,1556397256.2521,Nieves,:slightly_smiling_face: how deside it is one 2-arg lambda or 2 one arged?
1302,1556397294.2532,Madeleine,For two one arg you'd do `#(x #(y (+ x y))`
1302,1556397324.2537,Nieves,x can be binded global symbol :slightly_smiling_face:
1302,1556397366.2548,Madeleine,"Ya, but so can it for `(fn[x] ...)`, so in this case it just shadows the global symbol"
1302,1556397379.255,Nieves,Not of course; in lambda calculus it called free or binded args
1302,1556397460.257,Madeleine,I guess I'm not following. How is it any different to `(fn[x] (fn[y] (+ x y))`
1302,1556397461.2572,Nieves,everything in vector after `fn` is binded; `(def x partial) (apply #(x #(y (+ x y)) 33)`; and it must be as a (partial #(+ % ???) 33)
1302,1556397604.2594,Madeleine,Hey that's neat !
1302,1556397674.2613,Nieves,"So, the problem is how to strong set symbols as an arguments of lambda, but not as an external symbols"
1302,1556397686.2617,Madeleine,But. I would literally just have it be a macro that expands to `(fn[x] (fn[y] (+ x y))`
1302,1556397744.2629,Nieves,You can write such macro. But it will reduce your capabilities for using external symbols
1302,1556397786.2645,Madeleine,"I don't think so, since the user picks the symbol names, they are in control, if they don't want to shadow, they just use another name"
1302,1556397788.2647,Nieves,"On the other hand, you will know it as a feature, not a bug :slightly_smiling_face:"
1302,1556397812.2654,Madeleine,"I mean, you could expand it into gensymed symbols as well; Then you wouldn't be able to shsdow; shadow"
1302,1556397825.2664,Nieves,"Stay on strong semantic, not weak conventions"
1302,1556397839.2669,Madeleine,"Though I would find that surprising, since I'd expect it to shadow; So why doesn't fn has the same problem, I'm still not following?"
1302,1556397957.2686,Nieves,"cause fn have only way and ability to create a new local-meaning (how it say?) symbols; `let` in Clojure is a spec form, but semantically it is a macro on lambda (and in Scheme it really is!); `(let [a 1 b 2 c 3] (+ a b c))` -&gt; `((fn [a b c] (+ a b c)) 1 2 3)`; so, semantically speaking, only lambda-abstraction can insert new named args in combinators; and of course, you can shadow external symbol in `fn`; but it is well controlled and known"
1302,1556398311.2741,Madeleine,What about `(let [a 1 b 2] (fn [a b] (+ a b)))`
1302,1556398344.275,Nieves,it is a trivial shadowing I mentioned before :slightly_smiling_face:
1302,1556398354.2754,Madeleine,"Right, so I'm just saying I'd like some syntax sugar over fn :yum:"
1302,1556398382.2765,Nieves,what I wanna say - you can wrap `fn` in a macro; But!
1302,1556398391.2772,Madeleine,"`(let [a 1 b 2] #(a b (+ a b)))`; Are you saying the evaluation order would be wrong with non reader macros, because let special form won't expect it?"
1302,1556398497.2797,Nieves,maybe haskell way would be better  `(\ x y =&gt; (+ x y))` :slightly_smiling_face:; `\` - is a real macro!; `#` already used by reader special cases
1302,1556398583.2824,Madeleine,"Ya, it's too late for #. But I wish it worked as I wrote it. Maybe adding #f(x y (+ x y)); Or even #fn(x y (+ x y)); Haskell way isn't bad either, just doesn't seem as consistent with the rest of Clojure's syntax"
1302,1556398639.2843,Nieves,and now it is time to main question - is it so far from current `fn` syntax?; :slightly_smiling_face:; `#fn(x y (+ x y))` or `(fn [x y] (+ x y))`
1302,1556398716.2864,Madeleine,"```
(fn [x y] (+ x y))
#fn(x y (+ x y))
```; :drooling_face:"
1302,1556398759.2873,Nieves,(not every time I type slower :joy:)
1302,1556398759.2874,Madeleine,Guess not
1302,1556398765.2877,Florance,:slightly_smiling_face:
1302,1556398774.288,Madeleine,"Though I do find it visually less distracting; But ya, ideally it would have been how `#` worked; I think you could still do it; You could have it that when there is no % or %n inside #, it assumes to be #(params form)"
1302,1556398918.2905,Florance,But then there is magic.; and syntax.
1302,1556398965.292,Madeleine,I guess this would be an issue: `#(+ 1 2)`
1302,1556398966.2921,Florance,And every time I would look at an anonymous fn I’d have to remember and think about if the magic is happening there or not.
1302,1556399026.294,Nieves,but now `#(+ 1 2)` is a normal non-arged lambda
1302,1556399046.2948,Madeleine,"You think? Okay, let's say I create #f and these are example usage:

```
#f(a b (+ a b))
#f(+ 1 %)
#f(+ %1 %2)
```

You'd find that confusing?"
1302,1556399132.2953,Nieves,"```
(#(+ 1 2))
=&gt; 3
```"
1302,1556399159.2964,Madeleine,"Ya, extending # wouldn't work, we'd break lambda of no args"
1302,1556399255.2988,Nieves,"<@Madeleine> can I suggest a little tweak? :slightly_smiling_face: `#f(a b (+ a b))` -&gt; `(\ a b (+ a b))`; destruction will breaking, but other will work :slightly_smiling_face:"
1302,1556399304.3004,Florance,"```
#f(a b (+ a b)) =&gt; (fn [a b] (+ a b)) ;; cost: is wrapping a and b in a vector
#f(+ 1 %) =&gt; #(+ 1 %) ;; cost: an extra character
#f(+ %1 %2) =&gt; #(+ %1 %2) ;; cost: an extra character.
```"
1302,1556399314.3007,Madeleine,"Ya, I guess that could work as well.; So the cost I see isn't how many chars to type; But how visually non distracting it could be"
1302,1556399384.3029,Nieves,and as I already mentioned - do not forget about magic distraction syntax in `fn` - macro :slightly_smiling_face:
1302,1556399405.3039,Madeleine,"Now that I think about it though, it seems what I'm really asking for is named arguments inside # and thus the ability to nest it.; Maybe just `#(+ %a %b)`"
1302,1556399448.3052,Nieves,Looks like so
1302,1556399473.3065,Madeleine,"Ya. That would satisfy my use case, would be even better, since now it's actually 50% shorter as well"
1302,1556399506.3073,Nieves,and this is exactly the same i talked about several types above - strong splitting internal args from external symbols
1302,1556399532.308,Madeleine,"Oh, that's what you meant?"
1302,1556399552.3089,Nieves,and you still can write a macro and your dsl syntax for it; yes
1302,1556399565.3096,Madeleine,"I mean, someone could do `(let [%1 1 %2 2] #(+ %1 %2))` no? Though unlikely"
1302,1556399630.3104,Nieves,`%` prefix with number suffix now used for it in `#` - style lambdas; you can choose another convention - but you have to choose any one
1302,1556399775.3124,Madeleine,Wonder if Rich Hickey would approve a patch to add support for `#(+ %a %b)` hehe. Probably not
1302,1556399799.3129,Nieves,I dont think so optimistic :slightly_smiling_face:; But!; Your can write your own .clj code preprocessor!
1302,1556399886.3145,Madeleine,"Haha, ya. I'll probably just live with (fn[a b] ...) for now :yum:"
1302,1556399956.3157,Nieves,Lets go back to classic :joy:
1302,1556399957.3158,Madeleine,"I think the only time I really need this is when I do a map in a map; And I feel, maybe there's just a whole better way to do what I'm trying to do"
1302,1556399993.3169,Nieves,I often was needed nested `#` lambdas; and I had to choose which lambda make `#` external or internal :slightly_smiling_face:; for ex - update map value by function with nested map or filter
1302,1556400110.3199,Madeleine,"Yup; There's definitely many time where you need to nest, at least one level"
1302,1556400153.3214,Nieves,but distructing syntax in `fn` macro makes choice easier :slightly_smiling_face:
1302,1556400173.3217,Madeleine,"Ya, maybe I should just stop using #(), and only use fn. Then I'm never accidentally nesting it and wondering why it throws exception"
1302,1556400238.3224,Nieves,Good that this exception throws at compile time!; Not at runtime )
1302,1556405753.3236,Roselia,<@Nieves> is that you who was asking a question about tail call recursion on fp discord?
1302,1556405866.3246,Nieves,"yes, that was me, and I have same nickname on all messengers/forums."
1302,1556405896.3252,Roselia,"yeah i thought so, just sent you an answer, if its still relevant"
1302,1556405946.3262,Nieves,"thanks, but I already had a constructive discussion about it here"
1302,1556405957.3265,Roselia,"great, np"
1302,1556406125.3289,Nieves,and I think I'l be rare visitor of discord and other channels - I have a limited amount of day time (only 24 hours :slightly_smiling_face: ) and multiple messengers wants more than this :slightly_smiling_face:
1302,1556406154.3294,Roselia,"yeah, i would like to delete slack, but this community is too important for me"
1303,1556430742.3299,Georgina,Thank you I will try that!
1304,1556435657.3304,Johnathon,"i remember reading somewhere that anonymous functions end up being stored/cached in such a way that keeps them efficient when used more than once, say as an anonymous comparator. is that right?"
1302,1556442521.3341,Roselia,"<@Johnathon> right, functions is just a jvm object, you can store and invoke it, unless you  create many function instances in a loop.
In fact there is no difference between anonymous function and named function.
If i understand it correctly.
`(def fn-name (fn [x] x))`
equals to
`(defn fn-name [x] x)`"
1302,1556442686.3346,Mariela,"I also wondered this recently :slightly_smiling_face:

<https://github.com/clojure-goes-fast/clj-java-decompiler> answered, e.g. Clojure is smart enough make `fn`s once, in advance, rather than many, on-the-fly"
1302,1556442709.335,Roselia,"<@Mariela> in which case tho, in a loop?; (do
  (println (fn [x] x))
  (println (fn [x] x)))
creates two different objects obviously; you must store function instance returned by `fn` somewhere, be it local binding or Var or even java reference type"
1302,1556443349.3366,Mariela,"here's the decompilation of

```
(defn sample []
  (do
    (println (fn [x] x))
    (println (fn [x] x))))
```

-&gt; <https://gist.github.com/vemv/bcd6bb57861531b1b6b9995744d27776>"
1305,1556444783.3379,Nieves,"It does not need to guess - just use `macroexpand` :slightly_smiling_face:
```
(macroexpand '(defn fn-name [x] x))
=&gt; (def fn-name (clojure.core/fn ([x] x)))
```; and outside the loops each `fn` call seems to create a separate object, as shown in thread above and in another little example
```
(defn f [x] x)
(defn g [x] x)
(def h f)
[(= f g) (= f identity) (= f h)]
=&gt; #'user/f
#'user/g
#'user/h
[false false true]
```
it seems that Clojure does not do optimization in this case, cause 1-st order objects may used as a different items"
1302,1556445684.3416,Roselia,"<@Mariela> how you decompiled sample function, i can't make it work for some reason; i mean how you called clj-java-decompiler exactly; <@Mariela> its still created two classes for each function, instantiated and called both of them, no optimization there; ```
    public static Object invokeStatic() {
        ((IFn)const__0.getRawRoot()).invoke(new endpoint$sample$fn__528376());
        return ((IFn)const__0.getRawRoot()).invoke(new endpoint$sample$fn__528378());
}
```"
1302,1556447851.3432,Mariela,"&gt; its still created two classes for each function,

yeah, I don't expect Clojure to try comparing different `fn`s searching for equality

&gt; instantiated

object creation and short-lived GC are extremely cheap AFAICT

the _classes_ are created once, statically, that was my point. Perhaps a naive compiler would create the classes in runtime; &gt; i mean how you called clj-java-decompiler exactly

plain usage, wrapped in `(with-out-str)`, using 0.2.1"
1302,1556448057.3436,Roselia,"hmm; ```
(defn my-identity [x] x)
=&gt; #'playsync.core/my-identity
(with-out-str (decompile (my-identity 5)))
=&gt;
""
 // Decompiling class: cjd__init
 import clojure.lang.*;
 
 public class cjd__init
```; it outputs cjd__init class; or
```
(with-out-str (decompile (fn [] (my-identity 5))))
=&gt;
""
 // Decompiling class: playsync/core$fn__13171
 package playsync;
 
 import clojure.lang.*;
 
 public final class core$fn__13171 extends AFunction
```; but your version produced
endpoint$sample class; where sample is a named function i guess; i'm missing something here"
1302,1556448979.3453,Mariela,wrap the `defn` call with `decompile`
1302,1556455967.3458,Roselia,great ty
1306,1556465592.3468,Liliana,"I'm trying to use the clojure java api (for a ticket on java app, used by java users)
```
IFn fn = Clojure.var(""clojure.core"", ""fn"");
IFn vector = Clojure.var(""clojure.core"", ""vector"");
fn.invoke(vector.invoke(), null);
```
but I get
```
An exception occured while executing the Java class. Parameter declaration missing
```"
1302,1556465910.3476,Liliana,"ah got it `fn.invoke(null, null, vector.invoke(), null)` the two first null's are probably the meta and optinal name."
1302,1556472777.3491,Johnathon,<@Nieves> <@Roselia> anonymous functions in loops was the reason i was asking. thanks for the clarification. :slightly_smiling_face:
1302,1556473699.35,Roselia,<@Johnathon> just create fn outside of a loop and you are set
1302,1556474102.351,Johnathon,"yup, that's where i ended up. i was just curious from a lazy programmer's perspective.; thanks <@Mariela>. just saw this thread. that's what i thought!; anonymous functions do not equal true when compared (of course), however they're reused under the hood"
1302,1556474755.3515,Roselia,"<@Johnathon> no, two different(unequal) functions will be used independently; or we don't understand each-other :smiley:"
1302,1556475742.3519,Johnathon,"hmm. i'm trying out `clj-java-decompiler` but i get the following when i run `decompile`
```
Execution error (ClassNotFoundException) at jdk.internal.loader.BuiltinClassLoader/loadClass (BuiltinClassLoader.java:582).
sun.misc.URLClassPath
```"
1302,1556475787.3521,Roselia,<@Johnathon> try jdk8
1302,1556476066.3541,Johnathon,okay i'll get around to installing jdk8 when i have some downtime :slightly_smiling_face: just reread the conversation between you and vemv and i understand now. separate objects but cheaply created and GC'ed? i'm happy to def functions when used often. i was just curious how it all worked underneath.; thanks for explaining
1302,1556476114.3548,Roselia,"yeah separate classes for each, but one instance per function"
1302,1556476251.3558,Loria,"Now that Clojure 1.10 supports extending protocols via metadata, is there any reason to prefer attaching metadata to generic maps instead of creating new records for sets of keys corresponding to a domain object?"
1302,1556476344.3561,Clarine,I can imagine the latter is still more performant?
1302,1556476449.3564,Roselia,"```
(let [fx (fn [x] x)
      fy (fn [y] y)]
             (println (fx 5))
             (println (fx 5))
             (println (fy 10))
             (println (fy 10))
             (while nil
               (println (fy 10)))
```
```
 public static Object invokeStatic() {
        final Object fx = new core$fn__14873$fx__14874();
        final Object fy = new core$fn__14873$fy__14876();
        ((IFn)const__0.getRawRoot()).invoke(((IFn)fx).invoke(const__1));
        ((IFn)const__0.getRawRoot()).invoke(((IFn)fx).invoke(const__1));
        ((IFn)const__0.getRawRoot()).invoke(((IFn)fy).invoke(const__2));
        ((IFn)const__0.getRawRoot()).invoke(((IFn)fy).invoke(const__2));
        while (true) {
            final Boolean true = Boolean.TRUE;
            if (true == null) {
                break;
            }
            if (true == Boolean.FALSE) {
                break;
            }
            ((IFn)const__0.getRawRoot()).invoke(((IFn)fy).invoke(const__2));
        }
        return null;
    }
```; as you can see only two objects are created one per function"
1302,1556476487.3571,Loria,"I assume it is, haven't done any benchmarks"
1302,1556476507.3575,Sixta,<https://github.com/puredanger/bench-proto>
1302,1556476643.3593,Loria,"I'm wondering what are the use-cases for extending via metadata? Is it more for one-off uses where you want to glue things together without setting up records?; oh right, metadata can be attached to lists and vectors as well, can't use records for those"
1302,1556476720.3604,Sixta,very convenient for datafy and navable
1302,1556476744.3606,Shanelle,<http://vijaykiran.com/2019/04/defn-48-david-miller/>
1302,1556476790.3609,Clarine,"yeah, that episode rocked."
1307,1556480748.3629,Stacee,"hi, so I have this collection. for each element, I map it with a function that produces a vec. I'd like to map every element of the coll then flatten/combine all the vecs together
I tried `(transduce (map mapping-fn) concat coll)` at first, but that gave me StackOverflowError for some reason. So now i have `(transduce (map mapping-fn) (completing (fn [acc next] (into acc next))) [] coll)`. is there a prettier way?"
1307,1556480779.3631,Celestine,Sounds like you want `cat`?
1307,1556480840.3641,Nieves,why produce a vectors to then concat them? `(vec (mapcat .....))` does not work?
1307,1556480908.3647,Stacee,"oh nice, mapcat is what I want. it's a transducer too"
1307,1556480910.3648,Celestine,<@Stacee> like this ```(into [] (comp (map mapping-fn) cat) coll)```
1307,1556480918.365,Stacee,thanks!
1307,1556480971.3658,Celestine,"Yeah, `mapcat` as a transducer will work for this case. `cat` is useful if you have a more complex pipeline -- or the `cat`ting doesn't come after a `map`ping :slightly_smiling_face:; ```(into [] (mapcat mapping-fn) coll)```"
1308,1556489279.3672,Angila,"Has anyone run across an error in core.async where it mysteriously tries to close a boolean?
```
Exception in thread ""async-dispatch-49"" java.lang.IllegalArgumentException: No implementation of method: :close! of protocol: #'clojure.core.async.impl.protocols/Channel found for class: java.lang.Boolean
```; I think something weird is going on, as I’m just opening a pipe between two channels I’ve created myself.; One of the channels has been added to a pub.; This seems to be enough to blow everything up.; Manually piping it with a go-loop works. Interesting, and bizarre…"
1308,1556490023.3704,Elaine,"stop the repl, clean cache dirs, drink a coffee and try again?"
1308,1556490028.3707,Angila,"Okay, this is just crazy. Copying the source code of pipe works, but calling it as a function doesn’t.; Good idea :slightly_smiling_face:; Stopping the REPL and cleaning the cache solved the problem. Thanks for the reminder :slightly_smiling_face:; Looks like it was just one of those weird bugs that crop up from time to time. Restarting the REPL and cleaning the cache fixed it."
1309,1556498165.3748,Liliana,"I'm thinking if I've stumbled upon a bug, I've been having GC problems with Java-JNA, which seem to be because clojure hash-map assignments assign the original variable to a null.
As can be seen in this short screencast I did <https://www.youtube.com/watch?v=A81I9fwV8AY> it seems that by looking at the decompiled clojure class
```
    public static Object invokeStatic() {
        Object csnd = ((IFn)const__0.getRawRoot()).invoke();
        Object thread = ((IFn)const__1.getRawRoot()).invoke(null);
        ((IFn)const__2.getRawRoot()).invoke((Object)new bug$spawn_csound_client$fn__8111(csnd), (Object)const__3);
        ((IFn)const__4.getRawRoot()).invoke(csnd);
        ((IFn)const__5.getRawRoot()).invoke(csnd, (Object)new bug$spawn_csound_client$fn__8113());
        Object[] arrobject = new Object[10];
        arrobject[0] = const__6;
        arrobject[1] = csnd;
        arrobject[2] = const__7;
        Object object = thread;
        thread = null;
        arrobject[3] = new bug$spawn_csound_client$fn__8115(csnd, object);
        arrobject[4] = const__8;
        arrobject[5] = new bug$spawn_csound_client$fn__8120(csnd);
        arrobject[6] = const__9;
        arrobject[7] = new bug$spawn_csound_client$fn__8123(csnd);
        arrobject[8] = const__10;
        Object object2 = csnd;
        csnd = null;
        arrobject[9] = new bug$spawn_csound_client$fn__8125(object2);
        return RT.mapUniqueKeys((Object[])arrobject);
    }
```
that this `csnd = null;` defenitely shouldn't be there?
Now knowing this, I can prevent this, but it's one of those annoying bugs :slightly_smiling_face:"
1308,1556499995.3775,Jasmine,"I wouldn’t trust the decompiler, look at the actual bytecode. Clojure adds bytecode that clears the passed args to prevent head-holding. This is not representable in Java so the decompilation will typically look weird."
1310,1556533657.3805,Bart,"trying to upgrade an older app from clojure 1.8.0 to 1.9.0, but running into missing dependencies on what I believe is `spec.alpha` and `core.specs.alpha`. basically `:cause Could not locate clojure/spec__init.class or clojure/spec.clj on classpath.` on build; i do have several versions of both in my local repo"
1310,1556536964.3829,Elaine,"<@Bart> some dependency from your project need to be upgraded too.
clojure.spec.alpha was first released(as alpha) as `clojure.spec` then renamed to `clojure.spec.alpha`"
1311,1556537130.3832,Elaine,probably `clojure.future.spec`
1308,1556540023.3846,Jasmine,"Clojure 1.9 depends on spec.alpha so shouldn’t need future spec; You should get that automatically though with lein, etc"
1312,1556545107.3884,Donita,"Morning Clojurists. I am wondering if it is possible to retrieve the value of a let bound symbol using its string name?
```(let [e :a] (some-fn ""e""))```"
1312,1556545234.3888,Jasmine,that would be an unusual thing to do
1312,1556545258.3891,Donita,lol ya
1312,1556545278.3895,Jasmine,"possible via macro invocation, but why?"
1312,1556545420.3912,Donita,Urg I am afraid its a long story involving a vector of keywords and symbols used with core match and some code I am trying to write tests for.
1312,1556545659.3942,Liliana,"As I used VisualVM, I was able to track down this GC error, it comes from the body.
```
(set-message-callback csnd (fn [attr msg] (print msg)))
```
refering to
```
(defn set-message-callback [^Csound instance callback]
  (let [msg-cb ^MessageCallback
        (reify MessageCallback
          (invoke [this inst
                   attr msg]
            (callback attr msg)))]
    (.setMessageCallback instance msg-cb)))
```
So nothing to do with this line that I commented in the video :slightly_smiling_face:"
1312,1556545661.3944,Donita,"Is suppose what I don't quite understand is where your symbols are defined when you use a let, and if there is a way to enumerate whats available in your context. I see ns-publics but that doesn't include let defined stuff."
1312,1556545755.3953,Liliana,"<@Donita> maybe you want to represent your data differently, maybe (let [e {:value :a :from ""e""}]) or something"
1312,1556545915.3964,Roslyn,"And here is a macro to get local bindings:
```
(defmacro local-context []
  (let [symbols (keys &amp;env)]
    (zipmap (map (fn [sym] `(quote ~sym)) symbols) symbols)))

(let [[a b &amp; rest] [1 2 3 4]]
  (local-context))
=&gt; {vec__97005 [1 2 3 4]
    seq__97006 (3 4)
    first__97007 2
    a 1
    b 2
    rest (3 4)}
```"
1312,1556545954.3972,Donita,oh awesome <@Roslyn>
1312,1556545955.3973,Roslyn,"(keys in a map are symbols, not keywords in this case)"
1312,1556546176.3984,Donita,so &amp;env  is a map that contains the symbols from a let - but available from within a macro; thats perfect for me
1313,1556546385.3993,Lecia,very good tip <@Stephen> thank you
1312,1556546477.3995,Stephen,I used it to 'mock' a notification server (actually the mock worked better than the .not real version :))
1312,1556546677.4006,Donita,"thank you @vlaad, <@Jasmine> and <@Liliana> for taking time to answer my question - your help is much appreciated :wink:"
1312,1556547047.4017,Roslyn,"it contains all available local bindings, not only from `let`, but also from `loop`, `fn` etc.; ```
((fn [a]
   (loop [b 1]
     (let [c 3]
       (local-context)))) 0)
=&gt; {a 0, b 1, c 3}
```"
1314,1556550096.4021,Lecia,":slightly_smiling_face: great, will give it a try. It is a swagger API so should do!"
1315,1556579597.4032,Malik,"are records a popular feature?; I keep seeing ""clojure just uses lists/vectors, maps, and sets and skips using types"" but records seem like something more?; maybe that's a better question for the beginners channel"
1315,1556580958.4058,Gilberto,"They're helpful as wrappers for stateful connections for isolating interfaces. An example would be a DB connection pool, wrapped in a record with a single field, implementing a high-level DB API in the form of a Protocol.

I use maps for regular and domain data, and write specs for those."
1315,1556581000.4064,Meagan,"I think the biggest thing is protocols are quite a bit faster than a map lookup; so for paths that are hot, but still need the kind of dynamicity of maps, records can help optimize those paths without losing semantics of a map; I think I remember someone saying on here that they were first introduced when exploring implementing the Clojure compiler in Clojure"
1315,1556581485.412,Celestine,This is still fairly good advice <https://cemerick.com/2011/07/05/flowchart-for-choosing-the-right-clojure-type-definition-form/>; <@Malik> Bottom line: use maps unless you have a good reason to use records :slightly_smiling_face:
1315,1556581583.4134,Oscar,"I’m a fan of records because of the readability, generated code (e.g., creation fns), and protocol support. I use them all over, including for domain data. I use maps for intermediate or ad-hoc data. But you’re right in noticing that records have been de-emphasized and that’s only continuing"
1315,1556581674.4155,Celestine,"Alex (Miller) has commented (several times, in several forums) that his book, Clojure Applied, used records a lot more heavily than he would do these days -- so, yes, definitely a de-emphasis over time. Part of the issue is that records don't support namespace-qualified keys and therefore don't really play nice with `clojure.spec`.; Another issue that I've run into is that if you accidentally `dissoc` one of the record basis fields, it changes type to a map silently which can cause all sorts of weird, hard-to-debug breakage. So you have some fields you can `dissoc` and some that you can only `assoc` to `nil` instead."
1315,1556581756.4182,Meagan,yeah I use maps for everything unless I need speed
1315,1556581777.4196,Oscar,"ew, didn’t know about the `dissoc`ing of a record field"
1315,1556581783.42,Meagan,"esp. now that you can extend-via-metadata, it's essentially a tradeoff of: namespaced keywords vs. speed"
1315,1556581824.4215,Nieves,"Sometimes I want to have a criteria for splitting some values by type. It can be done by regular maps with special `:type` keys (bad solution), maps with metadata (better, but have some issues, but I choose this way often) and records - I think is it a good solution to add any type/meta labels to data"
1315,1556581887.4229,Celestine,My two uses of records are: where I need something map-like to participate in a protocol or where I need something map-like and speed is really important -- and I don't need namespace-qualified keys :slightly_smiling_face:
1315,1556581913.4231,Oscar,"wait, so `extend-via-metadata` ~does~ requires runtime dispatch I guess?"
1315,1556581925.4233,Meagan,yeah
1315,1556581933.4239,Oscar,gross
1315,1556581940.4242,Meagan,"it has to lookup metadata, then lookup the symbol in the metadata"
1315,1556581992.4253,Celestine,That's why it is opt in -- protocols have to declare that they can be extended to arbitrary objects via metadata.; `datafy`/`nav` in Clojure 1.10 rely heavily on that.
1315,1556582043.427,Meagan,<@Nieves> i try really hard to namespace my keywords and let them quack appropriately :duck: by the time I want to add a `:type` key I start looking for a different way of modeling the information
1315,1556582049.4272,Celestine,"I noticed that the Component library also got an update recently to opt in to extension via metadata, which is really nice."
1315,1556582190.428,Nieves,"<@Meagan> yes, and types/records seems to be a good way of such different way of modeling I think"
1316,1556583234.4301,Jenni,"if I dynamically load a clojure file, possibly reloading slightly changed versions of that file, is there going to be a multi-threading issue?
(specifically, I'm planning on having the file implement a defmulti function... and I will have multiple files with different implementations)"
1316,1556583642.431,Jasmine,Defmulti extension is thread safe
1316,1556583644.4311,Dann,"watch out - defmulti is a no-op when reloading, unless you make an effort to clear out the old def; and you lose all defmethods for the the defmulti if you do that"
1316,1556583691.4327,Jasmine,"Each extension drops the cache too, so better to do loads at the beginning if possible"
1316,1556588734.4329,Jenni,"yeah, not possible :disappointed:"
1317,1556588747.4331,Jenni,what cache?
1317,1556590564.4335,Jasmine,"there is a cache of dispatch value to method impl; when you add a new method extension, that invalidates all of those prior selections so cache is dumped; if you're doing that a lot for some reason, you'll have worse performance for calls"
1316,1556593259.4358,Jenni,"if i have a ""base"" namespace that i never reload &amp; and that defines defmulti, then if i have defmethod in my reloadable namespace, that case is OK?; Or maybe that's what you mean by extension (""defmethod""); And by the way if there's a better way to resolve the function than to use ""defmulti"" let me know. Maybe I simply need to know what namespace is being loaded, and then expect it to have loaded a particularly named function? (a ""main"" so to speak)"
1316,1556593809.4376,Rosaline,"there is resolve; ```
user=&gt; (doc resolve)
-------------------------
clojure.core/resolve
([sym] [env sym])
  same as (ns-resolve *ns* symbol) or (ns-resolve *ns* &amp;env symbol)
nil
user=&gt; (doc ns-resolve)
-------------------------
clojure.core/ns-resolve
([ns sym] [ns env sym])
  Returns the var or Class to which a symbol will be resolved in the
  namespace (unless found in the environment), else nil.  Note that
  if the symbol is fully qualified, the var/Class to which it resolves
  need not be present in the namespace.
nil
user=&gt;
```"
1316,1556594086.4387,Jenni,"OK, that would avoid any defmulti drawback i suppose. thx"
1316,1556595186.4394,Celestine,"<@Jenni> If you're on Clojure 1.10, there's `requiring-resolve` that will also `require` the namespace if needed, in a thread safe manner."
1318,1556595932.4407,Becki,Are you constantly loading different files to redefine how the defmulti dispatches for the same value?
1318,1556606398.4447,Wesley,"Late to the party comments about a conversation several hours ago: Maybe I'm weird, but I like records.  I have nothing against maps, and I used them like crazy, but if I have something that I think of as a fixed data structure, it's clearer if it's a record.  I love that Clojure has such natural support for records.  It's one of the great things about Clojure.  In addition, for certain kinds of interop, Java thinks records are Java classes (because they are), and the Java code you're working on can throw them around and so on, while you get the convenience of working with the records in Clojure.; Thanks <@Celestine> for mentioning <https://cemerick.com/2011/07/05/flowchart-for-choosing-the-right-clojure-type-definition-form> .  I had lost my links to it and was coming up blank in web searches.  My feeling is that this chart is a good heuristic.  Emerick knows a heck of a lot more than I do, but I think that the ins and outs of Clojure data structures for interop are just too difficult to summarize in a simple flowchart.  I have found that I had to ignore some of the advice in that chart."
1316,1556619197.4533,Nisha,"I’m needing an embedded scripting language (with Clojure syntax) for Clojure program, something like when you use lua or scheme to script c++ programs, but I didn’t find many useful libs for this, except <http://github.com/benzap/eden|github.com/benzap/eden>, which however has its own lua-ish syntax.
I guess that’s not how you do things in Clojure?
So how would you do embedded scripting in Clojure?"
1316,1556620053.4542,Sixta,The answer tends to depend on your security constraints. Who is providing this scripting data?
1316,1556621311.4548,Nisha,Myself.; So no security constraints.
1319,1556621937.4558,Sixta,`eval ` is probably okay for you then? :)
1320,1556625948.4564,Roberto,is there a way to know if i'm running in a repl or in a production environment?
1320,1556626087.457,Roslyn,"probably a lot of ways depending on how your dev env differs from prod env. maybe have a look at `(System/getProperty ""user.dir"")`?"
1316,1556627075.4579,Nisha,<@Sixta> And what should I use to have at least some isolation?
1316,1556627441.458,Sixta,Clojail / security manager might be good
1321,1556638109.4587,Lana,"I just use `eval` with some macros that set up a nice context for the code, and make certain values available as locals if they are mentioned in the code. I use RSyntaxtTextArea to give users a syntax-coloring editor (Swing) widget for the code, and offer HTML documentation of the semantics and values available for the type of code they are editing. It has worked out well, people are using it in big shows. <https://github.com/Deep-Symmetry/beat-link-trigger#beat-link-trigger>; Here’s the section of the user guide that shows the expression editor I am talking about: <https://deepsymmetry.org/beatlink/trigger/guide/beat-link-trigger/Expressions.html#editing-expressions>; The ability to do that was what made the whole project make sense. It’s the core super power that a Lisp gives me. :smile:"
1322,1556664120.4623,Lesha,"Why does Clojure give back a double when you combine a BigDecimal and a double, like `(+ 2M 3.0)` is not `5M`, but `5.0`?"
1322,1556664165.4628,Dann,"doubles are the cheaper thing to store, and no result could be more precise than a double"
1322,1556664353.4631,Lesha,"<@Dann>Not sure I follow what you mean by ""no result could be more precise than a double"". See example below."
1322,1556664382.4637,Dann,"2.0 isn't precise, if you mean something more precise than a double, use a more precise type"
1322,1556664402.4643,Lesha,Right. I understand.
1322,1556664405.4645,Dann,"oh, you mean, which one wins...; I guess that's down to jvm method dispatch, and the intutive thing is for the method to be called on the first arg; I think this <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Numbers.java#L661> vs. this <https://github.com/clojure/clojure/blob/master/src/jvm/clojure/lang/Numbers.java#L983> is the question here"
1322,1556664698.4664,Nella,"I think it's lines 645 and 952 that are most relevant; when a bigdecimal and a double is used together, doubleops are used for the math; presumably because math can only be as precise as the least precise number you're using"
1322,1556664830.4681,Dann,"~<@Nella> but if the first arg is a bigdecimal, the bigdecimal method is used~"
1322,1556664931.4709,Nella,"```user=&gt; (+ 2M 3.0)
5.0
user=&gt; (+ 2.0 3M)
5.0```"
1322,1556664951.4714,Rosaline,"like a million years ago I was writing a core.logic program that took akind of database of facts about numeric types, and operations on those types, and would generate a bunch of static methods, with the idea that you could use it to generate a replacement for clojure.lang.Numbers; and whoe floating point (both single and double precision) was represented, to get something that matched clojure.lang.Numbers is as a contagion"
1322,1556665021.4731,Dann,"now I see that I misread the example, thanks"
1322,1556665032.4735,Rosaline,if you have an operation with inexact floating point numbers you get inexact floating point numbers back; <https://github.com/hiredman/Archimedes/blob/master/src/Archimedes/bar.clj#L37-L40>
1322,1556665120.474,Becki,great name for the project; <@Rosaline> that is a really cool program 
1323,1556680394.4761,Antione,"<@Rosaline> should be knighted, IMHO."
1324,1556684323.4763,Georgina,It worked perfectly thanks again :smiley:
1325,1556694769.4822,Velva,"Hi guys I hope you like to give minor style suggestions. What is clojure idiomatic to denote a slightly updated value? In Haskell, you usually use apostroph eg
```
let foo = [1, 2, 3]
     foo' = 0 : foo
```
but in clojure `'` is used to quote forms. What is a more idiomatic name for `updated-foo` here?
```
(let [foo '(1 2 3)
       updated-foo (conj foo 0)]
  updated-foo)
```"
1325,1556694877.4832,Tressa,first that comes to mind is \* (as in let - let\*) but people use that for macro-wrapped functions so might be confusing
1325,1556695194.4847,Velva,"You mean `let*`? Yes I've seen it some places but people do indeed find it confusing, also as `*foo*` is the convention for dynamic variables"
1325,1556695400.4854,Tressa,"you can use `'` i guess?
```
(let [foo 12
      foo' (+ foo 1)]
  foo')
=&gt; 13
```"
1325,1556695451.4859,Velva,Thats true
1326,1556727567.4922,Otelia,for cases like this i think it is common/idiomatic to use shadowing -- just reuse foo instead of foo'
1327,1556731947.4928,Dann,"suffixing with `'` is idiomatic; I've seen both, it's a thing various house styles disagree about in my experience"
1328,1556734841.4958,Danyell,"If I have a React element that sets up a `go` block, with a `loop` that listens on a channel, in my `will-mount` life cycle method; when that component is unmounted... does the go block still live in memory listening on that channel?; It seems that, that is the case... But I am not so sure.."
1327,1556735019.4969,Dann,"the go block compiles to a field on the channel itself, if the channel goes out of scope the go block is freed too; if you hold onto the channel, whatever go block is parking on it is probably kept around; it sounds weird but it works out, if the channel is not visible in any live code, the go block can never wake up again, so it makes sense that it can be freed"
1327,1556735129.4983,Danyell,The channel never goes out of scope; so that explains it
1327,1556735165.4992,Dann,"you can let the go block fall through, or let it park on something that will go out of scope..."
1327,1556735188.4995,Danyell,what do you mean by letting it fall through?
1327,1556735227.4999,Dann,exiting from the end of the block without parking or looping
1327,1556735383.0007,Danyell,Is there way I can have it stop listening or drop the block ?
1327,1556735436.0013,Dann,there's idioms for this - eg. close the channel and write the go block such that if it gets a nil (channel closed) it exits; but there's no clean way to force the block to exit if it wasn't written to do so
1327,1556735624.0027,Danyell,Is it possible to open up the channel again? Or do I have to make another call to chan?
1327,1556735677.0029,Dann,"channels can only be closed once; if you want to keep the channel, but tell a consumer to close, you could check for a special token like `::close`"
1327,1556735744.0046,Danyell,that sounds like its exactly what I need; Thanks <@Dann> :thumbsup:
1329,1556755159.0067,Meagan,anyone know what dep to include if I want to use clojure.jdbc with mysql?
1329,1556755207.0072,Celestine,<@Meagan> do you mean `clojure.java.jdbc`?
1329,1556755262.0085,Meagan,"well, I actually mean your `next.jdbc` lib :slightly_smiling_face:"
1329,1556755275.0088,Roselia,<@Dann> can you explain semantics of ::keyword
1329,1556755306.0097,Meagan,"here's what I'm trying to do:
```
$ clojure -A:rebl:rebel -Sdeps '{mysql/mysql-connector-java {:mvn/version ""5.1.6""}}'
[Rebel readline] Type :repl/help for online help info
user=&gt; (require '[next.jdbc :as jdbc])
nil
user=&gt; (def db {:dbtype ""mysql"" :dbname ""content_service""})
#'user/db
user=&gt; (def ds (jdbc/get-datasource db))
#'user/ds
user=&gt; (jdbc/execute! ds ""show tables"")
Execution error (SQLException) at java.sql.DriverManager/getConnection (DriverManager.java:702).
No suitable driver found for jdbc:<mysql://127.0.0.1:3306/content_service>
```"
1329,1556755306.0098,Jasmine,":: means ""keyword, autoresolved in the current namespace context"""
1329,1556755309.0099,Dann,it expands to a namespaced keyword in the current namespace
1329,1556755318.0102,Roselia,thanks; ty
1329,1556755403.0108,Celestine,"Hmm, I would have expected that to work, but that's a pretty old MySQL driver.; It's been tested against `mysql/mysql-connector-java {:mvn/version ""5.1.41""}`"
1329,1556755449.0112,Meagan,"oh, my `-Sdeps` isn't right"
1329,1556755473.0114,Celestine,"Yeah, just noticed; Missing `:deps`"
1329,1556755777.0118,Meagan,works great :slightly_smiling_face: thanks!
1329,1556756062.012,Celestine,Best place to ask questions about `next.jdbc` -- or `clojure.java.jdbc` or databases in general -- is <#C1Q164V29|sql>
1330,1556762486.0133,Fernande,"<@Roselia> fwiw, i have found the following page quite handy: <https://clojure.org/guides/weird_characters#autoresolved_keys>"
1331,1556772762.015,Jennie,"How to include a git repo in deps.edn which have java source. I am trying like this ```{:deps
 {org.clojure/data.csv {:git/url ""<https://github.com/clojure/data.csv.git>""
                        :sha ""e5beccad0bafdb8e78f19cba481d4ecef5fabf36""}}}``` but I am getting `ClassNotFoundException` for Java files. Any pointers or help is appreciated."
1331,1556772857.016,Celestine,"<@Jennie> Java has to be compiled first. You can't just pull in source files, unlike Clojure."
1331,1556772903.0167,Jennie,So it means I can't include Java in the same package/repo?
1331,1556772922.0173,Celestine,<@Jennie> That repo does not have Java code in it so I'm not sure what you're asking/trying to do here.
1331,1556772960.0179,Jennie,"Nvm, the above is just an example. Here is the repo <https://github.com/gdrte/suricatta>; the error is `Syntax error (ClassNotFoundException) compiling reify* at (impl.clj:106:3). suricatta.impl.IParam`; ```  gdrte/suricatta {:git/url ""<https://github.com/gdrte/suricatta.git>""
     :sha ""9cc71345e79b72e3504c1c94a9ba76c2925be74f""}
```"
1331,1556773067.0193,Celestine,"Right, you can't use Java source files with `clj`/`deps.edn`. They need to be compiled (via `javac`) first."
1331,1556773088.0197,Jennie,"So, I can't do it one go, hmmmm."
1331,1556773115.0202,Celestine,"You would need to compile, build, and publish your Java code as a JAR somewhere, and depend on that."
1331,1556773205.0216,Jennie,"aah... actually I forked that project, and upgraded clojure and some other libs. I didn't tried to send a PR to original author. I thought clojure git deps will work for me without messing the artifactory id.; Thanks for the reply Sir."
1331,1556773392.023,Celestine,"For some situations, you can actually hack around this by shelling out and running a `javac ...` command line."
1331,1556773428.0234,Jennie,"yeah, I will build it locally and include the jar"
1331,1556773702.0238,Celestine,You can add a JAR to the classpath as a `:local/root` dep.
1331,1556773750.0242,Jennie,I just did that. It worked. Thanks again.
1331,1556773817.0249,Celestine,It's really a good incentive to try to do everything in Clojure :slightly_smiling_face:
1332,1556789674.0275,Zona,"every week I get an email from the Rust team called ""This Week in Rust"", it's an update on news, jobs, calls for participation in open source projects, events and so on

is there an equivalent for Clojure?"
1333,1556791055.0296,Isreal,Cherished Clojure weeklies are: Daniel Compton’s The REPL newsletter <https://www.therepl.net/Newsletters/> and Eric Normand’s <http://PurelyFunctional.tv|PurelyFunctional.tv> Newsletter <https://purelyfunctional.tv/newsletter/> ; I also really like Alex Miller’s weekly update blog: <http://insideclojure.org/>
1334,1556797716.0342,Cherise,"What’s up with this?

```
  (= 40.4 (float 40.4)) ;; =&gt; false
  (= 47.5 (float 47.5)) ;; =&gt; true
```"
1334,1556797996.0358,Alyce,"For me, it's the otherway round. Comparing precision on floats on the JVM, using the equals method, I suspect is the same issue when comparing floats on Java on the JVM. You're not sure on the precision that the JVM uses per call.; There's lots of results on google on comparing floats (on Java, but equality valid to Clojure); <https://dev.clojure.org/jira/browse/CLJ-1036>; ```
Rich Hickey added a comment - 05/Sep/13 8:27 AM

It is out of scope for Clojure to fix this for Java types Float/Double/BigInteger
```"
1335,1556809509.0395,Danna,"I have a `com.cognitect.aws/glacier` question; I want to run `list-vaults` but when I run
```(aws/invoke dev/gl {:op :ListVaults
                    :request {:accountId ""099465141348""
                              :apiVersion ""2012-06-01""
                              }})```
I get
```=&gt;
{:code ""MissingParameterValueException"",
 :message ""Required parameter missing: API version"",
 :type ""Client"",
 :cognitect.anomalies/category :cognitect.anomalies/incorrect}```; what is the secret sauce for getting the `apiVersion` accepted?; (I tried putting into ```(aws/client {:api :com.cognitect.aws/glacier
                     :version ""2012-06-01""
                     :region :eu-west-1
...)``` but that didn't help either"
1335,1556809991.0412,Marlyn,<@Danna> turn on request validation
1335,1556810149.0425,Danna,just with `(aws/validate-requests gl true)` you mean?; same error message ..?
1335,1556810268.0436,Marlyn,"Also, `(aws/doc client :ListVaults)`; Make sure the keywords you're providing are correct; Usually they are capitalized"
1335,1556810347.0455,Danna,yeah that doc does not talk about API versions at all
1335,1556810393.0462,Marlyn,Have you tried omitting the arguments; Just empty map
1335,1556810423.0476,Danna,yes so I get a helpful error message if I leave out the required `:accountId`
1335,1556810427.0478,Marlyn,I've never seen an API that makes you send in the version; Ok
1335,1556810467.0486,Danna,I think there might be a regression for the AWS glacier API floating around; but I'm not quite sure; these are all JSON apis at the AWS end of things aren't they; there's a ```x-amz-glacier-version: 2012-06-01``` header in some of the docs; <https://docs.aws.amazon.com/amazonglacier/latest/dev/api-error-responses.html>
1336,1556812479.0528,Jeannette,does turning tuples into a map destroy information about order?
1336,1556812791.0536,Yajaira,"<@Jeannette> Yes, maps do not guarantee order. If you need a sorted map I suggest looking at: <http://clojuredocs.org/clojure.core/sorted-map>; And <http://clojuredocs.org/clojure.core/sorted-map-by>"
1337,1556815862.0546,Emmy,"Is this a bug?
```user=&gt; :0
:0
user=&gt; ::0
:user/0
user=&gt; (ns foo)
nil
foo=&gt; (ns user)
nil
user=&gt; (require '[foo])
nil
user=&gt; ::foo/0
Syntax error reading source at (REPL:2:0).
Invalid token: ::foo/0
```"
1338,1556815930.0558,Dann,":0 isn't meant to work, but happens to"
1337,1556815937.056,Rosaline,"that is actually a very complicated question connected to many mailing list posts, irc and slack discussions"
1337,1556815946.0562,Willia,`:foo/0` instead of `::foo/0` ? (already namespaced)
1337,1556815971.0572,Rosaline,"at one point `:0` was made not to work, and then that change was reverted"
1337,1556815983.0579,Emmy,because leading numbers are invalid identifiers?
1337,1556815994.0583,Rosaline,which you might interpret as positive intent that `:0` is intended to work
1337,1556816072.0591,Emmy,it's more that the autoresolving is the only one that doesn't work
1337,1556816074.0593,Rosaline,but my advice would be to behave as if `:0` doesn't work
1337,1556816131.0602,Dann,"<@Emmy> :0 was never designed to work, a version of clojure existed where it worked anyway, it was kept that way. ::foo/0 never worked because the issue was understood before ::foo/bar existed"
1337,1556816319.0608,Emmy,ok cool thanks
1339,1556834346.0622,Della,"Could someone remind me, I think I remember seeing a fn named something like `requiring-resolve`. Where would I find this :thinking_face:"
1339,1556834513.0624,Dann,clojure versions 1.10+
1339,1556834640.0631,Della,"Okay, I’m on 1.10.0-alpha7. Is it in a specific ns? Intellisense is failing me…"
1339,1556834652.0634,Dann,"why use a 1.10 alpha?; it's in clojure.core, I'm not sure if it was present in the 1.10 alphas or not, but it is present in the 1.10 release"
1339,1556834704.0644,Della,I see. Just haven’t gotten around to changing that version string quite yet. Thank you!
1339,1556834735.0647,Dann,"~oh, I might be wrong, it might be a 1.11 thing...~ - nope, definitely here in 1.10 ```$ clj
Clojure 1.10.0
(ins)user=&gt; (requiring-resolve 'clojure.set/union)
#'clojure.set/union
```"
1339,1556834777.0651,Della,"Ah okay, that would at least explain why I can’t find it any of the usual channels; Yep, there it is. Thank you."
1340,1556835816.0665,Jasmine,It was added till very late in the release cycle 
1341,1556840862.0668,Celestine,I think it was in one of the final Beta versions?
1340,1556841860.0673,Roselia,lets vote what to read next joy of clojure 2nd or programming clojure 3rd ed?
1340,1556841966.0678,Celestine,"I voted for JoC, assuming you haven't read earlier editions of either."
1340,1556841985.068,Roselia,"right, i didn't"
1340,1556842002.0682,Celestine,JoC 1ed was my first Clojure book (but I had Lisp/FP background). Clojure in Action 1ed was my second Clojure book.
1340,1556842050.0684,Roselia,"i have java(2 years) and common lisp(3 months + PCL book), 4 months of clojure background"
1340,1556842069.0687,Celestine,"Back then, there weren't too many options :slightly_smiling_face: I loved Clojure Programming when that came out. Since then I've bought almost everything except Living Clojure and a bunch of the somewhat random Packt Publishing Clojure books (variable quality!).; You'll love JoC then!; And then maybe Clojure Applied? Or Programming Clojure 3ed."
1340,1556842120.0694,Roselia,or both :hugging_face:
1340,1556842174.0696,Celestine,"Getting Clojure is an interesting read to.; Clojure Cookbook too, although it's getting a bit long in the tooth (maybe there's a 2ed planned/in the works?)."
1340,1556842301.0701,Roselia,no idea
1340,1556842305.0703,Celestine,"Oh, apparently I _do_ have Living Clojure. It just isn't inside a folder like all my other O'Reilly books..."
1340,1556842317.0705,Roselia,you sort by publisher?; i prefer by language \ field
1340,1556842399.0709,Celestine,"Several publisher auto-sync to Dropbox, so those are by publisher. That way I can read the PDFs on any device.; So I have 82 tech books by Pragmatic, O'Reilly, and Manning. And then maybe another 50 or so ebooks from other publishers.; (My OneDrive a/c has 127 PDFs but that includes technical papers, book previews, reference cards, and a variety of other non-tech-book things so it's hard to be sure)"
1340,1556842663.0715,Roselia,"here we go
<https://gyazo.com/c9649268a0ca6ae308f692ce57935160.png>; thats so cool, i dont have that much money yet :smiley: nor time"
1340,1556842731.0723,Celestine,"Mostly time. I've been accruing tech books for decades.; Several publishers let you ""register"" your physical copy of a paper book and then you can d/l the ebook for it. But I still have a pretty massive paper library from early decades. Including classics like ""A Microprogrammed Implementation of APL"" and ""Programming the 6502"" :slightly_smiling_face:"
1340,1556842838.0727,Roselia,thats really smart move; <@Celestine> how fast do you read technical books? Like about something new.
1340,1556842964.0732,Celestine,"I'm a speed reader so, very fast..."
1340,1556842977.0734,Roselia,"I mean it takes me few days per chapter including practice, exaples and side sources like articles on the topic."
1340,1556843063.0738,Celestine,"If I'm practicing alongside, that slows me down a bit. I think I got through Seven Languages in Seven Weeks, including all the exercises in less than 30 hours total. Maybe even close to half that? Can't remember."
1340,1556843136.074,Roselia,"So yeah, i'm about 5 times slower than that."
1340,1556843310.0744,Celestine,"On average, I read about a page a minute. Seven Languages is just over 300 pages. Yeah, I must have gotten through that in a lot less than 30 hours, even with exercises :neutral_face: It's kind of a weird ""skill"". I was tested in kindergarten and they figured out I have some sort of semi-eidetic memory which means I don't read linearly -- I sort of ""snapshot"" blocks of text etc and then my brain somehow decodes them asynchronously."
1340,1556843458.0746,Roselia,"or it's a magic and you are a wizard; alright thank you Sean, time to enjoy the joy of clojure; cya"
1342,1556861548.0817,Julianne,"Hi all, I am hitting a weird issue with core.spec when trying to add extra assertions to a `s/keys` spec using `s/and`.

I have been able to make a minimal example of the problem.

```
(s/def ::bar (s/or :string string?
                   :int int?))
(s/def ::foo (s/and (s/keys :req-un [::bar])
                    (fn [x]
                      (prn x)
                      true)))

(s/explain ::foo {:bar ""bar""})
;;=&gt; {:bar [:string ""bar""]}
;;=&gt; Success!

(s/explain ::foo {:bar 1})
;;=&gt; {:bar [:int 1]}
;;=&gt; Success!
```

You can see that the predicate after the `s/keys` spec now has the `:bar` value transformed to a pair by the `::bar` `s/or` spec. This is not what I expected."
1340,1556862499.0845,Celestine,<@Julianne> That's how `s/or` works.
1342,1556862536.0854,Celestine,It conforms the value into a data structure that shows _how_ it matched the spec.
1342,1556862693.0882,Julianne,"thanks <@Celestine> I sort of understood that, I didn’t realise it got conformed and passed the conformed value through each predicate in the `s/and`."
1342,1556862694.0883,Celestine,"```user=&gt; (require '[clojure.spec.alpha :as s])
nil
user=&gt; (s/def ::bar (s/or :string string? :int int?))
:user/bar
user=&gt; (s/conform ::bar 42)
[:int 42]
user=&gt; (s/conform ::bar ""42"")
[:string ""42""]
user=&gt;                  ```; Yes, `s/and` flows values through so if something conforms a value, that is what's passed on to the next predicate."
1342,1556862759.0897,Julianne,"ahhh, ok thanks I didn’t understand that part. Thanks!"
1343,1556872320.0915,Eufemia,"hi, i can't see how read-string can possibly execute code without using the eval. (read-string ""(+ 1 1)"") evals to a list (+ 1 1). ""(+ 1 1)"" is the user input.; (read-string ""#=(+ 2 3)"") =&gt; 5; could someone explain how this gets evaluated?"
1343,1556873092.0936,Elayne,"<@Eufemia> I’m not sure I fully understand the question, but “#=” is the read-eval literal and calls `eval` here: <https://github.com/clojure/tools.reader/blob/master/src/main/clojure/clojure/tools/reader.clj#L588> more notes, <https://github.com/clojure/tools.reader/blob/master/src/main/clojure/clojure/tools/reader.clj#L866>"
1343,1556873406.0963,Eufemia,<@Elayne> thanks. read-string is called at runtime parse the this string and return a reader macro expresion. But arent macros expanded at compile time? I dont get how that parsed expression gets run
1343,1556873463.0969,Elayne,"<@Eufemia> reader macros aren’t the same as macros, they are handled at read-time"
1343,1556873631.098,Eufemia,how many phases does the 'runtime' compile executable have then? read-time + eval-time?
1343,1556873804.0992,Elayne,"well, if you have `eval` then you have all the phases, no?; maybe some of the info on this page will help  <https://stackoverflow.com/questions/5669933/is-clojure-compiled-or-interpreted#5670203>; &gt; the dynamic and interactive nature of Clojure that means you can invoke the compiler at run-time if you want to. This is all part of the Lisp “code is data” tradition."
1343,1556874432.1008,Eufemia,thank you <@Elayne> i think i figured it out my doubt
1343,1556874878.1015,Sonny,ls
1343,1556874953.1017,Roberto,is there a way to use a leiningen profile in a macro?
1344,1556876421.1024,Eufemia,"is there some doall + map macro? Similar to run!, but the return the collection?"
1344,1556876708.1029,Fatima,What are you trying to do?
1344,1556876767.1034,Eufemia,"`(doall (map #(..) col))`; if i didn't need the result, i could do `(run! #(...) col))` which is nicer; im looking if there is something similar"
1344,1556876968.1062,Fatima,One way is to use `mapv` instead of map. It’s eager. Another is to use transducer version `(into [] (map #(...)) coll)`; Third would be to use `reduce` instead of `map`.
1344,1556877333.1078,Zona,"last time someone asked a similar question, I think the most Clojure-y answer was to use a transducer"
1344,1556877596.1095,Fatima,"Heh, tried this out of curiosity and it works. You can use normal function composition.
```
user&gt; (def doall-map (comp doall map))
#'user/doall-map
user&gt; (doall-map #(or (println %) %) [1 2 3])
1
2
3
(1 2 3)
```; This might have some serious caveats though, I’m not sure. Personally I like the transducer version most.; Depending on the situation of course."
1345,1556877913.1122,Eufemia,cool; :slightly_smiling_face:
1346,1556925549.1176,Klara,"Hello, I’m used to the `cond` from Scheme, does the `cond` in Clojure support the `=&gt;` syntax?"
1346,1556925719.1181,Celestine,<@Klara> I'm not familiar enough with Scheme to know what that syntax means -- could you explain?
1346,1556925741.1183,Klara,"like, in Scheme:
`(cond ((re-match ...) =&gt; (lambda (match) ...)))`
`if-let` feels a bit like it, but it only allow one test"
1346,1556925775.1189,Celestine,"Ah, take a look at `condp` and see if that's closer to what you're looking for..."
1346,1556925776.119,Klara,"I found <https://github.com/Engelberg/better-cond>, but I don’t wanna take on a library; yeah, i was looking at `condp`, but it doesn’t seem to capture the result from the test"
1346,1556925920.1197,Celestine,"are you sure? `its result-fn, which must be a unary function, is called with the result of the predicate as its argument`"
1346,1556925950.12,Klara,oh hmm; let me try; i want to access the result in the consequent part
1346,1556926050.121,Celestine,"```(condp = 4
  2 :&gt;&gt; #(println '2 %)
  4 :&gt;&gt; #(println '4 %))``` prints `4 true`"
1346,1556926057.1213,Klara,oh oh
1346,1556926188.1224,Celestine,"BTW, it's better not to post the same question in multiple channels -- so folks in one channel don't have to spend time answering something that was already answered elsewhere.; <@Klara> Did `condp` solve your needs?"
1346,1556926290.1232,Klara,"i’m gonna give it a try, thanks!"
1347,1556983306.125,Klara,"I just wanna say, I’m really happy that `clojure.pprint/cl-format` exists, it’s a cool piece of work!"
1348,1556986452.1255,Karren,"Cool, didn't know that such a thing exists.
But be aware of <https://dev.clojure.org/jira/browse/CLJ-1950>"
1349,1556991530.1268,Eura,"hello,i am reading a spark book,and i am trying it with Clojure,everything is simple so far,i also saw the sparkling library,the question i have is this; i can wrap select of spark to make the use more simple like this; (defn select [dataset &amp; col-names]
  (.select ^Dataset dataset (into-array (map (fn [c] (if (string? c)
                                                       (functions/col c)
                                                       c))
                                             col-names)))); but when i use it,catalyst knows what my select function is? or i loss the optimizations?; in general i was wondering if using spark from Clojure is simple or problems will occur ,but so far it seems simple to use spark from Clojure; i found that the plans are exactly the same,so spark i guess has the way to find what my function will do to the dataframe thanks"
1350,1556996476.1318,Herman,"Yeah it's just a declarative specification either way, regardless of what intermediate functions you call to get there. Catalyst is pretty smart."
1351,1557001127.1329,Felix,"(not trolling, geniune question) Is there a useable GADT (like subset of ocaml, subset of rust) type system for use in Clojure yet, or is Racket the closest to ""scheme with gadt"" ?"
1351,1557001294.1336,Celestine,<@Felix> I'm not sure what GADT would even look like in Clojure.
1351,1557001320.1339,Felix,"I'd settle for just sum + union types; to be able to declare things like

(struct Cat (:name String) (:age int) (:lives_left int))
(struct Dog (:name String) (:age int) (:can-defend bool))
(enum Animal [Cat, Dog]); mainly I want to be able to look at a var and know valid fields on the var (rather than explore it in a REPL)"
1351,1557001407.1361,Celestine,Have you looked at `clojure.spec`?
1351,1557001420.1365,Felix,"Yes, spec is not what I want."
1351,1557001453.1374,Celestine,Clojure is a dynamically typed language. What you're asking for doesn't really fit in.
1351,1557001469.1386,Madeleine,Doesn't Gadt not make any sense in a dynamically typed environment?
1351,1557001474.1389,Felix,"Specs provides guarantee of ""these invariants seem to hold on these randomized tests"", whereas I'm looking for ""the compiler will not allow these invaraints to be broken"""
1351,1557001475.139,Celestine,"`clojure.spec`, multi-methods. Those are Clojure's tools for solving that sort of problem.; Or records and protocols."
1351,1557001521.1404,Felix,there was some work <https://typedclojure.org/>
1351,1557001532.1413,Celestine,"<@Felix> Have you looked at ""Typed Clojure"" -- yeah, was just about to suggest that..."
1351,1557001538.1416,Madeleine,Are you saying you want a DSL within Clojure which has static type guarantees of the kind that also supports GADT?
1351,1557001597.1428,Felix,<@Madeleine>: DSL or host language -- I'm okay with either. I'm looking for a practical scheme that supports sum + union types.; <@Celestine>: is typed.clojure used in practice? I thought it was still experimental
1351,1557001721.1451,Celestine,<@Felix> Typed Clojure is an ongoing experiment that Ambrose has been working on for years. We looked at using it at work years ago but it was difficult to use -- and Ambrose has done a lot of work on making it more gradual and easier to use.
1351,1557001750.1461,Madeleine,This is the closest I've seen: <https://github.com/lambdaisland/uniontypes>; Not quite GADTs though
1351,1557001791.1488,Celestine,"We tried Schema and Typed Clojure several times, and went back and forth between them, and gave up on both in the end. We _are_ heavy users of `clojure.spec` at work tho'..."
1351,1557001806.1497,Marlyn,"I don't care about compile time vs runtime errors. The salient part is I catch the errors ""before it leaves my laptop"".  spec + test.check give me that"
1351,1557001827.1506,Celestine,Indeed.
1351,1557001846.1515,Madeleine,"Otherwise, there's very little apart from core.typed for static type checking in Clojure. That said, all types are union and sum of everything all the time. So you can still model things that way easily. You just don't get compiler checks."
1351,1557002276.1538,Marlyn,It's like going to an Italian restaurant and asking for gluten free...  Gotta embrace the fact that Clojure is a dynamic language
1352,1557002299.1547,Celestine,"Hey, in California, you can get gluten free in Italian restaurants! :slightly_smiling_face:"
1351,1557002315.1553,Madeleine,"If you want real typed lisp, I'd look at either carp.lang or typed racket or shen"
1351,1557002322.1556,Marlyn,Hahaha I always forget about Cali <@Celestine> 
1351,1557003112.156,Felix,"<@Marlyn> I think it's more like walking into a Mac store and asking ""do you have windows emu support yet"" ?"
1353,1557005879.1576,Madeleine,"I think the thing is, Lisp don't work very well with strong static types. Because fundamentally, they're about interactive inside out development.; For example, appart for carp.lang, I don't think I ever saw a static typed lisp, whose static typing wasn't gradual or optional."
1353,1557005972.1589,Mariela,"Keep an eye on <https://github.com/arohner/spectrum>

Meanwhile you can use sth like <https://github.com/jeaye/orchestra> . If you spec _code_ (as opposed to data*), useful errors will pop up far more frequently than with generative testing alone

Basically it's like Clojure's :pre and :post

*non exclusive approaches"
1353,1557006772.1598,Becki,i'm going through Programming Languages Application and Interpretation and its in a typed lisp. They exist; there's also shen i think?
1353,1557007950.1604,Sixta,Racket was a cited example above
1353,1557008073.161,Madeleine,"Racket and Shen are both optionally/gradually typed only.; The thing is, the static types restrict what you can do. And Lisps want to do things that don't bode well with static types. Most of core.typed was issues with trying to figure out ways to type existing core functions. Similarly, the syntax doesn't work very well with types either. Where do you add the type defs in the sexpr?"
1353,1557008427.1657,Celestine,"Yeah, when we used `core.typed`, one of the biggest problems I had was getting it to accept code that was idiomatic but hard to infer types from -- so I found myself refactoring to much less idiomatic structure in order to successfully type check the code."
1353,1557008814.168,Madeleine,"There's very simple examples (and maybe someone with better type theoretic knowledge can correct me), but for example, I have a function that takes a keyword followed by one or more values until another keyword is reached which can also be followed by one or more values. What type is that?; `[:add 10 23 45 66 83 :remove 23 98 34]`; For example; You could say it's a vector of either keywords or ints"
1353,1557008916.1706,Celestine,`clojure.spec` can specify that. I suspect dependent types (like in Coq etc) can as well?
1353,1557008958.1717,Madeleine,"But its not really what it is. So that would be pretty loose, and almost worthless for correctness. Since bugs would be things like using the wrong keyword, or having the order of the keywords wrong.; <@Celestine> Ya exactly, that's where I was getting at with my example. Spec is much better. Because I can spec those highest level constraints, like that :add should come before :remove for example.; Maybe dependent typed could as well. But it's my in impression they still require too much effort from the programmer for widespread adoption. Not a lot of people are willing to take the productivity hit from using them"
1353,1557009805.1769,Celestine,"Yeah. Types get you some of the way but no matter how much effort you put in, they can't specify as much as `clojure.spec` in some areas -- and the same is true in the other direction. Types give you an upfront safety net that certain incorrect code won't compile, which can save time (but of course, certain _correct_ code won't compile either)."
1353,1557010333.1806,Madeleine,"For sure. I just feel overall, the things people like about Lisps are the things that are hard to impossible to type, starting with heterogeneous lists of variable length. You can cons anything on them, and that's amazing. If you constrain what you can cons on it... well, such a Lisp is slowly becoming less of a Lisp and more of just Haskell; So you reach a point where there is no point in having strong static typed Lisp. And you realize if that's what you want, just use Haskell or OCaml or Java even"
1353,1557010668.1839,Celestine,"Aye, I've used everything from assembly up to Haskell and I'm one of those devs who just gets frustrated with type systems. I think programmers are inherently either ""statically typed people"" or ""dynamically typed people""."
1354,1557018255.1936,Oscar,"Type systems are becoming more expressive:
<https://youtu.be/4i7KrG1Afbk>

Dependent types allow for support of contract-like constraints.

The use case of sub-selection for `spec` schemas can already be handled by structural types and row polymorphism, as in Typescript and Elm.

If you’re comfortable with using `spec` for that particular use case, then you’d be comfortable using static types in Clojure."
1353,1557024591.1949,Alease,"When doing a defrecord or type while implemening a protocol, does it matter if your implemented function use the ""this"" binding or the bound variables in the protocol definition?"
1355,1557024748.196,Alease,"I often see them omitted as `(some-protocol-fn [_ some-other-args] ..)`; I guess using this would give you the whole entity, for assoc or update."
1355,1557028257.1978,Malik,"does anyone here use some kind of coroutine library with clojure? I'm used to using M:N threading with things like Elixir and Go and the idea of possibly starving out OS threads by blocking actions concerns me; it might be a remote concern, but still a concern"
1355,1557028374.1985,Meagan,core.async implements CSP with a thread pool; but you can still block the thread pool by doing blocking IO on a channel
1356,1557032616.1991,Madeleine,"Can you talk about this more? What you mean by sub-selection? What is the use case for it, can you give an example?"
1356,1557041071.2001,Sixta,Core async would work without a thread pool. It could be tuned to a single thread.
1357,1557048537.2023,Enola,"Cross-posting the underlying question from <#C0744GXCJ|cursive>.
I have a code that calls function with some not null arguments, but one of the arguments becomes null in the function's body.
Here's a piece of code of interest, it's from `cognitect.transit`:
```(defn write
  ""Writes a value to a transit writer.""
  [^Writer writer o]
  (.write ^com.cognitect.transit.Writer (.w writer) o))```
During debugging, when the current line is the very first one, `writer` is not null. But as soon as I step into , it becomes null for no apparent reason.

How can such thing possibly happen?; Nevermind that - I got confused by the inconsistently highlighted stacktrace, and the reported null value is not null in reality."
1358,1557054461.2042,Nisha,"Hi! Is there a readline lib that I can use to build completion and history function on terminal input?
Something similar to <https://github.com/chzyer/readline>"
1359,1557057151.2048,Sixta,Jline probably
1358,1557058967.2054,Nisha,"<@Sixta> No Clj lib available ?
I found `bhauman/rebel-readline`, but couldn’t find a simple example of how to use it for my use case. It’s mostly documented for REPL use."
1358,1557058991.2058,Sixta,<@Nisha> none I've encountered
1358,1557072570.2078,Madeleine,<@Nisha> You shouldn't hesitate to use Java libs from Clojure. It's part of the power that Clojure brings to make that easy and possible. Rebel-readline uses JLine itself.
1360,1557082780.2083,Meagan,how are people using `tap&gt;` in practice?
1360,1557082901.2088,Celestine,"<@Meagan> For debugging, instead of ""println"" debugging.; When I'm debugging, I add `tap&gt;` calls (instead of `prn`/`println`), and eval the top-level block (to redef the function I just changed), and then run whatever scenario I need and see what crops up in REBL."
1360,1557083003.2116,Meagan,I know you use rebl right. Wondering if other people do the same but just wire it to prn ; Slow typer on my iPad :stuck_out_tongue_winking_eye:
1360,1557083060.213,Celestine,"Before using REBL, I used to connect an additional Socket REPL and telnet into it and add a tap watcher that `prn`'s stuff.; That way tap output goes to a separate terminal from my regular stdout."
1360,1557083091.214,Meagan,Do you leave in tap after you commit?
1360,1557083110.2143,Celestine,"Not generally.; While it's safe to leave it in, I don't see much point in having `tap&gt;` calls in production code.; If you need tap-debugging in production, you can always connect to the process, eval in new function definitions with `tap&gt;`, do the debugging, and then eval in the original version again.; (mind you, if you're running with direct linking enabled, that workflow doesn't always work, unless you re-eval further up the call chain)."
1361,1557088940.2184,Brent,Is there a way to pretty-print the output of `macroexpand-1` to make it more readable than 1 long line? Thanks!
1362,1557090877.2187,Otelia,are you looking for `clojure.pprint/pprint`?
1363,1557094381.2189,Oscar,check out Rich’s _Maybe Not_ talk. he discusses having a spec schema from which you can select a subset of fields and provides motivation
1363,1557096681.2191,Madeleine,"Okay, maybe I thought you were responding to me. That's why I got confused. But now I think you were talking to todo."
1362,1557100138.2195,Oscar,I just looked for a user named “todo”. smh
1362,1557100178.2197,Madeleine,I thought there was haha
1362,1557100221.2199,Oscar,"oh man, so that wasn’t just a sprinkling of Spanish?"
1362,1557100234.2201,Madeleine,No :yum:
1362,1557100367.2203,Oscar,"anyway, happy to provide pointers to any type-related info. I’ve been a long-time Clojure user and espouser of dynamic types. over past few years my opinion on types has changed based on experiences working on large Clojure and Python projects; I still use Clojure daily for work and hobbies, but starting to switch over to Haskell for some things"
1362,1557100491.2207,Madeleine,"If you were talking to me then, I was talking about full strictly static type systems. Not optional. Where every single construct needs to be typed. I still feel that doesn't work well with Lisps. Dependent types add a huge annotation burden which would defeat the Lisp dynamic interactive live programming flow, and make the sexpr syntax even more of an eye sore I feel. Hindley Milner typed can't type all of Lisps constructs, and if you changed Lisps so it could, it's no longer Lisp, but a weird sexpr like syntax for Haskell. The only types I think could work are simple systems like Java's type system. Common Lisp has support for those optionally for example and that works fine."
1362,1557100601.2209,Oscar,"yeah, I agree with most of that and especially the optional portion. That’s the direction I wish Clojure was headed, optional/gradual typing"
1362,1557100672.2211,Madeleine,"I wasn't so much talking about being pro static or dynamic, but more that this holy grail everyone wants, which would be the dynamism of Lisp and the compiler checks of Haskell I think is a pipe dream, at least for now, because they literally oppose each other. What is great of Lisp is dynamism, which invariably means you can't have strong static guarantees. So you need to choose which one you prefer.; I don't think optional typing work honestly; That seem to have been an issue with core.type adoption"
1362,1557100713.2217,Oscar,it’s kind of frustrating to see `spec` continue as a runtime-only checker when other languages can statically check the structural types that seem to be the main motivation behind `spec`
1362,1557100745.2219,Madeleine,They can't though; Not without limiting the expressivity of the language
1362,1557100764.2223,Oscar,"I think optional typing can work, I agree that core.typed didn’t get there"
1362,1557100789.2225,Madeleine,You don't feel optional typing is a Jack of all trade master of none?
1362,1557100809.2227,Oscar,"mm, so you can have specs that act as contracts. where one can use arbitrary predicates, and I agree those can’t be expressed in most type systems"
1362,1557100825.2229,Madeleine,"What good is it that X is typed, if the Y it calls or the G that calls it aren't"
1362,1557100848.2231,Oscar,"but look at Rich’s talk, and the specs he uses as examples can be statically checked. proof being Typescript, Elm, and OCaml; those borders are then checked via tests like spec does now; but regions of code that are fully annotated (or inferred) can be checked statically"
1362,1557100896.2237,Madeleine,"Hum... I don't remember the details, but his whole spiel was that Haskell and other strongly typed system did it wrong, and so did he with spec 1"
1362,1557100927.2241,Oscar,"yeah, he used a strawman where Maybe types were used to represent optional fields"
1362,1557100974.2243,Madeleine,"It was more of a criticism of being forced to define things where they aren't in the domain I felt.; If you define an ADT, you need to specify all that could be in it."
1362,1557101009.2247,Oscar,"Haskell does have the ability to express structural types, but it is a little bit hacky. The languages I already mentioned: Typescript, Elm, and OCaml; are statically typed and _do_ have solid support for structural types and handle the issue Rich brought up"
1362,1557101032.2249,Madeleine,"Problem is, different time or states have different requirements of what could be in it."
1362,1557101039.2251,Oscar,"yep, exactly"
1362,1557101042.2253,Madeleine,"How? I don't have experience with those; Let's say I had a Customer with a Name and Credit Card; Both are mandatory for some functions, but required for others?; How you model that?"
1362,1557101126.2261,Oscar,"so the keywords to search for are “row polymorphism” and “structural types”, but as for how they work, it’s similar to what’s coming in spec2. You have some type schema/definition, and for a function that only requires a subset of the fields defined in the schema, the type/spec for the function parameter is defined as a subset of the schema"
1362,1557101210.2263,Madeleine,"Ok I see.; Ya, I guess that was his insight. And Haskell doesn't support them first class, which was his criticism; But doesn't both of these suffer if safety?; For static systems; How do they handle type equality or mismatch?"
1362,1557101372.2273,Oscar,"in Haskell, the closest reasonable solution is probably lenses. but that isn’t really row polymorphism. if you ask Haskell folks for three or so top issues to fix in the language, records/row types will be one of them; how do you mean?; <https://v1.realworldocaml.org/v1/en/html/objects.html>; there’s some info on row polymorphism in OCaml. maybe that helps? as to what the type checker is doing, I don’t know"
1362,1557101606.2281,Madeleine,"So, say you have a record of [:a :b :c]. And there's a function that needs [:a :c] and its given [:a :c :x :y] as input. And say it returns [:a :b :c], how does it know these are all compatible types?"
1362,1557101656.2283,Oscar,"because you only need [:a :c], and any additional fields are ignored; note that :a and :c will have types too, so the matching is based on field-type pairs"
1362,1557101695.2287,Madeleine,"Okay, the link you sent me mentions the limitations I'm talking about.; In the ""Subtyping Versus Row Polymorphism"" section.; They talk how each approach has trade offs, and neither can perfectly give us the behaviour we want, but that's the compromise of static type systems often time, you adapt to the way the type checker works in order to rake its benefits; ""For example, lists of heterogeneous elements cannot be created using row polymorphism""; Like that's a pretty big blocker for Clojure and most Lisps. Since they're most primitive construct are heterogeneous lists"
1362,1557102004.2297,Oscar,that’s also an implementation detail of the type checker for a specific language
1362,1557102076.2299,Madeleine,"Hum... are you sure? They don't make it sound like it. It seems to be a limitation of row polymorphism. Subtyping can do it, but then things can't be type inferred and needs to be explicitly casted it seems."
1362,1557102160.2301,Oscar,I honestly don’t know enough about OCaml to discuss it. =/ Let me do some reading and see if there’s an example of a type system without that limitation
1362,1557102160.2303,Madeleine,I need to look more into both of them for sure. Seems interesting; Thanks for pointing it out
1362,1557102741.2307,Oscar,"thanks for discussing it, I wish that happened more here! it’s good to run into the limitations"
1362,1557102844.2309,Madeleine,"Ya, thanks to you too. I like both static and dynamic languages. For different reasons. I prefer using certain dynamic langs, but not all. Only Lisps really, otherwise I prefer statically typed languages. I'm more experienced with C++, Java, C#. But have learned Haskell amateurishly. In general though, I find every static system is restrictive in one or another way. That's inherent from the problem. How do you teach a computer to understand and reason about code in a way that it can catch the bugs in it, when you couldn't. Nobody would say no to that, if it didn't come with trade offs. And even between strategies for achieving this there are many trade offs. So I tend to be skeptic of the static type advocates that don't start with talking about limitations and sacrifices of their approach :yum:; That doesn't mean sometimes the trade isn't worth it. But you need to accept that you will model things, not necessarily the way that you want to model it, not necessarily the way that is most intuitive, and not necessarily the way that the domain has it, but the way the type checker needs it.; At the end of the day, for me, it comes down to what I'd rather do and who I trust more. Could I personally catch more bugs if I was modeling it my way, and having fun doing it? Or would the type checker catch more bugs if I modeled it its way, and felt frustrated throughout the process :yum:; So in practice, I found I do better with Clojure over Java,C#,C++, but I do worse with Python, JS and Ruby.; I guess though,  I need to give Haskell, OCaml and PureScript a real good try to see if I end up doing better with them"
1362,1557103383.233,Oscar,"Have to run to dinner, but definitely up for talking more about types and trade offs.; The biggest hurdle for me with Haskell was getting comfortable with the handling of Effects through types. OCaml or others that aren’t pure (i.e., monads or some other effects system isn’t required) are maybe a good place to start exploring; And Idris’ dependent types are really cool "
1362,1557103870.2373,Madeleine,Have a good meal
1364,1557121600.2378,Roslyn,What is the use case of `type` function when there is `class`? When it's useful to put `:type` on something's metadata?
1364,1557131600.2391,Min,"since you can ""type"" anything supporting metadata I guess one answer could be that it's useful with multimethods dispatching via (type ... )"
1364,1557131754.2409,Roslyn,"oh, makes sense"
1365,1557165789.2425,Roselia,is there any book or written series about clojure compiler?
1365,1557166209.2429,Jasmine,"not to my knowledge; wish I had the time to write such a thing :) in a broad sense, the clojure compiler is just translating a relatively small set of possible expressions to java bytecode, and as such is pretty simple as far as compilers go; there's essentially no optimization - really Clojure leans on the JIT rather than doing much itself; fortunately, the jvm is pretty great at it"
1365,1557166544.2463,Meagan,the defn podcast with the guy working on ClojureCLR was super interesting. he went into differences between JVM and CLR and how one could optimize things for one over the other
1365,1557167108.2465,Dann,"sounds very interesting, is this the one? <https://player.fm/series/defn-2464514/ep-48-david-miller-and-clojure-on-the-clr>"
1365,1557167120.2468,Meagan,yep
1365,1557167356.2486,Marlyn,The nice thing about the clojure compiler is that it's a one pass translator to bytecode
1365,1557167413.2501,Abbey,"Anyone else have this issue? I'm using the Clojure CLI and have dependency that is a git repo. If I try to update the sha I get this error. ```Destination path ""my-repo"" already exists and is not an empty directory
org.eclipse.jgit.api.errors.JGitInternalException: Destination path ""my-repo"" already exists and is not an empty directory```.; I'm also having a hard time finding exactly where the code gets checked out."
1365,1557167460.252,Marlyn,"I've had that error before and I haven't been able to pinpoint it, but I remember something about auth; All the files go in .gitlibs <@Abbey> "
1365,1557167510.2534,Fatima,This was really good
1366,1557167542.2539,Abbey,"Thanks, <@Marlyn>"
1365,1557168268.2574,Shonda,I would buy this day one :slightly_smiling_face:
1367,1557168286.2578,Leda,"Hello guys, i'm writing tests for an async function that uses `future`
But in order to test it, i need to know when the background process have finished, but because it's async i have a return value right when i call it. How can i handle this situation?"
1365,1557168298.258,Jasmine,"well, don't hold your breath"
1367,1557168301.2582,Jasmine,:)
1365,1557168421.2584,Roselia,yeah i've seen this one few days ago; <@Leda> check `future-done?` function
1367,1557168693.2592,Leda,"wow, thanks"
1365,1557168760.2596,Dann,there's also `realized?`
1367,1557168781.2602,Roselia,whats the difference?
1367,1557168787.2604,Dann,"I think realized? is more general though (but I've heard multiple warnings about using it on lazy things); realized? works on promises, delays, futures, and lazy-seqs; and from what I hear, using it on lazy-seqs is a bad code smell"
1367,1557168816.2614,Roselia,i mean if we have realized why do we have more specific future-done?
1367,1557168853.2622,Dann,"principle of least power I guess  - also it uses the java Future api, and not the IPending api so it works on java futures, not just clojure's specific implementation of futures; every clojure future isa java.util.concurrent.Future, but not every j.u.c.Future is a clojure future"
1367,1557168977.2639,Leda,"well, i can use `future-done?` but still i have to supply a `Thread/Sleep` ? or i can use something like this `await-for` ?"
1367,1557168985.2642,Roselia,yeah i see
1367,1557169017.2651,Dann,<@Leda> what do you  want to do if the future takes to long?
1367,1557169019.2653,Roselia,realized is bound to be used for IPending implementors
1367,1557169032.2657,Dann,"if you always want to wait for it, just use deref / @; if you want to timeout, that's an optional arg to deref"
1367,1557169050.2666,Leda,"<@Dann> nothing, the test will fail i guess"
1367,1557169053.2668,Dann,"in neither case do you actually need to explicitly check if it is realized; <@Leda> then I'd use deref, with the timeout arg (how long is too long? probably more than 0 ms...) then use the timed-out value as your failure condition in the check"
1367,1557169120.2679,Leda,ok i'll try
1367,1557169184.2681,Dann,"<@Leda> ```(ins)user=&gt; (let [f (future (Thread/sleep 1000) ::OK)] (deref f 500 ::failure))
:user/failure
(ins)user=&gt; (let [f (future (Thread/sleep 1000) ::OK)] (deref f 5000 ::failure))
:user/OK```"
1367,1557169195.2683,Roselia,was about to write that snippet :smile:
1367,1557169254.269,Leda,"so, `deref` waits for the future to be done?"
1367,1557169266.2694,Roselia,yes it blocks
1367,1557169270.2697,Leda,nice
1367,1557169271.2698,Dann,"yes, by default it blocks, but with the extra arg it has a timeout; there's also future-cancel, if you know your code calls some cancellable method"
1367,1557169305.2708,Leda,"nice to know, async is something i didn't really used before on clojure or other langs"
1367,1557169345.2711,Roselia,"try core.async also, it provides a nice way to build concurrent applications"
1367,1557169448.2721,Leda,"don't think i need that much, it was just a function that needed to be async because it's just a HTTP response 201, Accepted and being processed; ```
(deftest download-musics--return-file-string
  (let [result (deref (core/download-musics test-links) 180000 ::failure)
        _      (shell/sh ""unzip"" result :dir core/resources-folder)]
    (is (string? result))
    (is (.exists (io/as-file (str core/resources-folder result))))
    (is (= (+ 1 (count test-links)) ;; This is because file-seq add's the own arg folder at the beginning of the seq
           (count (file-seq (io/file (str core/resources-folder (subs result 0 (- (count result) 4))))))))))


Uncaught exception, not in assertion.
expected: nil
  actual: java.lang.ClassCastException: class java.lang.String cannot be cast to class java.util.concurrent.Future (java.lang.String and java.util.concurrent.Future are in module java.base of loader 'bootstrap')
```

<@Dann> what i'm doing wrong here?"
1368,1557172035.2735,Florance,Does `core/download-musics` return a ref or a string?
1367,1557172085.2738,Leda,string
1367,1557172150.2745,Florance,The error message you’re getting is because you’re trying to treat a string (the result) as a ref (like an atom)
1367,1557172159.2748,Leda,"oh ok; but i can't really change the behavior of this function and it's output, guessing if i could make a wrapper that returns some kind of ref?"
1367,1557172291.2761,Meagan,you can change `download-musics` but not the deftest?
1367,1557172354.2765,Leda,"i can change deftest but not `download-musics`; it's output goes directly to a handler that returns an HTTP response based on it, and using a `ref` as return value would break the response pattern that i'm using for all my functions"
1367,1557172448.2778,Meagan,why does the deftest try and `deref` it?
1367,1557172541.2784,Leda,"because `download-musics` is async and i need to wait the background process to finish; `deref` blocks the main thread until it's done, but i didn't know that it expects a `ref`, or, i knew it but i forgot :disappointed:"
1367,1557172584.2795,Meagan,"according to the error, you don't; it's returning a string. not a future"
1367,1557172634.2804,Leda,"yes, because i need an immediate response from this function, in this case, a string; i'm struggling to write a test for it"
1367,1557172684.281,Meagan,it sounds like you should remove the `deref`; I dont' really understand what's going on. are you redefing the `download-musics` to just return a string or something?
1367,1557172820.2836,Leda,"`download-musics` is an async function, which returns a string. Inside it's body, there is a `future`, to do the background work (download the musics), but i need an immediate response of where this musics are going to be stored, so it returns the string (the name of the zip file that will be created).

all i need is to write a test that waits the completition of the `future` inside it's body, so i can test it propperly; guess i'll need to write a simple `Thread/Sleep` for now, just to write the test and refactor it later"
1367,1557173031.2845,Brent,thanks!
1367,1557173527.2852,Meagan,"no idea. either download-musics returns a string synchronously, or it returns a future that resolves with a string. I don’t understand your test"
1367,1557173888.2856,Suzann,Can you post the source of `core/download-musics`?
1367,1557174199.2867,Dann,"<@Leda> one pattern for what you are doing is to return a hash-map, eg. `{:f the-future :s the-string}` so a client can use the parts of the result that matter; if the consumer needs a string, you can make a thin wrapper that just pulls the string out, but you can use the real return value in your test; you don't really need a unit test for a function that does nothing but a single key lookup"
1369,1557176579.2909,Nieves,"Sorry for silly question, but can you suggest me, what project I can create and share on github, to make any interest to my person as a remote employee (keeping in mind, that I live in Russia). If it is possible, of course :slightly_smiling_face:"
1370,1557222376.294,Jeannette,"is there something like the inverse of ""-&gt;"" out there? a macro that takes a nested lisp expression and a symbol and returns it in threaded form?"
1371,1557228564.2954,Maybell,I’m having a hard time contemplating what you mean. Could you elaborate? Maybe some pseudo-code would help
1371,1557228637.2956,Fatima,Do you mean something like this? <https://github.com/clojure-emacs/clj-refactor.el/wiki/cljr-thread-first-all>
1372,1557235121.2982,Gladys,"Hello! I'm taking a new job and going back to Rails land from Clojure world. I'm a little sad to leave functional programming, and would like to maintain some of the fp mindset, so if anyone knows any good resources/blogs that discuss what fp concepts  work well for OO codebases and how best to apply them, I would greatly appreciate it :pray:"
1373,1557241362.2997,Meagan,"I don’t think this is a normal thing, but you could try writing one :D"
1374,1557247859.301,Bernardine,"Anthony, sad to see a Clojurist lost to Rails : )
Take a look at, which begins by outlining a Ruby path from OO to functional way of thinking: <https://medium.com/@aarontdixon/dynamic-validations-in-rails-8019570f9c59>"
1375,1557249029.3018,Jeannette,clj-refactor seems to be what I'm looking for
1375,1557249194.3032,Elaine,"How do I access ""this"" inside `toString` ? And how to control the creation of the instance?
```
(.toString (proxy [PersistentArrayMap] []
             (toString []
               ""42"")))
```"
1375,1557249351.3036,Dann,"that empty vector is the list of args to the superclass constructor; <@Elaine> there's an implicit `this` you can access ```user=&gt; (str (proxy [Object] [] (toString [] (clojure.string/reverse (str (supers (class this)))))))
""}tcejbO.gnal.avaj yxorPI.gnal.erujolc{#""```; there's also `proxy-super` for delegating to the superclass explicitly  ```user=&gt; (str (proxy [Object] [] (toString [] (clojure.string/reverse (proxy-super toString)))))
""b94e08c1@a47291ff$tcejbO.gnal.avaj$yxorp.resu""```"
1376,1557251773.307,Jasmine,"the `this` in `proxy` is the only ""magic"" anaphoric macro symbol in clojure I think"
1375,1557251860.3076,Dann,`:&gt;&gt;` in condp feels like a cousin of that
1376,1557251907.3083,Jasmine,"a little, but all keywords evaluate to themselves, so no issue there (vs symbols which evaluate to something else)"
1375,1557251926.3087,Dann,"yeah - not the same thing, just a similar ""magic"" feeling; also marginal cases: catch, finally, inside try, and thrown? and thrown-with-message? inside clojure.test/is; in that they are not bound anywhere, but they have meaning implemented by a parent macro"
1375,1557252578.3106,Rosaline,<https://dev.clojure.org/jira/browse/CLJ-2201>
1375,1557252644.3108,Dann,":exclamation: good to know, thanks"
1377,1557258023.3111,Elaine,let's vote :exclamation:
1378,1557258729.3141,Herman,"I'm reading about `core.spec` and I came across one passage in the design rationale that I'm having trouble understanding.

&gt; Invariably, people will try to use a specification system to detail implementation decisions, but they do so to their detriment. The best and most useful specs (and interfaces) are related to purely information aspects.

What's an example of ""trying to use a specification system to detail implementation decisions?"", as contrasted with a purely informational use of a spec?"
1378,1557259034.3144,Jasmine,"spec'ing intermediate internal functions; or like some of the specs for clojure.core that people have written fall into this; they look at exactly what a function currently implements and spec that, which may eliminate things that will be supported in the future; clojure core functions are aggressively polymorphic and we continue to add cases over time - spec'ing that stuff is a form of unnecessarily reducing future options"
1378,1557259333.3188,Herman,"That's what I thought it might be, but I was having trouble putting it into the right words. So I guess using spec for ""implementation decisions"" would be arbitrarily limiting what you can pass to or return from a function so that a given spec is always satisfied.; thanks!; so it seems like from the rest of that passage that spec is most useful at the edges of a program - informing and adding context to what other programs can send to or get from the program which uses spec."
1378,1557260323.3211,Jasmine,"certainly focused on the the functions that consume, transform, and emit maps of attributes"
1379,1557264187.3213,Gladys,"Thanks!

I am very interested to see how the transition goes : o But I'm also gonna try to make sure and stretch my fp muscles periodically with walk-throughs/tutorials I've been meaning to get to, so I won't totally be leaving clojure behind :wink:"
1379,1557318320.3263,Ivana,Is there a common trick to have `clojure.walk/postwalk` stop walking a data structure similar to how `reduced` can be used to stop `reduce` in walking a list?
1379,1557318399.3267,Sixta,Not that I recall from the source
1379,1557318467.3275,Jasmine,"Nope, unless you check something stateful like an atom"
1379,1557318617.3284,Ivana,"I have a hacky solution that walks a structure twice, but I'll try to come up with something better"
1379,1557318985.3286,Harris,<https://github.com/clojure/tools.analyzer/blob/master/src/main/clojure/clojure/tools/analyzer/ast.clj#L26-L115>; here's an implementation of `walk`/`prewalk`/`postwalk` over an AST that can be terminated via `reduced`; should be easy to extract general versions a la `clojure.walk`
1379,1557319549.3298,Ivana,"<@Harris> Cool, thanks; I just came up with this ```
    
(defn postwalk-reduced [f form]
  (clojure.walk/walk
   (fn [x]
     (if (reduced? x)
       (unreduced x)
       (postwalk-reduced f x)))
   f
   form))


(defn postwalk-reduced-demo [form]
  (postwalk-reduced (fn [x] (print ""Walked: "") (prn x) x) form))

(comment

  (postwalk-reduced-demo {:a (reduced {:b 1})})
  (postwalk-reduced-demo {:a {:b 1}})

  )```; Very basic, but seems to do what I want so far; (i probably have it wrong. I'll experiment a bit more and report later); actually postwalk seems more complicated, but with prewalk I get what i want - stop changing nested datastructures)
```
(do
  (defn prewalk-reduced [f form]
    (clojure.walk/walk
     (fn [x]
       (if (reduced? x)
         x
         (prewalk-reduced f x)))
     unreduced
     (f form)))

  (prewalk-reduced (fn [x]
                      (if (and (seq? x) (contains? #{'fact 'facts} (first x)))
                        (reduced x)
                        (if (= '=&gt; x)
                          '=?&gt;
                          x)))
                    '(5 =&gt; 5
                        1 =&gt; 1
                        (fact
                         2 =&gt; 2
                         (fact =&gt; 1)))))
```"
1380,1557324774.333,Sixta,is there a predicate for knowing the state of a future? e.g. failed
1380,1557324854.3333,Andrea,"`future-done?`? - ah, failed... hmm"
1380,1557325116.3338,Sixta,"Looks like deref-to-map (private in clojure) does this:

```
(let [[ex val]
        (when-not pending
          (try [false (deref o)]
               (catch Throwable e
                 [true e])))])
```"
1380,1557325529.334,Ivana,makes sense
1381,1557331513.3368,Mariela,"Anyone experienced in solving leaked sockets stuck in CLOSE_WAIT status? as reported in <https://github.com/http-kit/http-kit/issues/326>

Seems relatively common in JVM servers.

<http://www.serverframework.com/asynchronousevents/2011/01/time-wait-and-its-design-implications-for-protocols-and-scalable-servers.html> has some some promising advice which seems to apply to my case:

&gt; Don't design a protocol whereby a client connects to the server every minute and does so by opening a new connection. Instead use a persistent connection design and only reconnect when the connection fails

But still, our usage of http-kit is pretty vanilla so maybe there's a hard-and-fast fix"
1382,1557332933.3378,Matha,Has anyone here experimented semi-extensively (aka more than just a hello world) with GraalVM’s native images for Clojure? I am curious as to whether it works well enough to use in production on a medium-sized project.
1382,1557333136.3391,Rosaline,"pushing such an experimental thing to production, when normal jvms exist and run java bytecode great seems like such a bad decision; like, all my experience with clojure professionally has been writing backend systems with it, and the jvm works great there, so it is just so hard to see any upside; that being said <#CAJN79WNT|graalvm> is a channel that exists and you might try asking there"
1382,1557333300.3415,Meagan,I think <@Matha>’s use case is AWS Lambda; we were speaking in <#C03S1L9DN|clojurescript> about it
1382,1557333321.3421,Marlyn,"there is no good, only good for...; I'm pretty down on native-image and my personal opinion is that we spend a disproportionate amount of time fetishizing fast startup; rather than attacking bloat in dependencies; I see a lot of projects and when I run `lein deps :tree` or `clj -Stree` i'm always astonished"
1382,1557333498.345,Rosaline,"it isn't surprising though; a feature of targeting the jvm is getting access to all the libraries, so people go nuts with them"
1382,1557333538.3459,Marlyn,people also like fast food
1382,1557333542.3462,Matha,indeed; thanks <@Meagan> for specifying :stuck_out_tongue:
1382,1557333552.3465,Marlyn,"Ring still depends on clj-time and Joda, for example; for one tiny little use case; lots of projects pull in jaxb to do date parsing; an xml binding library, for date parsing; put that in your pipe; all of this slows down startup"
1382,1557333736.3504,Matha,As <@Meagan> said my use case is to run the application in a serverless setting; multi-seconds startup times of the JVM are unacceptable there unfortunately :disappointed:
1382,1557333738.3505,Marlyn,anyways you're going to sink a lot of time into just getting native-image to compile on anything but the most trivial projects
1382,1557333846.3523,Becki,<@Clarine> has gone through this recently with clj-kondo
1382,1557334371.3543,Marlyn,"many people have spent time getting graalVM native image to play... you won't be able to take a random jar or dependency and compile it blindly.  Look into `jaotc` <@Matha>, it doesn't have any of the restrictions that native-image has; if Java is ice cream, graal native-image is ""frozen dairy treat""
jaotc is still ice cream"
1382,1557334603.3559,Matha,<@Marlyn> I see; and does jaotc work with most hjars then? and does it speed up startups a lot?
1382,1557334617.3562,Marlyn,"yes it should; it is a bug if there is code that jaotc cannot handle; it does reflection, invokedynamic, etc; all the stuff native-image barfs upon; it comes with the jvm; Also based on Graal, totally different strategy though"
1383,1557334878.358,Matha,Alright I’ll try it out; thank you!
1384,1557341514.3615,Mariela,"The following doesn't appear to work - I see no `meta` changes:

`(alter-var-root #'something vary-meta assoc :deprecated true)`

Any ideas?"
1384,1557341600.3619,Becki,you want `alter-meta!` right?
1384,1557341707.363,Mariela,"right! thanks, had forgotten about that one :slightly_smiling_face:

I would have expected the `alter-var-root` to work though"
1384,1557341801.3633,Becki,the doc implies it works on the binding not the var; but don't ¯\_(ツ)_/¯; *know
1384,1557341964.3641,Mariela,"good one, root binding != value mutation"
1385,1557343726.3642,Sixta,"I'm trying to create vars to mimic the mathml structure, and there's a tag named `true`, which I obviously can't `def`. Is there a good suffix I should use? I'm reserving `*` for the function versions (unless I go for true** I guess?)"
1385,1557344222.3645,Olympia,`True` maybe?
1385,1557344341.3646,Sixta,"I like that, my only hesitation is that completion for `tr` wouldn't pick it up I guess :thinking_face:; Hmm, I'm trying to write a macro which writes a macro, and I'm getting a bit stuck with doing the unquote splicing in the nested defmacro. Any wizardry?; Oh, I can literally do a backtick inside a backtick!"
1386,1557346496.3664,Clarine,How fast is the startup of a hello world program with jaotc compared to Graal native?
1387,1557354688.3676,Loria,why doesn't clojure core have a `div` function that truncates toward negative infinity?; seems odd to have both `mod` and `rem` but no counterpart to `quot`
1387,1557354789.3686,Latonya,Probably because it is an uncommon use case?  I don't recall anyone ever asking for one before.; What languages have such a thing?
1387,1557354861.3691,Loria,"Haskell, under the exact same names; <https://stackoverflow.com/questions/8111120/integral-operators-quot-vs-div>; I need it for some basic modulo arithmetic, it's easy enough to define on my own but it seemed like an odd omission"
1387,1557355797.3723,Nieves,"it seems, that the roots of many decisions in Clojure came from the Java. maybe this case is the same?"
1387,1557356471.3733,Loria,"I suppose so, couldn't find anything about the matter though"
1388,1557356515.3738,Dann,"I'm not sure, but would `Math/floorDiv` be related to what you want?; returns largest int smaller than the  or equal to the quotient"
1387,1557356654.3748,Loria,"yes, that's it! Thanks :slightly_smiling_face:"
1387,1557356694.3754,Dann,"for performance reasons clojure only goes far from the java Math stuff for opt-in accuracy reasons; so if what I'm looking for mathematically isn't a correctness / precision improvement, I usually check the java.lang.Math API"
1387,1557356857.377,Loria,"I see, so the difference is that clojure.core functions take in all sorts of polymorphic types like BigInts and Ratios at the expense of some performance?"
1387,1557356930.3779,Dann,"more importantly they have contexts where they auto-promote to preserve accuracy, if you opt in; eg. use `+'` instead of `+`, `inc'` instead of `inc`; or use `/` instead of quot or java interop (?)"
1387,1557357065.3791,Loria,"hmm I'll keep that in mind, thanks!"
1389,1557369164.3803,Liliana,"would ^""[B"" be the right way to typehint the java equivalent of string[] ?; ah forgot the semicolon in `^""[Ljava.lang.String;""`"
1387,1557375233.3812,Jasmine,Yes
1389,1557407133.3826,Micheal,<@Liliana> how would I do that for an array of BigIntegers?
1389,1557407174.3831,Liliana,<@Micheal> make an instance of it in clojure and do .getClass interop
1389,1557407243.3835,Becki,`(str (class (make-array String 0)))` can spit that out for you i think? <@Liliana>
1389,1557407290.3837,Liliana,that works too
1389,1557407315.3841,Becki,i bet there's a way to get it without the class keyword at the beginning
1389,1557407428.385,Liliana,"all in all, this typehint does look very cryptic to me, but I guess the combination of arrays/types is almost too infinite for a special typehint symbol to be implemented for each and one of them?; well, I'll get used to it, I'd imagine all alternatives would conflict with the reader"
1390,1557420878.3878,Becki,"`every-pred`'s docstring doesn't guarantee the order of evaluation, just that it will stop on the ""first"" one that returns a logical false value. Is it improper to do `((every-pred integer? even?) nil)`? Are we guarnteed that `integer?` will check before `even?`?; inverting the order will throw an illegal argument exception; (also says set of predicates which is why first might be ambiguous)"
1389,1557427686.3905,Suzann,You can take a look at the source and see it is just using `and`s. <https://github.com/clojure/clojure/blob/841fa60b41bc74367fb16ec65d025ea5bde7a617/src/clj/clojure/core.clj#L7316-L7354>
1390,1557428156.3923,Becki,<@Suzann> I see the source now allows for that. But I want to know if clojure will guarantee this going forward or if it just happens to be ordered now 
1390,1557428289.3949,Suzann,"I know you think the doc string is ambiguous, but arguments are vectors, not sets. It does say it takes the first argument and that it short circuits. Short circuiting is an ordered operation. But more than that Clojure takes backwards compatibility very seriously. Changing the order would be a huge breaking change. It will remain that way for as long as Clojure exists."
1390,1557428414.3968,Becki,I don’t believe the arg is a vector. I understand the backward comparability but I’m not sure this is considered a contract of every pred or just an implementation detail ; And I certainly grant this is unlikely to change.; Just wondering if it can’t change
1390,1557429403.3985,Suzann,<@Becki> What sort of evidence are you looking for that it won't change?
1390,1557429426.3991,Becki,A docstring that the preds are applied left to right; Maps are ordered up to 8 elements. But it’s not in a docstring so relying on it is crazy and it’s best ignored; But also just being told it’s no big deal. Just musings on this one
1391,1557431082.4045,Suzann,"The docstring is trying to say that.  But it is just not explicit. ""Note that f is short-circuiting in that it will stop execution on the first
  argument"". I know you think this is ambiguous, but arguments to a function are ordered and that is what first is referring to here.

The docstring definitely isn't going to change to remove the ambiguity. But this code hasn't changed in 8 years and won't change in the future."
1390,1557431192.4048,Becki,fair enough :slightly_smiling_face:
1391,1557431209.4052,Dann,unordered arguments would break so many things...
1391,1557431233.4059,Suzann,"Also test cases imply this.

```
 ;; 2 preds, short-circuiting
   false    ((every-pred number? odd?) 1 :a)
   false    ((every-pred number? odd?) 1 3 :a)
   false    ((every-pred number? odd?) 1 3 5 :a)
   false    ((every-pred number? odd?) 1 3 5 7 :a)
   false    ((every-pred number? odd?) 1 :a 3 5 7)
```"
1392,1557431489.4072,Jennie,Hello every one. Are there any reporting tools available in Clojure. Any body tried integrating BIRT into your clojure app ?
1391,1557432437.4088,Celestine,"<@Suzann> The docstring is clear that the returned function `f` will short-circuit on the ""first argument"" but says nothing about the order of the _predicates_. Just the order of arguments to `f`."
1390,1557432483.4096,Celestine,So I'm with <@Becki> that the docstring gives no explicit guarantees about the order that `f` will apply the predicates (to each argument).
1391,1557432526.4109,Celestine,It just says it will stop at the first argument for which not all the predicates return false. It could apply the predicates in any order.
1391,1557432528.4111,Suzann,"<@Celestine> Yes, you are right, I misread.; It would still be a very large breaking change. And the tests seem to expect that the preds are applied in order.; I don't see that happening."
1391,1557432645.4137,Celestine,"Aye, I agree it would be unlikely -- but it is still an implementation detail -- and the core team _has_ changed implementations occasionally in the past that break behavior _that was not guaranteed by the docstring_."
1391,1557432695.4143,Becki,<@Celestine> you are saying what i was thinking _much_ more concisely and clearly :slightly_smiling_face:
1391,1557432731.415,Tammera,"its like a contract, what isn’t promised isn’t guaranteed :slightly_smiling_face:"
1391,1557432740.4153,Celestine,The confusion stems from both `every-pred` _and_ the function it returns both being variadic.
1391,1557432760.4154,Tammera,I sometimes wish there was a bit more chaos in programming. Things that werent guaranteed randomly changing behaviour; (only in tests!)
1391,1557432787.4161,Meagan,I expect that a change in `every-pred`’s order would be a breaking change though; there’s implicitly _some order_
1391,1557432815.4169,Celestine,"Years ago, I worked on a C compiler system that deliberately had variable behavior for undefined and unspecified situations :slightly_smiling_face:"
1391,1557432816.4171,Meagan,the docstring just doesn’t say which one exactly
1391,1557432842.4174,Tammera,"Yeah, I toyed with the idea to make a map/set impl that randomized its order"
1391,1557432851.4177,Meagan,so I wouldn’t expect the order to change
1391,1557432871.418,Celestine,"It was a code checking system, so it detected these situations explicitly in the runtime and handled them -- rather than just letting things blow up or always behaving in a predictable manner :slightly_smiling_face:; It could apply the predicates all in parallel :slightly_smiling_face:"
1391,1557432899.419,Becki,calm down djikstra :slightly_smiling_face:; i think i remember him envisioning conds all working like that. thought it was right around the corner
1391,1557432975.4202,Meagan,I think that’s contra to the _short circuiting_. :stuck_out_tongue:
1391,1557433164.4212,Becki,<@Marlyn> did you have thoughts? I saw you typing
1391,1557433256.422,Marlyn,can a man rage type into an input box and then delete it in peace? :joy:
1391,1557433261.4222,Becki,hahaha; absolutely. but i always enjoy your thoughts
1391,1557433281.4231,Tammera,"hahah, typing notifications are so annoying"
1391,1557433282.4232,Marlyn,i was going to say that there is implied order; and changing order is a solution -- what's the problem?; can always augment the docstring
1391,1557433317.4242,Tammera,type… think… revisit… remove
1391,1557433835.4262,Antione,"<https://dev.clojure.org/jira/browse/CLJ-1872> - empty? is broken for transient collections

I spent a little time staring at what it would take to submit a patch for this. Do I understand correctly that RT seqFrom and RT canSeq would need to include logic for TransientVector and company?"
1391,1557433869.4267,Meagan,you might try <#C06E3HYPR|clojure-dev>
1391,1557433886.4272,Antione,"I might, figured I'd throw it out here first."
1391,1557433891.4275,Meagan,I’m not super familiar with the RT stuff
1393,1557434333.4281,Antione,posted it over there
1391,1557434906.4294,Dann,"I feel like I've seen this pattern over and over - transient collections working for a specific use case (blindly accumulate items in one big reduce then persist), and all kinds of ops we expect for collections not working or working weirdly on transient collections"
1393,1557434980.4303,Dann,"the bugs get fixed eventually (I don't know if any of the collection features have been called wontfix yet), but they keep coming up; or maybe my memory is skewed; also iirc at best that transient coll will give you ~15% perf boost, and that's if it's in your main bottleneck"
1393,1557436461.4322,Antione,"<@Dann> yes, there definitely are more than a few transient tickets"
1394,1557461478.4391,Nisha,"I'm trying to write a small wrapper of jline, but git lost in deciding the pattern. Do I wrap the constructor and provide functions that takes an object a parameter, or do I instantiate and hide the jline class in the wrapper namespace in a var or atom, and provide functions that implicitly use the hidden object?; Could someone point me to some tutorial or examples?"
1394,1557461912.4408,Meagan,I think that depends on the answer of: would you ever need _two_ instances of the jline class?
1394,1557462438.4432,Bree,"At some point, the answer to that is going to be yes. I would not hide the object. If you do, then provide multi-arity functions: one without the object that uses your ns def and one that takes the object explicitly "
1394,1557462554.445,Nisha,"If I don’t hide that object, the code to use it would be something like:
```
(def line-reader (mywrapper/line-reader))
(mywrapper/readline line-reader ""this is a prompt"")
```; Does this look good?"
1394,1557462632.4461,Meagan,"yep, that seems good :slightly_smiling_face:; maybe you could provide a 1-arity version that automatically constructs the reader; I’m not familiar with line readers or jline specifically, so it’s hard for me to comment"
1394,1557462702.448,Nisha,"I somehow feel it’s smelly, but don’t know where and how to fix it. Probably because it’s also side-effect code."
1394,1557462735.4486,Meagan,"like take e.g. a database library. you’ll almost always create a db connection object, and pass that to all of your other functions (query, transact, etc.); I guess another question could be: what would happen if you created an object _every time_ you did something with the jline class?"
1394,1557462996.4513,Nisha,"I don’t know. That might work, but then I will need to do the same for all the util classes, like completer, highlighter and maybe history handler.; then I’ll have to save the states, for example completion candidates, outside the object, like in an atom or something.; Hmm I just feel java and clojure don’t work alone well."
1394,1557464045.4535,Meagan,"sounds like you have some mutable resource you’re managing, which you should provide as an object you can pass to the various functions"
1395,1557464815.4541,Celestine,"Wrapping an OOP library with a function layer that creates and passes the objects is really no improvement.; If you can figure out how to wrap the library with _data_ and a simple function API, you have a win.; Otherwise you might as well just use the underlying Java OOP library with interop."
1396,1557468060.4553,Nisha,"Yeah that’s how I feel, not really an improvement. It’s just `(.readline obj)` vs `(readline obj)`"
1395,1557468104.4559,Nisha,<@Celestine> But what do you mean by wrap with data and simple function API? Could you give me an example?
1395,1557471950.456,Tarsha,I think <https://github.com/cognitect-labs/aws-api> is a great example
1397,1557477782.4677,Antione,I think a more accessible version of what’s being described is something like hiccup or ring.
1396,1557478840.4742,Sonny,"<@Nisha> you may find ‘memfn’ from the core library a useful too when creating these thin idiomatic wrappers around Java libraries. I agree with <@Celestine>, re: not getting too deep into the rabbit hole. It’s entirely possible when doing something like this, to write a lot of code that really doesn’t end up improving the situation, but ‘memfn’ can often be used to create a very thin layer that allows the calling code to appear slightly more idiomatic. "
1397,1557479088.4754,Mireille,"someone mentioned to me it's possible to add a dependency to deps.edn and not have to restart the java process. is that true, and how would I set up my app to do that?"
1396,1557479860.4762,Leeann,It is true
1397,1557479935.4766,Clarine,"<@Mireille> it’s called add-lib, it’s a alpha-omega feature"
1396,1557480006.477,Sonny,"What's ""alpha-omega""?"
1396,1557480011.4772,Leeann,<http://insideclojure.org/2018/05/04/add-lib/>
1396,1557480043.4779,Clarine,<@Sonny> it’s more alpha than alpha
1396,1557480108.479,Sonny,"Haha! Yeah, honestly the thought had crossed my mind before that by calling all these things ""alpha"", there was going to be no names left for stuff that has yet to make it into the alpha. Cache invalidation and naming things :stuck_out_tongue:"
1396,1557480131.4793,Leeann,And off-by-one errors
1396,1557480146.4795,Clarine,OutofNamesException
1396,1557480157.4798,Sonny,:laughing:
1396,1557480185.4804,Leeann,"On that note, my son told me (when I praised him): If everything I do is great, everything I do is average."
1396,1557480250.4807,Clarine,can’t argue with your son
1396,1557480272.4809,Leeann,Nope
1398,1557489489.484,Raina,"When using `go-loop` in core.async... can the logic in the loop occur concurrently... by that I mean if I have input channel with 10 items, and I poll the channel in go-loop and process an item, will the items get processed concurrently?"
1398,1557490938.4858,Murray,"Why `when-let` only support one pair binding?; <@Raina> nope, If you have only one `go-loop`, it will process item one by one. If you want parallel processing, you can use `pipeline` or `pipeline-blocking`."
1398,1557491186.4882,Raina,thank you; So basically that is about the same concurrency as if using a single agent
1398,1557491295.4896,Lavonia,Yeah. An agent will have an actual thread though so there's no overhead of IOC threads.
1398,1557491432.4909,Raina,"So the benefit of core.async is only there if I spawn a lot of go-blocks, because they can share a small number of threads; So if I have like 1 continuous process per user and I have 1000 users, then I should make a `go-loop` for each person and it will work with limited number of threads?"
1399,1557495281.4931,Lavonia,Yeah.; But if you have a bunch of independent things to do. This might not be the best approach. `pmap` and reducers might be a better way to go about it.; _core.async_ is more appropriate when the processes have to communicate with each other (using channels)
1398,1557496208.4956,Raina,"The biggest obstacle to naive implementation for me is that some processes have to be throttled in my case, and if I use naive sleeping in the process, then it takes up a thread."
1398,1557497215.4962,Fredda,"Yeah, core.async is good for that too"
1398,1557497302.4974,Murray,<@Raina> you should not sleep in go block.
1398,1557498012.4979,Raina,"I know, but I think I've found a solution"
1398,1557498085.4986,Fredda,You usually don't have to worry about sleeping in go blocks. When waiting on channels they sleep automatically.
1400,1557500734.4993,Shayla,"I have a quick question about a micro-benchmark i'm running; using <https://github.com/hugoduncan/criterium>, i'm checking two different versions of the same code, and i'm confused why the single-pass version that uses reduce is slower than the version that does multiple passes with filter and map; reduce version:
```
(-&gt;&gt; (server-cards)
     (reduce (fn [acc card]
               (if (ice? card)
                 (concat acc (split (:subtype card) #"" - ""))
                 acc))
             [])
     distinct
     sort)
```; `(server-cards)` returns a list of maps, `ice?` checks the `:card-type` attribute to see if it's an `ICE` type, `:subtype` is a string of course; filter/map version:
```
(-&gt;&gt; (server-cards)
     (filter ice?)
     (map :subtype)
     (mapcat #(split % #"" - ""))
     distinct
     sort)
```; are they doing different things, and i don't realize it?; `(-&gt;&gt; (server-cards) (reduce (fn [acc card] (if (ice? card) (conj acc (split (:subtype card) #"" - "")) acc)) #{}) sort)` (conj and #{}) seems to be the fastest, at roughly half the time of the filter/map version; Ah, it's the repeated calls to `concat` in the reduce version. using `conj` with a `'()` makes it faster than the filter/map version, from a mean of 1 ms to about 770 us, and using a set instead of calling distinct at the end reduces it further to 600 us; well, thanks for listening, y'all! lol"
1401,1557503048.0073,Roslyn,"Side note: I really like combining criterium benchmarks with clj-async-profiler, so I can see both time spent and where it was spent"
1402,1557506630.0082,Leda,"Does anyone know a good way to auto generate API requests/responses tests by making use of an OpenAPI 3.0 specs?; I've been searching for some kind of solution based on this, and i've found in other languages, but nothing using Clojure, i thought it would be nice for me to try to create a lib/lein plugin that could do this; I REFUSE manually writing tests for my API Endpoints since i have it well documented using OpenAPI 3.0; and certainly i could generate automated tests for it because the specs from OpenAPI have all the necessary info to do so; i just want to make sure that if i could make something like this in clojure, this would be appreciated or used by other Dev's"
1403,1557507826.0166,Sophia,I had a interesting conversation recently with two people who work in IT/networking/cybersecurity who said they had mostly given up on programming as a frustrating and tedious task (having programmed only in Java and Python). I tried to sell them on Clojure and the part that interested them the most was the idea that programming could be interactive via the REPL. I told them about how you can build programs while evaluating each form inline and debug by revisiting your small pure functions instead of stepping through with breakpoints or printlns. Good reminder to focus on emphasizing interactivity when evangelizing as it truly is the most intuitive way to write programs!
1404,1557509726.0172,Zona,"I don't know anything about Java HTTP servers, how do I pick between the available Clojure ones? :slightly_smiling_face:"
1404,1557509758.0177,Meagan,go with Jetty if you're just starting out. it's fairly easy to get started and well supported; lots of guides + examples using Ring and Jetty
1404,1557510025.0185,Leda,i started with Ring also; in fact i didn't knew anything about backend development when i started with clojure. i learned by looking to real world examples
1404,1557510081.0199,Celestine,"We use the embedded Jetty server (with Ring, Compojure, Component, and Selmer -- for HTML templates) at work -- heavily in production."
1404,1557510171.0202,Meagan,"I'm not sure you need this to be in Clojure? It sounds like you want to send requests based on a Swagger spec, right?"
1404,1557510234.0215,Leda,"<@Celestine> when building API's, do you ever make use of Selmer/HTML templates?? i don't see how this would be possible/useful when building REST apis, just asking to know if i'm missing something"
1404,1557510403.022,Celestine,"<@Leda> No, if we're not producing HTML pages from a web app, we don't use Selmer.; Well, we also use Selmer to render HTML emails that we send to our members -- so we use Selmer inside REST APIs for that."
1404,1557510436.0228,Leda,"oh nice to know; do you ever built a medium/large product directly rendering HTML in server?; i mean, entirely; i imagine if this is easier to maintain than a REST API"
1404,1557511020.0265,Zona,I think it's easier for a small/1 person team because you don't need to maintain a separate front-end build process
1404,1557511033.0268,Dann,forcing a global singleton on an end user is pretty much never a good idea
1404,1557511047.0272,Zona,and you get SEO and page load speed benefits for free
1404,1557511135.0273,Dann,"pretending something that is intrinsically about side effects is somehow functional is a bad idea without a global system for managing state. We don't and won't have a global state management system in clojure (jline is there for its side effects, right?)"
1404,1557511319.0288,Celestine,"<@Leda> Prior to Clojure, our main member-facing app was server-side-rendered HTML. We have a few smaller apps now that do that (in Clojure, with Selmer), but we've mostly replaced the SSR HTML with a React.js-based SPA backed by a REST API."
1405,1557528719.0334,Clemente,"I had an idea about extending one protocol onto another protocol; doesn't seem like that's doable. I know it opens up a rats nest of inheritance issues, but still feels like something useful.  My scenario was to define a protocol InterceptorComponent that defines some callbacks, then extend io.pedestal.interceptor.IntoComponent onto it.  My imagined behavior is that this would be effectively equivalent to extending IntoComponent onto any record that implements the InterceptorComponent protocol."
1406,1557531409.0346,Meagan,"so basically, `IntoComponent` uses `InterceptorComponent`’s methods in some way and as long as a type implements `InterceptorComponent`, you can also use `IntoComponent` methods?"
1407,1557534422.0384,Bee,"Basically what you're saying is that `InterceptorComponent` describes a superset of `IntoComponent` behavior and thus anything that extends `InterceptorComponent` implicitly can implement `IntoComponent`. Trying to extend the one protocol onto the other lies madness, but you could write an adapter fn that returned a `reify`ed instance with implementations for both `IntoComponent` and `InterceptorComponent`. It would be indistinguishable from the input value (with regards to the `InterceptorComponent` protocol...) and could also participate in the `IntoComponent` protocol.; Alternatively, if you actually could implement `IntoComponent` with your new protocol, an implementation of `IntoComponent` can be expressed entirely in terms of the interface `InterceptorComponent`. Extension is just saving you having to write the `IntoComponent` implementations when you're defining your record/type, so why not macro your way out of that hole with e.g. `definterceptorcomponent` which expands to `deftype` with the `IntoComponent` protocol specs tacked onto the end of the user supplied body?"
1406,1557544637.0433,Jasmine,"it's intentional that protocols cannot be extended onto protocols. that said, protocols are nothing more than maps of functions and as such, there are ways to programatically get this effect. generally though, I've had better luck by extending a protocol to Object, then using conditional code to dynamically extend the concrete type you've received (which satisfies some secondary protocol) to the first protocol"
1408,1557568061.0446,Johnathon,"are there tools to provide performance details (mainly time-to-run) of all functions called from a parent function at runtime? i have a main function that kicks off loads of queries, calculations etc. i could `time` each one, but given how nested this code is i was hoping for an automatic solution."
1408,1557569230.0449,Min,<https://github.com/clojure-goes-fast/clj-async-profiler> is quite good
1408,1557570227.0452,Johnathon,cheers!
1409,1557578664.0479,Nisha,"Hi I’m trying to write my own client for a telnet-like protocol, for a mud game. I need to parse a byte stream, and the type of messages are identified by some special bytes, you know, just like telnet.; Is there a lib that I can use to help parse the byte stream?"
1410,1557583373.0491,Marchelle,<https://github.com/ztellman/byte-streams>
1409,1557586712.0494,Nisha,"Thanks, but it doesn’t seem to be for parsing bytes?"
1411,1557592637.0526,Nisha,Is anyone using `gerritjvv/clj-tcp`?   Somehow I’m getting error with it.
1411,1557592675.0535,Murray,"can I package all the dependencies in one uberjar, and my code in another jar. So I can deploy the dependencies only once(if no dependency changes)."
1412,1557594960.0545,Nannette,Is it possible to use Cognitect's AWS library with Ring? I reported one dependency issue when using both libraries in <#C09N0H1RB|aws> channel.
1412,1557595553.0561,Celestine,<@Nannette> looks like a dependency conflict with Jetty which you should be able to fix by specifying a compatible version directly in `project.clj`. 
1413,1557595563.0563,Antwan,Simple question; how do I execute a full sql file with jdbc; just a bunch of `CREATE TABLE IF NOT EXISTS` calls
1413,1557595662.059,Celestine,"<@Antwan> slurp it in, break it into statements (str/split on ;), and call db-do-commands on each one"
1412,1557595786.0599,Nannette,"<@Celestine>, thanks. I'll check that tomorrow."
1413,1557595815.0604,Antwan,None; like that?
1413,1557595889.0611,Celestine,Yeah something like that ; When I'm at my computer I'll pull up the code we use at work to do the same thing 
1413,1557595953.0623,Antwan,"```
Execution error (SQLException) at org.sqlite.core.NativeDB/throwex (NativeDB.java:478).
The prepared statement has been finalized
```"
1413,1557595996.063,Celestine,You probably need to tell db-do-commands not to use a transaction 
1413,1557596042.0634,Antwan,same error
1413,1557596283.0663,Celestine,Hard to debug when I'm on my phone :upside_down_face: If you can post more details in <#C1Q164V29|sql> I can take a look when I'm at my computer later 
1413,1557596293.0666,Becki,I remember looking into migratus for something. But use a different separator and split on that. I thought I remember the underlying thing not liking terminating semi colons
1413,1557596776.0688,Erna,"I don't know if this is the issue, but `clojure.string/split` has some non-intuitive behavior with separators at the end. TLDR; use a negative `limit` parameter. See <https://clojuredocs.org/clojure.string/split> for some examples. I got bitten by this recently."
1414,1557597112.07,Becki,I think the end result was that the batched statements can’t have terminating semicolons (this was on Postgres not sure what your dB is)
1415,1557600185.0705,Celestine,"The split ended up producing an empty SQL statement and that's what throws the exception.; `(str/split contents #"";\s*\n"")` or `(str/split contents #"";.*\n"")`"
1416,1557608888.0728,Murray,"should I use `*ns*` to get the qualified symbol in macro? like `(my-macro (+ 1 2))`, I want `+` as `clojure.core/+`."
1416,1557609449.0733,Kori,"You want to use syntax quoting in this case

``` 
`x =&gt; clojure.core/+
'+ =&gt; x
```"
1416,1557609920.0745,Murray,Thanks for the reply. but the code in (my-macro ...) will not use syntax quote.; is there a way to know the namespace of that symbol?
1417,1557610940.0749,Celestine,"Can you explain more about what you're trying to do?; ```user=&gt; (defmacro my-macro [x] (first x))
#'user/my-macro
user=&gt; (my-macro (+ 1 2 ))
#object[clojure.core$_PLUS_ 0x1f38957 ""clojure.core$_PLUS_@1f38957""]
user=&gt;  ```  The symbol is `clojure.core/+` here.; In case this helps: ```user=&gt; (defmacro my-macro [x] (.ns (resolve (first x))))
#'user/my-macro
user=&gt; (my-macro (+ 1 2 ))
#object[clojure.lang.Namespace 0x707b1a44 ""clojure.core""]
user=&gt;                ```"
1416,1557612987.0755,Murray,"looks great. I'm trying to write a macro that can be used in both `-&gt;&gt;` and `-&gt;`.; ```
(-&gt; (call (/ 1 0))
    (then (inc))
    (then (/ 2)))
;; =&gt; #error {
;;  :cause ""Divide by zero""
;;  :via
;;  [{:type java.lang.ArithmeticException
;;    :message ""Divide by zero""
;;    :at [clojure.lang.Numbers divide ""Numbers.java"" 188]}]
;;  :trace ...}

(-&gt; (call 1)
    (then (inc))
    (then (/ 3)))
;; =&gt; 2/3

(-&gt;&gt; (call 1)
     (then (inc))
     (then (/ 3)))
;; =&gt; 3/2

(some-&gt; {:a 1 :b 2}
        (then (:a))
        (then (/ 2)))
;; =&gt; 1/2

(some-&gt;&gt; {:a 1 :b 2}
         (then (:a))
         (then (/ 2)))
;; =&gt; 2

(some-&gt; {:a 1 :b 2}
        (then (:c))
        (then (/ 2)))
;; =&gt; nil

(some-&gt;&gt; {:a 1 :b 2}
         (then (:c))
         (then (/ 2)))
;; =&gt; nil
```
This is what I have currently."
1418,1557637173.0772,Jennie,anybody used `toucan`? I am looking for help on alias name.  Ex: `SELECT column_name AS alias_name FROM table_name;`; <@Marylouise> ^^
1418,1557637587.0785,Celestine,<@Jennie> Not sure I see the point of using `toucan`. It doesn't look very idiomatic to me.; Why not use pure SQL?
1418,1557637760.0803,Marylouise,"<@Jennie> the great thing about toucan is that you can use honeysql
```
(-&gt; (select :a [:b :bar] :c [:d :x])
    (from [:foo :quux])
    (where [:= :quux.a 1] [:&lt; :bar 100])
    sql/format)
=&gt; [""SELECT a, b AS bar, c, d AS x FROM foo quux WHERE (quux.a = ? AND bar &lt; ?)"" 1 100]
```"
1418,1557637837.0823,Celestine,"Well, that doesn't use `toucan` at all -- that's the great thing about HoneySQL and `clojure.java.jdbc` :slightly_smiling_face:"
1418,1557637860.0826,Marylouise,<@Celestine> how is toucan not idiomatic?
1418,1557637874.0833,Celestine,It tries hard to be an ORM :disappointed:; The fact that someone has to ask about something as basic as a column alias says there's a problem with `toucan` if it doesn't support that.
1418,1557637937.0845,Marylouise,"Yes that's the good thing about toucan (vs korma for example), it's still data driven; Use toucan where it makes sense, otherwise use honeysql"
1418,1557638112.0893,Celestine,"It uses a lot of global dynamic variables as well, which is terrible practice. It makes using multiple databases nigh on impossible."
1418,1557638172.092,Marylouise,"Agreed, the globals aren't nice. PRs welcome :slightly_smiling_face:"
1418,1557638184.0924,Jennie,"<@Celestine> <@Marylouise>  Thanks for the reply. First I looked at hugsql, but my team felt it is too much laborious which contradicted my reasoning to go with Clojure (our app is in Kotlin). I find toucan is enough to avoid too much of repetition and also I am convinced in case of more complex SQL there is HoneySql."
1418,1557638285.0931,Celestine,"Yeah, I'm not a fan of HugSQL because I don't like the SQL separate from the code that uses it.; But there's nothing wrong with SQL. It's a pretty good DSL :slightly_smiling_face:"
1418,1557638503.0987,Marylouise,"Using data is a lot more reusable and composable. A logical data translation layer really helps (like honeysql vs SQL, hiccup vs HTML).  SQL strings have various limitations and can cause security issues (if parameters aren't used)"
1418,1557638521.0991,Celestine,"`(sql/get-by-id connectable :table-name the-key)` seems a pretty concise way to get a hash map of a single row by primary key (one of Toucan's misleading examples makes it looks like this needs to be a lot of work).; <@Marylouise> Sure, HoneySQL provides composability. We use it heavily.; My point is that Toucan makes a lot of strawman comparisons to try to show it is ""better"" than an unrealistic alternative that nobody would actually use anyway."
1418,1557638732.1031,Marylouise,"Toucan adds a lot of useful things. For example, how would you do hydration easily using SQL? It also has nice post and pre process functionality."
1418,1557638773.1038,Celestine,`datafy`/`nav` provides that feature out-of-the-box in both `clojure.java.jdbc` and `next.jdbc`.; Lazily.
1418,1557638830.1048,Marylouise,Ahh in `next.jdbc`. That wasn't available when we implemented or DB layer. I'll check it out :slightly_smiling_face:
1418,1557638833.1049,Celestine,"But you'd be better off doing a `join` in SQL in the first place instead. That sort of ""convenience"" is one of the bad/misleading things that ORMs try to make ""easy"" for you."
1418,1557638874.1051,Marylouise,Yes but joins don't create nested structures. Is there a way to do that easily?
1418,1557638906.1054,Celestine,(I'm very down on ORMs after decades of work with them)
1418,1557638983.1061,Marylouise,"I don't like ORMS either. Toucan doesn't add a `.save` method on the data. You pass on the model definition and just data.; So toucan isn't the least ORM ""ORM"" I've used; <@Jennie> is better to use the specific channel for questions. See <#C592R5P8F|toucan>, <#C66EM8D5H|honeysql>, and <#C1Q164V29|sql> channels"
1419,1557643407.1111,Roselia,"When we create a sub-vector it holds on original vector, but what happens to original if we conj onto sub-vector and throw it away?"
1419,1557643670.1126,Sheron,"hopefully nothing, otherwise i have to rewrite all my code"
1419,1557643984.1132,Roselia,"right, nothing happens"
1419,1557643986.1133,Sheron,"if you have a moment maybe you can watch the video from here ? <https://youtu.be/wASCH_gPnDw?t=1753>   , it explains some things very well"
1419,1557643992.1135,Roselia,"v.assocN(end, o) is being called on original, new subvector returned; so almost the same thing as creating subvector of a subvector"
1419,1557644186.1153,Sixta,"I'm banging my head against a jetty server that after a `(.stop svr)` and `(.join svr)` is still using the port. The server is configured for websockets, so I'm not sure if that's related at all. Hoping this sounds vaguely familiar to someone who can help me out :slightly_smiling_face:"
1419,1557644236.1159,Sheron,"is it still listening after the stop ?; or is the port just in some wait linger and not listening ?; and just to make sure, you are trying that on windows, are you ? :slightly_smiling_face:"
1419,1557644375.1177,Sixta,"That's a good question, I'm not certain. I think it resolves it itself given a little time (human typing time) this only happens on `(reset)`.

Nope, linux!"
1419,1557644391.118,Sheron,just check    `netstat -anp | grep LISTEN`; if it's still there listening for real after the join; i use the same pattern myself in some integration tests and i don't remember it misbehaving
1419,1557644490.1196,Sixta,"I'm pretty sure this is related to websockets somehow, because it only happens if the server-side component of that is activated. Well, more specifically, if figwheel is trying to start a repl."
1419,1557644638.1202,Sheron,"netstat's output also lists the process id's , there's always a chance you have forgotten another process around that lives on the same port :wink:"
1419,1557644699.1212,Sixta,"Na, I've got a ""mostly reproducible"" (because it's racey) `echo '(future (cljs-repl)) (go)' | clj -A:dev` which succeeds for one of them, and fails for the other with ""Address in use""; I stuck a `clojure.java.shell/sh` in after the `.join` and I can't see the port in there at all :disappointed:; so what on earth is going on!"
1419,1557645148.1227,Sheron,i think join itself is just there to wait for the thread to stop after the server has been shut down ... join itself shouldn't do anything with the port by itself
1419,1557645375.1237,Sixta,"The join may well not be necessary, it was a guess I added. I suspected that the server wasn't completely shutdown yet."
1419,1557645487.1243,Sheron,"tested here locally,   right after i do  (.stop server)   the port is not being listened on anymore; so it does sound like there is indeed something racey going on in your machine , but i wouldn't blame it on jetty right away :wink:"
1419,1557645605.1259,Sixta,it's definitely racey. With the addition of `ss` it's much less likely to happen.
1419,1557645954.1276,Sheron,if it solves in little time then perhaps make the server restart thingy more persistent in it's actions :slightly_smiling_face:; we used to that on servers too before all the operating systems started to support the reuse flags on sockets; then you'd see an apache server going down and having to wait a minute before a you could do a rebind (on a badly configured linux server)
1419,1557646128.1292,Sixta,"This is in development, and is pretty much just the internal figwheel stuff being stopped/started quickly via the api.; the thing is, I'm not seeing 9900 in time-wait either.; <http://hea-www.harvard.edu/~fine/Tech/addrinuse.html> I only get this if I try and start a cljs repl (server side). I don't _think_ that's a websocket client, but maybe it is (or maybe it just alters the timing just so); but I should still be seeing time_wait if that's the case."
1419,1557646424.1311,Sheron,and you are sure there is no accidental duplicate process trying to rebind at the same time either ? :slightly_smiling_face:
1419,1557646455.1316,Sixta,"That would also show up in the `ss` I'm running just before starting (or, at least it should _once_); I have no java processes open, and I don't write any other code :smile:"
1419,1557646597.1326,Sheron,no funny macro business going on either evaluated at a different time than you think ? :slightly_smiling_face:
1419,1557646787.1329,Sixta,Nope. Functions and multi-methods here only.
1420,1557648440.1332,Nannette,It worked. <@Celestine>: thanks for your help!
1421,1557656880.1343,Bo,I've used tufte ( <https://github.com/ptaoussanis/tufte> ) and its `defnp` with good results
1422,1557665561.1356,Raina,"Hm... could not closing `chan` async channel cause a memory leak?; I have code that is passed a channel, reads an item from the channel and throw it away.; and the code that creates the channel doesn't hold on to it"
1421,1557677978.1368,Susan,"It's worth noting that, although the primary workflow of HugSQL is to allow separate SQL files, the library contains all of the necessary functions to use SQL inline in your code or at the repl.  Specifically, `db-run` and `db-fn` accomplish this and give you the same HugSQL parameter replacement abilities.  <https://www.hugsql.org/#using-other-fns>"
1423,1557682739.1376,Jasmine,"If no one is using it, should be gc’ed"
1423,1557682768.1378,Jennie,<@Marylouise> It worked for me like this `  (db/select [m/Facility :id [:facility_name :facilityName] [:standing_orders :standingOrders]])`
1424,1557684088.1398,Sixta,"I'm looking for libraries which enable suspendable evaluations in clojure. Nothing in mind too much, just looking at implementing something which parallels excel."
1425,1557684950.1401,Meagan,like continuations?
1424,1557685795.1404,Sixta,"That's what I was thinking of, yes!"
1424,1557686446.1412,Antwan,<https://kcsongor.github.io/time-travel-in-haskell-for-dummies/>; not to say the m word; but maybe something close to this?
1424,1557686504.1423,Meagan,<@Lavette> made a delimited continuations lib awhile ago; <https://github.com/swannodette/delimc>; there’s another library that people were talking about on clojureverse a few months ago
1424,1557686968.1436,Antwan,"for something like excel it feels like ""lazy evaluation"" might not be enough; or rather, even if it technically represents what is happening it isnt super useful beyond actually computing the values"
1424,1557687343.145,Sixta,"excel has a ""restarting scheduler"" where it pauses evaluation on request of a cell, and re-orders the evaluation, then starts again. A little bit like what pedestal does with interceptors I guess."
1424,1557687475.1456,Alyce,"Is there anything you can learn from the way Kotlin does it, their coroutine support, via libraries, is very well developed.; I believe they use a state machine; Of course, when Project Loom makes its way into the JVM, I'm sure the approach may change then too!"
1424,1557687620.1466,Sixta,a state machine? sounds like how the go-block works :thinking_face:
1424,1557687685.1468,Alyce,<https://github.com/Kotlin/KEEP/blob/master/proposals/coroutines.md>; I'm not that familiar with the depths of the approach that they took
1424,1557687830.1482,Antwan,"I think the ""reordering"" part is cruicial"
1424,1557687850.149,Alyce,There are quite a few videos from the designer of the coroutine support of kotlin on youtube.
1424,1557687853.1493,Antwan,"you basically need to make sure that the computations are a DAG and that you do them in topological order; so if someone makes a change you could do a ""virtual dom"" for each cell; and only recompute the values that have changed; or you could compute the whole batch of values"
1424,1557688068.1526,Sixta,"excel is slightly heavy-handed with it's approach to dependencies, but it does generally satisfy minimality."
1424,1557688075.1529,Alyce,"I do recall too that they (kotlin guys) changed the way coroutines worked, before making it public (i.e, non-experimental). Here's the post from Roman about it: <https://medium.com/@elizarov/structured-concurrency-722d765aa952>."
1424,1557688079.1532,Sixta,If you use INDIRECT then you'll be recomputed very often.
1424,1557688096.1535,Alyce,I think it would be exciting to have coroutine support in Clojure :slightly_smiling_face:
1424,1557688126.1537,Antwan,(go to town with macros)
1426,1557690243.1546,Sheron,dharrigan what problem would it solve ?
1427,1557695173.1557,Herman,"I don't know whether it has the ability to ""pause evaluation"" in the way you're describing, but I immediately thought of Matrix when I thought of ""excel-like"" dataflow in Clojure

<https://github.com/kennytilton/matrix>"
1428,1557699002.1573,Brent,Hello! I use deps.edn with cognitect/test-runner / Kaocha and cannot figure out how to get some namespaces AOT-compiled (needed due to `gen-class` in test files). Any [googling/solution] tips? Thank you!
1429,1557699388.1576,Jolanda,"hey, I just asked the same questions few days ago over at the <#C6QH853H8|tools-deps> room: <https://clojurians.slack.com/archives/C6QH853H8/p1557397085170000>"
1430,1557702039.1588,Malik,"is there a way to generate a hash-map with test.check.generators where one of the values is calculated from two of the other values?; None; basically I don't know how to do the gen for the :frame-rate; hmm maybe with a gen/let?; yeah, that should work"
1431,1557723042.1609,Mireille,is there a deps.edn version of `lein clean`?
1431,1557724171.1615,Celestine,"<@Mireille> `rm -rf .cpcache` :slightly_smiling_face:; You can use `clj -Sforce` to force the dependencies to be recalculated and the cache ignored, but I'm not sure if that _overwrites_ the `.cpcache` folder..."
1431,1557724626.1625,Mireille,thanks!
1430,1557726066.1639,Tammera,"Maybe drop the `-f`, removing with force always is ill advised "
1430,1557726100.1641,Celestine,Decades-long habits are hard to break :slightly_smiling_face:
1430,1557726267.1647,Tammera,Haha just as guilty ^^!
1432,1557728474.1649,Alleen,"Have a look at <https://github.com/leonoel/cloroutine> it's a low-level macro that can be used to implement the patterns mentioned in the articles you linked.
I'm not aware of any clojure implementation of trio-like structured concurrency but that lib would definitely be a good start if you're willing to explore this path."
1433,1557734067.167,Grant,"Does anyone have any experience with jnr-ffi? I am trying to write some clj bindings for a c library. i saw from caesium's source code how to do it when the functions return primitives, but the ones i am trying to bind return structs, and i haven't a clue how to approach it. it looks like, from java examples, that I need to extend the struct class with fields, but i don't know how to do that in clojure."
1433,1557735402.1672,Madelene,an à la carte build system perchance?
1433,1557738358.1682,Grant,"(in jnr-ffi, it looks as though in order to use structs you need to extend the Struct class with additional fields. that's the bit i don't know how to do.)"
1434,1557739934.1693,Stefan,<@Meagan> it would be good to wrap your hooks/userReducer to work with multimethods; or maybe even with whatever implementes Ifn; had to wrap it myself
1435,1557742355.171,Alaine,"A question related to maps and sequences.
Some of the sequence functions work on map e.g. first, rest, map (they convert a map to a sequence via seq)
However nth doesn’t work on a map; Is there a good reason for that?"
1435,1557742476.1733,Elaine,"hash-things (hash-map and hash-set) has no notion of order. Do not make sense ask for ""the second item""
first and rest make some sense once you can understand ""give me 'any' first item"""
1435,1557742701.1735,Alaine,second works on maps
1434,1557744887.1739,Sixta,"Actually for aero, but ideas from that yeah; I'd love to implement that paper, I don't think it's as general as it suggests, it's evaluation behaviour is pretty dependent on various haskell things like applicative"
1434,1557745284.1743,Madelene,"&gt; Actually for aero

Ahh ok, so you’re trying to manage a graph of effects inside an immutable edn tree?"
1435,1557749153.1751,Sixta,"I'm trying to model the completely dynamic dependency graph without setting my hair on fire. The first two implementations have set my hair on fire :fire:; I'm trying to add macro support at the same time, where macro means that #profile stops running all paths.; The interface needs to stay fairly similar because it is easy to use"
1435,1557749498.1757,Madelene,ahh so dynamic dependencies as in that talk too
1436,1557749951.1768,Star,who could agree with me: stacktraces should show what was the input...
1435,1557750393.178,Karren,"I wanted this so many times...
but input may be huge for example.
I guess it's hard to solve in general."
1435,1557750457.1783,Star,so it should be in a separate stacktrace like *e2 or something...
1435,1557750467.1785,Zona,"disagree, this is one way for personally identifiable information to end up in logs"
1435,1557750547.1787,Karren,"This could be enabled only in ""dev"" mode.
But I guess the problem is that it really isn't that easy - exceptions can occur at many different levels - at each step you'd need to capture the input and possible decide whether (and what) to show it."
1435,1557750835.179,Zona,"does clojure have a `trace` (from CL) equivalent?; ""Whenever a traced function is invoked, information about the call, about the arguments passed, and about any eventually returned values is printed to trace output.""

``` (defun fact (n) (if (zerop n) 1 (* n (fact (- n 1)))))
=&gt;  FACT
 (trace fact)
=&gt;  (FACT)
;; Of course, the format of traced output is implementation-dependent.
 (fact 3)
&gt;&gt;  1 Enter FACT 3
&gt;&gt;  | 2 Enter FACT 2
&gt;&gt;  |   3 Enter FACT 1
&gt;&gt;  |   | 4 Enter FACT 0
&gt;&gt;  |   | 4 Exit FACT 1
&gt;&gt;  |   3 Exit FACT 1
&gt;&gt;  | 2 Exit FACT 2
&gt;&gt;  1 Exit FACT 6
=&gt;  6```"
1435,1557750930.1804,Jasmine,"nth is for integer indexed cols, maps and sets are not integer indexed"
1435,1557751041.1806,Zona,"ah, <https://github.com/clojure/tools.trace>"
1435,1557751053.1809,Karren,"Yes, this is useful and something I (sometimes) use (via Cider).
However, you need to instrument the function beforehand - it may be harder if the error isn't that easy to reproduce (which is a problem anyway) or it may just took way longer or it may be deep down in java call stack..."
1435,1557751098.1811,Fernande,"haven't tried this, but does this help at all? <https://github.com/kkinnear/zpst>"
1435,1557751285.1815,Karren,"Not sure how practical this approach is, but I think you ultimately need JVMTI agent (or something equivalent) - this could be an interesting thing to explore:
- <https://stackoverflow.com/questions/42226592/how-to-get-the-values-of-method-local-variables-and-class-variables-using-jvmti>
- <https://github.com/cretz/stackparam>"
1435,1557752252.1819,Jasmine,"yes,  it overwrites (for the specific command you ran)"
1437,1557754001.1821,Meagan,You mean you can't pass a mulimethod to useReducer?; If so can you open an issue please so I remember
1437,1557754141.1826,Magdalena,[ANN] Cognitect Labs' aws-api 0.8.305 <https://groups.google.com/forum/#!topic/clojure/rKAbv6-U3CM>
1438,1557755845.1836,Mariela,"Can I make `(instance? ""Ljava/lang/Integer;"" x)` work?

(`instance?` rejects strings as criteria); which is logical because an array is not an object...

anyway my question stands - can I check if something is an array of x?; ok, this is a FAQ easy to find, sorry for the noise"
1439,1557760163.1842,Min,"&gt; (instance? (Class/forName ""[Ljava.lang.String;"") (into-array String [""s""]) ) =&gt; true"
1440,1557762248.186,Alaine,"What are the exact relationships between collections and sequences?
Here <https://clojure.org/reference/sequences#_the_seq_interface> the Seq interface is describe by means of 3 functions first, rest and cons but in the description (and the signature of the function), the term collection is used instead of sequence. Can someone clarify it?"
1440,1557762398.1864,Jasmine,sequences are (logical) collections; Collections are (in Clojure) defined by IPersistentCollection; Sequences are defined by ISeq (which extends IPersistentCollection)
1440,1557762540.1874,Mariela,"Nice one!

I ended up avoiding the scary notation completely:

`(instance? (class (make-array String 0)) (into-array String [""s""]))`"
1440,1557762560.1878,Jasmine,IPersistentCollection extends Seqable (to request a seq view of a collection)
1440,1557763191.1898,Alaine,Thanks <@Jasmine>. I am going to meditate on it
1441,1557766992.1921,Bee,"One thing I think is useful when contemplating sequence vs. collection: A collection is a finite, non-scalar grouping of some 'things', e.g. List, Vector, Set, Map. A seq is an interface to data that makes sense to apply to collections, and also to non-collection, infinite things like `(range)`, `(iterate)`, `(cycle)`, et al. You can compute infinities with a seq, but not with a collection."
1440,1557767060.1925,Jasmine,"given that sequences are collections, collections are not necessarily finite; one term used in some of the clojure  reference docs to refer to list, vector, map, set. sorted set, sorted map, etc is ""data structure"", which are finite"
1440,1557767306.1947,Dann,"it uses ByteBuffer, which has all the methods needed for pulling other types out of bytes"
1440,1557767317.1951,Jasmine,"there is no ""type"" in the Clojure impl that contains those data structures but not sequences"
1440,1557767340.1955,Dann,"in fact, that's straightforward enough that I'd skip clojure libs / bindings and just feed the InputStream into a ByteBuffer via interop, and use that API"
1440,1557767349.196,Jasmine,"<https://clojure.org/reference/data_structures>; sometimes ""collection"" is used to mean ""the data structures but not seqs"" and sometimes it is used to mean ""all collections, including seqs"". this is not done consistently either in the docs, or the code, or the broader community."
1440,1557767503.1985,Bee,"Yeah, it's worthwhile to understand the context that the word 'collection' is being used, with more precision than 'talking about Clojure the language'"
1442,1557769315.2008,Lesa,"I need to write some code that writes to a unix socket (in this case, `/dev/log` so I can write a timbre appender to send logs direct to syslog). Right now I'm puzzling my way through netty code as it seems to be the only java library that packages the native integration sensibly, but their relative lack of docs is making that pretty slow going. Does anyone know of a clojure library/feature I may have missed for doing so?"
1440,1557769832.2018,Alaine,"<@Jasmine> I am trying to understand exactly what is the meaning of “Collections are represented by abstractions, and there may be one or more concrete realizations.” from <https://clojure.org/reference/data_structures#Collections>"
1442,1557769963.203,Meagan,"I think it means that the actual underlying type might change, but the interface will stay the same if you have an operation that produces the same collection type; for instance, I believe Clojure maps use a `PersistentArrayMap` under the hood up until a certain size, which then switches to a different type `PersistentHashMap`; for various performance reasons"
1442,1557770057.2051,Becki,"like in scheme and common lisp there are map-hash, map-vector, but in clojure you just use `map`?"
1442,1557770068.2054,Meagan,"this difference is opaque to you, because they have the exact same interface; yes, the seq interface is even more general"
1442,1557770116.2062,Becki,i think F# is kinda annoying in this way.
1442,1557770157.2067,Meagan,"it must have gotten it from OCaml :stuck_out_tongue: `+`, `+.`, oh-my!"
1442,1557770225.2072,Dann,"clojure of course has `+` and `+'`, but the meaning is much different"
1442,1557770314.2082,Bee,<@Lesa> Did you take a look at <https://github.com/RackSec/unclogged>
1442,1557770432.2087,Lesa,"Yes, unfortunately only supports udp/tcp (and is also abandoned)"
1442,1557770807.2089,Bee,"If Unix socket's a hard req I dunno if there's much pre-existing help out there. You can find some other stuff that'll do the JNI lifting for you (e.g. <https://github.com/jnr/jnr-unixsocket>, and I'm inclined to trust Charles Nutters' code...)"
1440,1557770821.2092,Bee,But you're still gonna be doing the Java interop yourself
1442,1557770945.2094,Lesa,"Yeah I'm chatting with our sysadmins to see if they'll consider opening up a plain old net socket, that'll simplify things considerably; jnr-unixsocket looks like a possible option though, much simpler than going the netty route. thanks :slightly_smiling_face:"
1443,1557771420.2111,Bee,:+1:
1442,1557771437.2115,Alaine,"Another question about sequences and collections. In <https://clojure.org/reference/sequences#_the_seq_interface> the `Seq` interface is said to be made of `first`, `rest` and `cons`. Why `empty?` is omitted?"
1443,1557771644.2127,Dann,empty? is just the negation of clojure.lang.RT/seq
1442,1557773435.213,Jasmine,<http://insideclojure.org/2016/03/16/collections/> expands on the question above in a lot more detail
1444,1557773475.2136,Jasmine,"and also in Clojure Applied, ch 2, which has a great picture that I am unable to share with you due to copyright :)"
1443,1557773857.2148,Lemuel,"So, I have a weird problem where I *removed* a circular namespace dependency, and now I'm getting a spec failure on `ns` inside a third party library.  If I put it back, it works.; I'm baffled at how to even debug this.; Thoughts?"
1443,1557774029.2169,Jasmine,maybe share the error?
1443,1557774313.2176,Lemuel,here: <https://gist.github.com/eraserhd/8efd4d3ab0183d2c5375bfd059b582a2>
1443,1557774439.2179,Jasmine,"that was a real spec error, fixed here <https://github.com/pedestal/pedestal/commit/64b8f877590c8bb66341544728da576d8e33124f#diff-5695192ae2429b3d8cf22903401a1be9>; prob your prior cycle was hiding the load of it somehow"
1443,1557774488.2186,Lemuel,"oh, weird!"
1443,1557774516.2188,Jasmine,latest pedestal is 0.5.5; not sure when that was fixed exactly; I guess it was in 0.5.5; you'll only see that fail as of Clojure 1.10.0
1443,1557774758.2208,Lemuel,"welp, I figure you've just saved me three hours of debugging.  I'll buy you some kind of bevarage at the next conj."
1443,1557774817.2212,Jasmine,"no need, happy to help ;)"
1443,1557775186.2219,Alaine,No worries. I have this book
1443,1557788938.223,Jenny,i’ve used <https://github.com/ztellman/gloss> before. e.g. in <https://github.com/wiseman/turboshrimp/blob/master/src/com/lemondronor/turboshrimp/navdata.clj>
1445,1557793559.2246,Nisha,"Is it possible to use items from an lazy seq one by one in order?; For example, repeatedly wait for 1 second and print a number from `(range)`"
1445,1557793716.2271,Vita,yes. loop/recur with first/rest should support that; None; or; None
1445,1557793915.2285,Dann,"or `(run! (fn [x] (Thread/sleep N) (println x)) (range))`; where N is the magic amount of time to sleep between items; or ```(doseq [item (range)]
  (Thread/sleep N)
  (println item))```"
1445,1557794184.23,Nisha,"My real use case is I want to print a lazy-seq of bytes read from socket.
`(repeatedly #(.read (.getInputStream (Socket. ""localhost"" 8888))))))`; Oh! thanks!"
1445,1557794203.2308,Dann,"so you aren't actually sleeping, just a blocking read?"
1445,1557794214.2311,Nisha,"Yeah, a blocking read."
1445,1557794239.2317,Dann,"yeah, I'd use run! if it wraps up nicely in one function, or doseq if you have multiple imperative steps; (and doesn't make sense to abstract the operation as a function for any other usage...); doseq also accepts all the syntactic tricks that for does (but imperative / eager)"
1445,1557794381.2328,Vita,do you mean to open the socket repeatedly? or only read from it?
1445,1557794423.233,Nisha,"oh my bad. I meant only repeatedly reading, not opening."
1445,1557794427.2332,Vita,:thumbsup:
1445,1557794775.2346,Nisha,OK it works! I was previously evaling from vim that’s why it didn’t print anything and hang. I tried it in the repl and it worked as expected. :relieved:; Thanks all
1446,1557802165.2359,Donetta,"Anyone ever get cljfx working with lein?  I'm asking around in <#CGHHJNENB|cljfx> but it seems pretty empty.  I installed the clojars package dependency in project.clj and ran lein deps, but when I try to include the ns, it errors out; not found in classpath etc."
1446,1557803339.2366,Celestine,"What error do you get <@Donetta> and what version of Java are you running?; ```(! 1107)-&gt; java -version
openjdk version ""11.0.1"" 2018-10-16
OpenJDK Runtime Environment 18.9 (build 11.0.1+13)
OpenJDK 64-Bit Server VM 18.9 (build 11.0.1+13, mixed mode)

Mon May 13 20:11:03
(sean)-(jobs:0)-(~/clojure)
(! 1108)-&gt; clj -Sdeps '{:deps {cljfx {:mvn/version ""1.2.9""}}}'
Clojure 1.10.0
user=&gt; (require '[cljfx.api :as fx])
nil
```; Seems to work with Leiningen too ```(! 1109)-&gt; lein new app jfx
Generating a project called jfx based on the 'app' template.

Mon May 13 20:12:02
(sean)-(jobs:0)-(~/clojure)
(! 1110)-&gt; cd jfx

Mon May 13 20:12:05
(sean)-(jobs:0)-(~/clojure/jfx)
(! 1111)-&gt; vi project.clj 

Mon May 13 20:12:46
(sean)-(jobs:0)-(~/clojure/jfx)
(! 1112)-&gt; lein repl
nREPL server started on port 57958 on host 127.0.0.1 - <nrepl://127.0.0.1:57958>
...
jfx.core=&gt; (require '[cljfx.api :as fx])
nil
jfx.core=&gt; Bye for now!

Mon May 13 20:13:18
(sean)-(jobs:0)-(~/clojure/jfx)
(! 1113)-&gt; cat project.clj 
(defproject jfx ""0.1.0-SNAPSHOT""
  :description ""FIXME: write description""
  :url ""<http://example.com/FIXME>""
  :license {:name ""EPL-2.0 OR GPL-2.0-or-later WITH Classpath-exception-2.0""
            :url ""<https://www.eclipse.org/legal/epl-2.0/>""}
  :dependencies [[org.clojure/clojure ""1.10.0""]
                 [cljfx ""1.2.9""]]
  :main ^:skip-aot jfx.core
  :target-path ""target/%s""
  :profiles {:uberjar {:aot :all}})

Mon May 13 20:13:22
(sean)-(jobs:0)-(~/clojure/jfx)
(! 1114)-&gt; 
```"
1446,1557804057.2382,Donetta,"Thanks - let me test - I have used openjfx with  openjdk version ""1.8.0_212"" just fine in the past, but perhaps i'm hitting an issue now.  let me give your samples a try"
1446,1557804091.2388,Celestine,"I've never managed to get it to work with openjdk 8, only Oracle JDK 8 and OpenJDK 11."
1446,1557804199.2396,Donetta,"<https://github.com/ahungry/ahubu> - That was my clojure browser project, it used openjfx, but I didn't use any of the clojurey abstraction libs like fn-fx or cljfx - it basically loads up the openjfx portion via .java files and hooks into it on the clojure side; openjfx with openjdk 1.8 that is; Maybe some class path is hardcoded in cljfx and can't be found under the openjdk hmm; When you got it to work with openjdk 11, was that by building openjfx from source?  or does it shop as part of 11? (or as a separate package like with openjdk 1.8?)"
1446,1557804780.2416,Celestine,openjdk11 does not include javafx -- cljfx brings it in as dependencies I think.; Yeah <https://github.com/cljfx/cljfx/blob/master/deps.edn>
1446,1557805500.2427,Donetta,Thanks - let me give 11 a whirl
1446,1557806735.2432,Celestine,<@Donetta> I figured I'd just try it on Windows PowerShell too
1447,1557807672.2439,Donetta,"ah, what a frustration"
1446,1557807720.2447,Donetta,"seems like I can't get any luck with arch linux and this setup using lein - I can get the require to work without lein using deps, maybe lein isn't needed; is there a way to have lein leverage deps installed from the deps.edn?"
1446,1557808474.2455,Celestine,"<@Donetta> There's a plugin for that -- `lein-tools-deps` I think it's called.; FWIW, we started with `lein` in 2011 at work, switched to `boot` in 2015, and switched completely to `clj`/`deps.edn` last year and we haven't looked back."
1446,1557808566.2469,Donetta,"thanks, maybe that's the best way forward for me as well, I'll have to spend some more time on deps.edn; does anyone in your environment use Emacs/Cider with that setup?"
1446,1557808688.249,Celestine,"We use Socket REPLs and plain text REPLs. I used Emacs for years but switched to Atom (with ProtoREPL at first, but with Chlorine now). My colleague <@Rosaline> uses Emacs but I'm pretty sure he's stopped using CIDER/nREPL these days."
1446,1557808823.2495,Donetta,Thanks again for the advice
1446,1557808853.25,Celestine,I'm a big fan of the simplest possible tools that work and support an effective REPL-driven workflow.
1446,1557809149.2504,Meagan,I use Emacs/CIDER and deps.edn every day. it’s good!
1446,1557809329.2512,Donetta,"Yea, this does seem nice - with nothing more than a core.clj, deps.edn and cljfx as a dependency, I have the sample working now.  I guess the other things I've used in lein, clj can replace as well?  (generating an uberjar etc.?)"
1448,1557809440.2515,Meagan,Ehhh not quite
1446,1557809473.2526,Meagan,There are some libs out there that try to fill those various holes to different degrees
1448,1557809575.2547,Meagan,"In my libraries, I use leiningen to publish. In my apps, I install CLJ on the host I’m running on"
1446,1557810274.2549,Jasmine,<https://github.com/clojure/tools.deps.alpha/wiki/Tools>
1448,1557810292.2551,Jasmine,^^ for libs
1446,1557810511.2559,Celestine,"<@Donetta> We use (my fork of) `depstar` to build uberjars for production deployment. Then we run them with `java -cp path/to/the.jar clojure.main -m entry.point`; I publish libs to Clojars using `clj -Spom`, `depstar` and a `mvn` deploy task.; (and there's a `tools.deps`/`clj` tool for publishing to Clojars if you prefer)"
1449,1557814636.2571,Alaine,"Something is still confusing me:
On one hand, when we call `seq` on a  map we get a sequence that is not indexed, on the other hand `nth` works on it
```
(indexed? (seq {:a 1})) ;; false
(nth (seq {:a 1}) 0) ;;  [:a 1]
```"
1450,1557817331.2602,Vanesa,"Hi, I had a doubt about core.async,
(async/alts!!
   [channel-im-expecting-data (async/timeout 30000)])
What happens to the timeout channel if i get the data from the other channel?
Does my thread get occupied for the next 30 seconds till the timeoutchannel emits something or is it picked up by GC immediately after the alts!! gets the 'winner' channel"
1451,1557820518.2603,Sixta,I'm trying to preserve the type of a collection after calling `map` over it. My attempt of `(into (empty xs) (map f xs))` doesn't work for vectors because it reverses the arguments. Is there any other good tricks for this?
1451,1557820711.2613,Nieves,`((if (vector? xs) mapv map) f xs)` ?
1451,1557820947.2614,Sixta,"That's probably sensible tbh :) although strictly speaking, ` (not= (type (list 1 2 3)) (type (map inc (list 1 2 3))))`"
1451,1557821224.2621,Nieves,"of course, lazy raccoon is not obvious raccoon ); but at most cases it dont need to make him strict before needed )"
1452,1557821922.2648,Nisha,"Hi, related to my previous question about lazy-seq of bytes from a socket:
```
(let [in (.getInputStream (Socket. ""localhost"" 8888))]
  (run! handle-byte (repeatedly #(.read in))))
```
What’s the advantage of doing seq operation here over recursively handling bytes?
Like
```
(let [in (.getInputStream (Socket. ""localhost"" 8888))]
  (loop [b (.read in)]
    (handle-byte b)
    (recur (.read in))))
```"
1453,1557824784.2656,Stasia,"Why are business use cases, like timestamps etc a bad fit for Clojure metadata?"
1454,1557825471.2657,Jolanda,"There’s an overhead to the `seq` abstraction, which at this level is quite significant. If you want to escape procedural code, I advise you turn to transducers"
1452,1557828417.2664,Nisha,"Do you mean the second style, which uses loop and recur, is procedural? And why should I escape it?; The way I see it is, even it’s procedural, it’s just the byte-reading part, which has side-effect anyway. Most of my business logic is inside `handle-byte`, which can still be functional."
1455,1557828681.2698,Antonia,"Hi! I am not sure it’s a right channel, but is there anybody who ever worked with flatbuffers from Clojure? Its Java API seems reasonable, however at first look it does not seem it can be clojure idiomatic enough. I can miss something tho."
1452,1557829041.27,Jolanda,"Yes, it’s not a big deal. Still, what you are doing can be represented as mapping over a bytestream (which also correctly handles when it eventually runs out, unlike the versions you posted).; See for inspiration:
<https://github.com/cgrand/xforms/blob/master/src/net/cgrand/xforms/io.clj#L14>; you can easily implement a `bytes-in` based on this"
1456,1557832865.2707,Brent,"Is `tap&gt;` suitable for data? I send a map to it but REBL shows it only as a string, and only first N characters (30??) so it is useless as most of it is namespaced keys :disappointed: <@Celestine>, you use REBL and tap&gt;, do you know? Thank you!!!
Update: Mouse over shows the whole map for a few seconds, which solves the problem, though I would prefer to be also able to inspect it in REBL's viewer."
1456,1557833321.2712,Zona,"sounds like `business use case` is the definition of data, not metadata :shrug:"
1456,1557833904.2759,Jasmine,"In general, ops in Clojure have strong perf expectations and you’d expect nth to only work on indexed things. However, nth has a fallback mode that does a linear search so it works on seqs. This is the only example like this I’m aware of in Clojure (and I believe it’s probably to support destructuring); Should be data and I believe there was talk about ways to inspect and def as it, but not sure where that is"
1452,1557835207.2777,Alaine,I see. So now I raise back my original question: why `nth` doesn’t work on a map (with an implicit transformation of the map into a seq)?
1456,1557835925.2786,Jasmine,"It’s a collection function, not a sequence function, so does no seq coercion; Since maps are unordered, asking for the nth thing is meaningless; If you explicitly convert to a seq, then you have something ordered, and you can ask the question"
1456,1557836393.2807,Alaine,Would it be accurate to say that seq coercion occurs only   inside functions where the perfs on seq are good?
1456,1557837956.2816,Jasmine,"No, seq coercion occurs on all seq functions ; Not a perf thing"
1457,1557839337.2822,Alaine,What is the exact meaning of a seq function?
1456,1557839766.2824,Jasmine,"the functions described at the bottom of <https://clojure.org/reference/sequences> - functions that take a seqable as last arg and return a sequence (really a seqable); as opposed to collection functions which take a data structure as first argument and operate on the data structure (assoc, conj, nth, disj, contains?, get, etc)"
1458,1557844072.2834,Meagan,<@Brent> are you using nrebl-middleware?
1459,1557846807.2835,Stasia,what about transient business data?
1457,1557848077.2838,Alaine,"I don’t want to drag your attention to unimportant details, but `nth` appears in the list at the bottom of <https://clojure.org/reference/sequences>
Also, I noticed that `last` works on maps"
1460,1557848971.2846,Clarine,"on Windows GraalVM native I get a nullpointer for `io/resource` because `(.getContextClassLoader (Thread/currentThread))` returns `nil`. What should I use instead?; it’s probably a bug in GraalVM, but maybe there’s a workaround?"
1457,1557850172.2851,Jasmine,last is a seq function so coerces to seq
1461,1557850437.2884,Mildred,I’m writing a macro that uses eval to do a series of requires and then uses them inside the body (like `(mymacro (:require [my.ns :as m]) (m/some-fn))`). It works fine except if I use a namespace aliased keyword (like `(mymacro (:require [my.ns :as m]) (m/some-fn ::m/my-kw))`). It throws an error saying it can’t resolve `m`. Curious if this is possible to get working and generally when are namespace aliased keywords resolved?
1461,1557850767.2888,Dann,namespace aliasing is done at read time; which happens before your macro runs
1461,1557850926.2897,Clarine,I believe this is known as the Gilardi scenario; <https://technomancy.us/143>
1461,1557850985.2904,Mildred,"Thanks <@Dann>, that makes sense. <@Clarine> reading…; <@Clarine> interesting article, and i’m already using a wrapping `do` (my macro is based off of the one found here <https://github.com/mfikes/chivorcam/blob/master/src/chivorcam/core.cljc>). AFAICT though, as <@Dann> said, the namespace aliased keyword expansion is happening before anything gets eval’d."
1461,1557851245.2936,Peg,Does anyone have experience with Jib for Clojure containers? What would be required to get that into boot or lein?
1461,1557851259.2941,Mildred,Which I guess means that the compiler is analyzing the file using the requires in `ns` perhaps to do that namespace resolution?
1461,1557851284.2947,Dann,"<@Mildred> one work around would be something like the macro turning `m my-kw` (or anything else that isn't an aliased keyword) into `::m/my-kw` on output; it could be symbols, strings, whatever; it could even convert `:m/my-kw` into `::m/my-kw` - if that makes any sense for the macro internally"
1461,1557851438.2963,Mildred,Sort of implementing my own version of the expansion
1461,1557851523.2977,Dann,yeah - it really depends on what your macro is meant to do
1461,1557851530.298,Mildred,"for this specific case I can work around it by just avoiding those namespace aliased keywords (it’ll be used in a fairly limited way, so that’ll be possible)"
1461,1557851557.2986,Dann,"~also, there's nothing stopping you from just using :my.ns/some-key - :: is never needed, just convenient~ - what you said"
1461,1557851571.2989,Mildred,"right, I did that initially too"
1461,1557851616.2994,Celestine,"<@Brent> Currently, `tap&gt;`'d values in REBL just display as strings -- you can't `datafy`/`nav` into them which is a bit of a shame. I use `tap&gt;` for debugging and being able to see output alone is valuable but, yes, it would be a lot more valuable if you could drill down into `tap&gt;`'d values in REBL like you can with regular values from the REPL. <@Jasmine>; It's also kind of annoying that `tap&gt;` returns `true`/`false` instead of the value you are ""tapping"". Makes it harder to use in a pipeline (you end up with `(doto tap&gt;)` instead of just `(tap&gt;)` and you can only use it with `-&gt;` not `-&gt;&gt;`)."
1461,1557852269.3001,Jasmine,I think we have a CLJ ticket for that
1461,1557855243.3005,Celestine,I don't see one <@Jasmine> -- I searched for both `tap&gt;` and `REBL`.
1461,1557855268.3011,Jasmine,Maybe we’ve just talked about it then
1461,1557855341.3013,Celestine,There's <https://github.com/cognitect-labs/REBL-distro/issues/20> about `tap&gt;` failing altogether in REBL on certain JDK versions (due to a reference to a class that has been removed).
1462,1557855827.3054,Keenan,"Wondering if anyone can help me find a more elegant way to do this. So for this puzzle here <https://adventofcode.com/2017/day/18> I've got a simple parser function to translate an instruction string into an instruction function. It's pretty boiler-platey though. In the end, I want to try multiple regexes to find what I need (with capture) and I want to short-circuit when I've got it (not try all the matches). I don't mind the repetition within regex strings, but the repeated `when-let` is pretty ugly:; None"
1462,1557855935.3061,Dann,"that could be cond; oh, but the destructuring - you want a match type thing that has destructuring built into the clauses"
1462,1557855989.3069,Keenan,Exactly.
1462,1557856219.3078,Dann,"you could do the regex as `#""([a-z]+) (\d+)""` then you can use cond on the a-z; or even case"
1462,1557856364.3097,Keenan,"Sure. I had considered some trick like that, but I guess I was hoping for something a bit more generic for this kind of thing. Not the end of the world, guess I could invest in some macro or something if I do this enough (suprisingly a lot in these AOC puzzles)."
1462,1557856415.3101,Dann,I think one parsing rule then dispatching on data is better than N parsing rules
1462,1557856448.3105,Becki,doesn't `match` work with regex?
1462,1557856464.3107,Dann,match isn't in clojure.core
1462,1557856505.3117,Becki,ah. if that's part of the desire then i suppose its closed off
1462,1557856530.3121,Dann,usually with puzzles like these people aren't able to use deps? dunno
1462,1557856598.3132,Keenan,"I can use whatever (no requirements, just for fun), but for sure I'll prefer things in core or more standard stuff when available."
1462,1557856675.3135,Becki,match is standard even though not core; (imo)
1462,1557856788.3154,Keenan,Right. Can you see how it would fit in with my above example? If it's elegant and not too off the beaten path (not trying to refactor my whole solution into some prolog type thing) I'd for sure consider it
1462,1557857105.3164,Evonne,"<@Keenan> what about something like this:; ```  (defn parse-instruction [i]
    (let [[_ op x y] (some identity
                  [(re-matches #""(snd) (\d+)"" i)
                   (re-matches #""(set) ([a-z]) (\d+)"" i)
                   (re-matches #""(add) ([a-z]) (\d+)"" i)
                   (re-matches #""(mul) ([a-z]) (\d+)"" i)
                   (re-matches #""(mod) ([a-z]) (\d+)"" i)
                   (re-matches #""(rcv) ([a-z])"" i)])]
      (case op
        ""snd"" #(assoc % :snd (Long/parseLong x))
        ""set"" #(assoc % x (Long/parseLong y))
        ""add"" #(update % x (partial + (Long/parseLong y)))
        ,,,
        )))```; Of course as soon as I write that my brain is screaming `defmulti` at me, but …"
1462,1557857187.3177,Becki,i looked back and I just mapped read-string over the strings once they were split by space
1462,1557857241.3183,Keenan,^^^ Haha. That's another way.
1462,1557857257.3189,Becki,here's the evaluator: <https://github.com/dpsutton/advent/blob/master/2017/src/advent/day18.clj#L15> and here's where i prepare the data: <https://github.com/dpsutton/advent/blob/master/2017/src/advent/day18data.clj#L50>
1462,1557857299.3201,Keenan,"<@Evonne> I do like that better, works with the speculative destructuring"
1462,1557857345.3205,Evonne,"It kinda separates it into a lexing step and a parsing step, which I like"
1462,1557857439.3214,Dann,"the code becomes quite a bit simpler if you do the regex once: ```(defn try-number                                                                                                                                      
  [s]                                                                                                                                                 
  (try (Long/parseLong s)                                                                                                                             
       (catch Exception _ s)))

(def instruction-re #""(\w+) (\w+) ?(\w+)?"")                                                                                                           

(defn parse-instruction                                                                                                                               
  [i]                                                                                                                                                 
  (let [[_ op a b] (re-matches instruction-re i)                                                                                                      
        x (try-number a)                                                                                                                              
        y (try-number b)]                                                                                                                             
    (case op                                                                                                                                          
      ""snd"" #(assoc % :snd x)                                                                                                                         
      ""set"" #(assoc % x y)))) ```; oh, I should have read the scrollback :D; I guess speculatively trying to treat everything as a number in order to use only one regex is weird though :/"
1462,1557857635.323,Evonne,"Looks like you could do it with 3 regexes though: op-digit, op-var-digit, and op-var."
1462,1557857645.3232,Dann,that's true; that's probably the most elegant version
1463,1557858000.3247,Nella,you could split on spaces and have a defmulti that dispatches on first. then the defmethod can just take the whole space split line and do what it needs to do with it.
1462,1557858038.3251,Nella,or even just a map of functions that are keyed by the instruction string
1462,1557858297.3256,Evonne,"Yeah, that was what I was thinking as soon as I wrote out the `some`-based version; The nice thing about `some` + regexes is that you can specify that, for example, the `add` operator has to be followed by exactly a 1-character channel name and an integer value.; The multimethod would have to add extra logic to provide those constraints."
1464,1557858569.3285,Leda,"Hey guys, i'm creating a zip file for the client download with Ring. But i want after the user download's it, it automatically deletes the zip file, any ready solutions for that?"
1464,1557858656.3289,Evonne,Maybe this? <https://github.com/clojure-cookbook/clojure-cookbook/blob/master/04_local-io/4-10_using-temp-files.asciidoc>
1462,1557858921.3296,Leda,"yeah i saw this but, deleting when the JVM exits is not a good solution; because it will be always online; it may be a solution by now, but not in the future"
1462,1557858960.3307,Evonne,there’s a line at the bottom showing how to delete the file without waiting for the JVM to exit
1462,1557859002.3312,Leda,"yes, but i don't know how to trigger this delete; i don't know how to tell if a user have tried to access the file, and if he finished downloading or not; i'm trying to figure out something within Ring that does do this"
1462,1557859082.3326,Meagan,you might consider deleting after a certain period of time. in case the user needs to re-try downloading it
1462,1557859101.333,Leda,yeah that's good too
1462,1557859118.3336,Meagan,"something like 10 mins / 20 mins / 1 hr, whatever you feel is best"
1462,1557859145.3341,Leda,"but in that case, there is any sort of lib that does this kind of job? runs a function every X minutes?; but the function would need to be specific to each created resource, because every resource has a different trigger time; wow, that seems to be hard to scale"
1462,1557859253.3357,Meagan,"there’s a few libs out there for running tasks on a timer. I’ve used <https://github.com/juxt/tick>; you could probably run it on a batch process: every 10 mins or so, run a function that checks if any files are over their expiration time and if so, delete them"
1462,1557859301.3376,Evonne,"I would probably do something like: have a task that checks the temps/ directory every few minutes, get the create-datetime for each file, and if the file is older than “X” minutes, delete it."
1462,1557859310.3379,Meagan,jinx! :smile:
1462,1557859313.3382,Leda,sounds good
1462,1557859320.3384,Evonne,"Lol, typing and not reading; The nice thing about periodically “sweeping” is that if your app crashes and restarts, it’ll automatically clean up after itself."
1462,1557859401.3395,Leda,"i'll check this `tick`library and see if i can create the task, thanks guys"
1462,1557859823.3421,Fatima,<@Leda> if you need something solid and scalable I recommend pushing the zip-files to AWS S3 and programmatically generating download URL that’s valid for x seconds. It’s a pretty common use-case.
1462,1557860047.3445,Leda,"wow, that sounds nice, definitely i can possibly use this later on, after my beta phase is over...; but i'll have to study this later, because my zip files vary from 10mb to 200mb, and i don't want the user waiting to download for too long..."
1462,1557860276.3483,Fatima,You don’t either want that your servers fill up from the zip-files and crash. :slightly_smiling_face:
1462,1557860323.3485,Leda,that's also true haha
1465,1557860459.3493,Sheron,"for the cases of ""user has to download some generated content"" - as my stuff is on aws i would definitely put the downloadable thing on s3"
1462,1557860470.3496,Sheron,"and tell the user to get it from there, maybe directly, maybe via a redirect"
1465,1557860539.35,Sheron,streaming big stuff out to possibly slow clients from your appserver is just looking for trouble :slightly_smiling_face:
1462,1557860566.3504,Fatima,"Yep, it’s a good idea to offload all the nasty bits to Amazon. :wink:"
1462,1557861971.3515,Alaine,"according to the previous definition, `last` is not a seq function as it doesn’t return a sequence"
1466,1557862242.3526,Dann,<@Leda> what if the zip never had to be a file? you can provide a download that's simply bytes generated into your output; this isn't something that ever needs to touch a file system; (or worst case you can use a file system that's just in-process heap memory - which guarantees cleanup when the process exits anyway)
1466,1557862589.3536,Jasmine,"ok, ""most"" return a sequence :)"
1467,1557871556.356,Onita,"hey everyone. i’m trying to work out a really simple example of parallelization to see if i can get some performance increase. is there any way i could potentially parallelize `(apply min-key second {1 2 2 3 3 4 .. })`?; my first thought was something like splitting the list into `n` components and then running `pmap` across them, but i feel like the overhead would dominate"
1467,1557871751.357,Celestine,<@Onita> How big is that map likely to be?
1467,1557871775.3573,Onita,"let’s say on the order of 1000s; this function would likely run super hot however, so any improvement would help"
1467,1557871977.3587,Celestine,`clojure.core.reducers` will probably help you here -- `r/fold` can do work in parallel.
1467,1557872007.359,Onita,"cool, thanks. i guess this is a good excuse to dive into that library"
1467,1557872027.3593,Celestine,<https://clojure.org/reference/reducers#_reduce_and_fold> should get you started
1467,1557872499.3599,Dorla,"<@Onita> using `val` instead of `second` is ~2x faster on my laptop:
```
(def m (zipmap (range 1000) (range 1000)))

(require '[criterium.core :refer [bench]])
(bench (apply min-key val m))
;;  Execution time mean : 41.214976 µs
(bench (apply min-key second m))
;; Execution time mean : 100.534521 µs
```"
1467,1557872539.3602,Onita,"wow. good find, thanks"
1468,1557874573.3614,Jasmine,"second walks it through the key, val is an indexed lookup; and particularly special-cased for map entries"
1469,1557878081.3622,Elaine,Why `last` is slower then `val` ?; `val` performs like `#(nth % 1)`
1469,1557878162.3628,Celestine,"<@Elaine> ```user=&gt; (source val)
(defn val
  ""Returns the value in the map entry.""
  {:added ""1.0""
   :static true}
  [^java.util.Map$Entry e]
    (. e (getValue)))
nil
```; `val` is a fast operation on a `MapEntry`; You can't call `val` on an arbitrary two-element vector :slightly_smiling_face:"
1469,1557878312.3643,Elaine,"`last` is linear time :open_mouth:
I thought that last was constant time in counted structures"
1470,1557879194.3647,Celestine,"You're thinking of `peek` perhaps?; ```user=&gt; (doc peek)
-------------------------
clojure.core/peek
([coll])
  For a list or queue, same as first, for a vector, same as, but much
  more efficient than, last. If the collection is empty, returns nil.
nil
```"
1469,1557879356.3655,Elaine,"```
user=&gt; (time (apply min-key val m))
""Elapsed time: 842.254296 msecs""
[0 0]
user=&gt; (time (apply min-key peek m))
""Elapsed time: 838.988506 msecs""
[0 0]
user=&gt; (time (apply min-key last m))
""Elapsed time: 2076.809707 msecs""
[0 0]
user=&gt; (time (apply min-key second m))
""Elapsed time: 1531.45713 msecs""
[0 0]
```
peek performs like val :slightly_smiling_face:
second is slow
last is slower"
1469,1557879504.3665,Onita,could someone help me understand what’s happening in the combine step of a fold when it’s called with no arguments?; having trouble getting my head around it
1470,1557879715.3679,Celestine,"<@Elaine> Yup, `peek` is special-cased for performance and seems to work just fine on `MapEntry` objects too ```user=&gt; (let [x (first {:a 1})] (quick-bench (val x)))
Evaluation count : 91382334 in 6 samples of 15230389 calls.
             Execution time mean : 4.912437 ns
...
user=&gt; (let [x (first {:a 1})] (quick-bench (peek x)))
Evaluation count : 92238174 in 6 samples of 15373029 calls.
             Execution time mean : 4.878394 ns
...
```; ```user=&gt; (let [x (first {:a 1})] (quick-bench (last x)))
Evaluation count : 4457562 in 6 samples of 742927 calls.
             Execution time mean : 139.544772 ns
...
user=&gt; (let [x (first {:a 1})] (quick-bench (second x)))
Evaluation count : 7887582 in 6 samples of 1314597 calls.
             Execution time mean : 76.811493 ns
...
``` Big difference in this case.; <@Onita> Both the reducef and the combinef can be called with no arguments, and should return the identity element.; Since you're looking for a minimum, I would imagine you'd need to return a ""maximum"" int value so all other values are smaller?"
1470,1557880407.3705,Onita,"yeah i think that’s where i got stuck, trying to conceptualize what the identity element of an application of `min-keys` would be"
1469,1557880415.3708,Onita,but i guess that makes sense
1470,1557881371.3715,Celestine,"It's a little odd in your case <@Onita> because your ""identity"" is to return an arbitrary `MapEntry` that contains a maximum value.; Your reducef could look like this: ```(defn mk ([] (clojure.lang.MapEntry. nil Long/MAX_VALUE)) ([a x] (min-key val a x)))```; and then you'd do ```(r/fold mk (seq your-giant-map))```; (you need the seq there, otherwise you seem to get a `reduce-kv` style call of your reducef with the accumulator, the key, and then value); (although I wonder if calling `seq` here defeats some of what `r/fold` can do? I haven't experimented much with it...)"
1471,1557884572.3744,Onita,"hmm, ok, let me give this a try; so i’ve got this, which at least returns the correct result
```
(defn faster-mk [m]
  (fold (fn reducef
          ([] [nil Long/MAX_VALUE])
          ([a b] (min-key second a b))
          ([a b c] (min-key second a [b c])))
        (seq m)))
```; but it seems to perform worse than the serial version, even for large sizes of `m`. tbc; you may be right about the `seq`.; in fact, it’s on the order of 100x worse; actually, the results are unclear. still testing"
1471,1557886429.3777,Celestine,"Use `(clojure.lang.MapEntry. nil Long/MAX_VALUE)` and `(clojure.lang.MapEntry. b c)` instead of vectors. Use `val` instead of `second`. Don't `seq` the map.; ```(defn faster-mk [m]
  (fold (fn reducef
          ([] (clojure.lang.MapEntry. nil Long/MAX_VALUE))
          ([a b] (min-key val a b))
          ([a b c] (min-key val a (clojure.lang.MapEntry. b c))))
        m))``` that should be faster; (although when I tested `(apply min-key val large-map)`, that was pretty fast)"
1471,1557886582.3797,Onita,"yeah, the simple version seems better. interesting; although, that example helps a lot in understanding fold"
1471,1557886644.3809,Celestine,"I tried it with a 20,000 element hash map... I think there's just not enough computation in there to benefit from concurrent execution?"
1471,1557886650.3811,Onita,"yeah. seems like it.; for my usage i don’t think i should optimize for maps consistently larger than 50k.; all the same, thanks a lot for your help"
1471,1557886952.3825,Celestine,"It's an interesting little puzzle :slightly_smiling_face: Happy to help!; Once you get up to 50k, there's more of a difference ```user=&gt; (let [v (into {} (take 50000 (repeatedly #(clojure.lang.MapEntry. (rand-int 10000) (rand-int 10000)))))] (quick-bench (apply min-key val v)))
Evaluation count : 1206 in 6 samples of 201 calls.
             Execution time mean : 522.122368 µs
...
user=&gt; (let [v (into {} (take 50000 (repeatedly #(clojure.lang.MapEntry. (rand-int 10000) (rand-int 10000)))))] (quick-bench (r/fold mk v)))
Evaluation count : 3420 in 6 samples of 570 calls.
             Execution time mean : 172.390103 µs
...```; (weirdly I'm seeing more of a difference at 20k than I did before -- benchmarking can be weird)"
1472,1557889368.3842,Onita,would it be bad practice to check how big a thing is before deciding how to operate on it?; `(if (&gt; (count thing) 20000) (parallel) (serial)))`
1471,1557891360.3855,Celestine,"<@Onita> If you know the performance changes at a particular size, that seems very reasonable."
1473,1557910056.3874,Ivana,"I'm observing weird behaviour around watches on a ref. Any idea what's wrong? <https://gist.github.com/jeroenvandijk/90650bd5d4b8e3ba346e3483bf70d3ab>; ```(let []
  (def ^{:flag 1} v 1))

(def ^{:flag 2} v 2)

(add-watch #'v ::listener (fn [_key _ref old-value new-value]
                            (println ""old "" old-value "", new"" new-value ""new-meta "" _ref (select-keys (meta _ref) [:flag]))))
 ``` Wrapping the def in a let block ""fixes"" the meta assignment"
1473,1557911584.3889,Edwina,the watch function will be called *before* the var’s value will be set; None
1473,1557911759.3911,Ivana,that doesn't seem to be the case for when it is wrapped in the let block; there is an inconsistency if i didn't make a mistake myself; In this gist you can see a sequence of evaluations that show this inconsistent behaviour
1473,1557911892.3925,Edwina,yeah seems there’s a difference indeed; though this probably falls under “that’s not what you’re supposed to use it ffor”; you’re also not guaranteed to have the state of the ref immediately before or after setting the value
1473,1557912262.3967,Ivana,"yeah i can imagine combining meta, watches and vars is not very common. You might be right :slightly_smiling_face:"
1473,1557912264.3969,Edwina,""" Note that an atom’s or
  ref’s state may have changed again prior to the fn call, so use
  old/new-state rather than derefing the reference. Note also that watch
  fns may be called from multiple threads simultaneously”"
1473,1557912303.3978,Lavonia,"Sorry for interjecting but I believe we are talking about vars here, not refs."
1473,1557912312.3981,Edwina,yeah.
1473,1557912312.3982,Ivana,But note the value of the var (`_ref`) is given to the watch function so it's not doing a deref
1473,1557912348.3991,Lavonia,"No, the `_ref` argument is the box the holds a value; Not the value itself; The third and fourth args are old and new values in the box which is the second arg"
1473,1557912374.4001,Ivana,The value of the ref i mean
1473,1557912374.4002,Edwina,"yes but the meta data on the var is mutable.; and you’re setting the meta of the var, not of the value; see alter-meta!"
1473,1557912410.4014,Lavonia,"Exactly. This meta is on the box (var), not the value in the box; Still doesn't explain the different behaviour  in the let though"
1473,1557912447.4026,Ivana,so `(meta some-var)` is doing an implicit deref on `some-var` if that's correct
1473,1557912452.4027,Lavonia,"I found the same thing's happening in my REPL:```user=&gt; (declare a)
#'user/a
user=&gt; (add-watch #'a ::listener (fn [_ ref old-val new-val] (pprint {:old-val old-val :new-val new-val :meta (select-keys (meta ref) [:flag])})))
#'user/a
user=&gt; (def ^{:flag 1} a 1)
{:old-val
 #object[clojure.lang.Var$Unbound 0x5e26f1ed ""Unbound: #'user/a""],
 :new-val 1,
 :meta {}}
#'user/a
user=&gt; (def ^{:flag 2} a 2)
{:old-val 1, :new-val 2, :meta {:flag 1}}
#'user/a
user=&gt; (def ^{:flag 3} a 3)
{:old-val 2, :new-val 3, :meta {:flag 2}}
#'user/a
user=&gt; (let [] (def ^{:flag 4} a 4))
{:old-val 3, :new-val 4, :meta {:flag 4}}
#'user/a
user=&gt; (def ^{:flag 5} a 5)
{:old-val 4, :new-val 5, :meta {:flag 4}}
#'user/a
user=&gt; ```"
1473,1557912536.4047,Edwina,"vars have an identity, and you can change the metadata on the var, so yeah it works *like* deref, but it’s not a deref since the deref gets the associated value instead of the metadata"
1473,1557912536.4048,Lavonia,The symbol `some-var` gets evaluated to a var(box) which is then deref'ed and the metadata on that value is given
1473,1557912545.405,Edwina,not really in this case; `ref` here is really `#'a`
1473,1557912609.4063,Lavonia,"```user=&gt; (def ^{:var-meta 1} a ^{:value-meta 2} {:value-itself 3})
{:old-val 5, :new-val {:value-itself 3}, :meta {:flag 5}}
#'user/a
user=&gt; (meta a)
{:value-meta 2}
user=&gt; (meta #'a)
{:var-meta 1, :line 1, :column 1, :file ""NO_SOURCE_PATH"", :name a, :ns #object[clojure.lang.Namespace 0x1cf336fd ""user""]}
user=&gt; ```; This might elucidate the difference."
1473,1557912655.4073,Edwina,so you’re dealing with the var `a` and that var has metadata which can be set directly (by `def` in this case); you can also set the meta data using `alter-meta!`
1473,1557913176.4095,Ivana,"Thanks guys. I'm trying to make something work for a naive user that set a meta flag on a var so options like `alter-meta!` are good, but not what i'm after. Maybe I'll have to manage expectations instead!"
1473,1557913211.4098,Harris,redeffing a var with `def` is not a good idea anyway (other than in dev)
1473,1557913539.4115,Ivana,"I don't think i'm doing explicit deref-ing. It's documented that watches support var's here and they get the var <https://clojuredocs.org/clojure.core/add-watch> . But if (meta some-var) is an implicit deref you might be right; or maybe i should *not* rely on the metadata of a var, since like Joost said, it is a mutable reference"
1473,1557914660.4126,Brent,"thank you , Sean! Let's hope it will be getting. better..."
1473,1557914749.4137,Edwina,"If you can, you might want to switch to using the meta data on the value instead. ; Depends on your use case of course "
1473,1557915087.4157,Ivana,I'm doing weird stuff with monitoring vars so I don't have that option for this use case; I'll look into sayid to see how they do this <https://github.com/clojure-emacs/sayid/blob/8ea70573e6eb1a0d1a450fd501f38c2cf26ce27f/src/com/billpiel/sayid/trace.clj#L134>
1474,1557915575.4168,Roselia,"any ideas why map-indexed 3 times faster on avg 580 vs 140 ms for 1m entries?
(map vector (iterate inc 0) v)
(map-indexed #(vector %1 %2) v)"
1474,1557920403.4184,Sixta,"<@Roselia> map does not handle chunks when given multiple sequences, that might be why."
1475,1557924252.4225,Donita,"Morning all - I am considering starting a side project to create a clojure to Dart compiler mainly for fun but also with mind to use it to create Flutter apps. What would be the best compiler to work from as a base - Clojure, ClojureScript or CLR? Dart is single threaded so more like JavaScript but the syntax is closer to java/C#. Thoughts?"
1476,1557924392.4242,Noble,"Hi everybody, I got an issue what I don’t really understand.
I am trying to import a protocol to my namespace and then use `satisfies?` to check an instance. In my ns I have the following: `(:import taoensso.carmine.connections.IConnectionPool)`, but when I try to use it like `(satisfies? IConnectionPool """")` then it throws an NPE; ```               clojure.core/eval          core.clj: 3214
                             ...
      boot.user$eval34439.invoke                  :    1
boot.user$eval34439.invokeStatic                  :    1
         clojure.core/satisfies?  core_deftype.clj:  569
 clojure.core/find-protocol-impl  core_deftype.clj:  536
          clojure.core/instance?          core.clj:  144
java.lang.NullPointerException:```; am I doing something wrong?"
1476,1557924990.4251,Jasmine,"For use in this way, you should require, not import; It’s a little confusing, but IConnectionPool here is both a var (the protocol map), and an interface (generates internally); satisfies expects the former"
1476,1557925417.428,Noble,thank you <@Jasmine> it fixed the problem
1476,1557925757.4282,Jolanda,<http://clojuredocs.org/clojure.core/satisfies_q#example-5cdc105ae4b0ca44402ef725>
1476,1557925855.4288,Noble,thanks <@Jolanda> I’ve checked the <http://clojuredocs.org|clojuredocs.org> first if there is an example like that; but there have been none yet :slightly_smiling_face:
1476,1557925881.4294,Jolanda,"making the world a better place, one clojuredoc at a time :stuck_out_tongue:"
1477,1557928510.4315,Virgil,what's the latest preferred way to profile Clojure code ? I want something similar to Smalltalk's `MessageTally` which returns a tree with time spent at each branch (in Smalltalk's case that's messages in Clojure it would be function applications)
1477,1557928568.4317,Min,<https://github.com/clojure-goes-fast/clj-async-profiler> is not bad
1478,1557940862.4329,Celestine,"Oh, I'm sure Cognitect will continue to improve REBL..."
1478,1557940874.4331,Jasmine,indeed
1479,1557942512.4336,Melynda,"Hello!

Is this a known issue with Clojure 1.10.0?

```
user=&gt; (declare foo)
#'user/foo
user=&gt; (def wrap-foo (partial foo ""hello""))
#'user/wrap-foo
user=&gt; (defn foo [s] (print (str s "" world!"")))
#'user/foo
user=&gt; (wrap-foo)
Execution error (IllegalStateException) at user/eval2006 (REPL:1).
Attempting to call unbound fn: #'user/foo
```"
1479,1557942585.4342,Rosaline,"that isn't a bug; partial is a function, which means its arguments are evaluated; foo is a declared var that doesn't have a value; so when evaluated the ""foo"" passed to partial, the result is a special object designed to catch these kind of bugs when it is invoked"
1479,1557942699.4366,Melynda,Why does it not throw right away?; i.e. when defining wrap-foo
1479,1557942732.4377,Rosaline,because then it would have to operate in such a way as to make declare useless
1479,1557942757.438,Suzann,"```
Clojure 1.10.0
user=&gt; (declare foo)
#'user/foo
user=&gt; (def wrap-foo (partial (var foo) ""hello""))
#'user/wrap-foo
user=&gt; (defn foo [s] (print (str s "" world!"")))
#'user/foo
user=&gt; (wrap-foo)
hello world!nil
```

Just to show what <@Rosaline> is saying even more clear. If instead of `foo` you refer to the var, it works how you want it to.; The var here defers the look up."
1479,1557942790.4388,Melynda,"Ah, so when I `declare` something I have to use `var`?"
1479,1557942794.439,Rosaline,"```
user=&gt; (declare foo)
#'user/foo
user=&gt; (def f #(foo ""bar""))
#'user/f
user=&gt; (defn foo [s] (str ""foo"" s))
#'user/foo
user=&gt; (f)
""foobar""
user=&gt;
```; using partial at the top level like without understanding that partial is just a function, so it's arguments are evaluated like any other function at call time is a common source of bugs"
1479,1557942904.4417,Suzann,"<@Melynda> Not sure why you are writing code like this. If you are just playing around with things, sure. But I wouldn't expect to see declare in actual code."
1479,1557942909.4418,Rosaline,"```
user=&gt; (def x 1)
#'user/x
user=&gt; (def f (partial + x))
#'user/f
user=&gt; (def x 3)
#'user/x
user=&gt; (f 0)
1
user=&gt;
```"
1479,1557942984.4426,Melynda,Thanks. So I generally should use `var` in this case? Or is there a better / more recommended way?
1479,1557943078.4444,Dann,<@Melynda> what are you trying to do? just define things out of order (that's the usual usage of declare); usually instead of using `(var x)` explicitly we use the reader macro `#'x` which expands to the same thing
1479,1557943117.4461,Rosaline,the best advice is don't use partial for top level functions like that
1479,1557943117.4462,Melynda,"<@Suzann> I have a map that contains coercion functions as values (and the keys they shall be applied to as keys). And one of these coercion functions calls other functions that will eventually make use the the coercion map again. So in theory this setup is cyclic, but in practice it is not, because the data structures it operates on are not cyclic."
1479,1557943165.4469,Dann,"<@Melynda> if the functions can all be defined in one form, there's `letfn` that allows cyclical references between the functions it creates in local scope; another variant is to have every fn take an argument containing a hash-map that includes all the other fns - that way, you can even add more functions at runtime or from another namespace"
1479,1557943419.45,Melynda,"So the data structure I operate on looks like this:
```
[{:foo 1
  :bar {:foo 2 ...}}
 {:foo 3 ...}]
```
And in these few instances where the object contains a ""sub object"" in the :bar key, I want to apply the same coercions to the sub object, which is why I need access to the coercion map."
1479,1557943514.4509,Dann,sounds like it could be a job for `clojure.walk/prewalk` with a function testing for map entries and calling a multimethod on key
1479,1557943737.4519,Melynda,"Hm, thanks. I never considered this to be a full walk, because :foo 2, the object under :bar, is of a different type that never contains other sub objects."
1479,1557944245.4528,Dann,"prewalk is a blunt tool, agreed, but it might lead to simpler code"
1479,1557944390.4534,Melynda,"I will try that. :slightly_smiling_face:; Might reduce the amount of code.; Thanks <@Suzann>, <@Rosaline>, <@Dann>!"
1479,1557944568.454,Dann,"one more note: I specify prewalk rather than postwalk specifically because you can't test for map-entries in postwalk (the code turns them into two element vectors, and that works fine for hash-map, but it removes a distinction you likely need to check for, prewalk avoids that issue)"
1479,1557944596.4542,Melynda,Thanks!
1479,1557944792.4548,Sherice,"I am trying to create a vector-based zipper where the children of a node are (next node).
For navigating around, this works fine:
```(defn vec2zip
    ""Return a zipper where the children are (next node).""
      [root]
     (z/zipper vector? next (fn [n c] (into n c)) root))```

But editing doesn't work as I'd expect:

```(-&gt; (vec2zip [:X [:A] [:B] [:C]]) z/down (z/insert-child [:a]) z/root)
[:X [:A] [:B] [:C] [:A [:a]] [:B] [:C]]```

Am I doing something stupid? I tried to attach metadata in the children and make-node functions, but it doesn't seem to stick. Might that be the problem?"
1479,1557945080.4555,Dann,<@Sherice> have you looked at `z/vector-zip`? - or is the point to implement this from scratch as an exercise?
1479,1557945109.4561,Rosaline,because n is the existing vector
1479,1557945120.4565,Sherice,I looked at z/vector-zip but it really doesn't seem to have the semantics I want.
1479,1557945130.4569,Dann,how so?
1479,1557945133.457,Rosaline,you need something like (into [(nth n 0)] c)
1479,1557945212.458,Sherice,"<@Dann> the children don't 'have names', if that makes sense."
1480,1557945224.4583,Sherice,<@Rosaline> let me try this.
1479,1557945334.4588,Rosaline,I would strongly recommend using maps instead of vectors for tagged data like this; the built in xml-zip basically has the semantics you want; (using maps with {:tag tag :children children})
1479,1557945440.461,Sherice,"<@Rosaline> Yeah, I have that working just fine with {:n :X :c [{:n :A} {:n :B} {:n :C}]} for example. Just gets a bit busy.; ```(defn map2zip
  ""Return a zipper for a map representing a plan.""
  [root]
  (z/zipper map? :c (fn [n c] (assoc n :c (vec c))) root))```; Thanks <@Dann> and <@Rosaline>. I've tried everything I can think of. Given what I've seen, I agree that maps are the best approach."
1481,1557949553.4651,Katherina,"Hello, what is the equivalent of `:java-source-paths` of leiningen in tools.deps? Some of my code is in Java and I really wanna use it as it is."
1481,1557949789.4655,Jasmine,tools.deps does not support java compilation; you can use it in combination with javac etc if you want that to work; or you can split your project into java-only and clojure-only parts and have the latter depend on the former
1481,1557949922.4672,Katherina,ah okay. Thanks for the info <@Jasmine> Is java compilation planned soon? Really love using tools.deps!
1481,1557950094.4692,Jasmine,"not planned - deps does a) dependency resolution, b) classpath building, c) program launching"
1481,1557950154.4708,Katherina,got it. thanks again :smile:
1481,1557950178.4713,Mona,"Are there any books on Clojure that explain it's philosophy as opposed to just teaching syntax? I am interested in learning about choices Rich made and trade-offs resulting from those choices. I know he talks about it in his talks but I would like (if it exists) to have a single place with all this information, so to say. To *understand* Clojure, not only to _learn_ it"
1481,1557950236.4723,Jasmine,"probably the best you'll get for that are either talks by Rich, or the <http://clojure.org|clojure.org> reference pages, or in book form - Programming Clojure (written by Stu Halloway and latest revised by me, both of us working with Rich)"
1481,1557950358.4727,Mona,"It's amazing to get an answer in less than a minute, and especially from you Alex! :slightly_smiling_face: Thank you! I love this community :heart:"
1481,1557950549.4729,Jasmine,<https://github.com/matthiasn/talk-transcripts/tree/master/Hickey_Rich> &lt;- more time efficient than watching videos; sibling dirs contain other relevant stuff probably
1481,1557950576.4733,Antwan,"if it is transient and doesn't matter, then it doesn't matter and you shouldnt bother keeping it; if it matters, then it is part of your data and it shouldnt be metadata"
1481,1557950625.4739,Jasmine,or <https://www.youtube.com/playlist?list=PLZdCLR02grLrEwKaZv-5QbUzK0zGKOOcr> :)
1481,1557950636.4741,Mona,thank you!
1481,1557951300.4747,Jasmine,that was missing some videos so I added them and reverse date sorted; the talk Rich did at JavaOne years ago is actually a pretty great intro <https://www.youtube.com/watch?v=VSdnJDO-xdg>
1482,1557951464.4752,Brent,"Hi, I am no expert but I would believe that Cljs is best because it was written after Clojure, with lessons taken from it (e.g. relies heavily on protocols rather than Java interfaces).  Also.
Clj and CLR emit bytecode while you likely want to emit code. Cljs uses Google Closure heavily - not sure whether there is something similar for Dart."
1481,1557951576.4754,Jasmine,"not in learning the language, but why the language exists"
1481,1557951617.4756,Mona,"Thank you, again!

Meanwhile, I've ordered your book :blush:"
1482,1557951819.4758,Jasmine,they make great gifts - buy 10!
1483,1557953321.4816,Viki,"Asking for the most ideomatic approach: suppose we have a mutual recursion
```
(defn a [x] (if .. (b x))
(defn b [x] (if ...(a x))
```
Now I’d like to inject another arg `y` into `a` but in order to do so I also have to:
1) change `b` *arity* (in case b call a not directly but there’s a longer call chain it gets tedious).
2) Another variant is introducing a *dynamic* var and do `binding` across everything (but it becomes opaque and var always means toplevel)
3) in case x is even not `{}` I could handle it with metadata containing `y` (looks like a hack)

What would you prefer?  (please vote) Am I missing yet another approach?

In short: 1=explicit pass args | 2=implicit | 3=hack"
1483,1557953369.4822,Shayla,can you write out the two implementations?
1483,1557953413.4826,Dorla,3) Use `(declare b)` before defining a?
1483,1557953448.4828,Viki,"See here <https://github.com/DomainDrivenArchitecture/smeagol/blob/master/src/smeagol/formatting.clj#L159>
I’d like to add an arg to `process-text`; Sorry, maybe I expressed myself not clearly, I know how to define/declare, the question is actually -&gt; pass something explicit or implicit"
1483,1557953551.4834,Celestine,"Also <@Mona> you can get quite a good sense of philosophy and the ""Why?"" of Clojure from The Joy Of Clojure book, if you haven't already read that."
1483,1557953880.4846,Viki,"maybe ideal situation is when x is a `{}` and passing around `(assoc x)` is very cool, but in this case it’s not :confused:"
1483,1557953989.4869,Bee,"Given it's mutual recursion with two fns colocated next to each other in the same file and calling each other directly, I'd add an explicit argument (and maybe another arity so clients can maintain their present interface)"
1484,1557953998.4871,Jin,"hey ya'll, what are people using for repl autocomplete etc when using just `clj` instead of leiningen? Is reply still common?"
1483,1557954144.4875,Viki,"yeah, preserving interface makes 1. even more verbose :disappointed:

this situation makes me think one more time that only passing hashes around rocks; use another main :slightly_smiling_face: <https://github.com/bhauman/rebel-readline> (uses `compliment` library for autocomplete, same as reply afair)"
1483,1557954748.4881,Lane,For this specific example you linked to I would get rid of those auxiliary functions. The 4 arguments passed around add a lot of cognitive overhead and the body of these functions don't do much.
1483,1557954943.4883,Viki,"yep, a valid point :+1: but still, it’s not always an option to incorporate everything inside a single scope; but I also aware that recur is more optimal than trampolines (which are even omitted in this case -&gt; stackoverflow possible); still, people often argue about scala implicits but they’re really handy instead of passing smth around"
1485,1557956554.489,Lane,"I agree, I use dynamic vars when I have a context to pass everywhere or to pass through a long list of functions that do nothing with it other than forwarding it."
1483,1557956965.4899,Antwan,<@Viki> I'm still not super clear about the context here
1486,1557956980.4903,Antwan,"does your ""y"" change over the course of the mutual recursion?"
1483,1557957229.4908,Viki,"yes it does, but only in `a`; `b` could only pass it around"
1487,1557962803.4921,Jin,:+1:
1488,1557967816.4931,Sebrina,"With something like ring, is it normal to layer your middleware from most app specific to most general?
```
(-&gt; handler
    middleware-a
    middleware-b
    middleware-c)
```"
1488,1557968567.4934,Rory,"Yes, I normally stack them from application to configuration middlewares.

```
(-&gt; handler
      api-middleware-a
      api-middleware-b
      wrap-json-response
      wrap-gzip
      wrap-errors
      ;; etc...
)
```

I hope that make sense :slightly_smiling_face:"
1488,1557968882.4937,Sebrina,"Yes, exactly what I was trying to find out!; If you have something that deals with authentication where would you put that?"
1489,1557972331.4941,Celestine,"That will depend on where in the process you want the auth to apply. We've taken different approaches with different apps, depending on exactly what we need."
1490,1557973214.4945,Modesto,"Is there a macro library for supporting 'array syntax' in Clojure?  If not, is it feasible to write one?  How does a macro like that work - do you sort of deal with the list elements as strings and break them apart to understand what to do?  This is something like what I had in mind:
```
(def a (double-array [1.0 2.0 3.0])
(macroexpand '(array-syntax a[0])            ; =&gt; '(aget a 0)
(macroexpand '(array-syntax a[0] = 4.0)  ; =&gt; '(aset a 0 4.0)
```"
1490,1557973475.4947,Rosaline,"no; macros are code -&gt; code transformations, the input has to be well formed code"
1490,1557973619.4976,Meagan,You can actually cheat here by abusing the fact that the Clojure reader will read a[0] as the symbol a and the vector with one element 0
1490,1557973648.4984,Rosaline,"you cannot; because there are places where you want a single thing, and the reader will not read in a[0] as a single thing"
1490,1557973691.0004,Roselia,"reader macros are not extensible for this very reason, because in other lisp people started to create new syntax constructions incompatible with code as data paradigm; correct me if i'm wrong"
1490,1557973974.0032,Meagan,"Not sure I understand why that would break anything <@Rosaline>. If the macro reads a then [0], seems like you can key off that appropriately in the simple cases specified"
1490,1557974006.0037,Roselia,"[0] is a vector of 1 element, multiple of such simple cases will make language unbearable to learn, look at scala's underscore"
1490,1557974054.0038,Sebrina,That makes sense. Thanks! After a bit of trial and error the sweet spot for me is between general configuration middlewares and the APIs.
1490,1557974396.0046,Shayla,"Yeah, sadly, clojure doesn't allow for reader macros, unlike Racket"
1490,1557974492.005,Meagan,I'm not say anyone should do this :joy:
1491,1557974671.0064,Jaimee,"Hi everyone, I have a memory leak problem with my clojure program, I am trying to debug it with yourkit however the heap usage does not change, I only see the ram usage increase constantly with `htop`, not sure how to find where the leak is"
1491,1557975026.0072,Antwan,"I think i badly misunderstand how namespaced keywords work; ```
::http/routes
=&gt; :io.pedestal.http/routes
```; i am not in the `:io.pedestal.http` namespace; i thought `::symbol` would resolve to `:my.ns/symbol`"
1491,1557975130.0096,Meagan,I bet you have aliased io.pedestal.http to http tho
1491,1557975138.0098,Antwan,...that would do it; ooooh that makes sense
1491,1557975202.0123,Meagan,That's correct if it is in the last part. If you do ::foo/bar it will look up the symbol foo as an alias in your current ns
1491,1557975207.0125,Antwan,"`::alias/thing` goes to `:full.path.of.alias/thing`; new issue; i have a macro which reads a resource from the classpath to generate functions; I think i need to go AOT for the program i am working on; during compilation i cant find that file; ...okay scratch that question; just like 9/10 times AOT isnt needed; but i still need to figure out how to get the clojure files into the jar; not sure where to put
```
            &lt;resources&gt;
                &lt;resource&gt;
                    &lt;directory&gt;src/main/clojure&lt;/directory&gt;
                &lt;/resource&gt;
            &lt;/resources&gt;
```"
1491,1557978598.0161,Jasmine,"if you're using a pom, I think that goes in &lt;build&gt;"
1491,1557978792.0163,Antwan,"think that did it, thanks; always hate working with maven, but at the end of the day it works"
1491,1557984588.0175,Meagan,"hmm. I need to read an EDN file, assoc some stuff in it, and then spit it out… while maintaining comments"
1492,1557984927.0181,Loria,have a look at `rewrite-clj`? I think that's what many tools use for that purpose
1493,1557987952.0185,Caleb,"hello :smile:; How to remove tag `a:`  ?; In ClojureScript: ` (emit-str {:tag ""{<http://www.w3.org/1999/xhtml>}html""})  ;; =&gt; ""&lt;html xmlns=\""<http://www.w3.org/1999/xhtml\>""&gt;&lt;/html&gt;"" `; In Clojure: `  (xml/emit-str {:tag ""{<http://www.w3.org/1999/xhtml>}html""})   ;;=&gt; ""&lt;?xml version=\""1.0\"" encoding=\""UTF-8\""?&gt;&lt;a:html xmlns:a=\""<http://www.w3.org/1999/xhtml\>""/&gt;"" `"
1493,1557989264.0202,Stefan,"<@Meagan> ok, will do; and yes that was the issue; multimethods are very convinient with respect to state management; issue opened"
1494,1557992590.0211,Lavonia,"Even when there is non-trivial state that may be changed by users, passing explicit args is better IMHO. We can get back the convenience of not having to pass args each time by implementing Component and/or Integrant's abstractions."
1495,1557998695.0231,Izetta,"hey, is anyone here working at juxt? need a hint on how to start a repl properly in the yada repo.; or even if you don't work at juxt :stuck_out_tongue:"
1495,1557998913.0237,Josh,"<@Izetta> have an ask in <#C0CFGN25D|juxt>; <@Sixta> is a juxter iirc, and of course <@Robbi>"
1495,1557998999.0246,Izetta,"ah, didn't see that channel"
1495,1557999378.026,Robbi,should be `lein repl` though. Feel free to mail me at <mailto:mal@juxt.pro|mal@juxt.pro>; There's also a <#C0702A7SB|yada> channel; <@Izetta> asking in <#C0702A7SB|yada> is the best place
1496,1558001048.0274,Antonia,"Well regardless of the problem context, if you want functions calling each other on the same level, usually something is wrong. It’s always good to call functions from top to bottom.

```
    / a
foo
    \ b
```

My bet is you just need a proper data/context shape + `(recur)` like

```
(defn foo
  [ctx]
  (recur
    (cond (condition)
      :a (a ctx)
      :b (b ctx))))

(defn a
  [ctx]
  (assoc ctx ...))

(defn b
  [ctx]
  (assoc ctx ...))```; Again, it’s hard to guess but the rule is simple and works all the time just great."
1497,1558005800.0283,Toccara,"Hello guys; i'm in situation which i need to make two things depend on each other for example:
1- write something to DB
2- if step#1 success write another something
how can i make both behave like if they run inside one transaction, both must be success not only one?; maybe dosync will help here?; so maybe i create a ref object with initial val = false and when event#1 success  i change ref to be true and make condition to run event#2 if ref is true?; or how better to make this?"
1497,1558006730.0359,Jasmine,"This is not really a Clojure question. If db and thing 2 don’t actually support 2PC distributed transactions like XA, then you are in the world of effectively doing your own distributed transactions and managing your own rollback in the case of failure.; Refs don’t help you afaict"
1498,1558007034.0378,Bart,is there a nice way of getting data out of a map where the keys are not keywords? f.ex. get the map at the innermost level here `{1 {3 {:key true}}`
1497,1558007046.0383,Bart,don't ask how this situation occured. :stuck_out_tongue:
1497,1558007083.0394,Antonia,"`(get-in data [1 3 :key])`, no?"
1497,1558007113.0404,Bart,@art yep. *slaps forehead*
1497,1558007131.0408,Toccara,"<@Jasmine> what do you mean i need to implement rollback methods if one of the events failed, suppose event#1 success and be inserted to the DB, and event#2 failed, then i need to run the rollback method to delete the record from the db which be inserted by event#1 ?"
1497,1558007362.0422,Bart,"<@Toccara> depending on the DB you use, but usually modifications to the same row are serialized in the database, so you can safely wait for transaction #1 to finish, check the return value, then do #2"
1497,1558007411.0425,Toccara,"okay got it; thanks guys :+1:; <@Bart> if  transaction #1 success and then try to invoke transaction #2 which failed, then i need a rollback methods implemented for event#1 to roll back; i guess that's what <@Jasmine> means"
1497,1558007568.0459,Bart,"yes, unless the database supports rollbacks on it's own (most don't yet)"
1497,1558007581.0462,Antonia,I am not quite sure I understand what you are trying to do <@Toccara>
1497,1558007604.0468,Toccara,okay
1497,1558007606.0471,Antonia,Are you writing to a single db twice?
1497,1558007618.0477,Toccara,lemme explain in more details what i'm trying to do
1497,1558007624.048,Antonia,Are you writing to different destinations sequentially?
1497,1558007658.0485,Toccara,"i would like to save reference of objects into postgresql and save the actual objects into s3 for example; so i need to make 2 operations here; 1- insert reference data into postgresql of the object
2- push the object itself into s3; i would like to make both run in one transaction, to make sure i pushed reference and the object, but not any of them; my try now is to handle the failure of any for any reason; @art got what i'm trying to do?"
1497,1558007841.0523,Antonia,"Well, it’s postgresql – in that case use transaction and if s3 upload fails roll it back, no?"
1497,1558007882.053,Toccara,"you are right; what i missed postgresql has roll back, but everything clear"
1497,1558007983.0544,Antonia,Normally if an exception occurs somewhere inside it’s rolled back implicitly.; However the best rule to follow is trying to avoid writing to multiple destinations in a single user transaction because if the transaction fails because of other reasons _after_ the file has been uploaded it needs to be deleted. In your case that does not seem necessary but still good to keep in mind.
1497,1558008592.0568,Toccara,<@Antonia> good thanks :slightly_smiling_face:
1499,1558022246.0587,Meagan,"anyone know how to insert a whitespace character (e.g. newline) using rewrite-clj?; that’s exactly what I was looking for! thanks!; ah, there are utilities in `rewrite-clj.node`"
1499,1558022568.0623,Rossie,"Heya; I'm using leiningen and need some dynamic eval in project.clj to get the absolute path to the project.clj directory; I'm using:

```
[""--verbose""
 ""--no-fallback""
 ""-Dclojure.compiler.direct-linking=true""
 ""-H:+ReportExceptionStackTraces""
 ""--report-unsupported-elements-at-runtime""
 ""--initialize-at-build-time""
 ""--enable-https""
 ~(fn [proj] (str ""-J-Djava.security.properties="" (:root proj) ""/java.security.overrides""))
 ""--rerun-class-initialization-at-runtime=org.bouncycastle.crypto.prng.SP800SecureRandom""
 ""--rerun-class-initialization-at-runtime=org.bouncycastle.jcajce.provider.drbg.DRBG$Default""
 ""--rerun-class-initialization-at-runtime=org.bouncycastle.jcajce.provider.drbg.DRBG$NonceAndIV""]
```

I was expecting that fn to be called with the project map, evaluating to a string, per <https://github.com/technomancy/leiningen/blob/master/sample.project.clj#L347-L348>  but clearly lein native-image isn't happy, because when I run it I get:

```
$ lein with-profile +client native-image
Error encountered performing task 'native-image' with profile(s): 'base,system,user,provided,dev,client'
java.lang.IllegalArgumentException: array element type mismatch
```

I tried to debug using `lein pprint`, but instead it's just getting unquoted and so I get a literal function object in pprint (that might not be a bug? I'm not sure when the fn eval is supposed to happen):

```
   :native-image
   {:name ""transgressor"",
    :opts
    [""--verbose""
     ""--no-fallback""
     ""-Dclojure.compiler.direct-linking=true""
     ""-H:+ReportExceptionStackTraces""
     ""--report-unsupported-elements-at-runtime""
     ""--initialize-at-build-time""
     ""--enable-https""
     #object[leiningen.core.project$eval493$fn__494 0x1ec22831 ""leiningen.core.project$eval493$fn__494@1ec22831""]
     ""--rerun-class-initialization-at-runtime=org.bouncycastle.crypto.prng.SP800SecureRandom""
     ""--rerun-class-initialization-at-runtime=org.bouncycastle.jcajce.provider.drbg.DRBG$Default""
     ""--rerun-class-initialization-at-runtime=org.bouncycastle.jcajce.provider.drbg.DRBG$NonceAndIV""]},
```

Any ideas? Do I need #= or whatever? (That wouldn't be great because I probably need the project map :))"
1500,1558023958.0632,Marlyn,"<@Rossie> `~(fn [] ....)` evaluates to a function; never mind, special unquote handling is some lein magic; <https://github.com/technomancy/leiningen/blob/master/sample.project.clj#L438-L449>"
1500,1558024475.0644,Rossie,"Well, allegedly :)"
1500,1558024891.065,Leda,what is the simplest job scheduler lib you guys can recommend?; tried `tick` from juxt but the scheduling feature  is disabled right now
1501,1558025149.066,Clarine,"anyone seen this error before?
```
No implementation of method: :xml-str of protocol:
   #'clojure.data.xml.protocols/AsXmlString found for class:
   org.joda.time.DateTime
```; or better: does anyone has an implementation of that protocol lying around?"
1500,1558025353.0665,Jasmine,<https://github.com/clojure/data.xml/blob/41366e182519a763700b7c58ec46379062c01b78/src/main/clojure/clojure/data/xml/jvm/emit.clj#L172-L192>
1502,1558027009.0668,Madelene,does anyone know of an alternative to `jvisualvm` or `jmc` that works with `adoptopenjdk-12`?; that’s not yourkit :slightly_smiling_face:
1502,1558027108.0675,Dann,"yourkit has a lot more information than htop does. The VM will never allocate more memory than the maximum you configure at startup, you can use that config to make sure the vm doesn't misbehave, then use yourkit (or even visualvm) to figure out where the free ram under that limit went if it is running out; using keys that aren't keywords is fine - Strings, Numbers, even other hashmaps or sets. You can use the hashmap itself `({""a"" 0} ""a"")` -&gt; `0`, you can use `get` which is the function that a keyword is actually calling when you use it as a function; keywords aren't a syntax for map lookup, they are just objects that know how to use get; the one thing you should never use as a hash-map key is anything with value equality that is mutable (eg. a java ArrayMap)"
1503,1558027446.0686,Clarine,thanks!
1502,1558027463.069,Dann,"<@Madelene> I dont' think I have your answer directly, but which set of features do you need?"
1502,1558027511.0694,Madelene,cpu profiling/instrumentation
1502,1558027570.0703,Marlyn,"I know you asked about alternatives, but what is the reason `jvisualvm` doesn't fit the needs?"
1502,1558027622.0712,Madelene,it doesn’t ship with adoptopenjdk … and old versions won’t (for me at least) connect to an adoptopenjdk vm; if it worked it would fit my needs :slightly_smiling_face:
1502,1558027666.0727,Dann,<@Madelene> there's HPROF if you don't need a UI or are comfortable with a fronted that loads its dump files
1502,1558027670.0728,Marlyn,you tried <https://visualvm.github.io/>  ?
1502,1558027674.073,Madelene,yeah I downloaded it and tried it
1502,1558027736.0741,Dann,are you using the jvm arg for accepting a dt socket connection?
1502,1558027742.0743,Madelene,"<@Dann> yeah I’d really like a UI… I can at a push use hprof, but it’s not as easy as clicking a start/stop button around your repl interaction"
1502,1558027787.0752,Dann,"if you use clj + the hprof agent you can eliminate noise like nrepl from your measurements though; it's not very convenient though, agreed"
1502,1558027805.0759,Madelene,<@Dann>: no… though you’ve made me realise it didn’t even get that far… I think it’s trying to use java 12 to load itself; this stuff used to be easy
1502,1558027865.0764,Marlyn,<https://github.com/oracle/visualvm/pull/133>; seems like you need to build master; that's annoying; <https://github.com/oracle/visualvm/issues/130>; there seem to be other workarounds (i only scanned quickly)
1502,1558028199.0793,Madelene,"hmm thanks for that… I tried passing the `--jdkhome=/Library/Java/JavaVirtualMachines/jdk1.8.0_121.jdk/Contents/Home/` but it displays an error screen saying please use jdk 8, 9, 10 or 11 — which is kinda annoying as I gave it the jdk 8 home; I also have `JAVA_HOME` set to jdk8; ok installing the official release from that site, and starting it with the command:

` ./bin/visualvm -J-Dcom.sun.tools.visualvm.modules.startup.DisableStartupCheck=true`

to disable startup checks at least starts up the UI.

No idea if it’ll work if I connect to something yet.; connecting to jdk8 vms works at least if you do that; ok you can get heap profiles on jdk12 — but you can’t access local samplers for CPU or memory :disappointed: — though you might be able to do it if you setup jmx :disappointed:"
1502,1558029067.0829,Marlyn,those can be enabled at runtime IIRC
1504,1558029075.0832,Marlyn,I forget how though
1502,1558029100.0838,Madelene,yeah I don’t do the JMX stuff very often; so always need to consult what you need to do; I might be better building from master if that works
1502,1558029174.0846,Marlyn,i don't think you need to do that; probably only need to flip some options on the target VM
1502,1558029271.0857,Madelene,it likely will be… just seeing whats involved in building it from source; ahhh `ant` well this is a fun trip down memory lane!
1502,1558029412.0862,Marlyn,shave that yak
1502,1558029465.0867,Madelene,looks like the next yak is building netbeans… I might have to leave these unshaved; oh joy netbeans requires mercurial ~not~ *and* git
1502,1558029709.0876,Marlyn,you do not need to do any of this; just need to connect already built jvisualvm to the target vm
1502,1558029757.0888,Madelene,"yeah i’ve aborted and am trying that now; I just have the fear because last time I did this I really struggled with RMI port stuff… but that was through a tunnel, so should be much more straightforward this time.; ugh cannot connect; ```

  :jvm-args [""-Dcom.sun.management.jmxremote""
             ""-Dcom.sun.management.jmxremote.port=9199""
             ""-Dcom.sun.management.jmxremote.local.only=true""
             ""-Dcom.sun.management.jmxremote.authenticate=false""
             ""-Dcom.sun.management.jmxremote.ssl=false""]
```; still failing to connect when trying `localhost:9199`; ugh giving up for the evening"
1502,1558031593.0915,Lonna,"<@Madelene> Not sure if this will help your situation, but when I’ve had network stuff get in the way of `jvisualvm`, I’ve added this to my startup: `-Djava.rmi.server.hostname=localhost`"
1505,1558032038.0918,Fatima,<https://github.com/aphyr/tea-time>
1506,1558033617.0927,Clarine,"is it by design that `clojure.data.xml` preserves newlines like this?
```
(parse-str ""&lt;foo&gt;&lt;bar/&gt;\n&lt;bar/&gt;\n&lt;/foo&gt;"") ;;=&gt;
{:tag :foo,
 :attrs {},
 :content
 ({:tag :bar, :attrs {}, :content ()}
  ""\n""
  {:tag :bar, :attrs {}, :content ()}
  ""\n"")}
```"
1506,1558033644.0929,Jasmine,it is by spec I believe; there is a flag to change this behavior though; iirc
1506,1558033677.0937,Clarine,"I guess so yes:
&gt; From 0.1.0-beta3 to 0.2.0-alpha1
&gt; Preserve whitespace by default; is it relatively safe to use the newest clojure.data.xml? I really need the namespace stuff :slightly_smiling_face:"
1506,1558033753.0945,Jasmine,I've used latest extensively without any issues
1506,1558033765.0947,Clarine,0.2.0-alpha6; thanks. the zipper stuff comes in really handy in something I had to do today :smile:
1506,1558033869.096,Becki,let me know if you run into a node which has the same name as its parent. There's a patch that I think shouldn't have gone in: <https://dev.clojure.org/jira/browse/DZIP-3>
1506,1558034049.0966,Clarine,"`:include-node? #{:element :characters}`, the question mark is a bit weird I guess. maybe it went from a boolean setting to a enumeration later?"
1506,1558034456.0979,Reiko,"What's going on here? I'm trying to get `for` to work and I'm getting strange output for doing a simple `(for [n (range 1 101)] (println n))` and getting this output:
```
(1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil 33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil 65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil nil 97
98
99
100
nil nil nil nil nil)
```; No idea why that didn't collapse"
1506,1558034517.0992,Becki,`println` returns nil. you have a collection of 100 nils. Your repl is also printing the side effect interleaved
1506,1558034539.0997,Antione,you may be looking for `(doseq [n (range 10)] (println n))`
1507,1558034581.1006,Reiko,Why does `for` behave this way?
1506,1558034620.1016,Latonya,`for` is intended to return a value that is a sequence.  It isn't really intended to perform side effects like printing in its body.
1506,1558034656.1023,Reiko,So then `doseq` is intended for side effects?
1506,1558034657.1024,Latonya,`doseq` is intended to iterate through a sequence and do arbitrary side effects on each one.
1506,1558034665.1027,Reiko,"ok; So in other words, `for` is lazy?"
1506,1558034710.1039,Latonya,"it produces a lazy result, yes."
1507,1558035168.1042,Reiko,"So my reason for asking is I never actually did FizzBuzz in Clojure and wanted to see how that looked. This works as expected, but it looks pretty bad. Is there a more concise way to do it?"
1506,1558035217.1047,Nella,my first thought would be using `cond` instead of multiple `if`s
1506,1558035231.1051,Reiko,`cond` doesn't evaluate after something is true
1507,1558035420.1054,Nella,"I'm not sure what you mean by that; also, it's nicer to use `zero?` rather than `(= 0 ...)`"
1506,1558035442.1063,Latonya,Neither does a daisy-chained (or nested) sequence of `if` expressions.
1506,1558035450.1065,Reiko,"""Takes a set of test/expr pairs. It evaluates each test one at a
time.  If a test returns logical true, cond evaluates and returns
the value of the corresponding expr and doesn't evaluate any of the
other tests or exprs. (cond) returns nil.""; <@Latonya> No idea what you're talking about because the above code works as expected; <@Nella> That's fair. I forgot about that shortcut, but I was referring to the sprawling structure; But technically what I have is shorter"
1506,1558035608.1096,Latonya,"`fizzbuzz2` below has the same behavior as `fizzbuzz` above does; ```(defn fizzbuzz2 []
  (doseq [n (range 1 101)]
    (cond (and (= 0 (mod n 3)) (= 0 (mod n 5))) (println ""FizzBuzz"")
          (= 0 (mod n 3)) (println ""Fizz"")
          (= 0 (mod n 5)) (println ""Buzz"")
          :else (println n))))
```"
1506,1558035652.1101,Reiko,"Ok. Then I guess there was a typo somewhere when I tried that; That's better then, thanks"
1506,1558035692.1109,Nella,I think that the natural typo to make when using cond at first is to wrap the condition and result in a pair of parens; that would cause some weird things to happen
1506,1558035774.1116,Reiko,Probably what happened; I also haven't written Clojure in a minute too; Part of why I wanted to do FizzBuzz; Yet I'm still baffled as to how so many people fail to do it
1506,1558035801.1129,Rod,"I’m not currently in front of a Clojure machine, but I believe that if you cheat and use `cl-format` you can DRY it up quite a bit:

```
(defn fizzbuzz [n]
  (doseq [i (range 1 (inc n))]
    (cl-format true ""~&amp;"")
    (when (zero? (mod i 3))
      (print ""Fizz""))
    (when (zero? (mod i 5))
      (print ""Buzz""))))
```"
1506,1558035832.1132,Reiko,"Interesting, but the `cond` is more readable; Not repeating anything anyway; And that's wrong; haha; Unless I'm misunderstanding `cl-format`"
1506,1558035896.1145,Rod,<http://www.lispworks.com/documentation/HyperSpec/Body/22_cac.htm>
1506,1558036047.1151,Reiko,Also not sure why you made it variable length. FizzBuzz is explicitly [1 100]; If I had to guess the biggest mistake is doing [1 100)
1506,1558036105.1162,Latonya,"From quick testing, this is close (but not identical) to the original `fizzbuzz`:; ```(defn fizzbuzz3 []
  (doseq [i (range 1 101)]
    (clojure.pprint/cl-format
     true ""~&amp;~%""
     (when (zero? (mod i 3))
       (print ""Fizz""))
     (when (zero? (mod i 5))
       (print ""Buzz"")))))
```"
1506,1558036134.1173,Rod,"I wish I had a real Clojure REPL in front of me (displaced Common Lisper here), but the identical logic in CL works fine"
1506,1558036135.1175,Latonya,The difference is that it does not print numbers when neither Fizz nor Buzz are printed.
1506,1558036152.1179,Reiko,Then that's not FizzBuzz
1506,1558036196.1185,Rod,"```
;; This is CL; see above for the Clojure version
(loop for i from 1 to 100 doing
  (progn
    (format t ""~&amp;"")
    (when (zerop (mod i 3))
      (format t ""Fizz""))
    (when (zerop (mod i 5))
      (format t ""Buzz""))))

Fizz
Buzz
Fizz
Fizz
Buzz
Fizz
FizzBuzz
…
```; I wonder why Clojure needed the extra `~%`, but now we’re getting distracted"
1506,1558036215.1191,Reiko,It's 101!; Literally just talked about that
1506,1558036236.1196,Latonya,"Tim's version is Common Lisp, not Clojure."
1506,1558036253.12,Reiko,CL is inclusive for range endings?; But either way still wrong. It's not printing the other numbers
1506,1558036374.1222,Rod,"Line 6 (`(println n)`) in the original solution above was cut off for me and I didn’t realize I had to expand it. Anyway, it seems like the answer to the original question is “`cond` and `zero?` can clean things up a bit, and avoiding repetition of the `mod` logic is probably more trouble than it’s worth”"
1506,1558036384.1225,Latonya,"I don't think anyone is claiming it has the same behavior as your original version.  I think Tim presented it as food for thought, as a potentially interesting way to reduce the number of explicit conditions written in the code."
1506,1558036404.1228,Rod,(I don’t have a FizzBuzz spec in front of me); Yes.
1506,1558036458.1237,Reiko,"<@Latonya> And that is meaningless when the spec must include that functionality, but anyway; And `zero?` might be ""easier to read"" for some people, but it's actually not shorter; I actually prefer the `cond` version because it is more readable, despite being a bit longer"
1506,1558036678.1266,Rod,"Oh, sorry, I see what you did with it. Not unreasonable"
1506,1558036685.1269,Suzann,"If you want a fun challenge, think about how to do fizzbuzz with no booleans (or pattern matching). I've given the challenge to a few different people and its always interesting to see what people come up with. You can assume you have a `range` function and can iterate over each element of it."
1506,1558036709.1271,Reiko,That's interesting for sure; And there is an actual solution to that?
1506,1558036748.1277,Suzann,There are multiple.
1506,1558036905.1289,Reiko,I'm guessing it's something pretty subtle
1506,1558036972.1294,Esther,does no boolean mean no way to check equality?
1506,1558036979.1296,Reiko,^; That's where I'm stuck
1506,1558037114.1306,Latonya,"This does not attempt to solve it in the way jimmy described -- just another variation similar to Tim's that does behave the same as the original:; ```(defn fizzbuzz4 []
  (doseq [n (range 1 101)]
    (let [msg (str (if (= 0 (mod n 3)) ""Fizz"" """")
                   (if (= 0 (mod n 5)) ""Buzz"" """"))]
      (println (if (= msg """") n msg)))))
```"
1506,1558037229.131,Rod,Cute
1506,1558037389.1313,Dann,"you can remove the empty strings from the if clauses defining msg ```(ins)user=&gt; (str nil ""OK"")
""OK""
(ins)user=&gt; (str nil nil)
""""
(ins)user=&gt; (str ""OK"" nil)
""OK""
```"
1506,1558037417.1315,Latonya,I know.  I'm just not (yet) comfortable relying on such things :slightly_smiling_face:
1506,1558037417.1316,Dann,and that doseq is so close to a dotimes...
1506,1558037750.1319,Reiko,Here's some DRY cleanup
1506,1558037802.1322,Dann,"you can replace `(if (= msg """") n msg)` with `(or (not-empty msg) n)` ```(ins)user=&gt; (not-empty """")
nil
(ins)user=&gt; (not-empty ""foo"")
""foo""
```"
1506,1558037897.1328,Reiko,"That's another one that is technically shorter, but different readability"
1506,1558037933.133,Dann,as far as I'm concerned both not-empty and zero? are clearer - they are weak constructs so their meaning is more direct
1508,1558037947.1332,Dann,I use them even when they are longer
1506,1558037949.1334,Reiko,I like using `=` because it's consistent with forms that don't have those shortcuts
1506,1558037974.1336,Dann,"I prefer specialization when it exists in the standard library, it reduces ambiguity; eg always use val instead of second/last for map entries"
1506,1558038026.134,Reiko,"For example, there are short forms for &lt; and &gt;, but not &lt;= or &gt;=. You have to use an additional form to negate"
1506,1558038091.1342,Dann,oh you mean pos? and neg?
1506,1558038095.1344,Reiko,yes
1506,1558038167.1347,Tammera,Is this cheating :stuck_out_tongue:?
1506,1558038176.135,Reiko,So for &gt;= 0 you have to do `(not (neg? n))`; When you could have just did `(&gt;= n 0)`; I prefer consistency with outliers; Also the former is two operations while the latter is only one
1506,1558038298.1363,Fredda,data first!
1506,1558038343.1365,Reiko,Well it's not FizzBuzz
1506,1558038484.1367,Tammera,"Hmm how do you mean, because it doesn’t print? It produces the exact sequence here: <https://en.wikipedia.org/wiki/Fizz_buzz>"
1506,1558038530.1371,Reiko,"""Write a program that prints the numbers from 1 to 100. But for multiples of three print ""Fizz"" instead of the number and for the multiples of five print ""Buzz"". For numbers which are multiples of both three and five print ""FizzBuzz""."""
1506,1558038647.1373,Tammera,"Right, but thats trivial: `(run! println (take 100 fizz-buzz))` :wink:; Its a bit sad that the next question obviously would be: “cool, and now for 5 and 7”"
1506,1558038763.1386,Reiko,That would seem unnecessary. If you can't do regular FizzBuzz you aren't going to do that and if you can you can do both; What's sad is how many people can't do it
1506,1558038873.1406,Latonya,"I think Lennart's comment is that his approach can generalize for arbitrary number instead of 3 and 5, but the size of the table required gets bigger with larger number (or at least with larger values of their least common multiple)"
1506,1558038878.1409,Reiko,"<https://blog.codinghorror.com/why-cant-programmers-program/>; Cool, but it's not what was asked so it would fail the test; The purpose of having an applicant do FizzBuzz is to establish that they can do basic programming, but more importantly, read a spec; If he were to give such a solution in an interview he would fail it; <https://haacked.com/archive/2007/02/27/Why_Cant_Programmers._Read.aspx/>"
1506,1558039118.1431,Tammera,"I don’t understand why, because it doesn’t print, is that what you are falling over?"
1506,1558039164.1433,Reiko,What is the spec?
1506,1558039736.1435,Tammera,"what are you implying here. The program I wrote correctly produces an infinite sequence of numbers with all multiples of 3 replaced by “Fizz” and multiples of 5 by “Buzz”. The only thing it doesn’t do, and was in the spec, is to limit to 100 and to print. That is however trivial to add:

```
(defn print-fizz-buzz
  []
  (run! println (take 100 fizz-buzz)))
```; It uses the fact that FizzBuzz (or at least the replacements) repeat themselves after the least-common-multiple of 3 and 5, which happens to be 15.; Thats why it becomes “harder” to write this replacement table for 5 and 7, because their least common multiple is 35"
1509,1558040374.145,Beckie,<@Clarine> I have 2 convenience parsers for XML here using clojure.data.xml and tagsoup
1506,1558040434.1453,Reiko,"Wow...so the spec is ""Write a program that prints the numbers from 1 to 100. But for multiples of three print ""Fizz"" instead of the number and for the multiples of five print ""Buzz"". For numbers which are multiples of both three and five print ""FizzBuzz"".""

Your code does not do this so you failed to understand the spec, thus failing the test. I don't know where the disconnect is...; As stated, the point is not can you do some trivial code; it's can you adhere to a simple spec."
1506,1558040674.1457,Latonya,"During an interview, some interviewers are looking more for how well the applicant thinks, explains, understands, and communicates, and would not fail someone automatically if you pointed out to them that their function returns a sequence, but doesn't print it out.  Especially if the applicant then says ""Oh, yeah, to print it out, here are the changes required""."
1506,1558040711.1459,Reiko,That's a poor interviewer then; The whole point of the test is to check your reading comprehension
1506,1558040721.1463,Latonya,Your opinion differs from mine on that point.
1506,1558040742.1467,Reiko,My opinion is irrelevant. The purpose of the test is well established
1506,1558040786.1469,Latonya,"If you pass over applicants that miss minor point, but solve the meat of the problem, and quickly understand and fix the problem when it is pointed out, I think the interviewer is potentially missing out on a great candidate."
1506,1558040794.1471,Tammera,"Yeah, and on mine. I think its more important that an applicant has the ability to abstract and adapt than to follow the test to the letter."
1506,1558040816.1473,Reiko,"The question was clear. The question did not ask for an abstraction, thus you failed the test; This is pretty amazing I have to say..."
1506,1558040828.1477,Latonya,"Great, then you are not hiring us :slightly_smiling_face:"
1506,1558040841.1479,Meagan,"the efficacy of fizzbuzz et. al. is murky anyway, but getting the correct answer is never the point of these questions but how they approach problem solving.

If you read the problem wrong the first time, I am not going to fault you for it. If you respond to feedback and correct it, you still pass."
1506,1558040857.1481,Reiko,"If you didn't follow the spec, which is your job as a developer, hell no; I've stated multiple times what the purpose of the question is, which is well established. It's supposed to be dead simple so you can easily follow it. If you can't follow a deliberately blatantly simple spec the chances you are going to follow a complex spec is very slim to none."
1506,1558040970.1485,Latonya,We understand your view
1506,1558040981.1487,Reiko,"Considering that a large portion of ""bugs"" come from not adhering to the established spec, this is critical; Which is why it is testing that; Other questions are indeed looking for how the applicant reasons and not caring about the actual answer, but this isn't one of them; Hiring managers that pass people that fail such tests are a huge part of the problem"
1506,1558041144.1497,Tammera,"Lets agree to have different opinions here, some of us like to test the reasoning capability of applicants (and this is what we do at my company) and others like to test the way they read specifications."
1506,1558041201.1499,Reiko,"You're again missing it. Our opinions are irrelevant. The FIzzBuzz question tests a specific thing, which has been stated repeatedly. What you think it is testing or what you think it should be testing is irrelevant."
1506,1558041238.1501,Latonya,Would you agree that companies should be able to set their own hiring policies?
1506,1558041255.1503,Reiko,...
1506,1558041380.1505,Celestine,Hiring managers that ask folks to program in an interview is a huge part of the problem :slightly_smiling_face:
1506,1558041400.1507,Reiko,sigh
1506,1558041407.151,Celestine,On-the-spot tests in interviews _just don't work_. They don't reflect real-world programming experience at all.
1506,1558041427.1512,Reiko,"That is an over-generalization; There are certainly bad questions, FizzBuzz is not one of them; FizzBuzz reflects real-world very well. CAN YOU READ A SPEC?"
1506,1558041466.1518,Celestine,"I've been a hiring manager for two decades. I've never asked these sorts of ""performing monkey"" questions in interviews, and I've never had to fire anyone I've hired for an inability to program."
1506,1558041476.152,Herman,"there are many hills to die on, the exact purpose of fizzbuzz is not one of them"
1506,1558041506.1525,Reiko,Well that there is an Appeal to Authority fallacy so ok?
1506,1558041536.1527,Celestine,I think FizzBuzz is a stupid interview question/technique. It's as simple as that.
1506,1558041552.1529,Reiko,Good for you?
1506,1558041593.1531,Celestine,"And, to be honest, this whole discussion belongs in <#C0KL616MN|jobs-discuss> if it belongs anywhere at all in this Slack."
1506,1558041597.1533,Reiko,"I don't recall the original conversation being about whether or not it is a good idea, but what it is; It could have been moved there, but the original conversation was about Clojure so it was on-topic.; This is also a thread so if people don't want to read it they don't have to. You nitpicking about where this should be is unnecessary"
1506,1558041855.1539,Latonya,"Sean is a moderator on Clojurians Slack, and often helpfully points out to people where discussions most appropriately belong (or in some cases, do not)"
1506,1558042018.1542,Tammera,"Yes, I would like to add that your tone can be seen as hostile, or it it least felt hostile to me. Please realise that you are on a public forum full of humans who can get their feelings hurt, and are here to wind down and relax. This is obviously not a real job interview ^^."
1506,1558043967.1547,Reiko,"There is no tone in text conversations, which is the issue here. I did not mean any negative ""tone"" and suggest that perhaps your defensiveness made you interpret what I said as such.

Given the initial conversation was about adhering to the spec of FizzBuzz, stating that your proposed solution fails the spec is perfectly valid and wasn't implied as a defect with you, but just an objective statement. I'm sorry that you interpreted it that way."
1510,1558044190.155,Suzann,I usually count the third param to get as kind of cheating. I usually let it slide. But ask people to rewrite without using it or `or`.; Disclaimer: I don't do this in interviews. Just for fun.
1506,1558044603.1582,Tammera,"Yeah same, I agree that 3-arity get is a cheat because it will use a conditional internally.; It’s a fun problem to think about abstractly, like how would you write it for using Fizz for 3, Barr for 5 and Buzz for 7. And then how would you write it when this mapping was arbitrarily given as an input.; Makes you realize what mathematical properties such a simple program really has."
1511,1558054232.1641,Shayla,"how do y'all go about performing major refactors?; any recommendations as I embark on my own?; (major being about 5500 lines of source total, lol)"
1511,1558054284.1654,Celestine,"I'd want to start out with pretty good test coverage, to be honest, for a refactor of that scale.; Also, ""refactoring"" for me tends to be small, incremental changes that I can verify in the REPL, via spec, or a small set of tests/test expressions. Tackling 5,500 lines sounds more like a ""rewrite""..."
1511,1558054405.1676,Shayla,"I'm mostly attempting to spread what is currently one giant namespace across 11 files into a bunch of namespaces, as dealing with the interconnectedness is reaching high complexity; my goal is to actually change as little as possible, more some much needed organization"
1511,1558054461.1692,Celestine,"Depending on what the code currently does, maybe you can come up with some scenarios where you could generatively test the old code and the new code produce identical results for random, conforming input data?"
1511,1558054554.1702,Shayla,"Not a bad idea in general! this is a game-engine, so generating correct random data is a little harder. Thankfully, I have a fairly extensive integration test suite so I can rely on that for now; thanks for the ideas!"
1511,1558054651.1721,Celestine,"As a sanity check on namespace size, we have just under 300 `src` namespaces in our codebase at work. Less than a dozen have more than 1,000 lines. Only one exceeds 2,000 lines (it has 2,017 lines). The total is 65k lines."
1511,1558054704.1723,Shayla,"holy crap; I'm glad to know ""many namespaces"" works even when larger"
1511,1558054769.1739,Celestine,"We also have just over 300 `test` namespaces, totaling just under 20k and only two namespaces exceed 1,000 lines (one is just over 1,000, one is just under 2,000).; Code organization is an ongoing issue. We're pretty much constantly looking at small refactorings to improve navigability and cognitive load."
1511,1558054850.1755,Shayla,that's my biggest issue: navigability and cognitive load
1511,1558054878.176,Celestine,"We started with a pretty flat structure and some fairly large namespaces. Then we moved to a more nested structure and smaller, more numerous namespaces."
1511,1558054910.1763,Shayla,"interesting, thank you"
1511,1558054994.1768,Celestine,"```Clojure build/config 50 files 1000 total loc
Clojure source 276 files 64691 total loc,
    3065 fns, 625 of which are private,
    411 vars, 29 macros, 56 atoms,
    504 specs, 19 function specs.
Clojure tests 307 files 19396 total loc,
    4 specs, 1 function specs.
``` We have a simple shell script that counts lines and certain forms.; We have lots of little EDN files for configuration -- and each subproject in our monorepo has its own `deps.edn` file."
1511,1558055098.1776,Shayla,That's super cool
1512,1558055763.1778,Harold,"I'm looking at your code to parse Netrunner data. I do similar, less elegant things, with Star Wars Destiny, Magic, and Warhammer Champions data."
1511,1558055827.178,Shayla,haha hey thanks! I'm pretty sure you're the only other person to have ever looked at it!
1513,1558067931.1789,Trevor,Hi :wave: how's <#C1ZU4NUA2|bangalore-clj> doing??
1513,1558067971.1794,Yasmine,<@Trevor> going gud
1511,1558069433.18,Madeleine,I like flat and big namespaces personally.
1514,1558070681.1804,Celestine,"I was wondering if anyone else would chip in. I've heard pros and cons of both.; We're reorganizing our code because some namespaces have become sort of ""kitchen sinks"" of stuff that's only vaguely related to the original purpose (and should have been put elsewhere in the first place).; We've also evolved our thinking a lot on just naming stuff in the seven years we've been working on this codebase.; (it still seems amazing to me that we have had Clojure in production for seven years now!)"
1514,1558070853.1837,Tammera,We joke at work that ‘everything is in `utils`’
1514,1558070880.1842,Celestine,"Yeah, it's _really_ hard to avoid having some sort of ""util"" namespace I think :slightly_smiling_face:"
1514,1558077823.1856,Sixta,The con of a big flat namespace is that reloading takes ages
1514,1558078956.186,Tammera,and that the likelyhood of having to reload that huge NS is steeply increased
1515,1558079087.1866,Antione,util is another name for “junk drawer”; premature splitting of namespaces is a sin imo. I prefer to grow an ns until natural splits reveal themselves.
1514,1558079287.1898,Madelene,yeah I tried that this time too and it still didn’t seem to work
1515,1558079322.1909,Madelene,but I think that was the solution in the past
1515,1558079351.1917,Antione,"lots of util namespaces often contain a significant number of fns which never see reuse across a codebase in my experience. And when they do it is often limited to a couple instances.; not saying that’s a rule, but I’ve actually dumped disparate namespaces back into one big namespace to tease out the right splits after the fact.; Premature splitting forces new names into existence which often aren’t the names that capture what’s actually going on in the domain."
1514,1558081039.2062,Madelene,"I strongly believe applications are better organised first by vertical/features then inside them horizontally.

There are many reasons the main being:

1. People tend to work on a feature at a time.
2. Parallelising work is easier to do by feature, so structuring your code by feature means less merge conflicts.
3. Code is much easier to navigate, and it’s way easier to find things and on-ramp people.  You can get a good idea on what an application does by looking at it’s top level namespaces.
4. When creating new code it’s much more obvious where to put it; which leads to greater consistency.

Cross cutting concerns can be colocated under an `app.concerns`, or even another root namespace, i.e. an `app-lib` ns; and eventually moved into separate libraries if it makes sense.

The biggest barrier to doing this, is that most clojure app templates organise horizontally by the framework first, e.g. they create you an `app.handler`, `app.model` namespace first.

I also agree that you shouldn’t prematurely split; beyond giving each feature its own ns.; so a trivial `app.feature` ns may contain the view and model code (still separated but together)… at some point you may break it out into `app.feature.view` and `app.feature.model`.  A good reason to do this is when you start wanting to test the models and views independently; so it will give you parallel test ns’s.; Libraries on the other hand make often make more sense to organise horizontally… though usually each library is a horizontal anyway."
1514,1558081664.21,Sixta,<@Madelene> have you seen the behaviour programming paradigm?; <https://lmatteis.github.io/react-behavioral/>
1514,1558081838.2112,Madelene,I don’t think so
1514,1558081918.2122,Sixta,"The demo can explain it better, but it's essentially about implementing each feature independently"
1514,1558081978.2131,Madelene,looks like it’s based on CSP — or something similar; but that’s just based on a 20 second glance
1516,1558084825.2158,Marquetta,"It is possible to use functions in lein project.clj file. But it doesn't work here:
:essthree {:deploy {:type          :uberjar
                     :bucket        ""uberjars.foo""
                     :path          ""bar""
                     :artifact-name ~#(str (:version %)) }}; ~#(str (:version %))  function gets converted to a string"
1516,1558085754.2165,Sixta,"I'd go a little deeper, that seems important but isn't. I think the async nature is important though.

The important thing are the events and then collecting all the behaviours and make some decision based on interpreting them in a whole."
1516,1558086340.2167,Madelene,":thumbsup: yeah I see that… seems to me that the logical conclusion to this stuff is event streaming and a query language on events… which is where a bunch of independent efforts have ended up… e.g. FRP.

Years back I experimented with using Rx to create a reactive model of XMPP… It’s definitely an approach that has its appeal, but the general problem with FRP is time leaks… and I’m not sure if anyone has solved that one.  Though FRP doesn’t necessarily mean what it used to."
1514,1558086393.2169,Madelene,Rx did introduce me to marble diagrams though — which are pretty great for this kinda thing.
1516,1558087971.2174,Sixta,"It's kind of like event streaming, but I assumed you asked all your producers if they had a message before moving on."
1516,1558088092.2176,Madelene,isn’t that still a potential form of time leak?  How long must the producer hold the message for?
1516,1558088172.2178,Sixta,"For JavaScript, I'm not sure you get a choice. It may operate on a closed world assumption, and it will queue up productions while it waits."
1517,1558092256.2223,Katherina,Any suggestions for a Clojure library doing CLI args parsing with the ability to add arbitrary sub parsers like Python's argparse? I tried `tools.cli` which seems too low level and have to write a lot of manual parsing and boilerplate myself. Also tried <https://github.com/l3nz/cli-matic> which is based on tools.cli and is quite nice and declarative but it doesn't allow nested parsers yet.
1517,1558092867.2233,Clarine,"<@Katherina> I saw this yesterday. I don’t know if it supports what you want, but it looks cool. maybe it works from clojure? <https://picocli.info/>; it seems to be annotation-heavy and no idea how that interacts from clojure; I see there’s a Clojure issue here: <https://github.com/remkop/picocli/issues/231>
so probably not suitable right now"
1516,1558093988.2251,Sixta,I think clojure could work fine with that via interop
1517,1558094137.2268,Katherina,<@Clarine> Those were precisely my thoughts too. The best contender for a Clojure wrapper I see is <https://argparse4j.github.io/> but was hoping if there is a more data driven solution out there
1517,1558094173.227,Clarine,write one based on that? seems pretty useful
1516,1558094393.2288,Katherina,could definitely try that. picocli's features seem quite cool though. <@Sixta> whats the best way of doing a Java interop with java annotations?
1516,1558094440.2291,Sixta,I think it's reify; But I'm trying to go off the top of my head
1516,1558094711.2303,Katherina,right. Im not familiar with this kind of interop. Will try looking into it.
1517,1558095120.2306,Alyce,How about commons CLI?; <https://commons.apache.org/proper/commons-cli/>
1516,1558096151.2312,Katherina,<@Alyce> Im not sure if it supports subparsers
1517,1558096161.2314,Alyce,kk
1517,1558096423.2319,Antonia,"Hm what’s wrong with `tools.cli`? <https://github.com/clojure/tools.cli#in-order-processing-for-subcommands>; &gt; Note that the options to log are not parsed, but remain in the unprocessed arguments vector. These options could be handled by another call to parse-opts from within the function that handles the log subcommand.; Define options, parse, check if there’s an arg, parse its options against another sub-command definition"
1517,1558096605.2349,Katherina,"<@Antonia> I felt its too low level and involves me writing a lot of boiler plate for validation and dispatch. <https://github.com/l3nz/cli-matic> built on top of it has a more declarative API and spec validation, but hides the subcommand aspect; the problem came from writing
```
(defn validate-args
  ""Validate command line arguments. Either return a map indicating the program
  should exit (with a error message, and optional ok status), or a map
  indicating the action the program should take and the options provided.""
  [args]
  (let [{:keys [options arguments errors summary]} (parse-opts args cli-options)]
    (cond
      (:help options) ; help =&gt; exit OK with usage summary
      {:exit-message (usage summary) :ok? true}
      errors ; errors =&gt; exit with description of errors
      {:exit-message (error-msg errors)}
      ;; custom validation on arguments
      (and (= 1 (count arguments))
           (#{""start"" ""stop"" ""status""} (first arguments)))
      {:action (first arguments) :options options}
      :else ; failed custom validation =&gt; exit with usage summary
      {:exit-message (usage summary)})))
```
for every subcommand using `tools.cli`; plus a dispatcher like this:
```
(defn -main [&amp; args]
  (let [{:keys [action options exit-message ok?]} (validate-args args)]
    (if exit-message
      (exit (if ok? 0 1) exit-message)
      (case action
        ""start""  (server/start! options)
        ""stop""   (server/stop! options)
        ""status"" (server/status! options)))))
```"
1517,1558096817.2372,Antonia,Let the root command validate common args and sub-commands validate their own args so the life is simpler.; Isolation is always good
1517,1558097048.2419,Katherina,"i totally agree. what im having trouble with is writing all the `(cond ...)` and the `ifs` by hand. And that makes it more error prone. `cli-matic` for example gives me the ability to define the whole thing in a map:
```
(def CONFIGURATION
  {:app         {:command     ""toycalc""
                 :description ""A command-line toy calculator""
                 :version     ""0.0.1""}

   :global-opts [{:option  ""base""
                  :as      ""The number base for output""
                  :type    :int
                  :default 10}]

   :commands    [{:command     ""add""
                  :description ""Adds two numbers together""
                  :opts        [{:option ""a"" :as ""Addendum 1"" :type :int}
                                {:option ""b"" :as ""Addendum 2"" :type :int :default 0}]              
                  :runs        add_numbers}

                 {:command     ""sub""
                  :description ""Subtracts parameter B from A""
                  :opts        [{:option ""a"" :as ""Parameter A"" :type :int :default 0}
                                {:option ""b"" :as ""Parameter B"" :type :int :default 0}]
                  :runs        subtract_numbers}
                 ]})
```; also gives me the function dispatch too"
1517,1558097093.2426,Mimi,"I’m guessing the consensus might be that this is overkill and/or maybe too low level … but I think from now on, whenever I need to parse anything (including command line stuff), I’m going with instaparse. It’s so awesome and you have so much control. instaparse + a cond statement ftw :wink:"
1517,1558097390.2431,Katherina,Thats the all conquering solution i guess :stuck_out_tongue:
1517,1558097420.2433,Mimi,"if ya need to parse, might as well do it right! lol"
1517,1558097682.2435,Katherina,<@Clarine> Seems like it has a programmatic API too: <https://picocli.info/picocli-3.0-programmatic-api.html>; could be useful
1518,1558098392.2454,Boyd,"Does anyone know how to find from which remote repo (ex. enonic, maven, clojars) that a project dependency wall pulled from using leiningen?"
1518,1558098606.2455,Clarine,aah; that seems a lot better
1517,1558101373.2462,Clarine,"let me know if you get it working, I’m curious :slightly_smiling_face:"
1517,1558101532.2465,Loreen,<https://memegenerator.net/img/instances/x300/84483335/what-does-quote-say-to-repl-not-now.jpg>
1517,1558101789.2467,Katherina,"Sure, trying to get to work on this Graal based CLI im putting together"
1517,1558102818.2471,Clarine,exciting! :slightly_smiling_face:
1518,1558102870.2473,Clarine,what are you making?
1518,1558103255.2476,Katherina,"<https://github.com/bob-cd/wendy>
its a CLI to a CI tool I've been building for a while now. Was in Python, now ""Graaled"" my way back :stuck_out_tongue:; Im trying to implement <https://github.com/bob-cd/wendy/blob/master/docs/commands.md>"
1518,1558103351.2482,Clarine,aah
1518,1558103386.2484,Katherina,"whats in the repo works for a single command, but was having a nightmare to extend it"
1518,1558104129.249,Raina,Regarding quotes
1517,1558104153.2493,Raina,`(meta ^:m 'm)` returns nil
1518,1558104196.2499,Raina,so replacing the `'` with `(quote ` is the only way out or is there something else?
1518,1558104560.2502,Meagan,"`with-meta` works; I’m often confused by the ^ meta reader, it seems to have some surprising behavior in certain cases (like this) so the only time I use it now is in a `def` to attach meta to a var; otherwise, I use `with-meta` explicitly"
1518,1558105768.2518,Harris,"`^:m 'm` is attaching meta to the compile time expression `(quote m)`; what you want to do is `'^:m m`; the behavior of `^` here is perfectly consistent; another way to understand what is going on here is to use `1` instead of `m`; ```user=&gt; ^:foo '1
1
user=&gt; '^:foo 1
Syntax error reading source at (REPL:3:0).
Metadata can only be applied to IMetas```; there's no difference at all between `'` and `(quote`"
1518,1558105935.2547,Meagan,"it might be entirely consistent :sweat_smile: I just find it doesn’t match what I want to do most of the time, so my tiny brain figured out `with-meta` is usually what I want"
1518,1558105953.255,Harris,"`with-meta` operates at runtime, `^` at read-time"
1518,1558105963.2553,Meagan,gotcha
1518,1558106004.2557,Harris,"(in fact, `^` _is just_ `with-meta` at read-time)"
1518,1558106018.2563,Meagan,I’m actually not sure why `'^:m` works
1518,1558106029.2566,Harris,it expands to `(quote ^:m m)`
1519,1558107911.2572,Becki,anyone have the <@Rosaline> ticket about iterating over a paginated collection?; can't remember enough to find it; ah found it. <https://dev.clojure.org/jira/browse/CLJ-1906>.
1519,1558108594.2581,Meagan,I wonder if that’s a use case for `nav` / `datafy` in actual application code
1520,1558109631.2583,Jasmine,interesting idea
1521,1558117879.2597,Zada,Hoping someone here might have some experience: I'm trying to set a log level inside a `log4j.properties` file just for a specific clojure namespace. Is there an easy way to do this that doesn't involve using Java interop to set the logging level inside the clojure code itself?
1522,1558120342.2599,Milagros,"Look in `~/.m2/repository/&lt;group&gt;/&lt;name&gt;/&lt;version&gt;/_remote.repositories` - that should list the repo the artifact came from:

```
~&gt; cat ~/.m2/repository/ring/ring/1.7.1/_remote.repositories
#NOTE: This is an Aether internal implementation file, its format can be changed without prior notice.
#Mon Apr 22 09:08:21 EDT 2019
ring-1.7.1.jar&gt;clojars=
ring-1.7.1.pom&gt;clojars=
```"
1519,1558126383.2615,Onita,is it just me or does 400-500ms for 800 `insert-multi!` rows in jdbc seem… like a lot
1519,1558126538.262,Tammera,are you sure that is time is being burnt in jdbc and not in your db?
1519,1558126815.2629,Onita,"i’m not sure, i just have an adhoc profiling call around the insert; any ideas on how i can dig further?"
1519,1558126840.2633,Tammera,If I recall correctly — but I am by no mean an expert — insertion performance depends on how many indices there are on your rows
1519,1558126882.2636,Onita,i have a primary key on 3 of 4 columns in the table; maybe there’s a way to get an explain out of jdbc?
1519,1558127098.2665,Tammera,"You could try inserting the same rows using the mysql client/psql, see how long that takes. I wouldn’t expect something like jdbc to add any large amount of overhead. But this is just a hunch, you should ask Sean Corfield when he’s around!"
1519,1558130189.2671,Celestine,<@Onita> How exactly are you inserting multiple rows?
1519,1558130236.2682,Onita,`insert-multi!`
1523,1558130260.2687,Celestine,So you said. What _exactly_ does your call look like?
1519,1558130301.2699,Onita,"so it’s provided with a vector of column names, and then 800 tuples for row values; if that’s what you mean"
1519,1558130308.2703,Celestine,"If you provide multiple maps, it does multiple inserts (per the docs). If you provide a vector of column names and a vector of rows (a vector of vectors of row values), it tries to do a single insert -- but the actual behavior is, like so many JDBC-related things, database-specific. For example, PostgreSQL requires that you provide a special option."
1519,1558130360.2707,Onita,what does the option indicate?
1519,1558130433.2716,Celestine,"The auto-gen'd docs haven't been updated for a while (infrastructure issues, I believe), but I've recently added this paragraph to the docstring for `insert-multi!` ```  Note: some database drivers need to be told to rewrite the SQL for this to
  be performed as a single, batched operation. In particular, PostgreSQL
  requires :reWriteBatchedInserts true and My SQL requires
  :rewriteBatchedStatement true (both non-standard JDBC options, of course!).
  These options should be passed into the driver when the connection is
  created (however that is done in your program).
```; So if you're on PostgreSQL or MySQL, you'll need to provide the appropriate option in your db-spec when you create your DB connection.; (and, of course, they're different options -- thank you JDBC :disappointed: ); BTW, there's <#C1Q164V29|sql> for SQL-specific / JDBC-specific questions -- which I'm much more likely to see as I don't have that channel muted (but I do have this one muted).; (JDBC is one of the biggest piles of frustrating, non-standard, quirkiness I've ever had to work with!)"
1524,1558153325.2766,Felix,"Given Clojure/JVM, cljs, graal, ... what is the 'lowest startup delay' method of running clojure on aws lambda ?"
1524,1558160237.2855,Antonia,"<@Felix> clojure on jvm8 is as fast as go, the jar is even smaller than go binary. But don't try to use 128mb of mem, too small. The rest is too abstract, you need to run your benchmarks depending on the case. VPC is still slow so probably if you really need lambda, you are limited to public databases like Aurora Serverless (MySQL atm, Postgres in preview), Dynamodb, Kinesis and so — the ones that give access through iam role and not force you to keep everything in a VPC. They said they should fix it some time in 2019. And this is applicable to all runtimes. From my observation, clojure does not really add any big overhead."
1524,1558160585.2856,Arlen,"&gt; clojure on jvm8 is as fast as go

<@Felix> As fast for startup time? I very much doubt that, especially if you need to load more than just `clojure.core`!"
1524,1558160896.2859,Antonia,"Dependencies is the thing to keep an eye on, right.; Like I said, it does not add big overhead, but still does some. If a lambda somewhere behind Kinesis Stream, Dynamodb Stream, SQS, SNS, it's fine to have it starting a bit longer than go or node.js.; I would not use lambda as an http handler tho, forgot to mention that, sorry."
1525,1558165038.2874,Clarine,"<@Felix> I don’t know about AWS Lambda but on my machine native with Graal is definitely the fastest. it can also be a bit limiting in terms of what it supports, e.g. no eval"
1526,1558169993.2918,Zetta,"Hi,  I'm trying to change the default print output for functions to into ```(doc f)```

While the following works fine in the default clj repl ```(remove-method print-method clojure.lang.Fn)
  
(defn- pretty-demunge
   [fn-object]   
     (let [dem-fn (clojure.repl/demunge (str fn-object))
            pretty (second (re-find #""(.*?\/.*?)[\-\-|@].*"" dem-fn))]
      (if pretty pretty dem-fn)))
      
(defmethod print-method clojure.lang.Fn [f w]  
    (.write w (:doc (meta (find-var (symbol (pretty-demunge f)))))))```
 It doesn't work in lein repl (I keep getting the default #function output, any idea why this is the case? (my guess is that I need to implement an nrepl middleware but id like to find an easier way of doing this)"
1525,1558195199.2941,Elaine,<https://clojure.atlassian.net/projects/CLJ/issues/CLJ-1906>
1525,1558206489.2953,Felix,"@art <@Arlen> <@Clarine>: this is my fault for not specifying it earlier -- but yes, I want to use Clojure on Lambda as HTTP REST API / handler. This is why I care about the code start time.; What is the best way to minimize the clj/lambda startup delay?"
1525,1558206562.2962,Sheron,you're having in mind aws lambda ?
1525,1558206570.2964,Clarine,"<@Felix> as I said, on my own machine Graal is definitely the fastest startup, but I don’t know how AWS Lambda works"
1525,1558206618.297,Felix,"<@Clarine>: I know nothing about Graal+CLJ. Is this something that can be deployed to Lambda? (I""ve deployed Go, Rust, and Clj-JVM functions.)"
1525,1558206670.2976,Clarine,"Graal can compile to a binary for linux, MacOS or Windows. I assume AWS can run linux binaries"
1525,1558206755.2982,Sheron,"aws lambda's  jvm startup is a major pain , there is no real way around it (i have invested tens of hours onto optimizations there) ...; if you want stuff that starts fast,  pick either python or nodejs there. (or maybe graalvm and native-image ... maybe maybe); maybe clojurescript on top of nodejs ?"
1525,1558206800.2994,Clarine,lumo might also work?; or yes cljs + node
1525,1558206824.3,Felix,"got it, so if I want clj-like on lambda, I should look into:

clj/graalvm, cljs/nodejs, planck, lumo

?"
1525,1558207062.3006,Sheron,y; even plain java stuff on the java vm is slow as hell for the first request
1525,1558207119.302,Felix,I can't tell if 'y' is for 'yes' or 'why' :slightly_smiling_face:
1525,1558207122.3021,Sheron,by the looks of it amazon is actually booting up a fresh jvm there and the performance of those has never been great off the line ... even my java lambdas are having trouble and they are much smaller than clojure itself.
1525,1558207173.3027,Felix,"so the overhead of planck, lumo, and cljs/nodejs should all be ~ the same right? boot a js vm + load cljs primitives ?"
1525,1558207597.3033,Clarine,"<@Felix> if you’re really going for speed I would use a compiled CLJS -&gt; nodejs project, no self-hosted stuff; or graalvm"
1525,1558207656.3042,Felix,"I'm really not a fan of Node. Googling ""clojure graalvm"" is bringing up lots of youtube talks. Do you have a link for setting up a nice clojure/graalvm workflow?"
1525,1558207738.3047,Clarine,I would look into <https://github.com/taylorwood/lein-native-image> or <https://github.com/borkdude/clj.native-image>; or just use `lein uberjar`. there’s an example here: <https://github.com/borkdude/cljtree-graalvm>
1527,1558207844.3069,Felix,"dumb question: so during development, I'm still developing vs JVM Cloljure REPL, but when everything is done, I say ""hey lein, take these java class files, and convert them over to graalvm"" ?"
1525,1558207847.307,Clarine,"<@Felix> for questions about Graal, there’s also the <#CAJN79WNT|graalvm> channel; <@Felix> yep :slightly_smiling_face:; that’s how I’ve been developing <https://github.com/borkdude/clj-kondo>"
1525,1558207876.308,Felix,this makes sense; thanks
1525,1558208009.3093,Clarine,"there are some things that GraalVM cannot handle, e.g. eval. there’s also an issue with `locking`. so YMMV."
1525,1558208290.3099,Katherina,<@Felix> <https://github.com/oracle/graal/blob/master/substratevm/LIMITATIONS.md>
1528,1558213581.3115,Dreama,i am curious if there is a simple way to recursively descend into a nested hash  and make a copy that has certain keys removed   .. i have tried clojure.walk and friends but that is good for transforming keys and not removing them
1528,1558213599.3117,Celestine,`update-in` with `dissoc`?
1528,1558213709.3124,Dreama,oh .. let me try that one ( was not sure if that would descend the hash ); problem with update-in is that is expects the path  to dissoc from but I am decending tree and don't know the path exactly .. i guess I could collect those paths ?  but might be better way ?
1528,1558214054.3155,Nieves,"maybe assoc them by nils can help? or why you need ""copy"" without some keys? you have a side function, which logic depends on this keys?"
1528,1558214055.3156,Jasmine,clojure.walk/postwalk-replace can be used for this
1528,1558214088.3162,Dreama,"i tried post-walk .. but i could not figure out how to &gt;&gt; remove &lt;&lt;  just transform the value; so i can transform it but not remove it with the walkies function; i have a tree with key values and want to walk and remove certain keys; so yes, i have a function to determine which to remove"
1528,1558214292.3195,Jasmine,"```user=&gt; (clojure.walk/postwalk #(if (map? %) (dissoc % :a :b) %) {:a 1 :e {:c 2 :b {:f 3}}})
{:e {:c 2}}```; something like that to remove all :a and :b at all levels"
1528,1558214352.3205,Dreama,oh .. wow .. trying that now
1528,1558214456.3211,Jasmine,"basically it will (bottom first) visit every node of the tree and replace the node it's on with the value returned from the fn; the if is important to only apply the dissoc on map nodes, and not on individual leaves, etc"
1528,1558214735.3226,Dreama,"ok .. got it .. it works really well .. and i love it of course, but gimme a few moments to let it soak in and then i will change the if to dissoc the keywords that i need"
1528,1558215346.3235,Sixta,Also see <https://github.com/FieryCod/holy-lambda>
1528,1558215629.3238,Darci,"generally, this is a perfect use case for specter. And it is totally general and will always maintain data types. In my experience/use it is simpler and far better for this sort of thing than  core stuff +  clojure.walk/*"
1529,1558218202.3268,Deangelo,"Hi everyone. I’ve got this little code
```
(let [image-fields [:thumbnail_image :featured_image :display_image]]
    (cond-&gt; updated-data
      (pos? (count changed-images))
      (assoc :images (mapv #(image-updates in-updated in-original %) changed-images))

      :always
      (dissoc :thumbnail_image :featured_image :display_image)))
```
and I want to `apply` that `dissoc` using `image-fields` but cannot figure out how to. so basically I want to do something like
```:always
(apply dissoc image-fields)
```
but because it’s in a `cond-&gt;`, I guess it ends up as being `(apply updated-data dissoc image-fields)`.

I tried it like this as well
```:always
#(apply dissoc % image-fields)```"
1529,1558218334.3273,Jasmine,"rather than tacking that on the end, ""always"" stuff can be done at the beginning"
1529,1558218361.3279,Deangelo,"do you mean up here?
```(cond-&gt; updated-data```"
1529,1558218371.3283,Jasmine,(cond-&gt; (apply dissoc updated-data image-fields) ... ); yeah
1529,1558218384.3288,Deangelo,yeah that makes sense :smile: thank you
1529,1558218391.329,Jasmine,cond is for conditional things :)
1529,1558218549.3298,Deangelo,thanks again. it cleared up a few other things before that chunk of code :+1:
1529,1558218997.3299,Dreama,good point <@Darci> I have watched the video on specter 2 times actually and thought of it but my partner prefers to use less libraries ( BUT ) in this case it makes sense ( so thanks for suggestion )
1530,1558220814.3306,Dreama,"i've been getting drunk on this code for a few hours; ```; (clojure.walk/postwalk #(if (map? %) (dissoc % :a :b) %) {:a 1 :e {:c 2 :stuck_out_tongue: {:f 3}}}); ```; to remove key/values from a tree   when key matches  a pattern; but could not figure out how to make it so that i dynamically check the keys ( to see if they match a regex ( lets say ) .. this code assumes that they are known keys like ( :a  or : b )  but I don't know the keys in advance.; i tried oh so many things, but i  could not figure it out  ( even tried specter )"
1530,1558221043.3348,Celestine,"<@Dreama> You have the whole map right there. You can get the `keys` and do whatever you need, based on them."
1530,1558221112.3357,Dreama,even nested keys ??  i guess you suggesting i ( step 1 )  pick out the paths  i want to remove  ( with my function )   then step 2 ( dissoc them ? ); my tree ( hash )  also looks more like  {:a [{:b 1} {:c 2}] :d { :e 4}}  where key values can be array of more hashes
1530,1558221314.3378,Celestine,"Perhaps you could explain more clearly what problem you are trying to solve?; With `postwalk`, you can look at the whole of each hash map within the tree -- inside the `(if (map ? %) ... % ... )` branch"
1530,1558221389.3394,Dreama,"just walking tree and removing key/values that match a pattern ( like if key has ""ui"" in it )"
1530,1558221403.3397,Celestine,"Then, yeah, you can absolutely do that."
1530,1558221420.3405,Dreama,i know i can do that .. i just flailing .. but i keep trying though ..
1530,1558221473.3415,Celestine,"`(apply dissoc % (map keyword (filter (partial re-find #""ui"") (keys %))))` -- something like that?; (I should pull up a REPL and try that before recommending it)"
1530,1558221513.3424,Dreama,oh .. so your saying if you find a hash   do that; ok .. let me slap that sort of thing in the REPL myself
1530,1558221575.3437,Celestine,"You may need to check that the list of keys returned that way is not empty before attempting the `dissoc`...; Hmm, no, `dissoc` supports just one argument so that should work without a condition."
1530,1558221620.3448,Dreama,got it but your idea is to get list of keys to remove .. ok .. that interesting
1530,1558221735.346,Celestine,"If your problem is ""remove all keys that have `ui` in their name, from all hash maps in the tree"" then that code solves that. But I get the impression that isn't quite the actual problem?"
1530,1558221825.3462,Dreama,no no .. that is exactly it; it is that simple; almost got it .. gimme a few more minutes; this was good suggestion by the way; got it .. oh man .. that was 3 hours well spent .. thanks  <@Celestine> and <@Jasmine> for both suggestions .. that was a whooper
1531,1558227868.353,Liane,"I see the word ""reified"" come up a lot and sometimes in ways that makes me think i dont understand how its used, at least in the clojure community.

1. its a verb, so it acts on something and that action is to make it less abstract. I reified my health and wellness plan by signing up for the local gym.
2. reify, in clojure, does just that, it defines  an anonymous type and creates an instance of that type.

so when i see it used like this:

&gt; X uses a global singleton for the fact base; I wanted something reified I can pass around.

I get confused. because im not sure how to interprate this, maybe they are saying that X only had the idea of a singleton, but they flushed out the implementation?"
1530,1558228700.3542,Latonya,"In the phrase ""I wanted something reified I can pass around"", it sounds like they want X to be a value that can be bound to a parameter, or returned as a value from a function call.; It would surprise me if everyone used the word ""reify"" identically to each other, BTW."
1530,1558229551.3556,Celestine,"`reify` does not ""define an anonymous type"". It creates an object that satisfies one or more interfaces or protocols."
1531,1558229666.3566,Celestine,"(if that has to create a Java class that implements a bunch of things, that's an implementation detail)"
1532,1558229968.3568,Celestine,"```user=&gt; (reify Runnable (run [this]))
#object[user$eval140$reify__141 0x546621c4 ""user$eval140$reify__141@546621c4""]
user=&gt; (type *1)
user$eval140$reify__141
user=&gt; (ancestors *1)
#{java.lang.Runnable clojure.lang.IObj java.lang.Object clojure.lang.IMeta}
user=&gt;    ```"
1530,1558230109.3574,Celestine,It hadn't occurred to me that it would implement `IObj` and `IMeta` but that makes sense...
1531,1558230131.3576,Celestine,<@Liane> ^
1532,1558231128.3579,Liane,"im out of my depth, but i am quoting the clojure docs directly:
<https://clojure.org/reference/datatypes#_reify>; interesting, thanks <@Celestine>, that makes sense. i think <@Latonya> is right here and it might have been a slight mis-use on the original authors part. Normally i dont get tripped up on such things but I wasnt comfortable with reify yet so its hard to see where the misconception is."
1532,1558239360.3602,Celestine,"Yeah, I think the ""defines an anonymous type"" is secondary to what it does. I mean, it has to ""Because Java"", but that's not really the _point_ of `reify`. The important part is ""creates an instance of ..."" something that implements the specified protocols and interfaces (and `IObj` and `IMeta`)."
1531,1558239935.3604,Zita,"Yeah, I found the same thing when debugging last week. Not expected, but reasonable."
1533,1558293096.3629,Deangelo,"I’m trying to call a server from my `clojure` app using `http-kit + enlive`. I’m basically trying to scrape a single page daily, but that page is JS rendered. Is there a way to somehow wait for javascript to render the page?"
1533,1558293153.3633,Meagan,you’ll have to use a headless browser like chromium; I believe there’s a Clojure library for doing this: <https://github.com/igrishaev/etaoin>; <https://github.com/igrishaev/etaoin#using-headless-drivers>
1533,1558293269.3647,Deangelo,thank you :slightly_smiling_face:
1534,1558323558.3664,Roselia,How to set `*print-namespaced-maps*` to `false` via `project.clj` for nrepl 6.0 `:init` doesn't work
1535,1558324509.3677,Lorenza,"Is there a library that would parse edn (as edn not text), kind of like spec but maybe with more of a focus on speed ?"
1536,1558329626.3692,Donetta,"Could someone tell me (or link me) the way in which I can define the ""entrypoint"" for a project using clj?  as if I were to type `clj -m my-package.core` ?  I assume some setting in deps.edn?  But main-opts at the top level doesn't seem to do the trick so May have missed something"
1536,1558329732.3702,Lavinia,"<@Donetta> just define a `-main` function in the namespace my-package.core and make sure you have `:paths [""src""]` in your deps.edn, so clojure can find your namespace definition"
1536,1558329777.3711,Donetta,"thank you - will the paths [""src""] setting assist with tools like Cider finding / auto-loading the file(s) on repl start?  I notice in lein projects that happened automatically for me, but with the deps.edn set up, I have to manually load each file"
1536,1558329906.3726,Lavinia,"`:paths` sets the classpath, where clojure searches for classes/namespaces. If currently `(require 'your.namespace)` doesn't just work and you have to load files manually, then you are missing `:paths` definition in your deps.edn"
1536,1558329940.3728,Donetta,ty
1536,1558329996.373,Lavinia,np
1536,1558330199.3741,Madeleine,"You can check in *Messages* buffer to see the command Cider ran to start nRepl; You should see it using your deps.edn; If not, it could be an issue there, where Cider is not starting nRepl in the context of your deps.edn"
1537,1558340156.3758,Madelene,I think their usage is correct if you read it as _reified as a value_.
1538,1558344296.3779,Deangelo,"hi everyone. where do you usually deploy your clojure apps?
I've tested a few - heroku, digitalocean, aws. heroku seems to be the most straight forward, easy and super quick one. it took me more than an hour on the other two. so was wondering if there are any other services out there"
1539,1558347254.3785,Thuy,Hey! I might be asking in the wrong channel but here it is:; I am looking for a library to create gists on github; a clojars search for github yielded decade old libs; d you have a recommendation?
1539,1558348381.3818,Fatima,"Github API looks very straightforward. I’d personally approach this by generating the required HTTP-request(s) with `clj-http` or something similar. <https://developer.github.com/v3/gists/#create-a-gist>; Another option could be using one of the Java libraries via interop, for example <https://github.com/eclipse/egit-github/tree/master/org.eclipse.egit.github.core>"
1539,1558348788.383,Thuy,thank you <@Fatima>; I'm inclined towards clj-http
1539,1558348969.3838,Fatima,Hmmm this is not maintained but it might just work <https://github.com/Raynes/tentacles>
1540,1558350182.3859,Alleen,"tricks I keep on forgetting :
• when you need a function that ignores its argument and returns nil, you can use `{}`
• when you need a function that ignores its first argument and returns its second argument, you can use `{}`
```(update {:a 1 :b 2} :a {})
#_=&gt; {:a nil, :b 2}
(update {:a 1 :b 2} :b {} 3)
#_=&gt; {:a 1, :b 3}```"
1540,1558351157.3867,Clarine,I think the “new” `:skip-whitespace` option should default to `true` in data.xml because upgrading from 0.0.8 to 0.2.0-alpha6 broke our code
1541,1558351748.3875,Nisha,"What could possibly result in exceptions disappear silently?; Here and there I found some functions in my code failing silently, where I expect them to throw exceptions and break the loop. I don’t understand why."
1542,1558352512.3899,Alleen,"looking at asynchronous constructs such as futures, agents or go blocks is usually a good start"
1543,1558354962.3901,Tarsha,maybe this is related <https://stuartsierra.com/2015/05/27/clojure-uncaught-exceptions>
1541,1558358723.3904,Nisha,"Ha that’s it. Thanks!; However, `Thread/setDefaultUncaughtExceptionHandler` doesn’t seem to fix it for `future` in my case. I use `future` to run a loop and never deref the future.

Does that mean I should get rid of `future` and use something else instead?"
1541,1558359460.391,Alleen,"yes, a future that is never derefed is a code smell. you may consider using a plain j.u.c.Executor instead"
1541,1558359880.3997,Nisha,That’s pathetic… Why don’t we have a simple `thread` in the core?
1544,1558359993.403,Domingo,"Hi, everyone
I had a question about state and persistence :
The thing is I have an atom as the main state of some module ... and the persistence (into db) is handled by adding a watch on that atom that translates the diff of two subsequent states into a transaction (put new state + put the transition)
However due to asynchronous behavior of watches (and fast state updates) ... I get foreign key errors, since the previous state is not inserted (transition has a foreign key constraint to state)
My questions :
- what is the best way to handle it?
- and is such a scheme for state managment rational, at all?"
1544,1558360247.4031,Shayla,"""pathetic"" seems harsh"
1544,1558360290.4033,Alleen,probably because the core is already big enough and java interop works well for this kind of stuff; BTW clojure functions implement java.lang.Runnable so spawning a thread manually from clojure is a one-liner
1544,1558360613.4065,Bee,"I think part of your problem is that you're using one identity (an atom) to try and control a huge grid of identities (each column of each row of a table, assuming that you're only trying to sync your atom to one table). It's worth calling out first because it's essential to what you are trying to do, and you cannot change that aspect of your plan without changing your plan."
1544,1558361287.407,Clarine,what are some repo’s that use reader conditionals + `:cljr` ?
1545,1558361752.408,Fernande,<@Clarine> there is this branch: <https://github.com/sogaiu/specter/tree/clr-support> - is that the sort of thing you are looking for?
1545,1558361812.4085,Clarine,yes
1545,1558361969.4094,Fernande,"there is also this: <https://github.com/sogaiu/compliment/tree/clr-support> - in both cases the work is incomplete, fwiw"
1545,1558362017.4098,Clarine,"yeah, I would rather test with established libraries, but it seems they are rare; it seems orchestra is compatible with cljr: <https://github.com/jeaye/orchestra/blob/master/src/clj/orchestra/spec/test.cljc>"
1545,1558366077.4116,Fernande,"<@Clarine> yes, iiuc, <@Tonda> recently added clr support"
1545,1558369024.4118,Tonda,"Tims did all the work, for use with Arcadia: <https://github.com/jeaye/orchestra/pull/37>"
1545,1558372241.4126,Fernande,"ah, i see, thanks for the clarification"
1546,1558373185.4133,Roy,<@Thuy> irresponsible seems to take care of tentacles: <https://clojars.org/search?q=irresponsible%2Ftentacles>; <@Thuy> this is what I ended up using for <https://github.com/exoscale/pullq> and it does the job well
1547,1558375440.4232,Domingo,"Thanks Alex,
I didn’t quite got that. But I could reaally use help.
I have an async component whose entire state is kept inside an atom and each value of the state has a version (i.e. every swap! will increment it)
Upon changing its value the watch will be called which then translates the changes into multiple inserts to multiple tables. The thing is watches invocations aren’t always in order.
So the watch will try to persist sth that depends on a version that itself is not yet written into db; I greatly appreciate your help"
1545,1558378410.4241,Bee,"So, we have three concerns we need to juggle:
- Identity: a place where we hold a successions of states
- State: a single coherent value ""of the world""
- Persistence/Durability: Storing things between processes so that there's a long term record of something of value.; An atom takes care of two of these things, State and Identity, and one Atom allows you to work with one Identity with one State at a time.; You want to take this one Atom and map it down onto a SQL database. Most SQL databases give you strong durability through a table semantic. One table is an NxM matrix of identities, each row/column pair is one thing that can get updated of the other columns in that row and the other rows in that table. If your one atom sprawls over multiple tables, you have an LxNxM matrix of identities you want to stuff into one identity.; So your problems are:
- You are trying to map a 3 dimensional LxNxM matrix of identities into one identity, an atom.
- The tool around atoms you're trying to use to do this, add-watch, does not guarntee each successive state will be handed to the watch in order.; If you want ordering guarantees, then you could maybe look at replacing the atom with an agent. With the agent, you can't synchronously write; you dispatch a write and it completes when every other write previously queued before it completes. You can still use add-watch.; But I think you'll still have a lot of problems by trying to hide your DB away behind an atom, or an agent, or any other in memory identity in Clojure, and encourage you to not do that."
1545,1558379051.4254,Liane,"yep makes sense, thanks sean"
1548,1558387545.4277,Liliana,"how does one AOT a clojure var, I'm using isBound on clojure.lang.Var
both `^clojure.lang.Var var` and `(:import [clojure.lang Var]) .... ^Var var)` result in
```
java.lang.NoClassDefFoundError: clojure/lang/Var
```"
1548,1558388200.4285,Rosaline,how are  you aot compiling and how are you trying to run your aot compiled code; it sounds like you are not including the clojure runtime with your aot compiled code
1548,1558388623.4302,Liliana,"I'm using badigeon via tools.deps, yes that's most likely the reason, it's a new api, so wasn't sure if this was the code or the build tool.; well wasn't sure with that var as well, since I'm trying to prevent reflection on mikera's namespace tool"
1549,1558406685.4317,Jaimee,"thank you, I found the problem, it came from me not freeing some tensorflow ressources"
1550,1558409324.4329,Riva,"I'm trying to get the duration of some mp3 files, anyone around that can point me in the right direction for doing that with clojure?"
1550,1558409584.4333,Jasmine,"there's a java sound api in the JDK, googled:  <https://stackoverflow.com/questions/3009908/how-do-i-get-a-sound-files-total-time-in-java>"
1550,1558409791.4343,Riva,"Yeah thats what I came across as well. Looks like thats what I'll be going with, thanks"
1548,1558413326.435,Domingo,"Yep that’s it; Thanks alot, Alex; Am I right to think that by the last comment you mean to push all state into db and not to hold any in identity in memory then?"
1551,1558438832.4389,Thuy,Thanks! I'll take a look.
1552,1558444756.4396,Bee,"You're already holding state in the DB; the only question is what interface you put over it. If you give yourself good tools for reading information out of the DB that you can reason with, then you'll have a program that's easier to reason about as a whole. As a start, you could pull maps, or vectors of maps out of the DB as a discrete read operation, and likewise have discrete writes. And there's a lot of tools already built to support you doing this, e.g. honeysql, hugsql"
1548,1558451965.4433,Elaine,"There is some static clojure parser, that support reader macros, reader-eval and maybe read some ""unreadble"" things like `#object[...]`"
1553,1558452035.4437,Jasmine,in what way do LispReader.java or tools.reader not satisfy the bill?
1553,1558452270.4449,Elaine,"```
(LispReader/read (new PushbackReader (io/reader (.getBytes ""[#=(prn :ok)]""))) {})
;; -- expected
;; =&gt; [#reader-eval (prn :ok)]
;; -- actual
;; :ok ;; printed
;; =&gt; [nil]
```"
1553,1558452431.4453,Jasmine,so you want read-eval to not eval?
1553,1558452547.4465,Elaine,Yep
1553,1558452642.4469,Jasmine,"well then, no that doesn't exist afaik :)"
1553,1558452857.4472,Roslyn,maybe rewrite-clj can read that?
1548,1558452867.4475,Roslyn,it even preserves comments and whitespace
1548,1558453031.4478,Harris,"depending on how desperate you are ```user=&gt; (require '[clojure.tools.reader :as r])
nil
user=&gt; (defrecord reader-eval [v])
user.reader-eval
user=&gt; (with-redefs-fn {#'r/read-eval (fn [rdr _ opts pending-forms] (reader-eval. (#'r/read* rdr true nil opts pending-forms)))} #(r/read-string ""[#=(prn 1)]""))
[#user.reader-eval{:v (prn 1)}]```"
1553,1558453196.448,Elaine,"```
(binding [clojure.tools.reader/*default-data-reader-fn* (fn [tag value]
                                                          {:tag tag :value value})]
  (with-redefs [clojure.tools.reader/read-eval (fn [rdr _ opts pending-forms]
                                                 (#'clojure.tools.reader/read* rdr true nil opts pending-forms))]
    (clojure.tools.reader/read-string
      {:read-cond :preserve}
      ""[#=(prn :ok) #?@(:clj [1] :cljs [2]) #object[] ::foo]"")))
```
I think that I will use tools.reader"
1548,1558453243.4482,Elaine,"Just need to figure out how to ""patch"" `::foo/bar` to return something like `#namespaced-keyword [foo :bar]`"
1553,1558453366.4484,Elaine,I will look too. But tools.reader seems to be OK for now
1553,1558454331.4486,Jasmine,"the resolver is pluggable, so you can do that; well, maybe not that pluggable"
1553,1558454564.4491,Harris,yeah you're out of luck for that unless you redef <https://github.com/clojure/tools.reader/blob/master/src/main/clojure/clojure/tools/reader.clj#L343-L361>; not quite sure what a good pluggable mechanism for this would be that avoids exposing the entirety of `read-keyword`; but I'm open to suggestions
1553,1558454690.4499,Jasmine,may I suggest that you don't do that? :)
1553,1558455437.4523,Harris,aye
1553,1558455620.4555,Jonelle,"I’m looking for design advice on a feature. I’m writing some code which hits a REST API. The interface to that API exposes some abstractions like “tags”, which are strings. I want to my code to hide those strings behind a mapping, so that the caller of my namespace can pass in data (which I could spec) which will be replaced with the correct string before calling the HTTP endpoint.
For abstracting over the tags, should I be using … vars? I could write a namespace that just defs each string and have the caller pass those as arguments.
Or maybe just normal keywords, instead? Maintaining a mapping of keyword to string for the tags.
Do namespaced keywords make sense here?"
1553,1558455951.456,Rosaline,if tags is an open set of strings then I would just leave them as strings; strings are a very flexible first class data type
1553,1558456141.4582,Jonelle,"the thing is they’re kind of all over the place — they’re tags on some products. So the punctuation and casing and whitespace is inconsistent. I was hoping to design so the caller doesn’t have to know if the “christmas” tag is “Christmas” or “XMAS” or whatever, they can just say `tags/christmas` or `:christmas`; plus then if the tag itself changes, which is fairly likely to happen (maybe there is an effort to make them more consistent), I can change the value in one spot instead of searching for all occurrences; I think then that means it’s a closed set from my code’s perspective?"
1554,1558460401.4668,Jeannette,"I have timeseries data that is a collection of events. the data is sparse, that is for certain timeframes there are no events. how am I supposed to build on this? do I let the collection with a lot of _nil_ propagate through the system and put nilchecks everywhere? or should I treat the whole timeseries data as a _function_ of time?"
1554,1558460699.4677,Dann,"maybe a sorted set, sorted by timestamp? that makes grabbing all items between times X and Y cheap; while avoiding any need for keys with nil values; ```(cmd)user=&gt; (sorted-set-by #(compare (:t %1) (:t %2)) {:t 0 :a 12} {:t 1 :a 3} {:t 4 :a 0} {:t 8 :a 1})
#{{:t 0, :a 12} {:t 1, :a 3} {:t 4, :a 0} {:t 8, :a 1}}
(cmd)user=&gt; (def s *1)
#'user/s
(cmd)user=&gt; (subseq s &gt; {:t 0} &lt; {:t 5})
({:t 1, :a 3} {:t 4, :a 0})
```; the first arg to sorted-set-by needs to be a comparator of two events; subseq takes the sorted set, and two comparison functions / compared item pairs (it can also take a single pair); instead of saying ""what's the data at time t"" you'd say ""what are the known data points between t and t'"""
1554,1558461537.4708,Jeannette,hmmm let me see how this works out.
1554,1558461618.4718,Dann,you can do the same with a sorted-map with timestamps as keys
1554,1558462348.4725,Rosaline,"whatever the representation, you shouldn't have nils laying around; like, in general, if I had a time series of data it would just be a collection of events, and any time period where there were no events, well there just wouldn't be events from that time period in the collection; if you need to reify your notion of time periods, then you have a set of time periods, and each event refers to a timeperiod, so a time period with no events would be added to the set of time periods, but have not events referencing it; ini either case no weird nils"
1555,1558464224.4759,Elaine,"I think that I found a bug
```
(clojure.tools.reader/read-string 
  {:read-cond :allow}
  ""[#?(:cljs #=(prn :ok) :default 1)]"")
```"
1555,1558465266.4761,Jasmine,"don't you want :read-cond :preserve ?; well, maybe I'm ahead of you - what do you get and what do you want?"
1555,1558465408.4767,Elaine,"ATM I'm just playing and understanding how `clojure.tools.reader` works
Then I see that reader-eval occur in all reader-cond branches"
1556,1558481830.4773,Kirsten,"To expand about nils, this is just for data, functions returning nil is perfectly fine correct? (As long as it doesn't leak into data)"
1555,1558491056.4778,Elaine,I'm trying antlr now
1557,1558505192.4785,Felix,"[(let [x 20]
  '`~x)

(let [x 20]
  `'~x)

(let [x 20]
  `~x)
]; results in [x 20 20] ;; I am confused why the first two differ"
1557,1558508650.4809,Lilli,"the first one is a literal, and is not evaluated; that's what the single quote is for --- it's like saying (quote `~x)"
1558,1558508792.4827,Lilli,_man ... cant escape this backtick_
1557,1558516246.4842,Felix,"Can you walk me step by step through how

(quote (quasiquote (unquote x))
and
(quasiquote (quote (unquote x))

eval to different things ?"
1559,1558524500.4859,Clarine,"has anyone done any benchmarking on moving from regular maps to defrecords? I know they’re theoretically faster, but I’d like to have some numbers and performance characteristics"
1560,1558527289.4872,Jasmine,"They’re not necessarily faster. They are faster in certain ways, so it really depends on your use case.; For instance, records don’t do structural sharing. Depending on your mutation pattern, this could mean using a lot more memory and affecting gc. It’s hard to test that in a micro benchmark.; Construction and access is usually faster. Mutation creates a new object, which may be slower, I really don’t know. Probably depends on number of fields.; Well, access of known fields is probably faster. Access of extra fields is probably slower (since it’s really map access plus a field lookup).; If you really want to know how it affects your particular app, you probably just have to try it."
1560,1558529727.4947,Clarine,"yeah, but that takes a lot of work, since you have to refactor all the places where you access the known keys, so I wondered if there’s already some research done on this. until I know more, I’ll probably won’t change anything"
1560,1558529798.4955,Min,I guess using (map-&gt;Foo ...) can be an anti-pattern too if you're micro-optimizing
1560,1558529815.4961,Jasmine,"well like I said, it's entirely dependent on what you're doing, so there can't be any research that applies to /your app/"
1560,1558529836.4965,Clarine,"I know, but there can be research that describes certain scenarios and heuristics. if the win is only a few nano-seconds I won’t bother"
1560,1558529856.4967,Jasmine,"well, that doesn't exist; I've microbenchmarked various things in the past, but that doesn't tell you gc effects etc"
1560,1558530012.498,Clarine,"for example rewrite-clj has a lot of defrecords, but when you replace the `children` of a node, it creates an entirely new object. that hadn’t occurred to me. so the benefit isn’t clear at all here"
1561,1558538348.4995,Roy,"Hi!; While running lein release from Jenkins the vcs push part does not work, git considers the repo to be in a detached HEAD state"
1562,1558539837.0013,Roy,I think I got it
1562,1558541423.0014,Mira,"<@Felix> my understanding is
1. `tilde` is a *syntax*-unquote, `backtick` is a *syntax*-quote, `apostrophe` is short for `quote` special form
2. first check for `~ those cancel each other out (syntax- quote/unquote)
3. ` stops evaluation and namespaces
4. ' stops evaluation"
1563,1558541835.0027,Nisha,"When I connect to a closed socket, it throws a connection exception, but with a syntax error. Why does this happen?
```Syntax error (ConnectException) compiling at (/private/var/folders/_m/m545vvvx28j2x50v81pjs3bh00l3wz/T/form-init4854649086981149918.clj:1:125).
Connection refused (Connection refused)```"
1564,1558545165.0032,Dann,"anything that happens while loading forms (top level of source, top level of repl) will often be reported as a syntax error; eg. `(def foo (/ 1 0))` is a syntax error because the divide by zero happens while compiling foo; ```user=&gt; (def foo (/ 1 0))
Syntax error (ArithmeticException) compiling at (REPL:1:10).
Divide by zero```; form-int*.clj usually means lein was doing something at the top level of a namespace, you probably shouldn't be doing anything with sockets inside def or the top level of a namespace"
1565,1558549389.0055,Larissa,"Hello all, I´m trying to use clj-time to print local time, but it always get UTC time,  I tried use `(f/unparse (f/formatter ""yyyyMMddHHmmss"") (l/local-now))` and `(f/unparse (f/formatter ""yyyyMMddHHmmss"") (t/now))`but no success. How does it work?"
1564,1558550934.0058,Beckie,"Use the new cljc.java-time from Clojure/North:  <https://youtu.be/UFuL-ZDoB2U>; Can also do `(zdt/now (ZoneId/of ""US/Hawaii""))`"
1564,1558552527.0069,Celestine,"Or `clojure.java-time` that has existed for quite some time ```(! 504)-&gt; clj -Sdeps '{:deps {clojure.java-time {:mvn/version ""RELEASE""}}}'
Clojure 1.10.0
user=&gt; (require '[java-time :as jt])
nil
user=&gt; (jt/zoned-date-time)
#object[java.time.ZonedDateTime 0x6d67f5eb ""2019-05-22T12:14:41.190-07:00[America/Los_Angeles]""]
user=&gt; (str *1)
""2019-05-22T12:14:41.190-07:00[America/Los_Angeles]""
user=&gt; 
```; Either way, I'd highly recommend using a Java Time based solution, like either of those or just raw Java Time with interop, instead of `clj-time` (and I'm one of the `clj-time` maintainers -- that library, and Joda Time, has been superseded by Java Time)."
1565,1558553901.0089,Larissa,"I tried this `(.toString (org.joda.time.DateTime/now) ""yyyyMMddHHmmss"")` and works, it´s better using java-time?"
1566,1558554103.0094,Marlyn,"Yeah Joda is deprecated; If you have the flexibility/choice, switch; If it ain't broke, don't break it :)"
1564,1558556614.0109,Celestine,"And just to be clear <@Larissa> you _don't need a Clojure library at all for this_: ```user=&gt; (java.time.ZonedDateTime/now)
#object[java.time.ZonedDateTime 0x2a448449 ""2019-05-22T13:23:03.927-07:00[America/Los_Angeles]""]
user=&gt; (str *1)
""2019-05-22T13:23:03.927-07:00[America/Los_Angeles]""
user=&gt; 
```"
1565,1558556650.012,Larissa,<@Celestine> Thanks for information
1564,1558556658.0122,Celestine,"That's baked into Java from Java 8 onward. Which is a big part of why Joda Time is considered deprecated -- Java Time was the ""next gen"" of Joda Time, designed by the same folks.; And here's the formatting in full, if you need it: ```user=&gt; (.format (java.time.ZonedDateTime/now) (java.time.format.DateTimeFormatter/ofPattern ""yyyyMMddHHmmss""))
""20190522132639""
user=&gt; 
```; (and you can use `:import` to clean that up, rather than typing out the package names each time)"
1564,1558556878.0138,Marlyn,the name `clojure.java-time` for a library is admittedly confusing and misleading
1564,1558556906.0146,Celestine,"Yeah, and the use of a single-segment namespace `java-time` is awful too."
1564,1558556906.0147,Marlyn,"but like <@Celestine> says, everything you need is already at hand; oof, really?; what's with all these clojure projects that do that?; Did you know the Java Module System will *reject* module jars with single segment names?"
1564,1558557008.0169,Celestine,"I suspect it's ""pushback"" against the `everything.core` convention that Leiningen accidentally gave us all those years ago? :slightly_smiling_face:"
1564,1558557013.017,Marlyn,clj-tuple is an offender I've found
1564,1558557035.0177,Shayla,"what's a ""single-segment namespace""?"
1564,1558557051.0181,Marlyn,"meh I don't know what it comes from, the namespacing advice/suggestion has been there for 10 years; <@Shayla> when you have a namespace named `foo`; rather than `noah.foo`"
1564,1558557090.0192,Celestine,`date-clj` is another one you can hate on :slightly_smiling_face:
1564,1558557117.0198,Marlyn,"you don't have to go ""full Java"" by doing `com.noah.whatever.foo` but namespacing is there for a reason"
1564,1558557137.0206,Celestine,And `date-clj`'s coord is `date-clj/date-clj` :slightly_smiling_face:
1564,1558557137.0207,Marlyn,"lots of projects have `config` as a namespace, yuuuck"
1564,1558557156.0214,Jasmine,what could possibly go wrong
1564,1558557157.0215,Marlyn,you can't mix that with another project with the same defect
1564,1558557162.0217,Jasmine,oh that
1564,1558557167.0219,Marlyn,yeah no biggie; (personal opinion: lots of projects that do this aren't worth using for other reasons.); but to do `clojure.java-time` is especially bad because it implies endorsement of sorts; same with `clojure.jdbc` or whatever that one is called
1564,1558557675.0248,Celestine,"Yeah, don't get me started on that one..."
1567,1558557713.0256,Jasmine,anti-contrib ?
1564,1558557731.026,Celestine,"But it's not really surprising people put `clojure` or `clj` or `cljc` or `cljs` into namespaces and/or artifact names given that they have a single concept in mind and it's for Clojure :slightly_smiling_face:; I called `next.jdbc` that because it's the ""next generation"" of `org.clojure/java.jdbc` / `clojure.java.jdbc` but I didn't want to imply ""authority"" via `clojure` unless it ends up in Contrib and that's looking less and less likely at this point (I have CircleCI and cljdoc in place so most of the benefits of Contrib are accounted for)."
1567,1558563285.0329,Beckie,"I agree that thin wrappers have limited value, but you may wish to check out the video for `cljc.java-time`.  It is a _*cross-platform clj/cljs implementation*_ that avoids the `js/Date` problems.  The clj part is auto-generated wrappers of `java.time`, so that is simple &amp; convenient.  The cljs part is a re-implementation of most `java.time` classes, and does not use `js/Date` at all.  See Clojure/North video for details:    <https://youtu.be/UFuL-ZDoB2U>"
1568,1558565455.0343,Kelle,"hey, does the clj repl support tab completion for namespace members? i know the lein repl does, but it doesnt seem to work when i use `clj -r`"
1568,1558565552.0349,Dann,"no, the clj tab completion is very rudimentary"
1568,1558565567.0353,Kelle,"lol hey justin. damn, okay"
1568,1558565579.0355,Dann,'sup
1568,1558565596.0357,Kelle,chillin :sunglasses:
1568,1558565612.0361,Becki,you can check out rebel-readline for a minimal terminal style thing <https://github.com/bhauman/rebel-readline>
1568,1558565628.0367,Kelle,"ahh cool, tyty"
1569,1558568780.0385,Nadia,woah cool
1570,1558576534.0396,Jaimee,~Is it possible to exclude part of my project from being included in the uberjar depending how I call leiningen?~ nevermind
1571,1558605421.0419,Felix,"in Clojure, is it possible to construct looping (but non lazy) values x, y such that `(= x y)` infinite loops?"
1571,1558606124.0422,Zita,Both infinite and non-lazy?
1571,1558606635.0427,Stephen,`(defn loop-forever [number] (do (println number) (recur (+ 1 number))))` use at your own risk :stuck_out_tongue:
1571,1558606796.0439,Alyce,"following on from that, and just for jest, would it be possible, just thinking, of using clojure reducers, to pretty much cause heat death by having each processor core sum an infinite sequence of numbers..."
1571,1558606869.044,Stephen,somehow it put full load on 2 cores when used
1571,1558607093.0453,Clarine,"would it make sense for clojure itself to enable some sponsporing options? via Github you can now enable several sponsporing links, e.g. patreon, opencollective. if most of the Clojure users would chip in for a couple of dollars a month, would that make a difference to the development of Clojure?"
1571,1558607924.048,Zita,“Somehow.” I’m sure with a little work it could tie up more cores.
1572,1558620523.0501,Onita,"hey everyone, got a super weird bug i’m kind of stuck on. i have a collection of 6000 32-byte arrays that i’m sorting with a function `compare-bytes`. `(sort compare-bytes coll)`. when the comparison function hits a particular element, it throws an exception `Comparison method violates its general contract!`; if i generate a separate collection of 6000 randomized 32-byte arrays, it works fine. even beyond 50,000 elements, no exception is thrown; it’s only with this specific collection. i can see nothing odd about the element on which the comparison function breaks down; also, `(= 6000 (count (distinct (map bytes-&gt;hex coll))))`"
1572,1558620774.0527,Becki,can you post your compare-bytes fn?
1572,1558620809.0533,Onita,"oh yeah, should have mentioned: it’s not mine, it’s the one in `ztellman/byte-streams`; i’ll get a link; <https://github.com/ztellman/byte-streams/blob/3e0822b58172b8d351b366213eda6090892e32b3/src/byte_streams.clj#L912>"
1572,1558621010.0544,Jasmine,wrap it in your own comparator function that catches and prints the inputs
1572,1558621135.0552,Onita,"i tried this earlier, but the exception comes from the sort and not the comparison, so i’m not sure how to grab the breaking elements; i guess i could just print all of them. one sec"
1572,1558621183.0563,Jasmine,"I believe you get this exception in Java when the transitive property doesn't hold (that is, e1 &gt; e2 and e2 &gt; e3 but NOT e1 &gt; e3), which is presumably something the sort relies on"
1572,1558621208.0567,Onita,"yeah, that’s what google seems to say; must the function only return something ε [-1, 0, 1]? i noticed it can return other values"
1572,1558621247.0581,Latonya,Ooh!  Debugging why a comparator is not a total order.   Looking at it ...
1572,1558621259.0587,Jasmine,can be other values
1572,1558621265.0593,Latonya,"The JVM can handle negative, 0, positive fine."
1572,1558621270.0596,Onita,i mean they seem correct (negative when l&lt;r etc)
1572,1558621284.0599,Jasmine,"given that this is a property, it's a perfect candidate for a generative test with test.check"
1572,1558621330.0601,Onita,"ha, seems it’s been done <https://github.com/ztellman/byte-streams/blob/b5f50a20c6237ae4e45046f72367ad658090c591/test/byte_streams_simple_check.clj>"
1572,1558621359.0606,Jasmine,that's not a transitivity test
1572,1558621359.0607,Onita,"oh, guess it’s not really checking transitivity; yeah"
1572,1558621372.0613,Jasmine,"but could easily be extended to do so! :); just gen a / b / c, and verify that if a&gt;b and b &gt;c, that a&gt;c; test.check will spit you back a failing example"
1572,1558621457.0622,Onita,sweet! on it
1572,1558621938.0639,Latonya,"Something that seems odd to me in cmp-bufs, which the function you linked calls in most/all cases - it calls a ByteBuffer .getInt method in some cases, or .get.  From my reading of Java API, those mutate a ""position"" member of a ByteBuffer object.  I don't yet see anything that initializes this position back to the beginning of the ByteBuffer, which would be a problem if the same ByteBuffer was compared more than once."
1573,1558623461.0641,Latonya,"Digging a bit further, I don't think that is it.  cmp-bufs appears to be using the ""absolute"" variants of the .getInt and .get methods, which might not mutate the position field at all.  It didn't on my first attempt trying it, to see if it did modify the position field.; Next guess to investigate -- cmp-bufs has an optimization where for buffers that contain at least 4 bytes, it gets 4 bytes at a time to compare, until it gets to the end, then does 1 byte at a time.  It uses p/- to subtract 2 32-bit integers, which can wrap around when the result is a 32-bit integer, too, and cause a JVM comparator to behave in undesired ways, as described in ""Beware using subtract"" section of this article: <https://clojure.org/guides/comparators>"
1574,1558625625.0648,Onita,quite the rabbit hole..
1572,1558625786.0651,Latonya,"I will let you know if I find anything, or give up on it.  Haven't given up yet.  My current suspicion is that most of the calculations and the return value are longs (64-bit signed integer), but Java comparator functions expect int (32-bit signed integer), and Clojure takes any value returned from a comparator function and coerces it to int via the .intValue method, which can be a different sign than the long value.; I suspect I can find a 4-byte ByteBuffer content for three byte buffers such that their comparison results are consistent if you look at the sign of the long, but inconsistent if you look at the sign of the coerced values returned by .intValue on those longs."
1574,1558626086.0655,Onita,"thanks a lot! this is definitely out of my league at this point. i ran a test.check for transitivity and it passed, as i kind of expected"
1572,1558626287.0657,Latonya,"This may be a case where it requires having an ""extreme"" combination of 4-byte values, e.g. those that when looked at as a 32-bit int, are either at or near the min possible value, max possible value, or near 0.; unless your random test case generation artificially stresses such values, it could take a very long time to find such corner cases."
1572,1558626425.0661,Onita,"would it help if i provided you with the actual collection i was using?; <https://pastebin.com/Hh3EVYXy> (6000 32-byte strings, not delimited); fails on 5632nd element"
1572,1558626736.0668,Latonya,maybe  can email info to me at <mailto:andy.fingerhut@gmail.com|andy.fingerhut@gmail.com> if data is not secret or anything
1572,1558626798.067,Onita,it’s in that pastebin link
1575,1558631822.0673,Latonya,"I have a pair of 4-byte ByteBuffer values such that (compare-bytes b1 b2) and (compare-bytes b2 b1) both return a negative value when converted to 32-bit int, so that looks wrong.  I don't think it causes the exception, but shows that the comparator is not good.; I have a proposed change to function cmp-bufs in that library that I think should correct the problem.; Would you be interested in trying it?  The change is replacing the first of two occurrences of `(p/* sign cmp)` in the file byte_streams.clj in function cmp-bufs with `(p/* sign (if (pos? cmp) 1 -1))`"
1575,1558632494.0679,Onita,"yeah, sure!"
1575,1558632823.0681,Latonya,"I'd like to find my own smaller sequence than yours that also causes the exception to be thrown, but I may not generate the necessary enthusiasm for that if that change fixes it for you, and just submit a PR with that change, plus some other tests that give wrong results without the change; In my limited testing, that change fixes the problem I found with a pair of values where (compare-bytes x y) and (compare-bytes y x) both return a negative value, meaning ""x &lt; y"" and also ""y &lt; x"".  I suspect it will also eliminate the exception you saw thrown.; Created a PR here, if you want to follow along: <https://github.com/ztellman/byte-streams/pull/39>; case anyone is interested in the issue <@Onita> was asking about, but doesn't want all the gory details in the thread, I do not know if I have fixed the bug he found, but I have a proposed fix that definitely improves the result of compare-bytes for a bad case I found where it can return (x &lt; y) and also (y &lt; x) for many pairs of byte streams x and y.   <https://github.com/ztellman/byte-streams/pull/39> is the PR if you want to track it."
1576,1558636016.0713,Madeleine,"I thought datafy could transform a Java object into Clojure data, am I wrong?; Like say I want to extract all values from a Java object into a Clojure datastructure instead like say EDN; And I want that to be deep"
1576,1558636233.0728,Rosaline,yes; in the sense that datafy by default doesn't do anything
1576,1558636343.0744,Madeleine,"So, when I call datafy, it just prints the object memory address"
1576,1558636350.0747,Rosaline,"right; ```
(defprotocol Datafiable
  :extend-via-metadata true

  (datafy [o] ""return a representation of o as data (default identity)""))
```; if you have something you want turned in to data in a particular way, you have to extend the protocol to do it"
1576,1558636419.0766,Madeleine,Oh. Okay I guess I assumed that Java objects had a smarter default then identity
1576,1558636433.077,Rosaline,"I am also not sure how deep the 'datafy' should go; from my understanding a intended use case is kind of a cycle from datafy to nav and back again; you datafy something, then nav to something it references, then datafy that, etc"
1576,1558636608.0796,Madeleine,"Oh right, so each datafy is one level. And to go deeper you have to recursively datafy. Makes sense. So it handles circular graphs"
1576,1558636687.0816,Dann,"or things that are method calls returning data under that object, which may be newly generated or may just be a getter for existing contents"
1576,1558636760.0822,Celestine,"Think of `datafy`/`nav` as an extended, explicit form of laziness."
1576,1558636895.0825,Madeleine,I still wished there was a default datafy for objects.; Don't really want to implement my own reflection field parsing
1576,1558637000.0835,Dann,"for things that use normal getter methods, there's `bean`; and there's definitely other reflection libs for making data out of objects that satisfy a few assumptions, IIRC TimMC made one..."
1576,1558637171.0848,Madeleine,"Ya, bean is there, but not deep. It's okay, I'll just use GSON; And then Cheshire to pull that into Clojure; Hum... there seems to be clojure.java.data"
1576,1558637898.086,Jasmine,"yes, java.data works too and makes different choices"
1577,1558640225.0878,Johnathon,does cognitect's aws-api library support signing CloudFront URLs? i inspected the ops of `com.cognitect.aws/cloudfront` but don't see anything related. same with `com.cognitect.aws/signer`.
1577,1558640282.088,Marlyn,it does not <@Johnathon>; it may be worth having an add-on library that does presigned URLs for cloudfront + s3
1578,1558641201.089,Jonelle,"out of curiosity, what would you name this function?
```
(defn- foo
  ""Take `n` random elements from `coll`, choosing those that satisfy `pred` first.""
  [n pred coll]
  (let [[preferred rem] ((juxt filter remove) pred coll)]
    (take n (concat (shuffle preferred) (shuffle rem)))))```

e.g.
`(foo 3 even? [1 2 3 4 5 7 9])  =&gt;  (4 2 1)`"
1578,1558641291.0894,Latrice,extract or pluck would be my suggestions
1578,1558641372.0898,Jonelle,"I was thinking something like `take-rand-preferring`
or `take-rand-biased` but bias might suggest probability"
1578,1558641473.0916,Esther,"I like the word draw (as in drawing a hand of cards), but that would probably be more confusing due to double meaning"
1578,1558641531.0923,Latrice,naming things is hard. :sweat_smile:; random-sample
1578,1558641613.0941,Jonelle,`random-sample`  is in clojure.core; it’s hard but I find it weirdly enjoyable
1578,1558641673.0958,Latrice,`sample-randomly` :laughing:
1579,1558645150.0961,Johnathon,"thanks again, <@Marlyn>"
1578,1558652011.0971,Dann,"I accidentally wrote random-sample on IRC, and someone on the channel was like ""I know you are joking but that's actually useful"" and it ended up in core"
1580,1558652031.0976,Dann,"it's too simple to take much credit for, but I found the whole process amusing"
1580,1558657549.0982,Cherri,"newbie question:   in :   ""(wrap-cors :access-control-allow-origin [#""<http://localhost:3000/>""]); what ""#"" means?"
1580,1558657610.0987,Dann,"```user=&gt; (class #""foo"")
java.util.regex.Pattern```; #"""" is a data reading literal for regular expressions, and can be used with things like string/replace, re-matches, re-find; <@Cherri> a guide to various weird sigils in clojure programs <https://clojure.org/guides/weird_characters>; link directly to the regular expression syntax <https://clojure.org/guides/weird_characters#_regular_expression>"
1580,1558657769.1006,Cherri,cool! thanks a lot!
1581,1558687657.0018,Lorenza,Is there a way in a test to tell it to just fail ? like for instance if the wrong dispatch function is called; and without resorting to (is (= 1 2)) or some (assert false ...) trickery; hum maybe just throwing an exception would make it i guess
1582,1558695431.0046,Lelia,Does anybody know who I have to contact if I want to delete my own package in clojars?
1582,1558696321.0053,Isreal,"Hi <@Lelia>, did you see <https://github.com/clojars/clojars-web/wiki/About#how-do-i-delete-a-jar>"
1582,1558699965.0055,Lelia,Thank you. It seems deleting it just put another burden for the admin.
1583,1558700590.0074,Maximina,"Is there any `Redis` library that implements delayed task scheduling?

I need to delay a task which is distributed and kept in redis, something like this one: <https://stackoverflow.com/questions/10868552/scalable-delayed-task-execution-with-redis>

I currently listen to `expire` keyspace notifications.. not sure if that is so scalable."
1583,1558701339.0079,Ivana,hmmm funny sounds very similar to what i'm looking at right now (maybe i'm wrong); you can put timestamps in redis keys so you are independent of Redis time constructs? (need to put the expiry on keys big enough so it doesn't interrupt with your own logic); are you working in a particular domain?
1583,1558702714.0118,Maximina,"Not really, its just that I want to do it in a way that scales :slightly_smiling_face:"
1583,1558702863.012,Ivana,"then not use Redis :slightly_smiling_face:; but <https://www.aerospike.com/docs/guide/llist.html>; or maybe the wrong datastructure one sec; <https://discuss.aerospike.com/t/how-would-one-implement-a-sorted-list-like-redis/1046/2>; Anyway hard to say if that will solve your issue, and if Redis is the bottleneck at all"
1583,1558703496.0157,Shayla,"in the card game I'm working on, I have a ""card"" object, which is just a map with certain properties. To make interacting with the objects easier, I have a bunch of ""accessor""/getter functions: `corp?` returns true if the card is a Corp card, `installed?` returns true if the card is currently installed, etc. These functions are all solely reliant on the card map passed in"
1584,1558703601.0178,Shayla,"Is there any ""best practice"" with organizing groups of functions like this? Seeing as I'm not creating multiple types, I don't see a benefit necessarily of using a protocol. if this was in java, these would all be normal ""attributes"": `public isCorp()` etc; I've moved them into a `card-properties` namespace and `[card-properties :refer :all]` them, but I feel like I'm falling into a trap or a code smell, lol"
1585,1558705891.0194,Asha,Collecting them in a namespace seems reasonable to me
1586,1558709884.0204,Zona,for the basic ones you could do away with the `fn` and replace with keyword `(:installed? card)`; given `(def card {:installed? true})`
1586,1558710259.0208,Shayla,"Sadly, a lot are more like `(= ""Hardware"" (:type card))`, which is a little more annoying and messy to write inline. And then of course, because it's a complex game, others are `(or (= ""Identity"" (:type card)) (= ""Fake-Identity"" (:type card)))`, which is _really_ annoying to write multiple times"
1586,1558714552.0211,Zona,"I feel like I've heard <@Cher> talk about this kind of decision on his podcast, <http://Lispcast.com|Lispcast.com>. I'm sure he's got way more insight than me :wink:"
1587,1558724386.0238,Brent,Can `[pre|post]walk` be used to extract selected leaves from a nested data structure? How? I want to descend only into some submaps and extract particular key from the leaf maps.
1587,1558724442.0242,Clarine,"<@Brent> do you want to prune the tree or get a series of values out of it?; ```
(w/postwalk (fn [m] (if (map? m) (select-keys m [:a :b]) m)) {:a 1 :b 2 :c {:a 1 :b 2 :c 3}})
{:a 1, :b 2}
```"
1587,1558724602.0246,Shayla,thanks for the recommendation! i'll check it out
1587,1558724642.0253,Dann,<@Brent> I've used `tree-seq` plus a filter to select leaves for this sort of thing
1587,1558724670.0258,Brent,I want to get out a seq of (leaf) values but exclude some branches
1587,1558724743.0264,Dann,how far above the leaves are the branch points you know you won't want?
1587,1558724757.0267,Clarine,"something like:
```
(remove map? (tree-seq map? #(vals (select-keys % [:a :b])) {:a 1 :b 2 :c {:a 1 :b 2 :c 3}}))
(1 2)
```
?; taking a look at clojuredocs for those functions might give you an idea"
1587,1558724825.0272,Brent,"doesn't tree-seq return all nodes instead of only leaves?; ± 1 and 2; Thanks, I think tree-seq doesn't do what I need but I can look at its implementation and copy that for my use case. (The thing is I have a nested data structure consisting of maps _and_ seqs)"
1587,1558725090.029,Dann,"usually with tree-seq my predicate is `coll?` which catches maps and seqs; but instead of `coll?` you can use a predicate that both checks for `coll?` and removes branches you don't want; `(fn [node] (and (coll? node) (not (ignored? node))))` - where ignored? checks for k/v pars with excluded keys, or whatever; right, but you can take the final sequence of nodes and return only leaves
in your `branch?` and `children` functions, you can prune nodes whose children are not wanted; in fact the function to return only the leaves should just be `(filter (complement branch?) ...)` where branch? is the same function you passed to tree-seq initially"
1588,1558726235.0315,Dann,"```(cmd)user=&gt; (load-file ""/tmp/foo.clj"")
(1 4 6 7)
(ins)user=&gt; (print (slurp ""/tmp/foo.clj""))
(def input
  {:a 1
   :b {:a 2
       :b 3}
   :c {:a 4
       :b 5
       :c 6}
   :d {:a 7
       :b {}}
   :e {:c 8}})

(def unused-keys
  #{:b :e})

(def branch? coll?)

(def children
  #(map (fn [node]
             (if-not (map-entry? node)
               node
               (if (contains? unused-keys (key node))
                 []
                 [(val node)])))
           %))

(remove branch?
        (tree-seq branch?
                  children
                  input))
nil
```"
1587,1558726335.0327,Dann,"that declines to descend into keys and only returns vals out of key/value pairs, and removes all keys in a blacklist instead of descending deeper when found"
1587,1558726493.0332,Beckie,<@Brent> You can easily process tree-like data structures with the Tupelo Forest library.  See the Lightning Talk:  <https://youtu.be/RtavTnRr0oM>; the README:   <https://github.com/cloojure/tupelo/blob/master/docs/forest.adoc>; and many live examples:   <https://github.com/cloojure/tupelo/blob/master/test/clj/tst/tupelo/forest_examples.clj>; and the API docs:   <https://cloojure.github.io/doc/tupelo/tupelo.forest.html>
1587,1558726717.0346,Meagan,are there any libraries for doing bidirectional transformations of Clojure data?
1587,1558728444.0349,Brent,thanks!; thanks a lot!
1589,1558728858.0356,Jenny,are there any other clojure/clojurescript streamers?  i know of <https://www.twitch.tv/jplur_>
1589,1558729392.037,Celestine,There's a <#C3M107FGW|livestream> channel where folks used to talk about that but it's been inactive for a long time :neutral_face:; I think it would be fun if folks got that back up and running <@Jenny>... it's always very interesting to see different people's workflows!
1589,1558729558.0383,Jenny,"yeah, that’s mostly what i’m interested in. the details of workflows that don’t always get documented on github pages, etc."
1589,1558729782.0393,Celestine,"I can't remember what I tried to use to stream with back then... Not Twitch, for sure. But mostly I work on a proprietary code base so streaming isn't something I can really do much of the time.; I did do a short YouTube video recently of my workflow with REBL (and Atom/Chlorine).; (because folks kept asking about ""how to use"" REBL)"
1589,1558731118.0414,Becki,someone livestreamed (and recorded) their advent of code solutions. I think <@Phebe> and <@Simonne>?
1590,1558734541.0415,Arlen,"What do you mean by ""bidirectional""?"
1590,1558734959.0417,Meagan,"precisely <https://en.wikipedia.org/wiki/Bidirectional_transformation>; ex. have a transformation `t` that takes some clojure data `a` and transforms it into `b`, and can also apply the transformation to take `b` into `a`.; one of the things that seems to come up in literature is taking an updated `b` and transforming it into an updated `a` as well; does that make sense? :grimacing:"
1591,1558746227.0431,Simonne,yep! <https://potetm.com/videos.html>
1592,1558750630.0438,Rosalba,"So here's a surprising thing I just found: (java.net.URI. ""<https://google.com>"") actually fetches the page; The javadoc didn't mention that, as far as I can tell.; Also, it seems to throw up on localhost uris. Is there a good way to validate uris without fetching?"
1592,1558751650.0454,Simonne,"<@Rosalba> Why do you think `(URI. ""<https://google.com>"")` makes a network call?"
1592,1558751702.0459,Rosalba,because it dumped the response in my repl; does it not do that for you?
1592,1558751774.0463,Simonne,"for me:

```
(java.net.URI. ""<https://www.google.com>"")
=&gt; #object[java.net.URI 0x7abeb19d ""<https://www.google.com>""]
```"
1592,1558751848.0467,Becki,This is a bad cider feature unfortunately; It can be disabled and should be by default. This is the feature to show images in the repl. 
1592,1558751939.0478,Simonne,<https://media.tenor.com/images/8170135a5927612c8f3ee75c4c1daa92/tenor.gif>
1592,1558751959.0481,Rosalba,"ah, I see; thanks :smile:; Do you know what the feature is called, that I may disable it?"
1593,1558755189.0494,Becki,i think you want `(setq cider-repl-use-content-types nil)`
1593,1558755421.0496,Rosalba,thank you
1593,1558762285.0507,Alison,"I was surprised to find that form metadata doesn’t contain `:file` by default for quoted forms, only `:line` and `:column` - I thought it did."
1594,1558762336.0516,Alison,"Reading the source, it looks like this is because `:file` metadata is added by the compiler, not the reader - is that correct? Is there any trickery I can use to get the file from quoted forms?"
1593,1558762434.0527,Alison,"Actually, no, it looks like `:file` is only added for vars in the compiler. I guess this is because the reader is reading from Reader, not necessarily a file."
1593,1558763270.0528,Arlen,"Sure. I don't know of any library that does that, except of course for very narrow cases like serialization.; Or, you know, inc and dec :p"
1593,1558769582.0535,Merna,<https://github.com/gfredericks/bijector>
1593,1558786562.0542,Jasmine,Sounds right
1595,1558789862.055,Hilaria,"[clojure deps question] in an Ubuntu env, I can run `git clone git@github.com:my-workspace/my-project` and it runs fine using the SSH keys, but when this project is added as dependency for other project like `my-project {:git/url ""git@github.com:my-workspace/my-project"" :sha ""0123...""}`  I get an error:
```Cloning: git@github.com:my-workspace/my-project
Error building classpath. connector is not available: 
com.jcraft.jsch.agentproxy.AgentProxyException: connector is not available```
Am I missing a configuration somewhere? :slightly_smiling_face:"
1595,1558803750.0564,Erna,<@Hilaria> Have you looked at the `Git configuration` section of <https://clojure.org/reference/deps_and_cli>   Perhaps that can help.
1595,1558803809.0572,Hilaria,thanks <@Erna>! I just fixed it. it was an issue with ssh-agent on that machine.
1595,1558804284.0577,Erna,Great. Glad it is resolved.
1596,1558809792.0592,Alethea,"hey everyone, is there an easy way to load edn files with env vars attached to specific lein tasks?

`lein test` would load `test-config.edn` while `lein run` would load `dev-config.edn`"
1596,1558811174.0617,Mariela,"sounds like an ""xy"" problem tbh... are you using Component/Integrant in the first place? They make it straightforward to have per-env systems, with different configs"
1597,1558814437.0638,Sade,"Using reitit, I have an html file in my resources/public that I wish to serve as my root ""/"". With the following code it serves it, but does so with a `302 redirect` to `/index.html`. How can I just straight up serve without the redirect? Why is it redirecting at all?

`(response/file-response (str (io/resource ""public/index.html"")))`; ^ (response is ring.util.response)"
1597,1558814565.0645,Kaylene,why not using resource-response ?
1597,1558814592.0648,Sade,"Hmmmm.... I'll try that; I didn't know about it; Thanks; that does the trick! Still not sure why the file-response was resulting in a redirect, though; Oops; actually, doesn't work, because it tries to download as an octet stream when I hit it with a browser"
1597,1558815532.0656,Kaylene,"you could read the file as a string
and respond with it in the body and content type set to text/html"
1597,1558816124.0658,Sade,"Yeah, I figured that would be a last resort"
1598,1558820357.0668,Alethea,Ill take a llok into component thx :smiley:
1599,1558870826.0684,Ashely,Can the clojure compiler detect side effects in functions? Can it decide at compile-time whether a function is pure?
1597,1558871158.0686,Herman,"<https://github.com/gnl/ghostwheel>

apparently, yes."
1598,1558872924.0698,Aubrey,I wouldn’t rely on that to be exhaustive though! There’s nothing in the language to make such a guarantee.
1599,1558873094.07,Ashely,"I’m interested in whether the compiler could automatically memoize all pure functions. Could effect massive speed improvements, minimal amounts of memory increase, with very little risk"
1598,1558874388.0702,Stephen,I don't think it's minimal. Like any function that does something on a data structure using an uuid is unlikely to be called twice with the same.
1598,1558878282.0707,Milford,"An interesting aside on the ClojureScript side, once Google Closure knows a function is pure, it does certain optimizations with it. Here is one case where it is incorrect: <https://github.com/google/closure-compiler/issues/3079>"
1600,1558878626.0711,Milford,"I suppose they have a notion of ""no side effects"" in this case, which is different than ""pure"" via their terminology <https://github.com/google/closure-compiler/wiki/Annotating-JavaScript-for-the-Closure-Compiler#nosideeffects-modifies-thisarguments>"
1601,1558884886.0713,Herman,Yeah my initial impression was that you could probably do a whole dissertation on this topic and still only come up with a method that only works on a restricted scope of language features
1600,1558887587.0738,Meagan,Clojure as it’s written can not. But a runtime certainly could detect at runtime and do certain optimizations. Or if code was written to be explicit about its effects
1602,1558888739.0756,Enola,"It has probably been discussed numerous times but I can't find any answer.
I have these macros:
```
(defmacro format-query [q]
  `(cond-&gt; ~q
     (map? ~q) (sql/format :quoting :ansi)))

(defmacro query [c q params]
  `(jdbc/query ~c ~(format-query q) ~params))
```
The issue is that `(query 1 2 3)` expands to `(jdbc/query 1 2 3)` whereas I want it to expand to `(jdbc/query 1 (cond-&gt; 2 ...) 3)`. Is it possible to do so?"
1602,1558889456.0765,Meagan,"based on your code, i’m not sure why it would expand to `(jdbc/query 1 2 3)`; but I think in this case you can change `format-query` to be a function, rather than a macro; and that might be what you want?"
1602,1558889609.0779,Roslyn,"should be
```
(defn format-query [q]
  `(cond-&gt; ~q
     (map? ~q) (sql/format :quoting :ansi)))

(defmacro query [c q params]
  `(jdbc/query ~c ~(format-query q) ~params))
```; first macro should be a function <@Enola>"
1602,1558889688.0795,Enola,"Sure. But now I can't use `format-query` anywhere except for other macros. I guess a solution in this case would be to extract the common part to another macro.
That's what I'll probably do. Thanks!; Can you help me understand why it's expanded the way it is with two `defmacro`?
The way I read it: `~` in `~(format-query q)` unquotes this part, so that the macro is expanded here. It expands in a form `(cond-&gt; ...)`. The thing I cannot understand is why this form is being computed during macro expansion."
1602,1558890510.0817,Ashely,"Okay, all interesting stuff - thanks everyone!"
1603,1558896497.0829,Meagan,"It was being computed during macro expansion because you used the macro in a macro; So the `format-query` macro was being executed, expanded and then the `query` macro continued evaluating and expanding; I have a need for a sparse vector. Any ideas how I might represent that?; It's a semantic thing rather than a perf thing. I need the inverse of `nth`: construct a vector with a value at position `n`.; And then I also need a way of merging the sparse vectors...; Bleh"
1603,1558896982.0882,Elyse,What other operations do you need to do?
1603,1558897526.0885,Meagan,"Pretty much just those; What I'm trying to do is, for example start with a source like `[1 2]` and project it using `second`. So it would produce `2`.

Then, I could change the projection to `3` and use that to update the source to `[1 3]`"
1603,1558897812.095,Enola,"""Project it"" and ""change the projection"" sound a lot like what Specter does."
1603,1558897876.096,Meagan,I'm basically implementing a lens. I am trying to figure out how to implement it myself rather than use a lib like specter :sweat_smile:
1603,1558898142.097,Elyse,The operations you mention above sound like they could be easily done on a hash map instead of a vector with regular old `assoc` and `merge`. It's not entirely clear to me how those things fit in to your lens implementation.; I suppose you could hold onto the novelty in a hash map and do the merge by `assoc`ing the novelty from the hash map into the vector.
1603,1558899786.0985,Meagan,"Right, the issue is the source to the data is a vector and that needs to be preserved"
1604,1558906162.1003,Deangelo,"hi everyone. is this an overkill?
```(some? (some-&gt; project :images :thumbnail))```"
1603,1558906169.1005,Deangelo,to check for non-nil value; looks a bit weird :smile:
1604,1558906468.1018,Roslyn,"why not just `(-&gt; project :images :thumbnail)`? thumbnail is probably not a boolean, so just having a value where you do check for nil is ok; or `(-&gt; project :images :thumbnail some?)` if are you really into booleans :slightly_smiling_face:"
1604,1558906552.1034,Sheron,"btw. if you want to get your clojure hat on on the raspberry pi 3 b+ .... installing zulu jdk &amp; lein works surprisingly easy; but trying to use openjdk from adoptopenjdk won't work , something with ssl connections and elliptic ciphers is broken there :disappointed: ... so zulu instead and life is good"
1603,1558906932.1053,Deangelo,<@Roslyn> I thought it would throw an exception if I did it without `some-&gt;`
1604,1558907072.1062,Roslyn,"keywords, when called as functions on nils just return nil `(:a nil) =&gt; nil`"
1604,1558907113.1065,Deangelo,"gotcha, thank you"
1605,1558923343.1069,Onita,"looks like this got merged in, great! should be really easy to check if this worked, but i’m not sure how to tell if the jar has been updated. the version number is the same, so i assume not yet"
1606,1558927297.108,Nisha,"Is there a way to fan out a seq, turning a seq into multiple seqs?; It seems straight to me how to fanout a channel into multiple ones, but I’m not using async, so I wonder if there’s a way to achieve the same thing for seq.; My real use case is that, I’m parsing a stream of bytes from a socket with a telnet-like protocol. I want to separate the telnet command bytes from the text bytes."
1606,1558927622.1137,Madeleine,You could use juxt maybe? Or partition?
1606,1558927692.1145,Nisha,"Currently what I’m doing is turning the bytes into a seq of packets, so something like
```b b b b ... b -&gt; {:type :telent :bytes [1 2 3 4]}, {:type :text :bytes [1 2 3 4]}, ...
```
Then I need to parse all the `:text` to parse out some bytes for another protocol. I guess I can re-assemble all the `:text` packets into a byte seq again, but I am afraid that there will be some performance issue."
1606,1558927877.115,Madeleine,In what way?; Seems in your case you could just do sort-by; Sorry I mean group-by
1606,1558929033.1182,Nisha,"well I don’t see a clear way to do this with `group-by`. To parse a byte and know which type it belongs to, I need to also check its previous and next bytes."
1607,1558929180.1194,Donetta,"Using cljfx, is there a way to use openjfx Canvas?  I can't find a sample on the site, and it isn't immediately intuitive as to how I would do it (or even make a plain OpenJFX element and add it to a cljfx node)"
1606,1558929403.1206,Madeleine,"Oh, sorry I thought your example was showing the datastructure and you had them already parsed into maps"
1606,1558929716.1214,Nisha,"I do have them already into two maps, but this doesn’t work well if I want to parse the bytes of the third type."
1606,1558930621.1223,Madeleine,You need to parse the byte array in the map? Or across them?
1607,1558931444.1247,Colin,"IMO, Should considering `TreeMap, TreeSet, PersistentTreeMap` on fn `last`  implementation"
1608,1558946487.1259,Neida,<@Nisha> So how do you want to groupo your bytes ? By a fixed number ?; So 4 bytes apiece ?
1609,1558953857.1274,Sixta,Has anyone experimented with grpc/protobuf and deps.edn? Is there a good library for compiling protobufs?
1609,1558955319.1279,Shira,google protobuf java library?
1610,1558955411.1288,Shira,just generate java code from protobuf and use it with java interop thats how i do it with kafka
1609,1558955547.1293,Ali,Does anyone know if Clojure works OK in WSL (<https://docs.microsoft.com/en-us/windows/wsl/install-win10>)
1610,1558955689.1308,Ali,"I'm running some compute intensive calculations on my Macbook like an idiot, when I have a monster of a gaming PC sitting in the next room twiddling its thumbs. I though maybe I could kick up a REPL on it and outsource the job."
1611,1558958569.1311,Sixta,"It does, yeah"
1612,1558965163.1334,Rossie,"I have a project that has a sever side component and a client side component. they have different dependencies, and I'm keeping them separate via lein profiles. For development convenience I want to merge the two, and I tried  `:repl [:client :server]` in my project.clj. However, while `lein repl` does not include server-only or client-only deps, `lein with-profile +repl repl` does. Am I misunderstanding hwo the `repl` profile works? Do I add it somewhere else instead? Am I misunderstanding how `lein repl` works?"
1612,1558965512.1339,Becki,"<https://github.com/technomancy/leiningen/blob/master/doc/PROFILES.md#task-specific-profiles> seems to confirm your expectation.
&gt; Some tasks automatically merge a profile if specified. Examples of these are the :test profile, when running the test task, and the :repl profile, when running the repl task."
1612,1558966073.1343,Madelene,"I’d add them to :dev profile, which `:repl` should also source"
1612,1558966112.1347,Rossie,putting it in the :dev profile appears to work
1612,1558966113.1348,Madelene,`:dev` will also make the deps available to your tests.; :+1:
1612,1558966135.1352,Rossie,"awesome, thanks! sorry, I just figured this out and then read your message :smile:; (and yes that does appear to work)"
1612,1558966209.1359,Becki,that might be worth raising an issue. the code appears to try to get the repl profiles.; i think it doesn't track down the transitive profiles there
1612,1558968037.1365,Nisha,"It’s a telnet like protocol, so the sequences are identified by certain byte patterns. For example `255` is used as an escape character, so `255 249` means `go ahead`, and `255 255` means `255`, kinda like escaped 255, and etc."
1612,1558968074.1372,Marlyn,<@Sixta> I've been working a side project to do protobufs without Java interop; byte array -&gt; Clojure map -&gt; byte array
1612,1558968099.1378,Sixta,<@Marlyn> on my god please yes
1612,1558968120.1387,Marlyn,the wire protocol isn't that tricky
1612,1558968142.1396,Sixta,"My experience with protobuf (and grpc) was not great. I spent an hour on it, and I didn't get anywhere.; I know that's not much, but it was incidental to what I wanted to do."
1612,1558968163.1406,Nisha,And so they are not grouped by a fixed length.
1612,1558968164.1408,Marlyn,Yeah it would be really cool if we could participate more smoothly in that ecosystem
1612,1558968194.1413,Rossie,<@Marlyn> neat! what's that look like -- gloss?; (I'm interested in that as well because GCP)
1612,1558968223.1425,Sixta,That would be great.; Time to make sure I'm following you on github
1612,1558968257.1435,Marlyn,"read the `.proto` definitions with instaparse and do some analysis on them, turning each `message` into a encoder/decoder; I haven't published it yet; but I haven't made progress on it in a couple months, so maybe I should just push the code up; the output of the analysis phase should be plain data so that you could write it down and skip analysis if desired; kinda like cognitect aws-api spits out `.edn` descriptors of AWS api's"
1612,1558969242.1463,Rossie,"yes please, my thing consumes that data and only incidentally the apis themselves"
1613,1558971012.1477,Brent,"Does anyone know why <https://clojure.github.io/clojure/clojure.core-api.html#clojure.core/gen-class> does not mention that it is possible to attach Java annotations to methods and constructors? <@Jasmine>? (Neither does the Java Interop page, but that is not so surprising)"
1612,1558974785.1486,Onita,doesn’t look like this fixed my issue. :&lt;
1614,1558975428.1488,Latonya,"You can see when new releases are made on Clojars here: <https://clojars.org/byte-streams>; Same data set still throws the same exception?; If so, I will try testing with it, then, and stop assuming I have found the last problem :slightly_smiling_face:"
1614,1558976030.1507,Venice,I'm having an issue in a large app where a top-level expression is causing a block on startup. Is there some flag I can pass to something to see what point clojure is at when it stops?
1615,1558978757.1534,Marlyn,<@Venice> start clojure with clojure.main and manually require your code entry point namespace with `(require 'your.code :verbose)`
1614,1558981096.1536,Onita,"that’s right, same issue"
1614,1558981424.1541,Min,"oh!  `:verbose`is new to me, nice"
1616,1558981608.1543,Leeann,Is this another example where clojures compare-machinery sometimes returns the wrong result because of truncating longs to int?
1614,1558981784.1545,Latonya,"Well, wrong if you do not know that fact and plan for it in advance, yes :slightly_smiling_face:; There may be another problem I haven't found and fixed yet, but the first problem I found with the comparator function was that it was returning what appeared to be a correctly signed Long value, but when truncated to 32-bit int would sometimes change the sign and not be the desired result."
1614,1558982380.155,Celestine,"Probably because you can attach annotations to code without using `gen-class`?; For example <http://corfield.org/blog/2013/05/01/instrumenting-clojure-for-new-relic-monitoring/>; I know that's not adding annotations to methods/constructors, just saying that you can do that in the general case outside of `gen-class`.; Is the syntax much different for doing this within `gen-class`?; (and, yeah, it would be nice if adding annotations was better documented somewhere...)"
1614,1558982805.1562,Latonya,"I tried with those 6000 32-byte sequences, converted with some little bit of code I wrote to convert those hex strings into 32-byte long java.nio.ByteBuffer objects, and sorting them with the updated compare-bytes caused no exception to be thrown.; I do get an exception thrown when I try to sort using the original definition of compare-bytes that you reported.; Probably a good idea to double check what method you are using to get the new version rather than the one currently published on Clojars.; Doing 'git clone' on byte-streams, then 'lein install' should install the modified version in your local $HOME/.m2 directory, where lein and other tools should be able to find it if you give the proper version number, which I think is 0.2.5-alpha2; You can also change the version string in the first line of the project.clj file to something that has never been released on <http://clojars.org|clojars.org> if you want to be sure your code is getting that version, instead of one from clojars.  You can search for byte-streams on <http://clojars.org|clojars.org> to see what versions have been released there, and the dates.  The last release date is in 2018, so cannot include the latest fix."
1617,1558986779.1584,Clarine,"if you write `'foo/bar` or
````foo/bar```
or
```(quote foo/bar)```
how should that affect linting required but unused namespaces? In Clojure, you do not need to require namespace `foo` in either case, although joker counts `foo` as used in the case of the syntax-quote. Currently clj-kondo does the same for syntax-quote and `quote`, although it probably shouldn’t in all these three cases."
1618,1558987727.1646,Hugh,"Hi!
Say I want the 4 fastest non-nils answers from 10 concurrent api calls, what is a good and fast way to do it?
```
(def ids `[1 2 3 4 5 6 7 8 9 10])
(defn ask 
  ""may return nil""
  [id] 
  (:body (http/GET {...}))
(defn take-4-first-non-nils [ids] ...)
```"
1618,1558987836.1655,Elaine,<@Hugh> you will need `async/alt!` from <#C05423W6H|core-async>
1618,1558988235.1672,Hugh,"<@Elaine> Thanks :slightly_smiling_face: Any example where we wait for first n results before returning them?; I’ve always seen example with *the* first result, but not more; thought it would start like so, but I don’t know actually `(async/take 4 ...)`"
1618,1558989264.1713,Elaine,"Yeah. something like **the** first result, 4 times in a row :sweat_smile:
Not sure about the answer but I'm sure that <#C05423W6H|core-async> and `alt` will compose that answer"
1619,1558990875.1718,Latonya,<@Onita> ^
1619,1558990923.172,Onita,"thanks! you’re right, i was probably using the wrong version. will check this again"
1620,1558992260.1723,Mariela,"I think it's a good idea to lint

```
`foo/bar
```

as a fault if the `foo` alias does not exist in the current ns.

Else:

```
`foo/bar
```; will likely evaluate to sth different than what the programmer intended; I would distinguish syntax-quote from plain quote though: only the former has the alias-expanding semantic, so I would only lint for the former"
1620,1558992482.1732,Clarine,"I have made two comments here:
<https://github.com/borkdude/clj-kondo/issues/210#issuecomment-496293314>
I think that’s the same as what you’re saying here right?; so syntax-quote handles the symbol as “using” the namespace, but normal quote doesn’t"
1620,1558992718.1738,Mariela,"I agree if in:

&gt; but these do not give the warning, which I believe is the incorrect behavior.

""the warning"" means a warning other than `is required but never used`, possibly a new one; You can play with pmap and a blocking queue.

Each fn in the pmap pushes to the blocking queue. Then you grab 4 elements from the queue, which by definition will be the fastest ones

Should be simpler than core.async code; (just beware that grabbing 4 elements may block forever if done incorrectly)"
1620,1558994849.1745,Brent,"thx, I had no idea! And I'd correct
&gt;, it would be nice if adding annotations was better documented somewhere...
to
&gt; it would be nice if adding annotations was documented somewhere...
:)"
1621,1558996988.1747,Celestine,Hah... yeah. I thought they were documented _somewhere_ but I remember it being hard to find anything about it.
1622,1559004258.1755,Felix,Is there anyway to get Scheme hygienic macros for Clojure?
1623,1559006010.1762,Meagan,<http://clojure-doc.org/articles/language/macros.html#macro-hygiene-and-gensym> is a pretty good intro to how Clojure handles hygiene
1624,1559008293.1784,Liliana,"I'm hitting a very strange bug atm, I'm using node-jre to run a (uber)jar. But somehow the resource paths are weird, in that I can only io/resource files from jar, if they are file and not folder, and the file is not nested. Not the newest jre running the jar, could that be the reason or something else?
(think I solved it, had some pom.xml from totally unrelated java project lurking around)"
1625,1559009214.1801,Bart,"anybody good at compojure routing? I want to have different wrappers for my login routes vs. other routes, then combine it all into one ring handler"
1625,1559009618.1824,Liliana,"<@Bart> it's a bit of a hassle if you're using cemerick's friend. I hade a terrible time getting the auth sent the right way. But solveable, just combine the protected routes with public routes in the handler.; and make sure the session cookie isn't dissoced anywhere in some middleware"
1625,1559009901.1849,Celestine,"<@Bart> You can use `(routes ..)` to combine multiple set of routes (since they're just handlers). ```(routes
  (wrap-login (routes ... your login routes ...))
  (wrap-other (routes ... your other routes ...)))``` something like that I think..."
1625,1559010065.1853,Bart,"wait, you can nest `routes`? doh"
1625,1559010303.1871,Celestine,"`routes` is just a function that takes handlers as arguments and combines them. Compojure goes through the list of routes/handlers until one of them returns non-`nil`, which with routes like `(GET ""/foo"" [] something)` which is a handler will return `nil` if it doesn't match...; ```user=&gt; ((routes (routes (GET ""/foo"" [] ""Get Foo"") (GET ""/bar"" [] ""Get Bar""))
                (routes (GET ""/quux"" [] ""Get Quux"") (POST ""/quux"" [] ""Post Quux""))) {:uri ""/quux"" :request-method :get})
{:status 200, :headers {""Content-Type"" ""text/html; charset=utf-8""}, :body ""Get Quux""}
user=&gt; ((routes (routes (GET ""/foo"" [] ""Get Foo"") (GET ""/bar"" [] ""Get Bar"")) (routes (GET ""/quux"" [] ""Get Quux"") (POST ""/quux"" [] ""Post Quux""))) {:uri ""/bar"" :request-method :get})
{:status 200, :headers {""Content-Type"" ""text/html; charset=utf-8""}, :body ""Get Bar""}
user=&gt; ((routes (routes (GET ""/foo"" [] ""Get Foo"") (GET ""/bar"" [] ""Get Bar"")) (routes (GET ""/quux"" [] ""Get Quux"") (POST ""/quux"" [] ""Post Quux""))) {:uri ""/bar"" :request-method :post})
nil```; I didn't add any middleware into that, but hope it gives the idea? <@Bart>"
1625,1559010949.1898,Bart,"yeah I got the idea at your first post <@Celestine>, thanks. somehow I was not seeing that `(compojure/routes)` just takes handlers &amp; assembles a handler"
1626,1559011827.1903,Lela,<http://danboykis.com/posts/things-i-wish-i-knew-about-core-async/>
1625,1559018187.1909,Lorenza,also works just as well on just windows; without the IO tax of WSL
1627,1559026630.1917,Celena,How to set *Content-Security-Policy* headers in Pedestal? Application is giving following errors.
1628,1559031201.1937,Nisha,"How do I profile the overhead of using lazy seq? Assuming my app is slow, how do I find out if it’s because I’m using too many lazy operations?"
1628,1559031350.195,Nieves,I add `(time` to some forms trying to find a bottleneck
1628,1559031645.1951,Brent,i will fix it :)
1628,1559031848.1964,Kellee,"how do I `eval` a `fn` declaration and keep type hints? I can't get it to work. the expected result is that `(eval generated-fn2)` won't give me reflection warnings.; here's the problem on <http://repl.it|repl.it>, if someone wants to give it a go: <https://repl.it/repls/ExcitedDetailedRedundancy>"
1628,1559032435.1973,Celena,Resolved it using this issue: <https://github.com/pedestal/pedestal/issues/499>
1629,1559034999.1999,Fae,"is this an implementation detail, or one can rely on it?
`(map f coll)` returns ""chunked lazy seq"", which gets realized 32 elements at a time
`(map f coll1 coll2 ...)` returns ""proper lazy seq"", when gets realized 1 element at a time; None"
1629,1559035095.201,Harris,"chunking is always an impl detail; (both its presence, lack of, or rate of)"
1629,1559035132.2021,Fae,"(I mean ""rely on the 1 at a time for 2nd arity""); ok"
1629,1559035141.2025,Harris,no (you can't rely on that either)
1629,1559035178.2037,Fae,"so if I'd want the laziest seq, I should do proper lazy-seq implementation myself?"
1629,1559035192.2039,Harris,"yep; ```(defn unchunk [s]
  (when (seq s)
    (lazy-seq
      (cons (first s)
            (unchunk (next s))))))``` is usually how it's done"
1629,1559035256.2049,Fae,`(-&gt;&gt; coll (map f) unchunk)`?; (question came from reading lots of duplicated ~code~ effort here <https://github.com/dakrone/clojure-opennlp/blob/master/src/opennlp/tools/lazy.clj> )
1629,1559035300.2059,Harris,`(-&gt;&gt; coll unchunk (map f))`
1629,1559035335.2067,Fae,hm
1629,1559035367.207,Harris,what controls the chunking is the input collection
1629,1559035392.2078,Fae,so in my example it is `range` who initiates chunks of 32?; cool
1629,1559035400.2083,Harris,well no
1629,1559035400.2084,Fae,TIL
1629,1559035440.2094,Harris,"it's `map` who decides to iterate on chunks rather than els, based on the type of the input coll"
1629,1559035444.2095,Ali,Does it now? Maybe I'll just try that straight up then.
1629,1559035461.21,Arlen,<@Nisha> profiling: <https://github.com/clojure-goes-fast/clj-async-profiler>
1629,1559035481.2108,Harris,"if you pass an ""unchunkable"" coll to map it will traverse it one element at a time; that's what `unchunk` does"
1629,1559035490.2111,Arlen,<@Nisha> Benchmarking: <https://github.com/hugoduncan/criterium>
1629,1559035497.2117,Ali,For some reason I thought `clj` wasn't stable under Windows native.
1629,1559035500.212,Lorenza,"been using clojure on windows since beta, making artifacts that would later run on solaris etc"
1629,1559035500.2122,Fae,"```(defn map  
([f coll]
   (lazy-seq
    (when-let [s (seq coll)]
      (if (chunked-seq? s)
        (let [c (chunk-first s)
              size (int (count c))
              b (chunk-buffer size)]
          (dotimes [i size]
              (chunk-append b (f (.nth c i))))
          (chunk-cons (chunk b) (map f (chunk-rest s))))
        (cons (f (first s)) (map f (rest s)))))))```"
1629,1559035511.2123,Arlen,You can also use VisualVM; <http://clojure-goes-fast.com/blog/profiling-tool-jvisualvm/>
1629,1559035527.2131,Fae,"so map just checks, but not enforces"
1629,1559035544.2135,Harris,"`(chunked-seq? (range 30))` =&gt; true
`(chunked-seq? (unchunk (range 30)))` =&gt; false"
1629,1559035546.2136,Lorenza,"the newish clj tool has trouble on windows yes, i have a workaround for that... let me find it"
1629,1559035580.2146,Harris,"the functions that ""understand chunking"" work by preserving the chunkiness"
1629,1559035583.2148,Lorenza,"so, follow the procedure outlined on the clojrue web site to install it on windows"
1629,1559035588.2151,Harris,"so if chunked-seq comes in, chunked-seq comes out"
1629,1559035593.2153,Lorenza,then in your project root put this file
1629,1559035594.2155,Harris,"if normal seq comes in, normal seq comes out"
1629,1559035669.2158,Lorenza,None; it will launch clj from a normal command prompt
1629,1559035706.2169,Fae,is there a way to know which (core?) fns return chunked seqs?
1629,1559035709.217,Lorenza,usefull for some tools that go around powershell
1629,1559035725.2174,Fae,"""rule of thumb"" or something"
1629,1559035725.2175,Lorenza,"anyways depending on your workflow you might not even need it; if you're not using deps.edn, no need"
1629,1559035758.2184,Fae,"or rather ""when would I want to return chunked seq?"""
1629,1559035851.2185,Ali,"Thanks, I'll try this. I use `deps.edn` exclusively, so I do need it.; (Datomic Cloud)"
1629,1559035875.2191,Lorenza,have fun !
1629,1559035915.2198,Fae,why isn't `unchunk` - a core fn? is it because chunks are an implementation detail?
1629,1559036368.22,Harris,"yeah; there's really no good documentation on this, because you ""shouldn't be thinking about it, it's an implementation detail"" is the core position I think"
1629,1559036657.2217,Fae,on the other hand things might get expensive
1629,1559037004.2218,Madelene,be careful though… laziness is hard to benchmark because it also includes the cost of doing the work.
1630,1559037015.222,Harris,¯\_(ツ)_/¯
1630,1559037079.2227,Fae,:thisisfine:
1630,1559037281.224,Harris,"I can tell you that the current impl produces chunked seqs off of:
- vector or their seqs
- bounded integer range
- Iterables that are not otherwise Seqable
- the return values of `sequence` used with a transducer
- the return values of `iterator-seq`; and most of the seq functions (`map`, `filter`, `keep`, `for` etc) are ""chunkiness preserving"", while `reduce`/`trasnduce` ""understand"" the chunkiness of its input coll"
1630,1559038048.2258,Ali,"<@Lorenza> For connecting, I'm getting timeouts on the REPL connections (so the REPL server isn't answering, I'm guessing), even though I've added rules for both ingoing and outgoing TCP connections on the correct port in Windows Firewall. Do you happen to know if I would need to do anything else to open the ports?"
1631,1559039227.226,Lorenza,you're connecting to a remote repl ?
1631,1559041386.2262,Ali,"Yeah, but I'm an idiot. I forgot the configure `:host` and `:bind` for nREPL.; (They default to localhost)"
1631,1559041416.2266,Lorenza,hah ! anyways i never had to go remote like this so i couldn't help
1631,1559041510.2269,Nisha,"Yeah I assume it’s hard, because it’s impossible to compare it to the non-lazy version, unless we have it implemented, which is hard again, and is the very reason why we implement the lazy version in the first place."
1631,1559041520.2271,Ali,"Yeah, I'm setting it up so that I can essentially use my laptop as a thin client to a much more powerful machine. But the laptop is still nicer to work on :slightly_smiling_face:"
1631,1559041965.2274,Madelene,"Yeah you really need two implementations… but a profiler can guide you to the right decision…

lazy sequences are usually fast enough though; but it depends on how much data you have going through them; and how many transformations you’ve stacked ontop — and of course how fast you need it to be :slightly_smiling_face:

A sign laziness is a problem is lots of GC activity; but that can also be caused by other things.  Also if you’re holding onto the head of seq accidentally can cause a lot of memory pressure/OOMs etc."
1632,1559046364.2318,Ali,"I've used Criterium to measure performance of running some data imports on my MacBook vs. my PC (PowerShell vs. WSL), and got these results:

```WSL: 9.075001 seconds
PowerShell: 5.753443 seconds
MacBook: 12.337244 seconds```

Things are better on the PC, but not as good as I expected (16GB 2017 MacBook vs. 32GB AMD Ryzen 2700X PC). Upon inspecting the PC, I notice that only four cores out of eight in total are utilised.

The function I'm testing is using a simple `pmap` to process things in parallel. Is there a limitation to `pmap` in only using four cores, or are there things I might need to tweak with the JVM?

(Oh, and BTW, the tax paid by using WSL seems very high indeed)"
1631,1559047289.2327,Olympia,it uses the # of available processors + 2 <https://github.com/clojure/clojure/blob/clojure-1.9.0/src/clj/clojure/core.clj#L6941>
1631,1559047432.2329,Ali,"Right. Well, that is 3 threads for the one processor then. I guess I have to look into other means of parallelization."
1631,1559047482.2331,Karren,3 threads for one processor?
1631,1559047507.2333,Ali,"Yes, there is one physical processor, albeit 8 cores.; Or did I misunderstand what ""processor"" means in this context?"
1631,1559047548.2337,Karren,"pmap should then use up to 10 parallel threads (or 18 if you you're talking about physical cores and have hyperthreading); it's a logical core as seen by operating system; typically on machines with HT, that means `2 * #physical cores + 2`"
1631,1559047611.2343,Ali,"Ah, gotcha. Yes, 16 logical cores. Alright, so for some reason it only reached 4 physical cores. Something else is going on then."
1631,1559047718.2346,Karren,"it may depend a lot on the type of operations you're doing. you might not get benefits you hope for just by running things in parallel In extreme cases, it may even be slower"
1631,1559047772.2348,Ali,"In this case it's reading fairly large XML documents, extracting data, and doing transformations. `pmap`ing should be a pretty straightforward way of optimizing in my mind. Each document is fairly long-running.; Maybe it's strangled by IO and I need to buffer some documents ahead of time."
1631,1559047833.2352,Karren,"Maybe, but you may get a lot of IO or memory contention. As always, it's best to measure :slightly_smiling_face:; Btw. for `pmap` this is the interesting line related to ""semi-lazy"" -&gt; it tries to stay ahead ""enough"" (factor `n`): <https://github.com/clojure/clojure/blob/clojure-1.9.0/src/clj/clojure/core.clj#L6948>; in general, Claypoole is interesting alternative to consider: <https://github.com/TheClimateCorporation/claypoole>"
1631,1559047921.2361,Olympia,"that may be it, also i never end up using pmap bc they dont work with transducers and transducers are typically faster for me"
1631,1559048013.2364,Ali,"The entire thing is lazy from start to end, with no transducers mixed in. It should be realized only on the accumulation of results outside of `pmap`.

Yep, `def`ing the `pmap` expression returns immediately."
1633,1559051799.2372,Latonya,"If you look at the source code for pmap you can see the expression it uses to determine the maximum parallelism: `(+ 2 (.. Runtime getRuntime availableProcessors))`  You can run that expression in a REPL on your system to see what the JVM considers that number to be.; Even if it is `(+ 2 8)` or 10, pmap can only give good performance increases if a couple of things are true: (a) the work done for each element of the sequence is large, compared to the work required for the JVM to create a new thread, which is what pmap does for each element.  (b) Each element should take about the same amount of time to process.  If they take wildly different amounts of time to complete, then pmap limits the parallelism because it does not work more than a certain amount ahead of the last unfinished element.; There are other libraries, e.g. using Java's ExecutorService, that try to keep N threads busy at all times, which avoids issue (b) that `pmap`'s implementation has.; I have not used it myself, but I believe this library offers some bit of Clojure API around Java's capabilities, but I have heard that several people go straight to Java interop for this, too: <https://github.com/TheClimateCorporation/claypoole>"
1633,1559052458.2384,Ali,"Cool, thanks <@Latonya> (and <@Karren>, <@Olympia>). That might be the bottleneck in that case. The documents I process _are_ wildly different in size.

I think the minimum time I've spotted for a single document is ~40ms for an outlier. Is this small compared to the cost of setting up a thread? If so, I guess I might need to chunk them into linear bits.

Even then, it wouldn't load every core evenly. I guess I could try to organise them into chunks of roughly the same size.; Or go with a threadpool solution."
1633,1559052870.2389,Latonya,"I suspect one could do a lot of fiddling to try to make `pmap` use its max parallelism as often as possible, whereas the thread pool solution would be likely to get you there with less fiddling.; If max parallelism was a relatively important goal for you."
1633,1559052930.2393,Ali,"Yeah, max parallelism is by far the easiest optimization I can do, as fiddly as it is.; I'll look into the less fiddly versions though, that seems sensible."
1634,1559057763.2416,Evonne,"We were just discussing keyword parameters in <#C053AK3F9|beginners> , and I think I remember a conversation somewhere back a ways where people were saying there was a reason to prefer plain maps over keyword params. Can’t remember what the reason was, though. Sound familiar to anyone?"
1633,1559058357.2421,Meagan,the reason I don't use keyword params is because you can't pass them around as data
1633,1559058455.2442,Bee,"Yeah, as soon as you want to composite a fn with keyword params, it's caller is responsible for splatting out the options instead of just passing in some map it might have gotten from its own caller"
1633,1559058483.2449,Meagan,"```
(defn foo [big-ball-of-params]
  ;; I have to peel each arg one by one off of the map
  (bar :a (:a big-ball-of-params)
       :b (:b big-ball-of-params)
       :c (:c big-ball-of-params)))

(defn bar [&amp; {:keys [a b c]]
  (println a b c))
```"
1633,1559058491.2451,Evonne,"That’s what it was, composition. Tks folks."
1633,1559058856.2465,Bee,"To be fair you can still get there with apply, but as soon as your caller is drawing the keyword args from n&gt;1 maps your caller has a lot more to juggle."
1635,1559060573.2467,Ali,`claypoole` and some minor refactoring sees a good improvement: `3.416247 seconds` in PowerShell.; It's now keeping all cores nearly maxed out.
1636,1559074912.2499,Clarine,"isn’t destructuring a little bit too forgiving in the `:or` here?
```
(let [{:keys [:a] :or {x 1}} {}] #_[a x]) ;; this is fine
(let [{:keys [:a] :or {x 1}} {}] [a b x]) ;;=&gt; error about x
(let [{:keys [:a :x] :or {x 1}} {}] [a x]) ;; works
```"
1636,1559075053.2504,Celestine,Macroexpand it -- see what it expands to...
1636,1559075125.2508,Clarine,"yeah, the x in `:or` is ignored when it’s not part of the previous symbols"
1636,1559075732.2514,Latonya,"It is the kind of thing a linter could warn about.  Eastwood has not implemented it, although I created an issue to remind developers about it a while back: <https://github.com/jonase/eastwood/issues/225>; Maybe this one is related, too: Maybe this one, too: <https://github.com/jonase/eastwood/issues/157>"
1637,1559076944.252,Mimi,"Hey <@Jenny>, I just recently challenged myself to try and build a twitch chatbot during livestreams on twitch: <https://www.twitch.tv/upgradingdave>; There’s also another clojure livestreamer here: <https://www.twitch.tv/rhonin52/>; I try to stream every M, W, F 7:30 eastern time. If you’re around, please stop by, love to have some help building the twitchbot!"
1636,1559077419.2535,Clarine,"<@Latonya> that’s what I figured: <https://github.com/borkdude/clj-kondo/issues/214>; (<@Marlyn> I saw you typing for a moment, if you have feedback on this, I would be happy to hear)"
1636,1559078046.2551,Marlyn,might want to lint on `(let [{:keys [patient/id order/id]}  value]...)`; GIGO (seen in <#C053AK3F9|beginners>); similarly for `:syms`
1636,1559078199.2563,Clarine,"ah I see, multiple keys with the same “name” part"
1636,1559078217.2566,Marlyn,"i mean, it would never get past simple REPL testing; (ugh MBP keyboards); unless one of the symbols was unused"
1636,1559078273.2582,Clarine,"yes, the idea of clj-kondo is that it catches errors before your REPL sees it, there is this interval in time where thoughts are transformed into sexprs into your buffer, but have not been evaluated yet; thanks; works: <https://www.dropbox.com/s/zjbbgpvhx7fc70e/Screenshot%202019-05-28%2023.30.11.png?dl=0>"
1636,1559079226.2596,Marlyn,<@Clarine> unused binding?
1636,1559079264.26,Clarine,"that particular binding is unused, because it’s shadowed by the next one?; the message could maybe be clearer, I’m all ears. this is the general message you get when you don’t use a binding, e.g. in `(let [x 1])`"
1638,1559079614.2618,Latonya,"Maybe ""duplicate binding id"", if you can have a different detection and/or message for this case vs. an unused binding?; I don't know if you maybe already have this for clj-kondo, but a short description or message, and then a link to a place you can get more details / examples / workarounds / etc., can be useful in explaining to users what is going on."
1636,1559079746.2639,Clarine,"the detection mechanism is the same for all “unused bindings” but I could make a few tweaks here and there.
that link idea is nice, it’s the same that shellcheck does, I might implement something like that; (btw if you’re not using shellcheck and write bash sometimes, it’s lovely)"
1636,1559079805.2647,Latonya,"I use such a small subset of bash's capabilities, that it is self-linting :slightly_smiling_face:"
1636,1559079900.2652,Clarine,one thing that it should have linted but didn’t: `if [ false ]; then ...`
1639,1559083327.2664,Liane,"if i reduce over a lazy seq, will the list get realized one at a time? e.g `(reduce ... (for [x (range 2)])`"
1639,1559083756.2665,Otelia,"See:
<http://clojure-doc.org/articles/language/laziness.html#lazy-sequences-chunking>"
1636,1559085374.2669,Dann,"~I think that document answers a slightly different question~
the document answers the question, I misread"
1636,1559085427.2674,Otelia,"But not one at a time, they're realized in chunks. I thought this was the question."
1636,1559085464.268,Dann,"right, chunking means there's no guarantee of one at a time processing"
1640,1559100396.2706,Fae,"is this the only way to typehint ""strings array""? `#^""[Ljava.lang.String;""` (not only strings, but array of any non-primitives)"
1640,1559101828.2714,Celestine,<@Fae> You can use `^{:tag (class (into-array TheType []))}`
1640,1559102333.2719,Fae,"thank you, Sean; <@Celestine> I get reflection warning with your method (in repl)"
1640,1559103064.2732,Celestine,Show your code...
1641,1559103288.2739,Felix,Is there any reason syntax-parse style macros are not available on Clojure? They seem very convenient for a large class of macros.
1641,1559103358.2743,Celestine,<@Felix> <https://clojure.org/guides/faq#reader_macros>
1641,1559103365.2744,Fae,"```
(set! *warn-on-reflection* true)
(let [spans (into-array opennlp.tools.util.Span [])
      s ""foo""]
  (opennlp.tools.util.Span/spansToStrings
    ^{:tag (class (into-array opennlp.tools.util.Span []))}
    spans
    ^java.lang.String
    s))
```; ~damn, it has into~ same"
1641,1559103503.2764,Felix,<@Celestine>: I'm no asking about reader macros. I'm asking about Scheme hygienic macros of syntax-case / syntax-parse.
1641,1559103509.2766,Fae,"cursive does not disambiguate it either; `^""[Lopennlp.tools.util.Span;""` and
`#^""[Lopennlp.tools.util.Span;""` do work though"
1641,1559103708.2781,Celestine,"<@Fae> Pretty sure `:tag` only works on vars, not locals or expressions..."
1641,1559103777.2785,Fae,so I have to `def` spans for it to work?
1641,1559103856.2796,Celestine,That would work (but I know isn't ideal). I'm not sure what exactly you need to explicitly hint an expression with type expression... I'd have to dig in the compiler source I expect...
1641,1559103948.2807,Fae,"I was curious if I could avoid string in a type hint, but it seems to be not worth it; why there is no `array?` predicate in core? Is it useless to know the collection is an array without knowing elements' class as well?"
1641,1559104272.283,Celestine,"<@Fae> what sort of collection? Only primitive arrays have an inherent element type, right? Not any of Clojure's collections..."
1641,1559104581.2842,Fae,like the array of custom Spans from example above. This is mostly (or only) for interop with java/js
1642,1559104648.2848,Meagan,"In cljs, `cljs.core/array?` does exist"
1641,1559104876.2851,Fae,"there is
(.isArray (class (into-array String [])))
=&gt; true"
1642,1559105261.2852,Jenny,"thanks, i’ll check those out"
1643,1559108701.2857,Ali,"Thanks to some helpful people here, I started using Claypoole yesterday (<https://github.com/TheClimateCorporation/claypoole>). I was delighted to notice that when I `reduce` over the results of `upmap`,  `reduce` is handed a result immediately when when `upmap` is done with it. It doesn't wait for the entire `upmap` expression to be done to do so. Feels like getting streaming for free."
1644,1559118311.2876,Ivana,Anyone know of simulation tools (like simulant) that do something with time manipulation? E.g. <https://github.com/Datomic/simulant/wiki/Todo#variable-clock>
1645,1559123236.2903,Brent,"When using namespaced keywords, is it possible to create a short alias when the namespace part of the keyword does not correspond to an actual Clojure namespace? I tried ```
(alias 'dom 'my.awesome.app.domain)
{::dom/greeting ""hello""}``` but it fails with
&gt; Syntax error ... Caused by: java.lang.Exception: No namespace: my.awesome.app.domain found"
1645,1559125058.2907,Fae,"<@Brent>
```
(alias 'bar (create-ns 'foo))

::bar/x
=&gt; :foo/x
```; (just in case: there is no `alias` in clojurescript)"
1646,1559135537.2922,Cruz,Has anyone ever faced such an issue with `lein-modules` lein plugin? <https://github.com/jcrossley3/lein-modules/issues/42>
1647,1559136377.293,Danita,"Hello. I'm often developing for Android and I was wondering: Is Clojure on Android dead, as of 2019?; Last commit for lein-droid is from 3 years ago."
1647,1559136937.2946,Milford,"<@Danita> Not exactly what you asked, but it's worth knowing that React Native + ClojureScript is often used to target Android.

(I don't know the answer to the question you asked.)"
1647,1559136986.2952,Cruz,"I used to develop a mobile app with re-natal, it worked well."
1648,1559137111.296,Laurena,"Hello, is there an equivalent to `clj-time.spec` in  `clojure.java-time`?"
1647,1559137137.2963,Danita,I see. Thanks for the info.
1649,1559139164.298,Jeannette,does this function have a name? #(%1 %2)
1649,1559139191.2982,Harris,"`invoke` if you're looking for a name, but it's not defined in `clojure.core`"
1649,1559139209.2985,Jeannette,"i see; what is this time format?
""2015-09-27D00:01:48.788186000""
how do i parse this with java-time?
clj-time.coerce/from-string manages to parse it when I replace the D character with T!
I still can't find a way to parse it with java-time though."
1649,1559140625.3014,Mathew,"<@Jeannette> I had the same problem, and I also changed the D for T to make it work, I’m interested in knowing if you find a different answer for this , thanks!"
1649,1559140782.3019,Jeannette,sure
1649,1559140863.3023,Evonne,Just a guess: “D” for “Daylight Savings Time”?
1650,1559141103.3028,Marlyn,"that datetime doesn't have a zone on it, so it's unlikely to have random info about DST"
1649,1559141130.3033,Evonne,"Yeah, not finding any online references to a “D” in place of a “T”"
1650,1559141926.3046,Marlyn,"```
(import java.time.Instant)
(import java.time.ZoneOffset)
(import java.time.format.DateTimeFormatter)
(def fmt (-&gt; (DateTimeFormatter/ofPattern ""yyyy-MM-dd'D'HH:mm:ss.n"")
  (.withZone ZoneOffset/UTC)))
(Instant/from (.parse fmt ""2015-09-27D00:01:48.788186000""))
#object[java.time.Instant 0x121c54fa ""2015-09-27T00:01:48.788186Z""]
```
<@Jeannette> simplest way to turn it into a java.time.Instant; (if you want to anchor it at UTC)"
1651,1559143644.3058,Meagan,has anyone paid attention to the what the Elixir folks are doing with Phoenix LiveView? 
1651,1559143692.3072,Landon,can one specify mirrors in `.clj/deps.edn`?
1651,1559143736.3079,Meagan,AFAICT the webpage basically opens a websocket connection to the server and the server handles streaming updates to the DOM based on user interactions ; I assume that this scales OK for Elixir because of it’s ability to spin up thousands of light-weight processes to handle each page session; I wonder if this would be tenable for Clojure
1651,1559144869.3109,Sixta,Go threads should make it work
1651,1559144907.3116,Bart,"i have a compojure/routing question. i've got a login process that reroutes to a certain URL, let's call it `/loginsuccess`, that should launch some work then redirect.; so I have a function that does some work then returns `(response (redirect ""/""))` to get to my original root-URL.; but now `/loginsuccess` ends up being used as referer, so it shows up in the browser as `/loginsuccess/#/browser-route` instead of `/#/browser-route`"
1651,1559146017.3147,Meagan,I just wonder how many concurrent sessions you’d be able to handle per node
1651,1559146159.3155,Sixta,"I'll naively say it's the same amount, and someone can come tell me I'm wrong; But my understanding is that it's the same"
1651,1559146186.3161,Meagan,haha
1652,1559148606.3175,Meagan,"with how much people talk about BEAM, OTP and Erlang/Elixir’s concurrency story I figured it must be better than using a thread pool"
1652,1559148706.3181,Sixta,"Go doesn't though, go is a green thread"
1652,1559148784.319,Meagan,"if you’re talking about core.async, I thought core.async is basically a state machine / scheduler on top of a thread pool?; honestly I’m totally naive about the way both core.async and BEAM actually work so I’m just going off of shallow readings I’ve done about both"
1653,1559151724.3208,Sixta,"It is a state machine, yeah. But that is copied from the .net model for the same kind of thing. That's basically what green threads are I think."
1652,1559151957.321,Meagan,"Right, so I guess my question still is: how does core.asyncs green threads scale in this case compared to BEAMs processes?; I wish someone had some benchmarks"
1654,1559154911.3245,Zita,"<@Jeannette> Now I’m not sure what you’re asking. IIUC, the `#(…)` macro generates an anonymous closure. `invoke` is called on the resulting closure (`IFn`) when… well, invoked. Am I grokking the question?"
1654,1559155250.327,Jeannette,"<@Zita> I was wondering what is the equivalent of the idea of (fn[f x] (f x)), if there is a core function that names it for example. I was not conscious that functions are implementations of an interface under the hood though."
1654,1559155926.3293,Zita,"Ah, yes. So to At the clojure level, `#(%1 %2)` just yields an anonymous closure `(fn [f x] (f x))` which implements `IFn`, as above. When the form is evaluated, `invoke` is called on the resulting `IFn` object."
1654,1559156539.3304,Rosia,"I'm trying to use jsonista custom encoders to emit epoch milliseconds when given a ZonedDateTime... anyone know why this isn't working? It's copied almost directly from the custom encoder example:
```
(let [encoders {java.time.ZonedDateTime
                (fn [zdt gen] (.writeString gen (-&gt; zdt .toInstant .toEpochMilli str)))}
      mapper   (j/object-mapper {:encoders encoders})]
  (j/write-value-as-string (java.time.ZonedDateTime/now) mapper))
```"
1655,1559158103.3315,Rosia,"I guess jackson-databind which jsonista uses has its own date handlers, which seem unable to be overridden like this. Is there another way to override them easily or is this not meant to be done?"
1656,1559161842.3329,Brent,"How do I call `public static Path get(String first, String... more)` from Clojure? `(Paths/get ""mydir"")` fails because it invokes `get(URI path)`. There must be better way then `(Paths/get ""mydir"", (into-array String nil))`, no?"
1656,1559161890.3331,Rosaline,"why must there be?; clojure's interop is generally more jvm interop then java interop, and varargs like that exist in java the language, not the jvm, where you must pass an array like that"
1656,1559162548.3359,Celestine,`T...` is Java's syntactic sugar for `T[]` at the JVM level -- which is what all non-Java languages have to interop with.
1656,1559162978.338,Letitia,"To add to Sean’s comment: you can see there are two arguments required for the string kind unfortunately
```(-&gt;&gt; (clojure.reflect/reflect Paths)
                    :members
                    (filter (comp #{'get} :name))
                    (map :parameter-types))```
the second being the array"
1657,1559163550.3394,Suzann,<https://hashrocket.com/blog/posts/websocket-shootout>
1656,1559163567.3397,Meagan,:clap:
1658,1559174197.3405,Larissa,"Hello all, is there any one that used `fn-fx` for JavaFX?"
1659,1559197936.0017,Ali,"Does anyone know how to set a custom entity resolver with `clojure.xml/parse`? I need to reroute online DTDs to local ones. Currently I'm rewriting the XML itself with regexes, which seems a bit non-idiomatic."
1656,1559207978.0032,Clarine,"regarding performance:
```
user=&gt; (defn contains [t] (contains? #{:foo :bar} t))
#'user/contains
user=&gt; (defn contains2 [t] (or (= :foo t) (= :bar t)))
#'user/contains2
```
it seems that contains2 is ~twice as fast, although the idiom in contains is very common."
1659,1559208254.0054,Nieves,"it is clear, in first case it have to create additional set structure and search in it. But it is more readable and noone thinks about 2 times fast on nanoseconds"
1659,1559208312.0059,Clarine,maybe Clojure optimizes the first case by creating the set at compile time? but maybe not
1659,1559208559.0078,Nieves,"Not sure about sets (they can hold values unknown on compile stage), but I guess that `case t` will most fastest way for this code"
1659,1559208608.0088,Clarine,"or something like this:
```
(defmacro one-of [x elements]
  `(or ~@(for [e elements]
           `(= ~e ~x))))

(let [x 10] (one-of x [1 2 3]))
```; you can indeed also write: `(let [x 10] (case x (1 2 3) true false))`"
1659,1559208731.0106,Nieves,But why you try to catch nanoseconds but not clear readable code with `some?` or using `set`?
1659,1559208812.0118,Clarine,"case appears to be much faster:
```
user=&gt; (time (dotimes [_ 10000000] (one-of :bar [:foo :bar])))
""Elapsed time: 221.057525 msecs""
nil
user=&gt; (time (dotimes [_ 10000000] (case :foo (:foo :bar) true false)))
""Elapsed time: 61.048416 msecs""
```"
1659,1559208815.012,Nieves,"And I am afraid that `for` macro also expands in a tremendous batch of forms; oh, I see, it will on compile time"
1659,1559208880.0133,Harris,"at load time, but yes"
1660,1559214942.0151,Marcelle,"For my project, some modules are loaded from `~/.m2`, and some from `/var/maven`. How can I control the exact location (e.g. force all to load from `~/.m2`)?"
1660,1559234183.0163,Rosaline,"What kind of os are you using?; /var/maven is a very non-standard thing, so either it is some setting in some tool you are using, or some non-standard packaging of some tool you are usig"
1661,1559237132.0168,Sixta,Nix?
1661,1559237184.0172,Dann,your maven config should be controlling where it looks for local archives
1662,1559238044.0179,Alease,"Is the clojure syntax indescernable from edn, or is edn specifically used in the context of serialization?"
1662,1559238268.019,Sixta,Edn is for serialization. Clojure syntax is a superset of edn.
1662,1559238321.0197,Dann,edn is a string format
1662,1559238641.0204,Alease,you can essentially change a clj file to edn and it's still valid?; or does edn have some declaration standards?
1663,1559238861.0218,Larissa,"Hello all, how can I translate this to clojure?
```table.setOnMousePressed(new EventHandler&lt;MouseEvent&gt;() {
    @Override 
    public void handle(MouseEvent event) {
        if (event.isPrimaryButtonDown() &amp;&amp; event.getClickCount() == 2) {
            System.out.println(table.getSelectionModel().getSelectedItem());                   
        }
    }
});```"
1662,1559238875.0222,Sixta,You can change anything you edn and it's valid edn?
1662,1559239074.0226,Dann,<@Alease> I'm pretty sure there's things in clojure that the edn standard doesn't' accept
1662,1559239132.0227,Sixta,#() is the easy one; Also ' behaves differently in edn
1662,1559239148.0231,Dann,"haha, just as I was about to paste this ```user=&gt; (clojure.edn/read-string ""#()"")
RuntimeException No dispatch macro for: (  clojure.lang.Util.runtimeException (Util.java:221)```"
1662,1559239157.0233,Becki,"and java interop, yes?"
1662,1559239171.0235,Dann,"```user=&gt; (clojure.edn/read-string ""`(foo ~bar)"")
RuntimeException Invalid leading character: `  clojure.lang.Util.runtimeException (Util.java:221)
```"
1662,1559239185.0237,Sixta,"Well, java interop is valid edn; Because symbols"
1662,1559239219.0241,Becki,ah you're right
1662,1559239232.0243,Dann,"interop seems fine ```user=&gt; (clojure.edn/read-string ""(java.util.Date.)"")
(java.util.Date.)
user=&gt; (clojure.edn/read-string ""Math/PI"")
Math/PI
user=&gt; (clojure.edn/read-string ""(. Math PI)"")
(. Math PI)
```; another big one: ```user=&gt; (clojure.edn/read-string ""::foo"")
RuntimeException Invalid token: ::foo  clojure.lang.Util.runtimeException (Util.java:221)

```; edn can't have a current namespace, so auto-namespaced symbols don't make sense"
1662,1559239419.0249,Sixta,I kinda wish edn had a facility for namespaces :(
1662,1559239450.0251,Dann,"it does, just not a ""current namespace"" ```user=&gt; (clojure.edn/read-string "":foo/bar"")
:foo/bar```"
1662,1559239617.0253,Alease,"neat info, I wasn't sure, I was watching an older rich video and he ploped some clojure code and showed it as edn, so I wasn't sure if there was some connection outside of serialization to the language"
1662,1559239757.0255,Dann,"it's intentional that everything that is valid edn (or nearly so) is valid in clojure source (as syntax or literal); but it doesn't extend to everything in the other direction; on the other hand, metadata (and the `^` metadata shorthand) does work on edn, and transfers to the read value; ```user=&gt; (clojure.edn/read-string ""^:foo []"")
[]
user=&gt; (meta *1)
{:foo true}```"
1664,1559240960.03,Luz,"I ran into a weird issue just now where I was wrapping `with-redefs` in a `fn`. When I tried to execute the function, the `with-redefs` would _fail_ for a function that I was rebinding but _succeed_ for an atom that I was rebinding. After relocating `with-redefs` so that it wrapped the `fn` instead, everything works.

I'm actually struggling to put this into a toy example, for whatever reason.

Clearly there is something going on I don't understand. Just wondering if there is any obvious ""gotcha"" that I ran into."
1664,1559240969.0301,Marlyn,regexes and `#'var`
1664,1559241401.0309,Sixta,I also miss regex (in config files)
1664,1559241409.0312,Dann,was the fn called by something lazy that might escape the context of the with-redefs form?
1664,1559241646.0317,Luz,"i don't think it would be evaluated lazily. here's what was calling `fn`:

```(defn with-props
  ""Temporarily rebinds props and calls `f`""
  [props-map f]
  (let [old-props (atom {})]
    (doseq [[k v] props-map]
      (swap! old-props assoc k (.getProperty props/properties k))
      (.setProperty props/properties k v))
    (f)
    (doseq [[k v] @old-props]
      (.setProperty props/properties k v))))```"
1664,1559241772.032,Dann,and where is the with-redef? - oh it's inside f
1664,1559241839.0332,Luz,"basically i had been calling

```(with-props {} 
  (fn [] 
    (with-redefs [my vars]
      (do-stuff))))```"
1664,1559241891.0341,Dann,"yeah, my question was if any of (do-stuff) might be lazy, or otherwise execute after with-redefs exits; (eg. if it uses other threads)"
1664,1559241938.0347,Luz,"oh. that's exactly what it is :slightly_smiling_face:; was writing to a channel, and the consumer of the channel had the var i was trying to redef; of course"
1664,1559241984.0361,Dann,"also - with-redefs is a really blunt tool - it's redefining those vars in all your other threads!; if two threads both use with-redefs, you have a race condition that could lose the original pre-redef values; a (grabs bindings)
a (stashes bindings)
a (sets bindings)
b (grabs bindings)
a (resets bindings)
b (stashes bindings)
b (sets bindings)
b (""resets"" bindings); that last step actually sets the bindings from a, not the original bindings; I wouldn't use with-redefs outside tests, and even then I'd be sceptical; (that is, if your tests use threads at all it's still likely to cause problems)"
1664,1559242279.0403,Luz,"fortunately it's (mostly) single threaded test code, but point taken"
1665,1559246370.0415,Clarine,"where can I find in which places in `defn` or `fn` metadata can be expected? on the fn name, on arguments… where else?"
1664,1559246420.0418,Dann,"at the end of the function body for multi-arity; ```user=&gt; (defn foo ([]) {:extra true})
#'user/foo
user=&gt; (-&gt; #'foo meta :extra)
true```; since there's no single argument list to put the meta on; err.. but a hash-map before the function bodies also works ```user=&gt; (defn bar {:also :OK} ([]) {:extra true})
#'user/bar
user=&gt; (-&gt; #'bar meta :also)
:OK
user=&gt; (-&gt; #'bar meta :extra)
true```"
1664,1559246601.044,Clarine,"so those are the normal hashmaps as metadata, but in which positions can people put metadata? `(defn ^String bar ...)`, `(defn bar ^String ([] ...)`? I’d like to have a comprehensive overview"
1664,1559246659.0442,Rosaline,metadata can be expected anywhere
1664,1559246678.0444,Clarine,good point :slightly_smiling_face:
1664,1559246681.0445,Rosaline,type hints (a specific kind of metadata) can only go certain places; and only certain metadata is copied from the read forms to evaluated obejcts
1666,1559249376.0457,Zenaida,"Hi! Could someone explain to me why `(every? vector? nil)` evaluates to `true`?; Like, does it make sense <https://github.com/clojure/clojure/blob/e72ffdcd039189e3fe230d160e093ae6ba8f24cf/src/clj/clojure/core.clj#L2680> ?"
1666,1559249522.0469,Dann,"<@Zenaida> ""is every member of an empty set a vector?"" - this is considered true in classical logic"
1666,1559249646.0476,Becki,colloquially you can think you need a counter example to disprove the universal. There are no counter examples in empty collections.
1666,1559249678.0478,Zenaida,hmmm nice! thanks for the clarification!
1667,1559276907.0498,Renata,"Hi, is there a something equivalent to GOPROXY in maven for fetching dependencies. In our CI whenever it tries to build a jar it fetches the dependencies every time from Clojars."
1668,1559280324.052,Rosaline,"It sounds like using docker without keeping your .m2 cache between builds, so persist your m2 between builds"
1667,1559281570.0522,Renata,"But to build up m2 it will still fetch it from clojars right,"
1667,1559281954.0524,Sixta,Only the first time
1666,1559297184.054,Merna,"Anyone got any preferences for picking things out of parsed xml these days? I like the look of the approach in <https://juxt.pro/blog/posts/xpath-in-transducers.html> but there's no library there or anything, just some notes - wondering if maybe there's something out there now"
1669,1559302807.0547,Harris,maybe try spectre
1670,1559312272.0575,Esther,Anyone here have experience with Clj on Windows through PowerShell versus Windows Subsystem for Linux?
1669,1559315380.0611,Zona,I use `clj` with powershell; it seems fine?
1669,1559315430.0616,Brent,"I want to read a long file, processing the lines, without keeping all of it in the memory. Is there a nice way to ensure the resource is closed once the whole line-seq is consumed? I guess I could wrap the processing in a transducer as they have the 1-arg ""completion"" arity... Thoughts? Thanks!"
1669,1559315643.0617,Olympia,"this might help, its from data csv but it might apply to whatever you are doing <https://github.com/clojure/data.csv#laziness>"
1669,1559316200.062,Brent,Thank you. The proposed solution - move with-open up - is usable but not as nice :)
1669,1559316313.0622,Danna,"<@Brent> I've had success with things like
```
(defn csv-maps
  ""generic low overhead way to turn (massive) csv file
   into lazily evaluated stream of maps""
  [ff &amp; opts]
  (reify clojure.lang.IReduceInit
    (reduce [_ f init]
      (with-open [^BufferedReader r (jio/reader ff)]
        (let [hdr (first (apply csv/read-csv (.readLine r) opts))]
          (transduce (map (partial zipmap hdr))
                     (completing f)
                     init
                     (apply csv/read-csv r opts)))))))
```; you can `reduce` over that and you get maps of the row data"
1669,1559318526.0633,Brent,Thank you! Does it close properly when there is an exception during the processing?
1669,1559321046.0635,Danna,"yeah the `with-open` should take care of that; it expands to a
```(try
...
(finally (.close
```"
1669,1559323789.0643,Brent,Thanks!!
1671,1559326032.065,Becki,is it correct that you can never see two sequential reader macros?
1671,1559326301.0659,Rosaline,"I don't think it is, I have never seen it done, but I believe that is supported behavior; sorry, no, I am thinking of tag literals; for reader macros, you can for exmaple, do things like #_#'+"
1671,1559326453.0685,Becki,"ah i think i am more precisely talking about tag literals. `#js`, `#uuid`, etc"
1671,1559326463.0687,Rosaline,"yeah, tag literals stack"
1671,1559326482.069,Becki,"makes sense i suppose. its just function composition, yes?"
1671,1559326561.0702,Rosaline,"well sure, but the way the reader works it is basically ""read the next form and hand the read result to this function"", and if the next form is also a tag literal it just does that again"
1672,1559327112.0707,Sixta,Aero configs use this a lot
1672,1559341743.0716,Lana,"I suspect the reason you’re not seeing a lot of answers to this question is that it is a non-specific question about some code with no context or explanation. If you could be more clear about what specific parts you are having trouble with, it would be easier to help. After a bit of research, it looks like you are using JavaFX, which I never have, and I don’t know if anyone else on this channel has either. Because of that, I am not going to be able to put together a test environment to really try out my answer, which means it will likely contain mistakes. But with that caveat, and assuming that you are asking how to express that code using Clojure Java interop syntax, it would be something like this…; First, I am assuming you have your table object in a Clojure local `table`.; ```
(.setOnMousePressed table
  (proxy [javax.event.EventHandler] []
    (handle [event]
      (when (and (.isPrimaryButtonDown event)
                 (= (.getClickCount event) 2))
                 (println (.. table getSelectionModel getSelectedItem))))))
```; That’s not the indentation/line breaks I would really use but I adjusted it to be more readable in the narrow thread window.; To more closely parallel your Java code (and avoid some reflection), you could type hint the `event` parameter, which would look like `(handle [^javafx.scene.input.MouseEvent event]` …); And you could shorten this code by importing the `EventHandler` and `MouseEvent` classes in your Clojure namespace so you would not have to fully-qualify them in your code."
1673,1559350052.0738,Mohamed,Using the build in `clojure` cli is there a way to make it download all the deps? The equivalent of `lein deps`?
1673,1559350164.075,Rossie,"with the clojure/deps.edn ecosystem, is there a good reason to stuff a project with multiple components (let's say server/client binary) that don't make sense separately but are developed mostly in tandem in 1 deps.edn file or multiple?; I ask  because i've currently done that with leiningen and hit a whole bunch of long-standing profile-related bugs"
1673,1559350895.0767,Kirsten,just running `clojure` alone will download the deps declared in deps.edn
1673,1559351133.077,Marlyn,that will start a repl; if you don't want that run `clojure -Spath &gt; /dev/null`
1674,1559353543.0777,Mohamed,Thank you ; <@Marlyn> what does -Spath do?
1674,1559356609.0788,Marlyn,computes the classpath
1675,1559370181.0807,Sixta,"<@Rossie> in JUXT/edge we use separate deps.edn files, and then use :local/root to pull them together.; On client projects (this hasn't been demo'd too much) we have designed extensive setups where the configs are factored out to make it easier to pull applications together this way."
1676,1559381330.086,Laticia,"i’m using http-kit to write a simple API server. does anyone know how to add SSL support to it directly with Clojure? by directly I mean without using an external reverse proxy (like nginx) or SSL terminator. Internal ones (i.e. inside the JVM where I could control with Clojure) are perfect; the reason i’d like to have control over the SSL part is because the API server is a test server for a custom SSL client on MCU, and we want to be able to generate new SSL certificate and have multiple SSL sockets listening with different certificates (for testing successful cases and unsuccessful cases); i’ll try jetty for now but if anyone has better suggestion it would be great"
1676,1559382382.0889,Karren,This still sounds like a perfectly doable thing with nginx or other proxy: <https://stackoverflow.com/a/38054382/1184752>
1676,1559382500.0892,Laticia,yeah sure i’m using a configuration like that for the production server but this is for the testing server and would like direct control over ssl configuration (including certificate generation) directly from the Clojure codebase
1677,1559395062.0905,Aubrey,The pedestal codebase might have some ready-made code you can either use directly or copy-paste 
1676,1559396319.0908,Laticia,"that’s a great note. this file has many interesting snippet:
<https://github.com/pedestal/pedestal/blob/09dd88c4ce7f89c7fbb7a398077eb970b3785d2d/jetty/src/io/pedestal/http/jetty.clj>"
1677,1559396371.091,Laticia,"for anyone who’s curious, i finished the exploring and got a working piece so far by using
- Bouncy Castle to generate a keypair and a self-signed certificate
- a KeyStore instance of type “pkcs12” to hold the certificate + private key
- Jetty with a ServerConnection configured with a SslConnectionFactory and a HttpConnectionFactory to finally get a running server"
1676,1559396587.0915,Laticia,not sure who else is interested but i may post a gist after cleaning the code a little bit another day
1678,1559401165.0923,Sheron,where do you host your stuff ?; if on amazon i would recommend using alb or elb instead of doing the ssl stuff yourself ... yes it costs a little extra but is well worth the money
1678,1559401893.094,Tressa,"even locally, an nginx reverse proxy can alleviate lots of that pain"
1679,1559403763.0946,Scotty,"Could you have a look, is this solution good enough, or am I misusing protocols this way?

The problem: I have a code that reads/writes things to a serial port. There are places in program where a number of reads/writes is expected to be finished by a specific deadline (protocol description contains phrases like ""if the whole data frame was not received within 1500ms, application should stop receiving it and return to idle state."") I have tried to weave the operation deadline through reading/parsing routines (the data frame cannot be read in one operation, as it contains embedded lengths), but it was awkward. At the end I bound a `deadline` to a port object. (edited: moved `read-byte` out of interface)"
1679,1559403916.0953,Toccara,Hello guys; how can i embed values into xml files in clojure?; something like erb in ruby for example; i guess i found <https://freemarker.apache.org/>; if someone interested too :slightly_smiling_face:; <https://github.com/yogthos/Selmer> also
1680,1559412278.1001,Loria,"Are `#`, `%` and `&amp;` valid characters in a Clojure(script) symbol? I couldn't find an official language spec, and the rules given in <https://clojure.org/reference/reader> seem overly restrictive; ```
Symbols begin with a non-numeric character and can contain alphanumeric characters and *, +, !, -, _, ', ?, &lt;, &gt; and = (other characters may be allowed eventually).
```"
1680,1559412488.1023,Latonya,"The rules given at <http://clojure.org|clojure.org> are what is explicitly supported.  The implementation does not prevent you from using other characters, but using some of those other characters can cause some use cases to break; If you are looking for an implementation of (symbol ""some string"") or (keyword ""some string"") that throws an exception if you give it a character that is outside of a particular set of characters, you will have to write it yourself or find it in some third party library."
1680,1559412620.104,Loria,Does that mean that using e.g. `a#b$c` as a variable name could potentially be broken in a future release of Clojure?
1680,1559412691.1052,Latonya,"I am not the decision maker on what changes in future releases of Clojure, so can't authoritatively answer such a question, but I can say that the Clojure maintainers do a great job at maintaining backwards compatibility, and rarely make changes that break such things.  They know that because the implementation allows other characters, that many people take advantage of htat.; But for example if you find that using such a variable name causes, say, printing your code or data to a file, then reading it back, to break, then if you are using characters outside of the allowed set, and that is the reason it is breaking, you will likely not get a lot of people rushing to change Clojure to make that work.; For example, if you use a space in a symbol or keyword, that will break the ability to print code/data and read it back and be equal to the original."
1680,1559412876.1079,Loria,"that makes sense, spaces are definitely off-limits"
1680,1559412888.1084,Latonya,"There is a Clojure JIRA issue that suggests some kinds of actions in this area -- I am forgetting whether it was only adding more documentation for Clojure, or adding a function that would check whether a proposed string was a supported symbol/keyword; Semicolons would be another thing that might be a bit grey in terms of print-read round-tripping.  Probably many others.; commas"
1680,1559412996.1117,Madeleine,You can easily extend printing and reading though. I've added support for spaced namespaces and symbols in some use cases where it was convenient
1680,1559413005.112,Loria,"I was wondering because clojure-mode in Emacs highlighted a variable name `foo#bar` wrongly, and I couldn't find out if it was an actual bug or according to spec"
1680,1559413012.1124,Madeleine,And it can round-trip if you need it serialized
1680,1559413014.1126,Latonya,Here is the JIRA issue I was thinking of: <https://clojure.atlassian.net/browse/CLJ-1527>
1680,1559413224.1138,Madeleine,"I don't think I've ever seen a breakage related to what are valid symbols and namespaces. Like no version of Clojure ever broke that.; So I'd say, it it works, you're probably good to go"
1680,1559413308.1151,Latonya,"But if you go to significant lengths, e.g. days and days of work, trying to get color highlighting ""working"" (whatever that means to you) for arbitrary sequences of characters, you may go mad. :slightly_smiling_face:"
1680,1559413595.1155,Loria,thanks for the clarifications! :slightly_smiling_face:
1681,1559421643.1159,Sixta,"Is it possible to use tools.reader to read a form as a string? Preserving whitespace. I'm guessing there might be some trick with the pushback reader, but not sure."
1682,1559427624.1167,Jasmine,"Yes, also in the Clojure reader; See <http://clojure.github.io/clojure/clojure.core-api.html#clojure.core/read+string>"
1683,1559432840.1187,Rossie,"I'm running: `clj -A:cli:client -m aot some-args`
the `client` alias has both an `:extra-deps` and a `:main-opts`. I was expecting the main-opts on the command line to override those from the alias, but instead the main-opts from `:client` are used. Is there an order to specify them in that fixes that, or is this why -R/-C exist?"
1682,1559432964.1194,Jasmine,"This is a known issue, but using R and C should be a workaround; A will always be applied last right now"
1682,1559433020.1202,Rossie,"ah, gotcha -- thanks :slightly_smiling_face:"
1684,1559452629.1249,Laticia,"locally, for testing purpose; yeah, for another project i’m doing exactly the same--using elb for ssl termination--yet this stuff is for developing and testing the “hardware” part of a solution (an MCU controlled gateway-ish thing that connects an input device to the application server running in the cloud); so finally the production server will be hosted behind elb as planned now, but i was trying to make the local server and want more flexibility on certificates for testing purpose"
1685,1559500330.127,Modesto,"How would I quote the symbol `/=` ?  `'=` is fine, `'/` is fine, but `/=` says `unmatched delimiter: )`.  Do I need to escape the slash or something?"
1685,1559500760.1274,Becki,"```
[dan@fedora datascript-todo]$ clj
Clojure 1.9.0
user=&gt; (quote \=)
\=
user=&gt; '\=
\=
```
i'm guessing this is an issue with your repl?"
1685,1559500778.1277,Modesto,"That's backslash, I was trying with forward slash"
1685,1559500837.128,Becki,"oh apologies; &gt; /' has special meaning, it can be used once in the middle of a symbol to separate the namespace from the name, e.g. my-namespace/foo. '/' by itself names the division function.; <https://clojure.org/reference/reader>; that's not a valid symbol is what i'm reading there"
1685,1559500930.1292,Modesto,"yeah even this doesn't work: `(read-string ""/="")`  =&gt; `invalid token: /=`"
1685,1559500957.1296,Fernande,in jvm clojure i get Syntax error for (def /= 1); in clojurescript i get Failed to read
1685,1559500986.1302,Modesto,so i'm making a toy library for array syntax to learn macros; and was trying to support e.g. `a[0][1] /= 2`; but I can't define a symbol `/=` to recognize
1685,1559501060.1316,Fernande,perhaps because / is used for &lt;namespace&gt;/&lt;name&gt; like situations?
1685,1559501072.132,Modesto,yeah just not sure how to work around it
1685,1559501080.1324,Fernande,perhaps there is no workaround
1685,1559501086.1326,Becki,not sure you can. same as you can't make `bob)` a symbol
1685,1559501118.1329,Modesto,I guess I'd have to recognize it as a string; like turn the list body into a string and parse it
1685,1559501177.1337,Becki,if you're breaking in the reader i'm not sure you can do that
1685,1559501206.1342,Modesto,I think I could turn the body into a string and find `/=` in the string and handle it accordingly
1685,1559501209.1345,Becki,unless you mean turn it into a string literal
1685,1559501223.1348,Modesto,but it would probably mean I'd have to do all the other cases (e.g. `*=` the same way) :confused:
1685,1559501403.136,Latonya,"If you are trying to ""write a language"" with Clojure macros that has the full library of Clojure available as well, then I'd recommend using a different symbol than `/=`, e.g. `div=`, even if that looks ugly.; If you are trying to write a language with its own custom syntax, and you are writing a compiler in Clojure to translate it into some other language that isn't Clojure, then you should be able to define whatever syntax you want that you can write a parser for.  I am guessing that is not what you are trying to do, though."
1686,1559540382.1396,Ali,"Checking for a non-empty collection, `not-empty` or `seq`?"
1686,1559541292.1407,Bart,"`not-empty` is just `(when (seq coll) coll)`, so `seq`; also `empty?` is implemented as `(not (seq coll))` which is why complementing it again with `(not (empty?))` is also not idiomatic; assuming you're just checking for non-emptiness, `not-empty` is still useful for `conj` purposes for example"
1686,1559541548.143,Ali,"This is just to short-circuit a function, so I'm looking for the thing that will do the least amount of work possible. Sounds like `seq`."
1687,1559543329.1432,Latonya,I believe that many Clojure programmers consider (seq coll) as idiomatic for this purpose.
1686,1559544213.1434,Bart,"it's the recommended idiom for testing non-emptiness on any collection, yes"
1688,1559544317.1436,Alleen,"for counted collections, `(zero? (count coll))` should be faster (`seq` will allocate an object if non-empty)"
1688,1559544470.1438,Bart,"`seq` basically just returns an iterator though doesn't it? it doesn't do anything besides that, like attempting to convert the sequence"
1688,1559544640.144,Ali,Which collections are counted?
1688,1559544747.1442,Alleen,"`seq` wraps the collection in a lazy sequence if not already one. If you call it on e.g a vector, it will coerce it and create a sequence. It's cheap, but not totally free.; <@Ali> eager collections are counted; some lazy seqs are counted as well but I would not rely on that"
1688,1559545861.1454,Ali,"Some measurements <@Latonya> <@Alleen>

```;; list 
(seq a-list)           ;; 18,208247 ns
(count (zero? a-list)) ;; 11,566028 ms
  
;; Vector
(seq a-vector)           ;; 14,460552 ns
(zero? (count a-vector)) ;;  5,665201 ns
  
(defn yo? [a-something]    
  (if (vector? a-something)
    (zero? (count a-something))
    (seq a-something)))
  
;; Conditional
(yo? a-list)   ;; 29,218636 ns
(yo? a-vector) ;; 22,279887 ns```; `(zero? (count …))` appears to be faster for counted collections indeed.

Edit: Actually, rereading the numbers, using `seq` is better than a conditional check. Therfore, `(zero? (count …))` only when it's certain to be a counted collection.; This is for a fairly large collection of about 200k items."
1689,1559547238.1463,Alleen,BTW `counted?` exists
1690,1559558230.1497,Danita,"Hi, I'm trying to slowly convert some of my company on to Clojure. Do you have any good data on language adoption over the years?"
1690,1559559473.1498,Karren,How did you measure that?
1691,1559560548.15,Amado,this may be relevant (including survey data) <https://clojure.org/news/2019/02/04/state-of-clojure-2019>
1690,1559561715.1504,Ali,"<@Karren> `(criterium/bench …)`

<https://github.com/hugoduncan/criterium/>"
1690,1559561847.1509,Danita,cool thanks
1692,1559564563.152,Ali,"<@Alleen> Remeasuring with `counted?`, it seems to make a surprisingly large difference for the conditional evaluation:

```(defn yo? [a-collection]
  (if (counted? a-collection)
    (zero? (count a-collection))
    (seq a-collection)))

;; Conditional
(yo? a-list)   ;; 25,774480 ns
(yo? a-vector) ;;  9,714775 ns```"
1692,1559564834.1529,Min,You could also do `(bounded-count 1 xs)`
1692,1559564963.1538,Marlyn,empty? may get a counted? check in 1.11
1692,1559564974.1539,Alleen,how did you build `a-list` ?
1692,1559565104.1541,Ali,"Cool! Doesn't really help in situations where `seq` is idiomatic though.; <@Min> Interesting, didn't know about that one. I'm getting these numbers:

```(zero? (bounded-count 1 a-list))   ;; 54,374905 ns
(zero? (bounded-count 1 a-vector)) ;; 14,014822 ns```"
1693,1559565629.1553,Ali,"`yo?` seems slightly more efficient than `bounded-count`.; These things do make a difference. Using `(zero? (count …))` instead of `seq` (I know I'm working with vectors), I dropped the running time of a function from 3.41 seconds to 2.37 seconds (for a computation where I know the evaluation sits in a very hot path)."
1693,1559566510.1591,Min,"I guess you could try also `(nil? (first xs))` since we're having fun with this stuff; as long as your collection has no nils; well it will just call seq on it so might not be so good with vectors, so yeah prolly useless"
1693,1559566695.1603,Jasmine,why are you even checking for a non-empty collection in the first place?; pretty much the only place I ever do this is when loop/recuring through a sequence (in which case you are forcing the seq anyways with first/rest); that yo? function above returns either true/false/nil/seq which seems like a mess
1694,1559568517.1618,Ali,"Parsing XML. I use it to halt evaluation early when a previous step in the parser produces no data of interest.

In practice it does make a difference in performance, and choosing the right way to evaluate whether data is present or not seems to make an additional difference.; But also, it's just fun to learn the performance implications of the different alternatives. I didn't initially expect this line of investigation to yield much of interest."
1693,1559568903.1622,Jasmine,what is the type of the thing being returned that you are checking?
1695,1559568988.163,Leeann,"I seem to remember that the `-` in `-main` has a special meaning, but I’m not able to google it ATM. Anyone have a link to more info about this?"
1693,1559569040.1639,Jasmine,it's the default prefix for static methods to genclass
1693,1559569043.1642,Madelene,there’s no special meaning as such it’s just the default option for genclass
1693,1559569054.1645,Jasmine,but that can be changed with an option to genclass
1693,1559569627.1646,Ali,"The XML documents are in JATS format which is a right mess of data-meant-to-be-read-as-metadata, data-meant-for-display, and data-meant-to-simultaneously-work-for-display-and-metadata.

My solution (which is probably suboptimal to begin with, but nevertheless) essentially invokes different parsers for different branches, that might return more data to be processed by a different parser and so on (because a ""display"" section, which I turn into hiccup, might return some forms that also needs to be read into proper named fields and so on).

As a side effect of this solution, parsers return a collection that might or might not be empty. To avoid looking for another parser for nothing, I kill the branch at that point."
1693,1559569736.1649,Jasmine,"well, in general, it's better to avoid making the empty collection in the first place if you can avoid it; that's why clojure collection functions are polymorphic on nil"
1694,1559569752.1653,Ali,Consistently return nil and use `nil?`
1693,1559569757.1655,Jasmine,"conj, assoc, etc; you don't need nil?, you can just use the value itself as a logical value; which is either nil or not; (if (parse ...) branch-when-parsed branch-when-nothing)"
1693,1559569943.1663,Ali,"Before `(parse …)` there's a lookup to find the correct parser, which reside in a map currently. I'm guessing that's the bottleneck that I'm circumventing.; Invoking `((get {…} nil) data)`, which resolves to `(nil data)` isn't great, so at some point I have to shut things down before it gets to that.; And it seems to be more performant to shut it down before `(get …)` than on receiving `nil` from the index."
1693,1559570244.1669,Jasmine,"why would you not find a parser?; could you return a default ""not-found"" parser that did the right thing?; ((get parser-table nil not-found-parser) data); make the special case not special"
1693,1559570534.1677,Ali,"Yeah, true, I could do that. `not-found-parser` would return `nil` no matter what. Do you reckon that would be better than checking for emptiness?"
1693,1559570566.1679,Jasmine,yes
1693,1559570667.1681,Ali,"Alright, I'll give it a shot!"
1693,1559570672.1683,Jasmine,"this is all general advice applicable in many places...  don't make empty collections, lean on polymorphic collection append functions, use identity/nil as a predicate, etc; seq is a good predicate when doing seq things. you're not doing seq things.; the code above will be smaller, more readable, and more performant"
1693,1559570798.169,Ali,I'll try it out and measure. Thank you. I haven't internalised the nil case into my collection of idioms like this. It's a good a time as any.
1696,1559580054.1705,Larissa,"Hello all, is it worth to use <https://github.com/daveray/seesaw> yet?"
1697,1559583326.171,Roslyn,Use <#CGHHJNENB|cljfx> <https://github.com/cljfx/cljfx>
1698,1559585658.1734,Keesha,"Hi everyone! What scheduler do you use in your Clojure projects? I am looking for something robust and reliable, like Celery for Python. I found several libraries but from the repos not one specific one was preferred more than others."
1698,1559586495.1738,Dann,"do you need persistent and distributed scheduling?; if no, use a ScheduledThreadPoolExecutor via interop; if yes, I think the only really mature and reliable option is quartz, there's some pain points in using that java lib via interop, so it's worth considering the quartzite wrapper; (if you use a specific infrastructure tool like mesos, the built in scheduling there is an even better bet, but that's going to be highly dependent on your other infrastructure decisions)"
1698,1559587293.178,Keesha,I haven't yet used mesos but seems cool. I am just making a small ETL tool that's probably not mission critical. I saw this as an opportunity to test out Clojure for this :smile:
1698,1559587434.1792,Dann,"if you don't need distribution (if all your threads can run in one process, which is likely true with a small ETL tool), the ScheduledThreadPoolExecutor is much simpler and easier to use and comes with the JVM. You can persist state between restarts via a normal DB.; there's that funny thing with python where the limitation of the GIL means that any tool that needs more than one thread probably ends up being fully distributed, but with clojure threads are easy to use and you can save a lot of complexity if you don't need to be distributed"
1698,1559587615.1818,Keesha,"True. Being a back end engineer for like, forever, I never felt the need to go around the GIL. May be now it would actually be a problem for the data engineering tasks I would likely need to do."
1698,1559587699.183,Dann,"what I mean is that N threads inside one process is much simpler, and better performing, than a distributed multi process solution; though maybe you don't even need threads here"
1698,1559587725.1834,Keesha,Got you! Thanks for the suggestion!
1699,1559587989.1838,Fatima,I’ve used this for simple task scheduling cases <https://github.com/aphyr/tea-time>
1698,1559588178.1858,Fatima,It provides a nice interface. But tradeoff is that it’s an extra dependency. And ScheduledThreadPoolExecutor is probably way more battle-tested.
1698,1559588178.1859,Keesha,Thanks <@Fatima>! tea-time seems pretty intuitive! I will try it :smile:
1700,1559592644.1869,Graig,"Another Quartz wrapper can be found in Immutant:   <http://immutant.org/documentation/current/apidoc/guide-scheduling.html>; Haven't used yet, was going to use it soon.  Now I need to check out tea-time too :wink:"
1700,1559592803.1877,Jasmine,you can find some others on the <https://www.clojure-toolbox.com/>; under Scheduling
1701,1559595457.1895,Lana,"If you don’t have JavaFX or are more familiar with Swing, seesaw remains quite useful. It’s the basis of my most-used project: <https://github.com/Deep-Symmetry/beat-link-trigger#beat-link-trigger>"
1701,1559614577.1921,Mariela,"Anyone familiar with getting spurious `No such var` errors?

Might have to do with Clojure 1.10+ error reporting

Hard to verify since this project uses 1.10+ fearures, so I can't tentatively downgrade so easily"
1700,1559614639.1924,Jasmine,doesn't sound familiar to me re 1.10 error reporting; repro? fuller msg? environment?
1701,1559615209.1928,Mariela,"known-good code/project is compiling fine on:

1.10.0
1.10.1-beta2

and failing with `[org.clojure/clojure ""1.10.1-RC1""]`, 100% of the times

it also is failing occasionally with 1.10.0
/ 1.10.1-beta2 with the same error, but I can't find what causes it

stacktrace doesn't appear to say much: <https://gist.githubusercontent.com/vemv/3fd022882c9b2533fb3d669df8bcfc48/raw/56a711137778b25f6c1710721c2b9b8c4ce016ff/gistfile1.txt>

project will be open-sourced soon. TODOed to provide a repro"
1700,1559615699.1933,Jasmine,RC1 is identical to beta2 (other than updating the changelog)
1701,1559616154.1935,Mariela,"Thanks. Now I have found the true culprit: updating a certain dependency.

But still I don't know the cause of the error at all, and the reporting from the compiler side is wrong, that seems for sure."
1700,1559616215.1937,Jasmine,"this is in the compiler analyzer, when trying to analyze a symbol in a form; to get here, it's a qualified symbol, the namespace is found (here, sut), but when it looks up the var, there is no such var in the ns; if it's failing sporadically, you may be fighting a concurrent load issue with the namespace where it is in the process of loading; I've seen something like this with spec gen where it dynaloads test.check.generators - if you've got two threads potentially loading the same namespace at the same time, you can get spurious errors like this; why do you think the reporting is wrong?"
1700,1559617189.1948,Mariela,"Thanks for the analysis!

FWIW I could find <https://github.com/benfb/gorilla-repl/issues/10> which seems similar (:compile-syntax-check + `no such var`).

In my repro I don't use a special Lein, any profiles, etc. It also fails in our CircleCI which is a vanilla one

The concurrent loading thing seems possible (although I have 0 dynamic loading)

&gt; why do you think the reporting is wrong?

First and formost because the var is _there_, the ns form is correct, etc. It's known-good code, used in various projects.

Upgrading an unrelated tiny dependency  (which in fact is only used in _test_ code!) triggered the error.

And the reported error does not include the name of this dependency at all. That makes me think the reporter is wrong - a correct one would point in the direction of the dependency, rather than suggesting that the main project has an undefined var"
1702,1559632000.0011,Jaimee,is there a way to tell leiningen to have a profile which ignore some files in `src` and dependencies?
1702,1559632310.0018,Nieves,"I'm not sure, but `:exclusions` is not about it?"
1702,1559632555.0022,Jaimee,"I'm not sure but I'll try, thank you!"
1703,1559644065.0038,Gemma,"Hello guys, anyone familiar with clojure machine-head? Trying to connect to Azure Iot Hub, but getting this error: `Execution error (EOFException) at java.io.DataInputStream/readByte (DataInputStream.java:267).`"
1700,1559656448.0051,Lavonia,"Clojure reader accepts more syntax than EDN but almost all of that is just syntax sugar and after read becomes data that can be put in EDN (excluding `#=()`). Rich Hickey mentioned this in one of his talks AFAIR, emphasising the fact that `eval` deals in data structures and not text, and the LISPs give users the ability to extend the language by participating in this `eval` right after reading.
Clojure for Java Programmers part 1 if memory serves me right."
1704,1559666651.0093,Mira,Hi! Say I intentionally `throw` during testing but don’t want the stacktrace in the test output is that possible somehow (w/ `lein test`/`clojure.test`)? hope that makes sense?
1704,1559666741.0099,Andrea,"There's `(is (thrown? ArithmeticException (/ 1 0))) ` and ```
(is (thrown-with-msg? ArithmeticException #""Divide by zero""
                      (/ 1 0)))``` as part of `clojure.test`. Mentioned here <https://clojure.github.io/clojure/clojure.test-api.html>; Hope that helps!"
1704,1559667152.0104,Mira,ah yes! thanks <@Andrea>
1705,1559678425.0106,Roslyn,"Is there a guide or tutorial or some kind of explanation to why we should use `seq` for non-empty checks? I feel like I'm missing something, because semantics of `(not (empty? ...))` are clear, and semantics of `seq` requires deep knowledge of it's behavior and truthiness semantics... Which I know, but don't understand why it is advertised as preferred approach. I also remember there where some discussions on slack awhile ago where Alex Miller suggested to use nils instead of empty vectors, and just use `(when xs ...)`, and I'm interested to know why is this approach considered better, because without this check you might get surprising behavior when conjing will add to beginning instead of end"
1705,1559678522.011,Becki,I kinda agree. I saw that <@Marlyn> mentioned that `empty?` might get a counted check in the future in which case `(not (empty?` will be necessary again. It feels like `seq` is kinda using the implementation details of `empty?`
1705,1559678752.0124,Nella,the reason that `(seq x)` is preferred over `(not (empty? x))` is because `empty?` is implemented as `(not (seq x))`; so `(not (empty? x))` is just `(not (not (seq x)))`
1705,1559678831.0138,Becki,"right. which was my point about implementation details leaking out. When empty? gets more complicated looking at `ICounted` then using implementation details is bad, no?"
1705,1559678881.0146,Marlyn,implementation details?
1705,1559678886.0149,Roslyn,"I don't buy not-not argument, it's implementation detail"
1705,1559678944.0165,Nella,"<@Roslyn> yeah, I don't really either; I just know that's a reason that is often given"
1705,1559679006.0185,Rosaline,<http://clojure-log.n01se.net/date/2009-02-19.html#10:24a> has some discussion that rich eventually jumps into
1705,1559679017.0186,Marlyn,i don't understand this at all
1705,1559679222.0195,Becki,"`empty?` is defined as `(not (seq ..))` now so the common convention for ""not-empty?"" is just `seq`. My point is that this is true because we know the implementation of `empty`. In the future, if `empty?` were to be optimized by checking `ICounted` the idiom of just using `seq` would both miss the optimization of `empty?` and not have an obvious semantic as ""not-empty?"" any longer"
1705,1559679281.0198,Marlyn,"it would check for counted, then do the existing impl; what is the optimization of `empty?` ?"
1705,1559679328.0211,Becki,presumably a check that if it can be counted its count is 0
1705,1559679346.0216,Marlyn,"it's not intended as an optimization, but something so that empty? can work on transients"
1705,1559679354.0219,Jasmine,"my suggestion to <@Roslyn> earlier is primarily due to the use case in that context - the stuff he is doing is collection stuff. In that case, lean on nil and polymorphic collection fns and avoid using empty collections at all. If you're in more of a seq context, then lean on seq.; in general in Clojure avoid making stuff to hold a ""place"" - if you do that Clojure's design will lead you to code that is simultaneously easier to read, has fewer branches, and is more performant.; this applies to putting nil values in maps (just omit), making empty collections (conj or assoc into nil instead), etc"
1705,1559679649.026,Becki,that seems to argue in favor of using `(not (empty? ..` on transients then if the standard idiom `seq` is not sufficient?
1705,1559679660.0263,Jasmine,"if you are working with collections (not sequences), forcing a seq just to check emptiness is not efficient"
1705,1559679664.0265,Marlyn,seq doesn't work on transients; at all
1705,1559679679.0271,Jasmine,"the advice to use (seq x) as a terminating predicate is primarily of use when working with sequences, where you are going to force the sequence anyways to walk it (and sequences cache that so the additive cost is negligible); that is all my own internalized ""best practice"", so not trying to speak for Rich in any way here, fyi"
1705,1559680247.0316,Roslyn,"I understand what you say about advising to use `(seq x)` where I am going to force sequence anyway, but can you elaborate more on ""avoid making stuff to hold a place""? Is `(let [x (blah-&gt;possibly-empty-vec blah)] (when-not (empty? x) ...))` somehow a place and `(let [x (blah-&gt;non-empty-vec-or-nil blah)] (when x ...))` is not?; I also worry about conjing into nil: I'd usually prefer to work on vectors, not lists, and conjing into nil produces a list"
1705,1559680433.0326,Becki,"sorry had work. But that's why `seq` as a dual to `empty?` is a poor fit when `empty?` is updated to work on transients but its dual would not work, right?"
1705,1559680615.0332,Jasmine,"ah right, I actually was thinking of (conj) for that one"
1705,1559680678.0338,Marlyn,seq and empty? are not duals
1705,1559680702.0343,Jasmine,"of those two examples you give, I definitely prefer the latter; wouldn't you rather avoid constructing an empty vector (which takes time and consumes memory) and also write `(when x ...)` vs writing `(when-not (empty? x) ...)`?"
1705,1559680795.0374,Roslyn,"but `(identical? [] [])` returns true, what is taking time here?"
1705,1559680829.0381,Marlyn,"I've seen a lot of code that contorts itself to use `empty?` because it's perceived as more literate than `seq` -- but `seq` is a fundamental function and idiom, not some advanced feature; `identical?` does not work on vectors -- it happens that the compiler interns the empty vector"
1705,1559680978.0403,Jasmine,Clojure rewards you again and again for not making stuff. nils are cool. I like nils. I disagree with Hoare. :)
1705,1559681010.0404,Roslyn,good point; I just realized I also prefer `blah-&gt;non-empty-vec-or-nil` :slightly_smiling_face:
1705,1559681215.0444,Jasmine,"if you're going to write stuff like `(when x ...)` though, you are committing to a philosophy and it requires some amount of discipline to return `nil` and not `[]`; I am all in on that; but make sure  everyone in your team agrees ;)"
1705,1559681256.0455,Roslyn,"yeah, this approach should apply to all the codes"
1705,1559681275.046,Jasmine,"same thing on omitting attributes from maps when the value is nil; if you're taking that approach (again, I'm all in), then you need to be careful to avoid adding those attributes when you create the maps in the first place; and aware of external libs/systems that might give you maps like that; generally, I think it's rarely worth stripping stuff out of maps if you get them from someone else"
1705,1559681402.0496,Roslyn,"<@Marlyn> Agree on `seq` being fundamental idiom, but `empty?` is still more literate, and a function to check if coll is empty in clojure core seems pretty fundamental as well, I don't see an argument here in favor of `seq`"
1705,1559681437.051,Jasmine,these are functions that apply in different worlds
1705,1559681438.0511,Beckie,"I always prefer an empty collection over a `nil`.  Also, I wrote my own function `(not-empty? x)`"
1705,1559681439.0512,Celestine,"For example, `clojure.java.jdbc` will give you maps with `nil` values if the column in the database was `null`. But in `next.jdbc`, at least on *master*, there's `next.jdbc.optional/as-maps` that will give you maps where `nil` values are omitted."
1705,1559681478.0521,Jasmine,"in some sense, jdbc is just surfacing sql here, so it makes total sense"
1705,1559681485.0525,Celestine,(the default `as-maps` is still `nil` values from `null` columns)
1705,1559681500.053,Jasmine,sql nulls are inherently overloaded
1705,1559681560.0544,Roslyn,"Yeah, right, different worlds. `nil` instead of `[]` for the win"
1705,1559681611.0554,Jasmine,"<@Roslyn> if you are writing seq-oriented code (using -&gt;&gt;, map, filter, etc), seq makes total sense and I think the language designer has been quite clear that it is the proper idiom for checking whether the seq has at least one element or not"
1705,1559681669.0561,Roslyn,I usually use transducers instead of lazy sequences wherever I can for performance reasons
1705,1559681690.0564,Jasmine,transducers aren't always faster; nothing wrong with using lazy seqs where it makes sense
1705,1559681784.0594,Roslyn,"hmm, I thought they are, with exception of mapcat fully realizing intermediate steps..."
1705,1559681786.0595,Jasmine,"past blathering on this topic recorded here: <https://clojure.org/guides/faq#transducers_vs_seqs>; if you're only going to use 5 values, then it's a lot faster to use lazy seqs"
1705,1559681804.0602,Marlyn,there may be a misconception that `seq` and `empty?` are opposites
1705,1559682219.0606,Roslyn,"it's not?
```
(criterium.core/quick-bench
  (into []
        (comp
          (map inc)
          (filter odd?))
        [0 1 2 3 4 5 6 7 8 9]))
;; Execution time mean : 329.302467 ns

(criterium.core/quick-bench
  (-&gt;&gt; [0 1 2 3 4 5 6 7 8 9]
       (map inc)
       (filter odd?)
       doall))
;; Execution time mean : 893.769899 ns
```"
1706,1559682259.0612,Roslyn,maybe I misunderstand you?
1705,1559682289.0613,Jasmine,"but you're forcing the seq realization to compute all values; my point is, if you don't need all of them, it can be much faster"
1705,1559682409.0617,Roslyn,"ah, sure, it's faster when I don't need everything"
1705,1559682459.0619,Jasmine,"it also depends how big your colls are and how many transformations you're doing. transducers win more with bigger colls and more transformations. the majority of code like this uses small colls and 1-2 transformations.; and in those cases, it literally doesn't matter; so write the version that's easier to read; replies in thread"
1705,1559682865.065,Roslyn,"but in example above, with a small coll and 1-2 transformations, transducers are almost 3 times faster, why it doesn't matter?"
1705,1559682903.0653,Marlyn,micro benchmarks don't matter; try it with a bigger computation in the xform
1705,1559683006.0657,Roslyn,"well, it's a good point that real performance issues are not what you think they are, but isn't it a death by a thousand cuts if through all your application you add extra time here and there on every coll operation?"
1705,1559683016.0659,Jasmine,"""3 times"" sounds really different but we're talking nanoseconds; so you can pay that a million times before it's 1 second different; so really more like death by 100 million cuts to care"
1705,1559683142.0666,Roslyn,"hmm you are right, that's true"
1705,1559683336.0668,Jasmine,"take <https://github.com/clojure/tools.deps.alpha/blob/master/src/main/clojure/clojure/tools/deps/alpha/reader.clj#L84>; could easily be written as a transducer, but the typical size of ""merge-deps"" is 3 and I much prefer the way this reads; lazy seqs are not inherently bad, don't be afraid of them :)"
1705,1559683477.0675,Roslyn,thank you for explanations!
1707,1559687133.0677,Fernande,"thanks for this!  haven't heard ""druthers"" in ages :slightly_smiling_face:"
1708,1559693904.0705,Kayce,"is there a short syntax for selecting namespaced keys of off map? e.g.: `{:foo/one 1 :foo/two 2 :three 3}` I want to do `(select-keys m [:foo/one :foo/two])` but without having to repeat `:foo`; or even better, select all keys that start with `:foo/` without even listing them one by one"
1708,1559694102.0717,Milford,"<@Kayce> Not exactly what you are asking, but in the context of destructuring:
```
user=&gt; (def m {:foo/one 1 :foo/two 2 :three 3})
#'user/m
user=&gt; (let [{:foo/keys [one two]} m] [one two])
[1 2]
```"
1708,1559694290.0725,Kayce,I know you can do that
1708,1559694291.0726,Milford,"But, presumably you are looking for a shorter version of
```
(select-keys m (filter #(= ""foo"" (namespace %)) (keys m)))
```"
1708,1559694347.0732,Kayce,"yeah, something like that, but I was hoping there’s some magical trick with `#:foo` maybe"
1708,1559694467.0738,Elaine,"no magic, just functions :slightly_smiling_face:"
1708,1559694566.0746,Kayce,I hate typing. I dunno how people even deal with semicolons and commas and all that crazy garbage in other languages
1709,1559699740.0004,Latonya,"Type one namespaced keyword, then copy/paste for the others?"
1709,1559700071.0015,Dann,I guess with data-readers you could define `#foo[:x :y :z]` to become `[:x/y :x/z]` or whatever
1708,1559701088.0017,Jasmine,bleh
1709,1559701172.0028,Jasmine,we've talked about extending the namespaced map literal syntax to vectors `#:foo[:x :y :z]` but then the question is what about sets `#:foo#{:x :y}` ? gross.
1710,1559701751.0037,Tamie,deps.edn and private git repositories...  any advice?  getting: `com.jcraft.jsch.agentproxy.AgentProxyException: connector is not available:`
1708,1559702179.0041,Jasmine,<https://clojure.org/reference/deps_and_cli#_git_configuration> might help
1710,1559702187.0044,Jasmine,platform?
1710,1559702577.0046,Tamie,linux
1710,1559709434.0048,Madeleine,"Hum, not the prettiest for sets, but it's not that bad either.; Especially if you put a space in it `#:foo #{:x :y}`"
1711,1559728955.0078,Gemma,"Hello, how can I stream System.out.println() to the Clojure REPL? I am using a java class compiled with leiningen, and I want to see its log when calling it in the REPL."
1712,1559730550.0082,Roslyn,"```
(System/setOut (java.io.PrintStream. (org.apache.commons.io.output.WriterOutputStream. *out*) true))

(.println System/out ""hi"")
```"
1712,1559736240.0083,Karren,"<@Roslyn> btw. I've run the same experiment you did (3x each measurement) and got much smaller difference: ~570 ns for transducers and ~720ns for lazy seqs
```
Just another point how misleading microbenchmarks results may be."
1713,1559742222.0097,Maximina,Is everyone using `Integrant` together with `Duct` or are you also running it standalone?
1714,1559743967.0104,Raina,"If I have clj and cljc file for same namespace, in what order are they compiled? Same for cljc/cljs."
1714,1559744005.0108,Jasmine,"platform specific is always preferred; so for clojure usage, I don't think you would get cljc compiled/loaded at all; cljs is more complicated as prob different stories for macro and non-macro"
1714,1559744106.0127,Raina,"ah, so it only compiles one"
1714,1559744131.0133,Jasmine,"yeah - they are alternate versions of the same namespace; in clojure, it will look for a .class first (if newer than clj or cljc), then .clj, then .cljc"
1714,1559744176.0141,Raina,thank you for that info
1714,1559744388.0144,Jasmine,<https://clojure.org/reference/libs#order> - doc ref
1715,1559748086.0145,Sixta,I'm using it without
1716,1559750953.0164,Gemma,"hello guys, I have a reservation system which works with `agent`, so people can't reserve at the same time. But sometimes it stops working, it gives me no exception, and it doesn't restart. how is this possible?"
1716,1559751085.0175,Rosaline,what evidence do you have that it stops working?
1716,1559751201.0192,Jasmine,agents can fail and won't restart
1716,1559751205.0194,Gemma,"well, on my client-side, when people are reserving the server responds that the agent needs restart, like I wouldn't have setup the error handler."
1716,1559751214.0196,Jasmine,there are lots of options for how errors and restarts are handled
1716,1559751245.0211,Rosaline,"but presumably you have a whole stack of code between the client and the agent, how do you know the failure isn't in there somewhere?"
1716,1559751271.0215,Gemma,"so, the error-handler! doesn't handle everything? <@Jasmine>"
1716,1559751299.0226,Jasmine,"I don't have any of it in my head atm, I just know there's lot of stuff there that I use so infrequently that I have to re-read the source"
1716,1559751314.023,Gemma,"<@Rosaline> because the error is specific to the agent, and because I log the errors and the restarts, and sometimes restarts doesnt happen, only the error"
1716,1559751377.0247,Jasmine,"and honestly, approx 0% of users use this stuff so it wouldn't surprise me if there were unsurfaced bugs"
1716,1559751426.0256,Rosaline,I thought you said you don't get an error?; what is the error that is specific to the agent?
1716,1559751441.0263,Jasmine,how are you configuring the agent wrt error-handler and error-mode?
1716,1559751530.0282,Gemma,"<@Rosaline>, I log in the database for certain functions. like restarting the agent. And when agent restarts I put the error in my logs. In the case when restarting doesn't happen, my error is logged, but is an empty string; <@Jasmine>, well it is in my snippet, I set-error-handler! after defining it"
1716,1559751610.0295,Jasmine,"the default error-mode of an agent is :fail, not :continue (unless there's an error handler); not sure how that changes if you set the error-handler after the fact"
1716,1559751649.0304,Rosaline,so it sounds like you do get an error; it is hard to say since you deleted the logging bits from your example
1716,1559751719.0321,Gemma,"I put it back, i didnt want chaos"
1716,1559751721.0323,Rosaline,but it sounds like you are getting an error (the error handler is running) and something is going wrong in your error handler
1716,1559751783.0327,Gemma,that's the code without modification
1716,1559751783.033,Jasmine,exceptions thrown in the error handler itself are ignored and lost
1716,1559751805.0337,Rosaline,"oh; yeah, you are running the error handler in a future; so they are racing to handle the error"
1716,1559751825.0348,Jasmine,you've introduced a race here by restarting in the future - restarts are ignored if the agent is not in a failed state
1716,1559751837.0352,Rosaline,so the error is already cleared by the time you try to get it with agent-error
1716,1559751864.0358,Jasmine,I would have to study all that code more closely to really think about the concurrency aspects of this
1716,1559751874.036,Gemma,"so, I take out future and it should be fine?"
1716,1559751898.037,Rosaline,"it may or may not be fine, depending, but it will take care of the empty string thing"
1716,1559751900.0373,Jasmine,"it would take me a lot more time to answer that question, and I don't have it atm"
1716,1559751910.0374,Gemma,"I never did concurrency before, this is my first approach on this topic.; But it will restart then, that's what matters, I guess."
1716,1559751945.0385,Jasmine,why not just use error-mode :continue?; then the agent will automatically restart?
1716,1559751984.0397,Rosaline,in general (depending on the database) you will be much better off using your database features to keep things consistent in the face of multiple writers
1716,1559751995.0401,Jasmine,`(set-error-mode! reservation-queue :continue)`
1716,1559752013.041,Rosaline,"presumably at some point you want this running on multiple machines, at which point the serialization you get from agents doesn't exist"
1716,1559752036.0416,Gemma,"<@Jasmine>didn't know such thing existed, thank you very much"
1716,1559752064.0426,Jasmine,"if you read the docstring for `agent` and some of the other functions around it, I think that might help"
1716,1559752130.0436,Gemma,"<@Rosaline> No, this project will stay with 22 shops, so I guess I won't need nothing more sophisticated. But I am trying to learn more about the topic, I also enjoy it more than the frontend. :slightly_smiling_face:; <@Jasmine> Thank you, duly noted. If it weren't for a stackoverflow topic, I wouldn't even used future, so yes, next time I start with the docstring."
1717,1559753404.0449,Madelene,both with duct and standalone here
1718,1559757673.0461,Somer,"Is there a way to have `(edn/read-string ""{:foo 1}"")` read `1` as an `Integer`?"
1716,1559757685.0463,Jasmine,No
1718,1559757756.0469,Somer,Maybe a custom data reader?
1718,1559757826.0478,Jasmine,The string above will not trigger any custom data readers
1718,1559757844.0485,Latonya,"If I understand correctly, a custom data reader could cause a string like `{:foo #my-tag 1 }` to read `#my-tag 1` as an `Integer`, but that is a different string."
1718,1559757857.049,Somer,"Yeah but could easily be written as `(edn/read-string ""{:foo #int 1}"")`"
1718,1559757868.0493,Jasmine,Even that would read 1 as a Long first; And your data reader could convert it to whatever
1718,1559757892.0503,Somer,That's fine. I just want the output to be an int.
1718,1559757974.0508,Latonya,Warning: most kinds of Clojure arithmetic done on an Integer will not return an Integer.
1718,1559758040.0521,Somer,That's ok. Our app has config files in EDN. Some of those config maps need to be passed via a `Properties` map to a Java library. Java libraries typically have methods declared that take an `int` and not ` long`.
1718,1559758221.0525,Dann,"if you use Clojure to call those methods, it usually does the right thing; isn't Properties always string-&gt;string?"
1718,1559758270.0541,Somer,"Hmm, lemme see. I definitely get an exception due to a Long being passed instead of an int."
1718,1559758289.0548,Jasmine,Properties extends Hashtable so you can abuse it by using the parent class methods to put other stuff in it
1718,1559758305.0557,Somer,I do this `(doto (Properties.) (.putAll kafka-config))` and pass it to a Java method.
1718,1559758312.0559,Jasmine,It is one of the worst APIs in Java
1718,1559758314.0561,Dann,"right, but it's not going to be via Properties... at least not via standard methods <https://docs.oracle.com/javase/7/docs/api/java/util/Properties.html#getProperty(java.lang.String)>; <@Somer> all the kafka configs are strings; I know that one specifically; I'm not doubting something wants an int and gets a long, but it's not kafka via properties"
1718,1559758384.0583,Somer,"I passed `{""<http://request.timeout.ms|request.timeout.ms>"" 20000}` as part of the kafka config and it threw the cannot pass a Long exception. This fixed it `{""<http://request.timeout.ms|request.timeout.ms>"" (int 20000)}`"
1718,1559758404.0587,Dann,"`{""<http://request.timeout.ms|request.timeout.ms>"" ""20000""}` is canonical; int happens to work"
1718,1559758417.0594,Somer,"Oh cool. I'll do that, much cleaner."
1718,1559758468.0602,Dann,<@Somer> usually I have a function that turns a clojure hash-map into string/string pairs then puts it into a Properties map
1718,1559758568.0612,Somer,"Yeah, should probably add helper function for that, especially now that I know it's a nasty api."
1719,1559766117.0626,Cristi,"hi,  is it possible to require two different versions of a library and use it at the same time?"
1719,1559766164.0629,Dann,"not in any simple way, no"
1719,1559766306.0632,Cristi,<@Dann> what would be the trick then?
1719,1559766348.0635,Dann,isolated classloaders iirc
1719,1559766384.064,Cristi,thanks! I will search about it
1719,1559766414.0645,Dann,everything I've tried or heard about it makes it seem frustrating
1719,1559766503.0665,Shonda,"A classloader hierarchy along the lines of the one OSGi uses, where peer classloaders do not delegate to their parents when looking for a loaded class. Been a long time since I did this, so the details are very fuzzy."
1719,1559766504.0666,Dann,"and making it work with Clojure iirc requires a pretty intimate understanding of how clojure extends the runtime classloader - my knowledge of this stuff is not very deep, maybe someone else can offer more detail; I know there was at least one fork of clojure for the express purpose of working with isolated classloaders"
1719,1559766543.0675,Shonda,That allowed OSGi services to use different versions of classes IIRC
1719,1559766558.068,Dann,right - the fork I mentioned was for usage with OSGi; because clojure as is wasn't compatible
1719,1559766571.0684,Shonda,but mixing that with Clojure? No idea how :slightly_smiling_face:
1719,1559766647.0693,Dann,"I think it's less about not delegating to parents, and more about creating two (or more) inheritance trees"
1719,1559767149.0741,Shonda,"Delegation might be the wrong word. I remember that it allowed a ""child"" classloader, instantiated for a service, to access classes ""sideways"" from other peers, without first looking in the parent. Or something like that :stuck_out_tongue:; That allowed for an additional security layer, whether a class was exposed outside its service, etc; but this is younger me from ~10 years ago!"
1719,1559767460.0755,Dann,"oh, that's more than I know about it"
1719,1559768169.0762,Shonda,"It was strange stuff in a way, I ported 2 implementations to a ""java on the chip"" box my company at the time made."
1720,1559769621.0773,Jasmine,"you can achieve this isolation in Java by using a post delegation classloader. however, clojure's dynamic classloader explicitly shares a class cache with all other dynamic classloaders"
1720,1559769934.0803,Cristi,"thanks guys, quite interesting, I also heard that it is possible to have clojure repl running along with a pure java application running under Tomcat and invoke commands from the repl, so , in theory we could  write java code, compile it and call from clojure repl without restarting the embeded tomcat server, am I correct?"
1720,1559770151.0817,Jasmine,"not exactly - depends what you're doing; that's not really a clojure question; depends if you're making new classes (then you need a classloader that knows how to load them) or redefining (there are paths  to this in the jvm but it's not trivial to do in general); in general, I'd say you should not do any of that. there are probably better ways to accomplish whatever  goals you have"
1720,1559770254.0844,Cristi,thanks Alex!
1720,1559770292.0857,Jasmine,"like, don't write code, just make new instances using existing classes. and make more flexible frameworks if you need more dynamicity (clojure is great for that via its var system)"
1721,1559770392.0886,Leda,"Hey guys, there is any Microservices example in Clojure? But I want something full fledged and mostly ready to production. I want to see some real project of a medium size or bigger. Not really interested in small examples, but I guess I won’t find this... "
1720,1559770435.0903,Leda,"Small projects are fine to understand stuff, but it really doesn’t teach anything about how a ready to production code is working and should be "
1720,1559770492.0914,Cristi,"the idea is, I'm currently working with an old java framework that requires too much time to build, and also, its too coupled so , you never knows how it will behave xD , so I was looking for a solution for faster feedback; I guess that the only option for that is jRebel or hotSwap agent; but anyway, I'm learning clojure now, to leave this crazy java world :stuck_out_tongue:"
1720,1559770597.0929,Dann,"<@Cristi> why not make a small set of stubs that call into clojure from the framemwork, then redefine the clojure stuff as needed while developing?; the stub should only need to change if you have a major architectural design, and the clojure stuff it calls is freely redefinable without a restart"
1720,1559770649.094,Cristi,uhmm interesting
1720,1559770709.0944,Dann,I've used this pattern for jsvc for example <https://github.com/noisesmith/clj-jsvc-adapter>
1720,1559770833.0952,Cristi,thanks <@Dann> I will have a look at it!
1720,1559771035.0959,Dann,"the code is very small - it just makes a tiny implementation of every method needed, that uses the clojure API to look up a var with a ""magic"" name and call it <https://github.com/noisesmith/clj-jsvc-adapter/blob/master/src/java/org/noisesmith/Cljsvc.java>; it expects an ns with `start`, `init` etc. as vars, then loads the ns and attempts to call them"
1720,1559771100.0968,Cristi,"yeah, its quite intuitive"
1720,1559771333.0977,Dann,"so my hunch is you can do the same with your old java framework - give it methods (probably easier to just do in java), and just make sure everything those methods do can be freely redefined in a repl; then no more restarting the framework for code changes"
1720,1559771360.0981,Latonya,"This small project was announced just recently, using Seesaw and Clojure: <https://www.reddit.com/r/Clojure/comments/bx698b/i_made_a_small_epub_reader_in_clojure>"
1722,1559779922.1042,Talisha,"Does anyone know of a best practice for taking a non-namespaced map (example: `(def x {:a 1, :b 2, :nested {:h 3 :f 4}})` and producing the `namespaced keyword` version given a spec:
example:
```
(s/def ::result (s/keys :req [:thing/a :thing/b :thing/nested]))
(s/def :thing/nested (s/keys :req [:other/f :other/g]))
```
and produces given `x` and the spec `::result` =&gt; `{:thing/a 1 :thing/b 2 :nested {:other/h 3 :other/f 4}}`; Or does a project already do this? For example, I would think the ring swagger coercion would do something like this.; Maybe I am being silly and `(s/keys :req-un [:thing/a])` is the right choice"
1723,1559783332.106,Jasmine,I would do the last - spec the data you have
1724,1559820690.1081,Merna,"<@Phebe> hey if someone wanted to implement the kind of clojure highlighting that you describe in your recent talk, but in emacs, is there anywhere they could steal bits of implementation from...?; I really like the idea of less noisy, more minimal but meaningful highlighting. At the moment I even don't use any highlighting at all, for performance when files have large maps :smile:"
1725,1559822843.1097,Gemma,Hello guys! What is the easiest way of calling clojure functions from an already compiled java class?
1726,1559824483.1124,Isreal,I watched the talk too and was curious to try out the tonsky color scheme! All I found was this <https://github.com/uzhne/alabaster-emacs> but did not try it out yet.
1727,1559829317.1142,Leatha,"hi guys
what is your opinion on partial functions?

Do you use them often?"
1727,1559829374.1147,Andrea,I tend to just use `#()` or something like <https://github.com/we-shop/arrows>
1727,1559830071.1173,Leatha,"Maybe i should've asked how do you deal with partial fns

let say i have defined partial that i will use later on in run time
how do i find out information about that partial function `#function[clojure.core/partial/fn--5561]` when it like this? Is there anyway to 'expand' it ?

Is it bad practice to have a lot of partial fns all over the place that are defined during startup but used during run time?"
1727,1559830302.1176,Jasmine,"there is no way to expand it, it is opaque to users; usually I prefer passing explicit environment over passing partials that close over it; as then it's visible"
1728,1559834424.1195,Gregoria,"Is there way with spec to validate the content of a string? I.e., can I use spec to ensure that a string is made of two parts separated by a ‘:’ (e.g. “procotol:domain”)?"
1727,1559834524.12,Jasmine,there's an example of this in the spec guide via regex for email <https://clojure.org/guides/spec>
1728,1559834626.1202,Gregoria,Right. Thank you!
1729,1559839792.1217,Dann,I can think of a lot of common instances (eg. `(Thread. #(foo))` - but really the answer depends on what the existing Java Class does and how it goes about finding something to invoke and invoking it.
1730,1559841471.1226,Leda,Does the usage of `future` has any implications/gotcha's when running the program within a JAR ?; It seems that it's not being called when running as a JAR
1730,1559841844.124,Dann,"whether your code is in a jar or on disk should not effect how it executes, aside from usage of `File` APIs that don't work for resources inside jars; how are you starting the future, and what's your evidence it doesn't run?"
1730,1559842034.1255,Leda,"yeah i'm having a problem with Files inside the resources too, and i'm trying to figure out how to create folders/files outside of the project folder/jar; my evidence is just a simple `println` inside the future, when running on disk it prints on console, and when running as a JAR it doesn't"
1730,1559842081.1266,Becki,could this be the process exiting before the future is run?
1730,1559842095.127,Dann,"there are no Files inside resources, use <http://clojure.java.io/resource|clojure.java.io/resource> instead of file; <@Leda> note that when an exception is thrown inside a future, it's reserved and doesn't do anything until the future is dereffed; likely the code inside the future is broken when in a jar (perhaps trying to use a file, which isn't valid for things inside jars), and the exception never gets thrown because you don't access the return value of the future"
1730,1559842225.1295,Celestine,"If you're using `timbre` already for logging, it has `logged-future` which is a replacement for `future` that logs any failures -- very handy!"
1730,1559842250.1299,Dann,you can also use try/catch inside future for use cases where you intentionally never deref; (try/catch plus log or print that is)
1730,1559842733.1317,Georgina,"Is there a ballpark memory consumption for a pretty trivial clojure “microservice” that has:
- a few routes
- very moderate traffic
- returns some json :smile:"
1730,1559842758.1324,Dann,I'd use visualvm and see how much of the heap your program uses; the java vm checks how much memory it's allowed to use and just grabs it whether it needs it or not; but visualvm shows how much is actually being used
1730,1559842818.1343,Georgina,"Yes I’m aware, I’m thinking how much is expected for something pretty simple to run. We have java services running with -Xmx=128mb; Will it be equal or more?"
1730,1559842831.1347,Dann,that's definitely too low for clojure
1730,1559842843.1353,Clarine,I guess you can also make and endpoint and expose ` (/ (.freeMemory (Runtime/getRuntime)) (* 1024.0 1024))`?; or usedMemory or whatnot
1730,1559842855.1361,Dann,"use visualvm because libraries can really change the baseline, I'd expect 500megs at least, in the low gigs is normal"
1730,1559842873.1368,Georgina,"<@Clarine> yeah, the problem is it’s very hard to monitor the jvm like that; The gc will take whatever you give it"
1730,1559842893.1377,Dann,"<@Clarine> I prefer visualvm because the actual numbers are constantly oscillating in a sawtooth pattern, but it's easy to see the peaks in the graph"
1730,1559842898.1381,Clarine,ah
1730,1559842913.1387,Dann,(I guess with some stats code you could capture peak / mean values but they are easy to eyeball)
1730,1559842926.1391,Georgina,I think a proper test would involve performance testing the service and lowering the memory allowed for the JVM?; and seeing when stuff stops working
1730,1559842997.1415,Dann,"since the tool differentiates used and allocated, you can get pretty close without lowering the numbers (and also when you  lower the allocation numbers below a certain point you sacrifice performance since the GC is doing more work)"
1730,1559842998.1416,Georgina,"I’ve got some pretty zealous colleagues when it comes to RAM memory usage, and I kind of can see their point since our software runs on prem at the customers data centers"
1730,1559843010.1419,Dann,they won't like clojure
1730,1559843025.1422,Georgina,Hehe I’m getting that feeling :slightly_smiling_face:
1730,1559843060.1434,Dann,"there are many places where clojure explicitly decides to use more heap space (for performance, for simplicity / consistency...)"
1730,1559843093.1445,Leda,<@Dann> the problem was indeed the future throwing an exception. It happens that i'm trying to execute a shell command inside a folder that is inside the JAR. and this seems to be impossible
1730,1559843107.1447,Dann,"there is no folder inside a jar; there's a resource path; if the shell needs to use your resources, you need to expand the jar; (or a system level tool that knows how to mount a zip file as a file system, but that would be OS specific)"
1730,1559843238.1475,Leda,"i don't necessarily need to access the files within the jar, i could first create them outside of it, but i'm having problems accessing anything outside the scope of the project, it doesn't accept to create a folder with the absolute path like: /home/user/folder"
1730,1559843271.148,Dann,for programmatically expanded things I'd opt for /tmp; or some other file system designed for ephemeral resources created by a program
1730,1559843297.1487,Leda,i was planning on using docker volumes; because i'm using docker to get prod ready
1730,1559843315.1493,Dann,"OK, there's a /tmp inside the docker image"
1730,1559843334.1497,Karren,"Exactly, it's also not that useful to use visualvm for the same reason."
1730,1559843354.1504,Dann,"and more importantly, it's mounted to a real file system that you can alter at runtime with a program in that image"
1730,1559843371.1508,Leda,"alright, i'll try to write the folder/files to a /tmp"
1730,1559843371.1509,Dann,(real as far as anything in your image is concerned at least)
1730,1559843383.1511,Karren,I'm successfully running a small Clojure app with -Xmx256m but the only way to check is to run bunch of different settings and workloads and see how it works.
1730,1559843432.1523,Dann,"<@Leda> a more specific gotcha is if you don't drop permissions, root's home dir isn't /home/root, it's /root; but /tmp is more reliable anyway"
1730,1559843478.1528,Leda,this `(.mkdir (java.io.File. folder-path))`  should work with a folder-path like this: `/tmp` ?
1730,1559843492.1531,Karren,Different GCs may give you different results especially in low-memory settings. I've heard that Shenandoah may be pretty good in such situations.
1730,1559843500.1536,Dann,"well, if folder-path is nested, don't use mkdir - there's one for nested dirs but it's different"
1730,1559843501.1537,Leda,"ops, `/tmp/my-folder`"
1730,1559843505.1538,Georgina,Interesting!; I think I could probably get away with 512mb but not much more
1730,1559843524.1545,Dann,"but sure, with a single level, mkdir should work"
1730,1559843534.1546,Karren,beware that JVM memory consumption isn't just heap though
1730,1559843550.155,Georgina,Atleast not for services that are also trivial to solve in plain java or kotlin.
1730,1559843552.1553,Dann,<https://docs.oracle.com/javase/7/docs/api/java/io/File.html#mkdirs()> creates all parents as needed; just an extra s in your code!
1730,1559843618.1556,Georgina,Yeah
1730,1559843719.156,Leda,"thanks for sharing this; but it really is a single level nesting; it's just a folder that i transform into a zip file later on, in the same function"
1730,1559843842.1571,Georgina,The downside of a really high level language I guess. :slightly_smiling_face:; Kind of conflicts with my current desire to write a bunch of small focused services.
1730,1559843875.1575,Celestine,"FWIW, most of the processes on our QA servers run with 256m heaps just fine. Even in production with heavy traffic, most of our processes run with 1g heaps. Only a few have larger heaps (and that's just to avoid GC bottlenecks if there's a really big spike in traffic).; Prior to Clojure, we used a web stack that really needed 10-15g to run smoothly so Clojure seems very lightweight to us :slightly_smiling_face:"
1730,1559843961.1579,Georgina,Hehe I guess we all have different contexts - I’ve written the last few services in Go which have been very easy on the RAM; And the CSP implementation actually make it sort of workable with concurrency; Kind of feels like brutalist programming tho compared to clojure :slightly_smiling_face:
1730,1559844148.1588,Leda,"thanks <@Dann> it worked on the JAR now, and i'm using the /tmp/ folder"
1730,1559844156.1589,Celestine,"Yeah, non-JVM systems seem to use tiny amounts of memory by comparison. I know lots of places that run JVM processes with heaps in the tens of GB :slightly_smiling_face:"
1730,1559844244.16,Leda,"now my Ring middleware only serve files inside the resource folder, so i need to point this files from /tmp/ and make them available :joy:"
1730,1559844577.1604,Dann,<@Leda> just use `wrap-resource` instead of `wrap-file`
1730,1559844612.1607,Leda,"i just saw it on the documentation hehe; i'll use both, since i need static files on the resources folder"
1730,1559844644.1615,Dann,"wrap-resource works on files; (as long as the directory is on classpath, but that's easy to arrange)"
1731,1559846106.1639,Mariela,"given a  symbol `'a.b.c`, how can I ask Clojure ""from which file/files you would you fetch this ns?""

would help me debug a possible classpath issue"
1731,1559846331.1642,Rosaline,you can't
1731,1559846382.1646,Mariela,"to be clear, I can just `ps aux | grep classpath` and see the process' classpath, but I want to see the exact thing Clojure would do"
1731,1559846430.1653,Marlyn,"either clojure will load it from `a/b/c.clj` or if AOT'ed from `a/b/c__init.class`; so run this:; `(require '[<http://clojure.java.io|clojure.java.io> :as io]) (io/resource ""a/b/c.clj"") (io/resource ""a/b/c__init.class"")`"
1731,1559846491.1667,Dann,*rarely* you should also check foo.cljc
1731,1559846507.1671,Rosaline,and you might need to do the underscores for dashes thing
1731,1559846520.1674,Jasmine,there is a munge function for that
1731,1559846546.1678,Dann,it would be convenient if there was a function that did the exact lookup and showed the resource it found
1731,1559846563.168,Rosaline,or if verbose loading included it
1731,1559846573.1682,Marlyn,^ that could be nice
1731,1559846815.1703,Mariela,"```
dev=&gt; (<http://clojure.java.io/resource|clojure.java.io/resource> ""clojure/core/specs/alpha.clj"")
#object[java.net.URL 0x675c1f6b ""jar:file:/Users/vemv/.m2/repository/clojure-future-spec/clojure-future-spec/1.9.0-beta4/clojure-future-spec-1.9.0-beta4.jar!/clojure/core/specs/alpha.clj""]
```

that was it! very likely I debugged the source of my issue (this library was overwriting the latest-and-greatest `clojure.core.specs.alpha`)

thanks <@Marlyn>"
1731,1559847045.1706,Marlyn,np <@Mariela> classpath conflicts are turrible
1732,1559847554.1707,Isa,Do you know why Clojure in google trends going down since 2017? it is like 40% less.
1731,1559847844.1714,Leda,"it seems that on 2017 or so, there was a giant hype about Functional programming"
1732,1559847871.172,Leda,now it's becoming something that all major languages are implementing in some way or another; but that's just a guess
1732,1559848008.1729,Isa,"I see how other languages grow, but Clojure going down. Just it worry me a little.; Well, probably more, than that :slightly_smiling_face:"
1732,1559848108.1741,Leda,"it seems that google trends do really show  a trend on functional programming from 2016 to the present; interesting that china has a lead on this trend, but probably because there is a billion of chinese people"
1732,1559848163.1752,Isa,"yes, I am surprised too"
1732,1559849036.1761,Jasmine,"fortunately, I do not program with Google, so all my Clojure programs still work great"
1733,1559852762.1832,Isa,What do you do on solutions like kubernetes where you create many services to reduce memory consumption in Clojure?
1733,1559852778.1834,Mariela,"...the issue above left me quite frustrated (~90m wasted) so probably I will implement a linter based on this snippet:

```
(defn resources
  ([n]
   (resources n (.getContextClassLoader (Thread/currentThread))))
  
  ([n ^ClassLoader loader]
   (.getResources loader n)))

(-&gt;&gt; ""clojure/core/specs/alpha.clj""
     resources
     enumeration-seq
     (map str)
     (clojure.pprint/pprint))

;; the above results in:
'(""jar:file:/Users/vemv/.m2/repository/clojure-future-spec/clojure-future-spec/1.9.0-beta4/clojure-future-spec-1.9.0-beta4.jar!/clojure/core/specs/alpha.clj""
  ""jar:file:/Users/vemv/.m2/repository/org/clojure/core.specs.alpha/0.2.44/core.specs.alpha-0.2.44.jar!/clojure/core/specs/alpha.clj"")
```

• list every ns declared/required in your project, fetch their `resources`
• if for any given ns there is more than one entry, issue a warning; Have you already tried trimming the dependencies on a per-service basis?

e.g. all services use the same deps b/c you have some internal framework, but maybe each service actually needs a fraction of that"
1733,1559853253.1841,Isa,"no, it is new topic for me; But I am not sure I would like to risk to do it and want to maintenance it :wink:; Probably will be easier paying for RAM heh :wink:"
1733,1559853325.1847,Mariela,"just to be clear I'm talking about plain project.clj / deps.edn dependencies. No much surgery needed

Are you using a large web framework?"
1733,1559853354.185,Isa,I don’t use frameworks at all. I prefer to use small libraries instead.; So for example I have service only to login user as auth-provider; but while it is Clojure it will consume so much RAM for such simple thing
1733,1559853429.1856,Mariela,"&gt; I don’t use frameworks at all. I prefer to use small libraries instead.

then it might be worth a shot. `lein deps :tree` might reveal where the bloat comes from

(if you are complaining about baseline :clj: RAM consumption, then I have no idea)"
1733,1559853438.1858,Isa,"Probably Clojure is not a good choice for such services, but I don’t feel confident to write it in for example golang; yes, it is a little about baseline :wink:; but not only, just I would like to listen somebody experienced in this topic"
1733,1559853512.1864,Mariela,perhaps there is some useful insight in the `Microservices with Clojure` book. Haven't got my hands to it yet
1733,1559853718.1868,Isa,But yeah… Probably the true is we should use another languages for small services or pay more for RAM :slightly_smiling_face:; there will be no magic
1733,1559853755.1872,Mariela,worst-case scenario you can resort to cljs / node.js :stuck_out_tongue_winking_eye:
1733,1559853791.1875,Isa,"Paying for RAM is not so bad :stuck_out_tongue: :wink:; I am thinking about it, because I am doing my own hobby project, which will became something serious maybe. So I will pay for everything from my own pocket.; Then you start to count this “small” bills and it matter heh; I am going sleep. Goodnight."
1733,1559854192.1909,Clarine,"I tried to find where `RELEASE` and `LATEST` are documented but then I read they are deprecated in maven 3?
How does this relate exactly to clojure deps and lein, since they use the maven stuff under the hood?
```
clj -Sdeps '{:deps {org.clojure/clojure {:mvn/version ""LATEST""}}}' -e '(clojure-version)'
```"
1734,1559854432.1913,Jasmine,they still work
1733,1559854460.1916,Jasmine,but I consider them to be unsupported from a clj / tools.deps pov
1734,1559854478.1919,Jasmine,because they are not fixed versions
1733,1559854570.1927,Clarine,"yeah, I usually only use it for one-off things in the command line when I don’t feel like looking up a version number. I didn’t even know `LATEST` existed until today"
1734,1559855687.1938,Celestine,"`clj-new` produces deps like that so that I don't have to keep updating `clj-new`'s templates when new versions of libraries drop. I figured folks would change the deps to specific versions if they wanted.; At work, we have some dev-only tooling that uses `RELEASE` so we always pick up the newest versions. If anything breaks in dev, we can easily pin a tool back to a working version."
1733,1559855753.1952,Celestine,(I don't use `LATEST` for anything tho')
1735,1559856355.1967,Danita,"Hi, what would you say is the essential Clojure testing stack? spec, test.check, clojure.test - anything else?"
1735,1559857274.1977,Lesa,"There's a lot to factor into that - what are you testing? where? (repl, cli, ci?); We currently use all of the above + `test.chuck` and `eftest`"
1735,1559857626.2002,Mariela,"etaoin if developing web apps
aero or such for having clean per-env config
component/integrant for having clean per-env systems
expound

more exotic: circleci.test, kaocha"
1735,1559857677.2013,Danita,<@Lesa>  Im talking about CI for medium-to-large commercial projects.; Thanks for the info.
1735,1559858354.2037,Celestine,"<@Danita> We have about 80k lines of Clojure at work. About 20k of that is test code. We use `clojure.test` and Cognitect's `test-runner` (since we're all `clj`/`deps.edn`-based). We use `clojure.spec` but mostly in production code for data validation, although we do use some instrumentation in dev/test, and we do some generative testing with it (so we use `test.check` under the hood as well).; We also use <https://github.com/clojure-expectations/clojure-test> (I prefer the `expect` style syntax) -- we used to use the core Expectations library but it wasn't compatible with `clojure.test`-based tooling."
1735,1559858534.2058,Danita,"Thanks, that's very helpful. I know what to research."
1735,1559858620.2086,Celestine,"We used to have Clojure-based Selenium/WebDriver tests -- and we used `clj-webdriver` for that but we've killed off those web apps and that library is pretty much unmaintained now. I'd probably look at etaoin if I needed that these days. We do have some `HtmlUnit`-based tests, just using `clojure.test` for assertions and plain Java interop.; And, like <@Lesa>, we use `test.chuck` for some stuff above and beyond `test.check` (mostly for string regex generators)."
1735,1559858736.2111,Danita,"Noted. I'm checking, because I'm preparing a pitch for the company. The big focus is on testing. Right now a lot of code is in Python which, as far as property-based testing is concerned, only has `hypothesis`.; Clojure seems to be much more powerful in this area."
1735,1559859486.2128,Dann,"also, for circleci specifically, there's a circleci test namespace that runs clojure.test tests but has some extra ci-friendly features; circle uses clojure internally and supports it well"
1735,1559860601.2136,Danita,What about Midje? Is it recommended?
1735,1559861325.214,Marlyn,Not recommended <@Danita> 
1735,1559866167.2152,Celestine,Agreed re: Midje. Definitely not recommended by quite a few folks <@Danita>
1735,1559866509.216,Oleta,"<@Danita> FWIW, if you end up using spec for generative testing, expound can help format the results: <https://github.com/bhb/expound#printing-results-for-check>; Orchestra is also useful if you plan to instrument functions during tests"
1735,1559871806.2188,Elaine,I use midje like this `(deftest foo (fact (+ 1 2) =&gt; 3))` and it's fine. <#C0744GXCJ|cursive> interation and `clj -A:test:test-runner` via `cognitect-labs/test-runner` works. Also I have the power of `contains/just`
1735,1559877032.2207,Celestine,"<@Elaine> I've never found Midje's syntax readable, but it's good to know it can be used like that with `deftest`. With `expectations.clojure.test` that was my goal, so you can write `(deftest foo (expect 3 (+ 1 2)))` -- and `expect` lets you use specs, predicates, and you can ""expect more"" with destructuring etc."
